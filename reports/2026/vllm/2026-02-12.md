# æ¯æ—¥æ›´æ–°æŠ¥å‘Šï¼ˆ2026-02-12ï¼‰

## vllm-project/vllm

| æäº¤æ—¶é—´ | ä½œè€… | æäº¤ä¿¡æ¯ |
|----------|------|----------|
| 2026-02-12 22:09:55 | danisereb | Add config file for fused MoE for Nemotron (TP4, B200) (#34411) |
| 2026-02-12 21:06:33 | Douglas Lehr | [ROCm] Enable MXFP4 MoE weight pre-shuffling on gfx950 and update aiter (#34192) |
| 2026-02-12 20:44:28 | Cyrus Leung | [V0 Deprecation] Remove code related to per-request logits processors (#34400) |
| 2026-02-12 16:22:06 | baonudesifeizhai | Fix Mistral config remap to accept compressed-tensors quantization #34028 (#34104) |
| 2026-02-12 16:04:44 | Louie Tsai | Vllm CPU benchmark suite improvement (#34128) |
| 2026-02-12 15:26:49 | AllenDou | [bugfix] refactor FunASR's _get_data_parser  (#34397) |
| 2026-02-12 15:15:16 | Kyle Sayers | [Bugfix] Fix Sparse24 Compressed Tensors models (#33446) |
| 2026-02-12 14:50:23 | Yichuan Wang | Fix DeepSeek-OCR tensor validation for all size variants (#34085) |
| 2026-02-12 14:44:03 | Lucas Wilkinson | [BugFix] Fix DP chunking  (#34379) |
| 2026-02-12 11:38:11 | Cyrus Leung | [Refactor] Pass Renderer to Input Processor (#34329) |
| 2026-02-12 11:33:15 | Cyrus Leung | [Refactor] Move validation to params definitions (#34362) |
| 2026-02-12 11:30:57 | Runkai Tao | [Bug Fix] Fix `naive_block_assignment` always defaulting to False due to arg misalignment (#33848) |
| 2026-02-12 11:08:19 | Michael Goin | [Bugfix] Fix MTP accuracy for GLM-5 (#34385) |
| 2026-02-12 09:29:32 | Michael Goin | [Refactor] Replace `activation: str` with `MoEActivation` enum (#33843) |
| 2026-02-12 08:54:17 | Kevin H. Luu | [ci] Integrate AMD tests into CI (#33626) |
| 2026-02-12 07:52:34 | Micah Williamson | [ROCm][CI] Revert Test Groups From mi325_8 to mi325_1 Agent Pool In AMD CI (#34384) |
| 2026-02-12 06:33:14 | bnellnm | [Bugfix] Fix some issues with MoERunner PR #32344 (#34371) |
| 2026-02-12 06:17:16 | Wei Zhao | Fix CI failure - Flashinfer Kernel tests (#34316) |
| 2026-02-12 05:02:05 | Raushan Turganbay | [Bugfix] Fix more multimodal tests for transformers V5 (#34334) |
| 2026-02-12 05:01:53 | Junseo Park | [Bugfix] send None sentinel on final commit so server properly sends transcription.done (#33963) |
| 2026-02-12 04:57:57 | Tomas Ruiz | [Benchmarks] Reduce ready checker log verbosity (#34349) |
| 2026-02-12 04:29:29 | elvischenv | [GPT-OSS] Remove unnecessary contiguous (#34337) |
| 2026-02-12 02:50:44 | TJian | [ROCm] [CI] fix test_unrecognized_env (#34350) |
| 2026-02-12 02:24:22 | Eldar KurtiÄ‡ | [Bugfix] Enable attn quantization of Llama-4 by correctly permuting scales for rope (int8, fp8) (#34243) |
| 2026-02-12 02:20:45 | Xinyu Dong | [Bugfix] fix default is_neox_style is True for deepseek (#34353) |
| 2026-02-12 01:37:40 | Isotr0py | [Multimodal] Expose `mm_processor_kwargs` for `DummyInputsBuilder` (#34330) |
| 2026-02-12 01:12:13 | Xinyu Chen | [Model Runner V2] Init cuda graph pool when necessary (#33217) |
| 2026-02-12 01:03:48 | junuxyz | [CI][BugFix] Fix silent failure in shellcheck hook and baseline existâ€¦ (#32458) |
| 2026-02-12 01:02:27 | SorenDreano | [Docs] Fix typo ("defult") and double spacing (#34348) |
| 2026-02-12 00:26:44 | kliuae | [ROCm] [aiter] Split KV cache update for AiterFlashAttention (#33681) |
| 2026-02-12 00:12:05 | Rohan Potdar | [Bugfix]: Fix ROCm fusion attn test; use AttentionBackend utils to create kv cache (#33948) |
| 2026-02-12 00:09:40 | Harry Mellor | Don't try and run GLM-ASR with remote code (#34352) |

### ğŸ“Š ç»Ÿè®¡æ‘˜è¦
> æœ¬æ—¥å…± 32 ä¸ªæäº¤ | ğŸ”´é«˜ 1 | ğŸŸ¡ä¸­ 12 | ğŸŸ¢ä½ 19
## ğŸ“‹ ç›®å½•

- [vllm-project/vllm](#vllm-project-vllm)
  - [ğŸ“Š ç»Ÿè®¡æ‘˜è¦](#-ç»Ÿè®¡æ‘˜è¦)
  - [ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (1)](#-ğŸ”´-é«˜é‡è¦åº¦å˜æ›´-1)
    - [[Refactor] Replace `activation: str` with `MoEActivation`...](#ff1f83b)
  - [ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (12)](#-ğŸŸ¡-ä¸­é‡è¦åº¦å˜æ›´-12)
    - [[V0 Deprecation] Remove code related to per-request logit...](#fb455ed)
    - [Vllm CPU benchmark suite improvement (#34128)](#55a1a95)
    - [[Bugfix] Fix Sparse24 Compressed Tensors models (#33446)](#e9cd691)
    - [[Refactor] Pass Renderer to Input Processor (#34329)](#b96f731)
    - [[Refactor] Move validation to params definitions (#34362)](#ced2a92)
    - [[ci] Integrate AMD tests into CI (#33626)](#83b47f6)
    - [Fix CI failure - Flashinfer Kernel tests (#34316)](#5aff269)
    - [[Bugfix] Fix more multimodal tests for transformers V5 (#...](#527ca32)
    - [[Multimodal] Expose `mm_processor_kwargs` for `DummyInput...](#0ab0610)
    - [[CI][BugFix] Fix silent failure in shellcheck hook and ba...](#fa7e0bf)
    - [[ROCm] [aiter] Split KV cache update for AiterFlashAttent...](#64f570a)
    - [[Bugfix]: Fix ROCm fusion attn test; use AttentionBackend...](#fd61887)
  - [ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (19)](#-ğŸŸ¢-ä½é‡è¦åº¦å˜æ›´-19)
    - [Add config file for fused MoE for Nemotron (TP4, B200) (#...](#dea6351)
    - [[ROCm] Enable MXFP4 MoE weight pre-shuffling on gfx950 an...](#8a798be)
    - [Fix Mistral config remap to accept compressed-tensors qua...](#f589761)
    - [[bugfix] refactor FunASR's _get_data_parser  (#34397)](#386bfe5)
    - [Fix DeepSeek-OCR tensor validation for all size variants ...](#80f2ba6)
    - [[BugFix] Fix DP chunking  (#34379)](#136b0bf)
    - [[Bug Fix] Fix `naive_block_assignment` always defaulting ...](#e1d97c3)
    - [[Bugfix] Fix MTP accuracy for GLM-5 (#34385)](#ec12d39)
    - [[ROCm][CI] Revert Test Groups From mi325_8 to mi325_1 Age...](#fb7b30c)
    - [[Bugfix] Fix some issues with MoERunner PR #32344 (#34371)](#31d992d)
    - [[Bugfix] send None sentinel on final commit so server pro...](#5458eb8)
    - [[Benchmarks] Reduce ready checker log verbosity (#34349)](#144d9b7)
    - [[GPT-OSS] Remove unnecessary contiguous (#34337)](#83e26c8)
    - [[ROCm] [CI] fix test_unrecognized_env (#34350)](#5001211)
    - [[Bugfix] Enable attn quantization of Llama-4 by correctly...](#11c7ace)
    - [[Bugfix] fix default is_neox_style is True for deepseek (...](#be7f3d5)
    - [[Model Runner V2] Init cuda graph pool when necessary (#3...](#ffb3d55)
    - [[Docs] Fix typo ("defult") and double spacing (#34348)](#48134a2)
    - [Don't try and run GLM-ASR with remote code (#34352)](#67a42b5)
#### ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (1)

### [Refactor] Replace `activation: str` with `MoEActivation` enum (#33843)
**SHA**: `ff1f83b` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/ff1f83b056aedcf3e2d978d267011b2b79c08aca)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆRefactorï¼‰â€”â€”å°†æ‰€æœ‰ `activation: str` å‚æ•°ç»Ÿä¸€æ›¿æ¢ä¸º `MoEActivation` æšä¸¾ï¼Œå¹¶æ–°å¢ `activation.py` ä¸ç›¸å…³å·¥å…·å‡½æ•°ã€‚

**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´ é«˜  
* å½±å“é¢å¹¿ï¼ˆæ ¸å¿ƒ MoE å±‚ã€é‡åŒ–ã€Benchmarksã€å•å…ƒæµ‹è¯•ç­‰ 30+ æ–‡ä»¶ï¼‰ã€‚  
* æ”¹åŠ¨æ¶‰åŠå…¬å¼€ APIï¼ˆ`FusedMoEConfig.activation`ã€`fused_experts` ç­‰ï¼‰ï¼Œå¯èƒ½å¯¼è‡´ä¸‹æ¸¸é¡¹ç›®åœ¨å‡çº§åå‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚  

---

## ğŸ“‹ å˜æ›´æ‘˜è¦
1. æ–°å¢ `vllm/model_executor/layers/fused_moe/activation.py`ï¼š  
   - `MoEActivation` æšä¸¾å®šä¹‰æ‰€æœ‰ MoE æ¿€æ´»å‡½æ•°ï¼ˆå« gated ä¸é gated å˜ä½“ï¼‰ã€‚  
   - å®ç° `is_gated`ã€`custom_op_name`ã€`without_mul()`ã€`from_str()` ç­‰å±æ€§/æ–¹æ³•ã€‚  
   - æä¾› `activation_without_mul()` ä¸ `apply_moe_activation()` ä¸¤å¤§å·¥å…·å‡½æ•°ã€‚  

2. **å…¨å±€è¿ç§»**ï¼šæ‰€æœ‰å‡½æ•°ç­¾åã€å†…éƒ¨è°ƒç”¨ã€é…ç½®ç»“æ„ä» `str` â†’ `MoEActivation`ï¼ˆæˆ– `MoEActivation` å®ä¾‹çš„ `value`ï¼‰ï¼Œå¹¶åœ¨éœ€è¦å‘ä½å±‚ C/C++/CustomOp ä¼ é€’æ—¶ä½¿ç”¨ `.value` æˆ– `.custom_op_name`ã€‚  

3. **å…¼å®¹å±‚**ï¼š  
   - `MoEActivation.from_str()` ç”¨äºæ—§ API å‘åå…¼å®¹ï¼ˆåœ¨å°‘æ•°å†…éƒ¨ä»æ¥å—å­—ç¬¦ä¸²ï¼‰ã€‚  
   - `activation_without_mul()` ä»ä¿ç•™åŸæœ‰è¡Œä¸ºï¼Œåªæ˜¯å†…éƒ¨å®ç°åŸºäºæšä¸¾ã€‚  

4. **ç›¸å…³æ¨¡å—åŒæ­¥æ›´æ–°**ï¼š  
   - `fused_moe`ã€`cutlass_moe`ã€`flashinfer_*`ã€`triton_*`ã€`quantization/*`ã€`cpu_fused_moe`ã€`xpu_fused_moe`ã€`rocm_aiter_fused_moe`ã€`layer.py`ã€`modular_kernel.py` ç­‰æ ¸å¿ƒå®ç°ã€‚  
   - æ‰€æœ‰æµ‹è¯•ã€benchmarkã€å·¥å…·è„šæœ¬å‡æ”¹ç”¨ `MoEActivation`ã€‚  

---

## ğŸ¯ å½±å“èŒƒå›´
| æ¨¡å— / ç»„ä»¶ | å—å½±å“çš„åŠŸèƒ½ |
|------------|--------------|
| `vllm.model_executor.layers.fused_moe.*` | å‚æ•°æ ¡éªŒã€æ¿€æ´»å‡½æ•°åˆ†æ”¯ã€å·¥ä½œç©ºé—´è®¡ç®—ã€é‡åŒ–æ–¹æ¡ˆåˆ¤æ–­ |
| `vllm.model_executor.layers.fused_moe.config.FusedMoEConfig` | `activation` ç±»å‹æ”¹ä¸º `MoEActivation` |
| `vllm.model_executor.layers.fused_moe.layer.FusedMoELayer` | åˆå§‹åŒ–æ—¶å°†å­—ç¬¦ä¸²è½¬ä¸ºæšä¸¾ |
| é‡åŒ–å­æ¨¡å— (`fp8`, `mxfp4`, `wna16`, `gguf`, `modelopt`, `quark`, â€¦) | æ£€éªŒæ¿€æ´»å‡½æ•°æ—¶ä½¿ç”¨æšä¸¾ï¼Œéƒ¨åˆ† assert è¯­å¥æ›´æ–° |
| Benchmarks / Tests / Utils | å…¨éƒ¨æ”¹ä¸ºæšä¸¾è°ƒç”¨ï¼Œéƒ¨åˆ†é€»è¾‘ï¼ˆå¦‚ `is_gated` åˆ¤å®šï¼‰ç®€åŒ– |
| Custom Op æ³¨å†Œ (`vllm.model_executor.layers.activation`) | é€šè¿‡ `MoEActivation.custom_op_name` ç»Ÿä¸€æ˜ å°„ |
| å¤–éƒ¨ç”¨æˆ·ä»£ç ï¼ˆå¦‚è‡ªè¡Œæ„é€  `FusedMoEConfig`ï¼‰ | å¿…é¡»ä½¿ç”¨ `MoEActivation.SILU` ç­‰æšä¸¾æˆ–ä»å¯ä¼  `"silu"`ï¼ˆä¼šåœ¨å†…éƒ¨è½¬ä¸ºæšä¸¾ï¼‰ |

---

## ğŸ” æŠ€æœ¯æ´å¯Ÿ

| ç»´åº¦ | å½±å“åˆ†æ |
|------|----------|
| **æ¶æ„å½±å“** | - **ç»Ÿä¸€æŠ½è±¡å±‚**ï¼šæ¿€æ´»å‡½æ•°çš„æšä¸¾åŒ–æŠŠæ•£è½åœ¨å„å­æ¨¡å—çš„ç¡¬ç¼–ç å­—ç¬¦ä¸²é›†ä¸­åˆ° `activation.py`ï¼Œé™ä½è€¦åˆåº¦ã€‚<br>- **API æ”¹åŠ¨**ï¼šå…¬å¼€é…ç½®ã€å‡½æ•°ç­¾åç»Ÿä¸€ä¸º `MoEActivation`ï¼Œæ˜¯ä¸€æ¬¡ **å‘å‰å…¼å®¹**ï¼ˆé€šè¿‡ `from_str`ï¼‰çš„ç ´åæ€§æ”¹åŠ¨ï¼Œéœ€è¦åœ¨æ–‡æ¡£å’Œå‘å¸ƒè¯´æ˜ä¸­æ˜ç¡®ã€‚ |
| **æ€§èƒ½å½±å“** | - **è¿è¡Œæ—¶å¼€é”€**ï¼šæšä¸¾å®ä¾‹åœ¨ Python å±‚ä»…æ˜¯è½»é‡å¯¹è±¡ï¼Œå±æ€§è®¿é—® (`is_gated`, `.value`) ä¸å­—ç¬¦ä¸²æ¯”è¾ƒç›¸å½“ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚<br>- **å†…å­˜å ç”¨**ï¼š`MoEActivation` å¸¸é©»å†…å­˜çš„å”¯ä¸€å®ä¾‹ï¼Œç›¸æ¯”å¤šä¸ªå­—ç¬¦ä¸²å®ä¾‹åè€Œæ›´çœå†…å­˜ã€‚<br>- **ç¼–è¯‘å™¨/Custom Op**ï¼šä¸å†åœ¨ C++/CUDA ä¾§ä¼ é€’å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯é€šè¿‡ `custom_op_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰æˆ–ç›´æ¥ä½¿ç”¨æšä¸¾å€¼çš„ `value`ï¼Œä¿æŒåŸæœ‰è°ƒç”¨æ–¹å¼ï¼Œæ€§èƒ½ä¸å—å½±å“ã€‚ |
| **å®‰å…¨è€ƒè™‘** | - **è¾“å…¥æ ¡éªŒæ›´ä¸¥æ ¼**ï¼šæšä¸¾é™åˆ¶äº†éæ³•æ¿€æ´»åç§°çš„å‡ºç°ï¼Œé¿å…å› æ‹¼å†™é”™è¯¯å¯¼è‡´è°ƒç”¨æœªçŸ¥ CustomOpï¼ˆæ½œåœ¨çš„å®‰å…¨/å´©æºƒé£é™©ï¼‰ã€‚<br>- **æ— æ–°å¢å¤–éƒ¨ä¾èµ–**ï¼Œä»£ç è·¯å¾„æœªå¼•å…¥å¤–éƒ¨è§£ææˆ–åŠ¨æ€æ‰§è¡Œï¼Œå®‰å…¨é£é™©æä½ã€‚ |
| **å¯ç»´æŠ¤æ€§** | - **ç±»å‹å®‰å…¨**ï¼šPython ç±»å‹æ£€æŸ¥ï¼ˆmypy/pyrightï¼‰å¯æ•è·é”™è¯¯ï¼Œæå‡å¼€å‘ä½“éªŒã€‚<br>- **å•ç‚¹ç»´æŠ¤**ï¼šæ–°å¢æ¿€æ´»æˆ–ä¿®æ”¹è¡Œä¸ºä»…éœ€åœ¨ `activation.py` ä¸­åŒæ­¥ï¼Œé™ä½é—æ¼é£é™©ã€‚<br>- **ä»£ç å†—ä½™ä¸‹é™**ï¼šå¤§é‡ `"silu"`ã€`"gelu"` ç­‰å­—ç¬¦ä¸²æ¯”è¾ƒç»Ÿä¸€ä¸ºæšä¸¾æˆå‘˜æ¯”è¾ƒã€‚ |
| **å…¼å®¹æ€§/è¿ç§»æˆæœ¬** | - **å‘åå…¼å®¹**ï¼šå¤§å¤šæ•°å†…éƒ¨è°ƒç”¨å·²æ”¹ä¸ºæšä¸¾ï¼Œå°‘æ•°ä»æ¥å—å­—ç¬¦ä¸²å¹¶é€šè¿‡ `MoEActivation.from_str` è½¬æ¢ã€‚<br>- **å¤–éƒ¨é¡¹ç›®**ï¼šç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²çš„ä»£ç ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º `AssertionError`ï¼ˆå¦‚ `assert activation == MoEActivation.SILU`ï¼‰ï¼Œéœ€è¦æ›´æ–°ã€‚<br>- **åºåˆ—åŒ–**ï¼š`FusedMoEConfig` è‹¥è¢«ä¿å­˜ä¸º JSON/YAMLï¼Œéœ€åºåˆ—åŒ–ä¸º `activation.value`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼ŒåŠ è½½æ—¶ä½¿ç”¨ `MoEActivation.from_str`ã€‚ |
| **æµ‹è¯•è¦†ç›–** | - è¿‘ 200 æ¡æµ‹è¯•å·²åŒæ­¥ä¸ºæšä¸¾ï¼Œè¦†ç›–äº†æ‰€æœ‰æ¿€æ´»è·¯å¾„ï¼ˆgated / nonâ€‘gatedã€quantized / nonâ€‘quantizedã€CPU / GPU / XPU / ROCmï¼‰ã€‚<br>- éœ€è¦é¢å¤– **é›†æˆå±‚é¢**ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å‹ï¼‰éªŒè¯å…¼å®¹æ€§ã€‚ |

---

## âš ï¸ æ½œåœ¨é£é™©

1. **å¤–éƒ¨ API çªç ´**  
   - ç¬¬ä¸‰æ–¹åº“æˆ–è„šæœ¬ä»ä½¿ç”¨ `activation="silu"` ç›´æ¥ä¼ é€’ç»™ `FusedMoEConfig`ã€`fused_experts` ç­‰ï¼Œä¼šåœ¨è¿è¡Œæ—¶è§¦å‘ `AssertionError`ï¼ˆå› ä¸ºå†…éƒ¨å·²æ”¹ä¸º `MoEActivation`ï¼‰ã€‚  
   - è‹¥æœ‰åºåˆ—åŒ–/ååºåˆ—åŒ–ï¼ˆå¦‚ `torch.save` / `json.dump`ï¼‰ä¿å­˜çš„æ˜¯æšä¸¾å¯¹è±¡ï¼Œæ—§ç‰ˆæœ¬åŠ è½½å™¨å¯èƒ½æ— æ³•è§£æã€‚  

2. **ä¸å®Œæ•´è¿ç§»**  
   - æŸäº›è¾¹ç¼˜è·¯å¾„ï¼ˆå¦‚ä½é¢‘ `apply_moe_activation` çš„è‡ªå®šä¹‰è°ƒç”¨ã€æˆ–æŸäº›å®éªŒæ€§ backâ€‘endsï¼‰ä»å¯èƒ½ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¯¼è‡´è¿è¡Œæ—¶ä¸ä¸€è‡´æˆ–éšå¼é”™è¯¯ã€‚  

3. **æ–‡æ¡£/ç¤ºä¾‹å»¶è¿Ÿ**  
   - å®˜æ–¹æ–‡æ¡£ã€ç¤ºä¾‹ä»£ç ä»å±•ç¤ºå­—ç¬¦ä¸²å½¢å¼ï¼Œç”¨æˆ·åœ¨å‡çº§åå¯èƒ½é‡åˆ°è¿·æƒ‘ã€‚  

4. **æšä¸¾å€¼ä¸ CustomOp åç§°ä¸åŒ¹é…**  
   - `custom_op_name` æ˜ å°„è¡¨è‹¥é—æ¼æ–°æ¿€æ´»æˆ–æ‹¼å†™é”™è¯¯ï¼Œä¼šå¯¼è‡´è°ƒç”¨æœªæ³¨å†Œçš„è‡ªå®šä¹‰ opï¼ŒæŠ›å‡º `RuntimeError`ã€‚  

5. **åºåˆ—åŒ–å…¼å®¹**  
   - `torch.save` ç›´æ¥ä¿å­˜ `MoEActivation` æˆå‘˜ä¼šæŠŠå®ƒåºåˆ—åŒ–ä¸ºæšä¸¾å¯¹è±¡ï¼›æ—§ç‰ˆæœ¬çš„ `torch.load` å¯èƒ½æ— æ³•æ¢å¤ã€‚  

---

## ğŸ’¡ å…³æ³¨å»ºè®®

| å»ºè®® | è¯´æ˜ |
|------|------|
| **æä¾›å…¼å®¹åŒ…è£…** | åœ¨å…¬å¼€ APIï¼ˆ`FusedMoEConfig.__

---

#### ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (12)

### [V0 Deprecation] Remove code related to per-request logits processors (#34400)
**SHA**: `fb455ed` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/fb455ed547a63e97e15deccfc493f8eef7a2da5c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å»é™¤ï¼ˆV0â€¯Deprecationï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡æäº¤åœ¨ vLLMâ€¯1.x ä¸­å½»åº•ç§»é™¤â€œæ¯ä¸€æ¬¡è¯·æ±‚è‡ªå®šä¹‰ logitsâ€‘processorâ€çš„å®ç°ã€‚å¯¹åº”çš„é…ç½®å­—æ®µã€CLI å‚æ•°ã€åè®®å­—æ®µã€éªŒè¯é€»è¾‘ä»¥åŠéƒ¨åˆ†ç¤ºä¾‹æµ‹è¯•å‡è¢«åˆ å‡æˆ–æ”¹å†™ï¼Œæ”¹åŠ¨é‡çº¦ 150 è¡Œä»£ç ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  

| æ¨¡å— | å…·ä½“å½±å“ |
|------|----------|
| `vllm/config/model.py` | åˆ é™¤ `logits_processor_pattern` é…ç½®åŠå…¶åœ¨ `compute_hash` ä¸­çš„å‚ä¸ã€‚ |
| `vllm/engine/arg_utils.py` | ç§»é™¤ `logits_processor_pattern` CLI å‚æ•°ï¼›`_check_feature_supported` åªä¿ç•™å…¶å®ƒç‰¹æ€§æ£€æŸ¥ã€‚ |
| `vllm/entrypoints/openai/*/protocol.py` | åˆ é™¤ `logits_processors` å­—æ®µåŠå…¶å¯¹åº”çš„ Pydantic ç±»å‹ï¼Œ`to_sampling_params` ä¸å†æ¥å— `logits_processor_pattern` å‚æ•°ã€‚ |
| `vllm/entrypoints/openai/*/serving.py` | å»æ‰åœ¨å®ä¾‹åŒ–æ—¶ä» `model_config` æ‹‰å– logitsÂ processors çš„ä»£ç ï¼Œç›¸å…³æ ¡éªŒå‡½æ•°ä¹Ÿè¢«åˆ é™¤ã€‚ |
| `vllm/sampling_params.py` | ç§»é™¤ `logits_processors` å±æ€§åŠå…¶åœ¨ `verify`ã€`clone`ã€`_verify_args` ä¸­çš„å¤„ç†ï¼›æ”¹ä¸ºåœ¨ `verify` æ—¶è°ƒç”¨ç»Ÿä¸€çš„ `validate_logits_processors_parameters`ï¼ˆä¼šç›´æ¥æŠ›å¼‚å¸¸ï¼‰ã€‚ |
| æµ‹è¯•ç›®å½• | ç›¸åº”çš„ `logits_processor_pattern`/`logits_processors` å­—æ®µè¢«åˆ å‡ï¼ŒåŸå…ˆé’ˆå¯¹ logitsâ€‘processor çš„å•å…ƒæµ‹è¯•è¢«ç§»é™¤ã€‚ |

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **å…¼å®¹æ€§**ï¼š  
   - ä»»ä½•ä»ç„¶åœ¨è¯·æ±‚ä½“æˆ–æ¨¡å‹é…ç½®ä¸­ä½¿ç”¨ `logits_processors` / `logits_processor_pattern` çš„ç”¨æˆ·ç°åœ¨ä¼šæ”¶åˆ° `ValueError`ï¼ˆåœ¨ `SamplingParams.verify` ä¸­ï¼‰ã€‚å»ºè®®åœ¨æ–‡æ¡£å’Œ Release Note ä¸­æ˜ç¡®è¯´æ˜è¯¥åŠŸèƒ½å·²åœ¨ V1 ä¸­ä¸å†æ”¯æŒï¼Œå¹¶ç»™å‡ºè¿ç§»æ–¹æ¡ˆï¼ˆå¦‚åœ¨æ¨¡å‹å±‚é¢è‡ªè¡Œå®ç°å›ºå®šçš„ processorï¼‰ã€‚  
   - ç”±äº `compute_hash` å»é™¤äº†è¯¥å­—æ®µï¼Œå·²æœ‰çš„æ¨¡å‹ç¼“å­˜é”®ä¸ä¼šå› æ—§å­—æ®µå˜æ›´è€Œå¤±æ•ˆï¼Œä¿æŒå‘åå…¼å®¹ã€‚

2. **ä»£ç æ¸…ç†**ï¼š  
   - ç¡®è®¤æ‰€æœ‰ `import vllm.v1.sample.logits_processor.validate_logits_processors_parameters` çš„è·¯å¾„ä»ç„¶å¯ç”¨ï¼ˆä»…åœ¨ `SamplingParams._validate_logits_processors` ä¸­ä½¿ç”¨ï¼‰ã€‚è‹¥ä»¥åå®Œå…¨åˆ é™¤è¯¥æ¨¡å—ï¼Œè®°å¾—åŒæ­¥æ›´æ–°ã€‚  
   - æ£€æŸ¥æ˜¯å¦è¿˜æœ‰é—ç•™çš„ `logits_processor_pattern` å‚æ•°åœ¨ CLI æ–‡æ¡£æˆ–è‡ªåŠ¨ç”Ÿæˆçš„ OpenAPI schema ä¸­å‡ºç°ï¼Œé˜²æ­¢å‡ºç° â€œæœªçŸ¥å‚æ•°â€ é”™è¯¯ã€‚

3. **æµ‹è¯•**ï¼š  
   - è¿è¡Œå®Œæ•´çš„ CIï¼ˆåŒ…æ‹¬ V1ã€V2ã€OpenAIâ€‘compatible æµï¼‰ç¡®è®¤æœªå‡ºç°å› å­—æ®µç¼ºå¤±å¯¼è‡´çš„åºåˆ—åŒ–/ååºåˆ—åŒ–é”™è¯¯ã€‚  
   - è‹¥é¡¹ç›®ä»ä¿ç•™ V0 åˆ†æ”¯ï¼Œå»ºè®®åœ¨ V0 ä¸­ä¿ç•™è¯¥å­—æ®µï¼Œä»¥å…è¯¯åˆ å¯¼è‡´æ—§åˆ†æ”¯ç¼–è¯‘å¤±è´¥ã€‚

4. **æ—¥å¿—ä¸é”™è¯¯ä¿¡æ¯**ï¼š  
   - å½“å‰åœ¨ `SamplingParams._validate_logits_processors` ä¸­ç›´æ¥è°ƒç”¨ `validate_logits_processors_parameters`ï¼ˆè¯¥å‡½æ•°ä¼šæŠ› `ValueError`ï¼‰ï¼Œå¯ä»¥åœ¨æŠ›å‡ºå‰åŒ…è£…ä¸ºæ›´å‹å¥½çš„æç¤ºï¼Œå¦‚ â€œPerâ€‘request logits processors are no longer supported in vLLMâ€¯1.xâ€.  

5. **æ–‡æ¡£æ›´æ–°**ï¼š  
   - åˆ é™¤æˆ–éšè— OpenAI æ¥å£æ–‡æ¡£ä¸­å…³äº `logits_processors` çš„æè¿°ã€‚  
   - åœ¨ *Getting Started*ã€*API Reference* ä¸ *Release Notes* ä¸­æ·»åŠ  â€œDeprecated: perâ€‘request logits processors (Removed in v1.0)â€ã€‚

æ€»ä½“è€Œè¨€ï¼Œä»£ç æ”¹åŠ¨æ¸…æ™°ã€å½±å“èŒƒå›´å±€é™åœ¨é…ç½®/åè®®å±‚ï¼Œæ ¸å¿ƒæ¨ç†é€»è¾‘æœªå—å½±å“ã€‚åªè¦å®Œæˆä¸Šè¿°å…¼å®¹ã€æ–‡æ¡£ä¸æµ‹è¯•æ£€æŸ¥ï¼Œå³å¯å®‰å…¨å‘å¸ƒã€‚

---

### Vllm CPU benchmark suite improvement (#34128)
**SHA**: `55a1a95` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/55a1a9563a7f8600cdc336e76d2074cef8ffe8e5)

**å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**å˜æ›´æ‘˜è¦**  
1. ä¸º CPU åŸºå‡†å¯¹æ¯”è„šæœ¬ (`compare-json-results.py`) æ–°å¢ Excel/CSV å¯¼å‡ºã€ç¯å¢ƒä¿¡æ¯è§£æã€è¡¨æ ¼å†™å…¥ã€æ–‡ä»¶åå®‰å…¨åŒ–ç­‰å®ç”¨å·¥å…·ã€‚  
2. `run-performance-benchmarks.sh` å¼•å…¥ `DRY_RUN`ã€`MODEL_FILTER`ã€`DTYPE_FILTER` ç­‰ç¯å¢ƒå˜é‡ï¼Œå®ç°ä»…ç”Ÿæˆå‘½ä»¤è€Œä¸æ‰§è¡Œå®é™…è·‘æµ‹ï¼›åœ¨ Dryâ€‘Run æ—¶è·³è¿‡ HFâ€‘TOKEN æ£€æŸ¥ã€æœåŠ¡å™¨å¯åŠ¨ã€è¿›ç¨‹æ¸…ç†ã€‚  
3. æ–°å¢/è£å‰ª CPU åŸºå‡† JSONï¼ˆtextã€embedï¼‰ï¼Œå¹¶åœ¨æ–‡æ¡£ä¸­è¡¥å…… Dryâ€‘Run ä½¿ç”¨è¯´æ˜ã€‚  

**å½±å“èŒƒå›´**  
- `.buildkite/performance-benchmarks/scripts/compare-json-results.py`ï¼ˆæ•°æ®å¤„ç†ã€æŠ¥å‘Šç”Ÿæˆï¼‰  
- `.buildkite/performance-benchmarks/scripts/run-performance-benchmarks.sh`ï¼ˆè·‘æµ‹è°ƒåº¦ï¼‰  
- æ–°å¢çš„ JSON æµ‹è¯•æ–‡ä»¶ä¸æ–‡æ¡£æ›´æ–°ã€‚  

**å…³æ³¨å»ºè®®**  
1. **ä¾èµ–ç®¡ç†**ï¼šæ–°å¢ `regex`ã€`openpyxl`ï¼ˆExcelWriterï¼‰ç­‰åº“ï¼Œéœ€è¦åœ¨ CI/ç¯å¢ƒçš„ `requirements.txt` ä¸­åŒæ­¥å£°æ˜ã€‚  
2. **å…¼å®¹æ€§**ï¼šä»£ç ä½¿ç”¨ `list[str]`ã€`Path | None` ç­‰ Pythonâ€¯3.10+ è¯­æ³•ï¼Œè‹¥é¡¹ç›®ä»æ”¯æŒ 3.9ï¼Œéœ€åŠ  `from __future__ import annotations` æˆ–æ”¹å†™ä¸º `typing.List`ã€`Optional[Path]`ã€‚  
3. **å®‰å…¨æ€§**ï¼š`_safe_filename`ã€`_sanitize_sheet_name` å·²é™åˆ¶å­—ç¬¦é•¿åº¦ï¼Œä½†ä»åº”é˜²æ­¢è·¯å¾„ç©¿è¶Šï¼ˆå¦‚ `../`ï¼‰ï¼Œå»ºè®®åœ¨å†™æ–‡ä»¶å‰ä½¿ç”¨ `Path.resolve().is_relative_to(base_dir)` æ£€æŸ¥ã€‚  
4. **å¼‚å¸¸å¤„ç†**ï¼š`_parse_vllm_env_txt` å¯¹å¼‚å¸¸è¡Œä»…è·³è¿‡ï¼Œå»ºè®®åœ¨è°ƒè¯•æ¨¡å¼ä¸‹è®°å½•æœªåŒ¹é…è¡Œä»¥å…éšè—æ ¼å¼é”™è¯¯ã€‚  
5. **æµ‹è¯•**ï¼šä¸ºæ–°å¯¼å‡ºå‡½æ•°ã€Dryâ€‘Run è¿‡æ»¤é€»è¾‘ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ `MODEL_FILTER`ã€`DTYPE_FILTER` æ­£ç¡®ç­›é€‰ä¸”ç©ºè¿‡æ»¤ä¸å½±å“å…¨é‡è¿è¡Œã€‚  
6. **æ–‡æ¡£åŒæ­¥**ï¼šREADME ä¸­çš„é»˜è®¤ JSON è·¯å¾„å·²æ”¹åŠ¨ï¼Œç¡®è®¤æ‰€æœ‰ CI è„šæœ¬ã€ç¤ºä¾‹å‘½ä»¤å·²æŒ‡å‘æ–°æ–‡ä»¶åã€‚  

æ€»ä½“è€Œè¨€ï¼Œæœ¬æ¬¡æäº¤æ˜¾è‘—æå‡äº† CPU åŸºå‡†çš„å¯è§†åŒ–ã€å¯å¤åˆ¶æ€§ä¸è°ƒè¯•ä¾¿åˆ©æ€§ï¼Œåªè¦æ³¨æ„ä¾èµ–ã€å…¼å®¹æ€§ä¸æµ‹è¯•è¦†ç›–ï¼Œå³å¯å®‰å…¨åˆå…¥ä¸»åˆ†æ”¯ã€‚

---

### [Bugfix] Fix Sparse24 Compressed Tensors models (#33446)
**SHA**: `e9cd691` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/e9cd6911321f7671de218d0c778c5400d7f1d1a6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBugfix  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
1. åœ¨ `cutlass_sparse_scaled_mm_supported` ä¸­å°† GPU èƒ½åŠ›æ£€æŸ¥ä» â€œ>= SM90â€ æ”¹ä¸º **ä»…ç­‰äº SM90**ï¼Œé˜²æ­¢åœ¨æœªæ¥çš„é Hopper å¡ä¸Šè¯¯æŠ¥å…¼å®¹ã€‚  
2. åŒæ­¥æ›´æ–°é”™è¯¯æç¤ºæ–‡å­—ï¼Œä½¿å…¶ä¸æ–°æ£€æŸ¥ä¿æŒä¸€è‡´ã€‚  
3. `CompressedTensorsConfig.from_config` ç°åœ¨åœ¨è¯»å– `config_groups` å‰å…ˆåˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ï¼Œé¿å…åœ¨ç¼ºå¤±è¯¥å­—æ®µæ—¶æŠ›å‡º `KeyError`ï¼Œå¹¶ä¿æŒåŸæœ‰å¯¹ Attention é‡åŒ–çš„è¿‡æ»¤é€»è¾‘ã€‚  
4. `get_quant_config` åœ¨åˆ¤æ–­ `compressedâ€‘tensors` æ—¶é¢å¤–ç¡®è®¤ `config_groups` å­˜åœ¨ï¼Œé˜²æ­¢è¯¯åˆ¤å¯¼è‡´åç»­åŠ è½½å¼‚å¸¸ã€‚

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `csrc/sparse/cutlass`ï¼ˆç¨€ç–çŸ©é˜µä¹˜å®ç°ï¼‰  
- `vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py`ï¼ˆCompressed Tensors é…ç½®è§£æï¼‰  
- `vllm/model_executor/model_loader/weight_utils.py`ï¼ˆæ¨¡å‹æƒé‡åŠ è½½ä¸é‡åŒ–é…ç½®è¯»å–ï¼‰

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. åœ¨é Hopperï¼ˆSM<90ï¼‰GPU ä¸Šè¿è¡Œå•å…ƒ/é›†æˆæµ‹è¯•ï¼Œç¡®è®¤ `cutlass_sparse_scaled_mm_supported` æ­£ç¡®è¿”å› `False`ï¼Œå¹¶ä¸”ç³»ç»Ÿä¸ä¼šå°è¯•åŠ è½½ç¨€ç– CUTLASS å†…æ ¸ã€‚  
2. ä¸º `CompressedTensorsConfig.from_config` æ·»åŠ è¦†ç›– `config` ä¸­æ—  `config_groups` åœºæ™¯çš„æµ‹è¯•ï¼Œç¡®ä¿ä¸ä¼šæ¼æ‰å…¶ä»–é…ç½®å­—æ®µã€‚  
3. æ£€æŸ¥æ–‡æ¡£æˆ–ç¤ºä¾‹ï¼Œæ˜ç¡®åœ¨ vLLM ä¸­åªèƒ½åœ¨ Hopper GPU ä¸Šä½¿ç”¨ Sparse24 å‹ç¼©å¼ é‡ï¼Œå¦åˆ™ä¼šé€€å›åˆ°å¸¸è§„å®ç°ã€‚  
4. è€ƒè™‘åœ¨ `get_quant_config` ä¸­ç»™å‡ºæ›´å‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œæç¤ºç”¨æˆ·ç¼ºå°‘ `config_groups` æ—¶çš„åŸå› ï¼Œä»¥æå‡å¯è°ƒè¯•æ€§ã€‚  

æ•´ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡ä¿®å¤æ¶ˆé™¤äº†åœ¨æœªæ¥ GPU ç‰ˆæœ¬ä¸Šçš„è¯¯å…¼å®¹é£é™©ï¼Œå¹¶æå‡äº†é…ç½®è§£æçš„é²æ£’æ€§ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥å¯¹åº”çš„ç¡¬ä»¶/é…ç½®éªŒè¯ç”¨ä¾‹ã€‚

---

### [Refactor] Pass Renderer to Input Processor (#34329)
**SHA**: `b96f731` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/b96f7314b451c01d2c727a93636c023b07adf732)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆRenderer ç”± Engine â†’ InputProcessor ç»Ÿä¸€ç®¡ç†ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡ PR å°†æ¸²æŸ“å™¨ï¼ˆRendererï¼‰ä» `EngineClient`/`LLMEngine` ä¸­æŠ½ç¦»ï¼Œæ”¹ä¸ºåœ¨ `InputProcessor` åˆå§‹åŒ–æ—¶æ˜¾å¼æ³¨å…¥ï¼Œå¹¶åœ¨æ‰€æœ‰å…¥å£å±‚ç»Ÿä¸€é€šè¿‡ `model_config` è®¿é—® `max_model_len`ã€‚ç›¸åº”åœ°ï¼Œæ›´æ–°äº†å¤§é‡æœåŠ¡å±‚ã€æµ‹è¯•ä»¥åŠé…ç½®ç±»çš„å±æ€§å¼•ç”¨ï¼Œ`PoolerConfig.enable_chunked_processing` çš„é»˜è®¤å€¼ä¹Ÿç”± `None` æ”¹ä¸º `False`ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- æ ¸å¿ƒå¼•æ“ï¼š`vllm/engine/*`ï¼ˆ`llm_engine.py`, `input_processor.py`, `output_processor.py`, `async_llm.py`ï¼‰  
- é…ç½®/å…¥å£å±‚ï¼š`vllm/config/pooler.py`, `vllm/engine/protocol.py`, `vllm/entrypoints/*`ï¼ˆopenaiã€servingã€tokenizeã€poolingï¼‰  
- æµ‹è¯•å¥—ä»¶ï¼šæ‰€æœ‰æ¶‰åŠ `engine.renderer`ã€`engine.input_processor`ã€`max_model_len` çš„å•å…ƒæµ‹è¯•  
- å…¶å®ƒï¼š`vllm/v1/engine/*` ä¸­çš„å±æ€§è®¿é—®ã€æ—¥å¿—/è¿½è¸ªå¼€å…³åˆå§‹åŒ–  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§**ï¼šRenderer ç°åœ¨æ˜¯å¯é€‰å‚æ•°ï¼Œç¡®ä¿æ—§ä»£ç åœ¨æœªæ˜¾å¼ä¼ å…¥æ—¶ä»èƒ½é€šè¿‡ `renderer_from_config` æ­£å¸¸åˆ›å»ºï¼›è‹¥æœ‰å¤–éƒ¨æ’ä»¶ç›´æ¥ä¾èµ– `engine.input_processor.renderer`ï¼Œéœ€å‘å¸ƒè¿ç§»æŒ‡å—ã€‚  
2. **ç»Ÿä¸€ `max_model_len`**ï¼šæ‰€æœ‰ä¸šåŠ¡è·¯å¾„å·²æ”¹ä¸º `self.model_config.max_model_len`ï¼Œè¯·æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ®‹ç•™çš„ `self.max_model_len` å¼•ç”¨ï¼Œé¿å…è¿è¡Œæ—¶å±æ€§é”™è¯¯ã€‚  
3. **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨ vLLM é…ç½®/ä½¿ç”¨æ‰‹å†Œä¸­è¡¥å…… â€œRenderer ä¼ é€’â€ ç« èŠ‚ï¼Œè¯´æ˜ `BaseRenderer` çš„è·å–æ–¹å¼ä»¥åŠ `PoolerConfig.enable_chunked_processing` çš„é»˜è®¤å«ä¹‰ã€‚  
4. **æµ‹è¯•è¦†ç›–**ï¼šå½“å‰æäº¤å·²ä¿®æ”¹å¤§é‡æµ‹è¯•ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥å¯¹ `renderer` ç›´æ¥å®ä¾‹åŒ–çš„å›å½’æµ‹è¯•ï¼Œç¡®ä¿åœ¨ä¸åŒæ¨¡å‹ç±»å‹ï¼ˆcausalã€embeddingã€mamba ç­‰ï¼‰ä¸‹æ¸²æŸ“è¡Œä¸ºä¿æŒä¸€è‡´ã€‚  
5. **æ€§èƒ½å›å½’**ï¼šRenderer æ³¨å…¥æœ¬èº«ä¸ä¼šå½±å“é€Ÿåº¦ï¼Œä½†åœ¨ `output_processor` ä¸­æ–°å¢ `tracing_enabled` å‚æ•°åï¼Œè¯·éªŒè¯å¼€å¯ OpenTelemetry æ—¶çš„é¢å¤–å¼€é”€æ˜¯å¦åœ¨å¯æ¥å—èŒƒå›´ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†æ¸²æŸ“å™¨çš„èŒè´£åˆ’åˆ†ï¼Œä½¿ `InputProcessor` ä¸æ¸²æŸ“é€»è¾‘æ›´ç´§è€¦ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°ã€‚ä½†ç”±äºæ”¹åŠ¨è·¨åº¦å¤§ï¼ŒåŠ¡å¿…é€šè¿‡å®Œæ•´çš„å•å…ƒã€é›†æˆä¸æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œä»¥é˜²é—æ¼çš„æ—§å±æ€§è®¿é—®æˆ–æ–‡æ¡£ä¸ä¸€è‡´å¯¼è‡´çš„ç”¨æˆ·ä½¿ç”¨éšœç¢ã€‚

---

### [Refactor] Move validation to params definitions (#34362)
**SHA**: `ced2a92` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/ced2a92f40ed56148a6f4496239b55a65f854081)

**å˜æ›´ç±»å‹**ï¼šé‡æ„ / åŠŸèƒ½å¢å¼º  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**å˜æ›´æ¦‚è¿°**  
1. å°†å¯¹ `SamplingParams`ã€`PoolingParams` çš„åˆæ³•æ€§æ ¡éªŒä» `v1/engine/input_processor.py` ä¸­æŠ½å–ï¼Œè¿å…¥å„è‡ªçš„ç±»å®ç° (`verify`ã€`_validate_*` ç­‰ï¼‰ï¼Œå½¢æˆè‡ªâ€‘åŒ…å«çš„å‚æ•°æ ¡éªŒå±‚ã€‚  
2. `SamplingParams.verify` ç°åœ¨æ¥å— `ModelConfig`ã€`SpeculativeConfig`ã€`StructuredOutputsConfig` ä¸ `TokenizerLike`ï¼Œç»Ÿä¸€å®Œæˆ logprobsã€logit_biasã€allowed_token_idsã€speculative decodeã€structuredâ€‘output ç­‰å¤šç»´åº¦æ£€æŸ¥ã€‚  
3. `PoolingParams` ä¹ŸåŒæ­¥ä½¿ç”¨å‰å‘å£°æ˜çš„ `ModelConfig` ç±»å‹ï¼Œå¹¶ç®€åŒ– `_merge_default_parameters`ã€`_set_default_parameters` çš„ç­¾åã€‚  
4. `input_processor._validate_params` åªè´Ÿè´£æ ¹æ®å‚æ•°ç±»å‹è°ƒç”¨ç›¸åº”çš„ `verify`ï¼Œå»é™¤äº†å¤§é‡åŸæœ¬æ•£è½åœ¨æ­¤å¤„çš„æ ¡éªŒå®ç°ã€‚  
5. ç§»é™¤å¯¹ `logits_processors`ã€éƒ¨åˆ† structuredâ€‘output éªŒè¯çš„è€å®ç°ï¼Œç»Ÿä¸€åœ¨ `SamplingParams.verify` ä¸­æŠ›å‡ºé”™è¯¯ã€‚  

**å½±å“èŒƒå›´**  
- `vllm/sampling_params.py`ã€`vllm/pooling_params.py`ï¼šæ–°å¢/ä¿®æ”¹æ ¡éªŒé€»è¾‘ã€ç±»å‹æ³¨è§£ã€‚  
- `vllm/v1/engine/input_processor.py`ï¼šå‚æ•°æ ¡éªŒå…¥å£ç®€åŒ–ï¼Œå»é™¤å¤§é‡é‡å¤ä»£ç ã€‚  
- ç›¸å…³å¼‚å¸¸è·¯å¾„ `VLLMValidationError`ã€`ValueError` çš„è§¦å‘ä½ç½®æ”¹å˜ã€‚  

**å»ºè®®ä¸æ³¨æ„ç‚¹**  
- **å‘åå…¼å®¹**ï¼šè‹¥å¤–éƒ¨ä»£ç ä»ç›´æ¥è°ƒç”¨ `input_processor._validate_*`ï¼ˆå·²æ ‡è®°ä¸ºç§æœ‰ï¼‰ï¼Œå¯èƒ½å¤±æ•ˆï¼›å»ºè®®ç»Ÿä¸€ä½¿ç”¨ `SamplingParams.verify` / `PoolingParams.verify`ã€‚  
- **é”™è¯¯ä¿¡æ¯**ï¼šæ ¡éªŒé”™è¯¯ç°åœ¨åœ¨ `SamplingParams.verify` ä¸­æŠ›å‡ºï¼Œè°ƒç”¨æ ˆä¼šæ›´çŸ­ï¼Œè¯·ç¡®è®¤æ—¥å¿—ä¸ API é”™è¯¯ç ä»ä¿æŒä¸€è‡´ã€‚  
- **æ€§èƒ½**ï¼šæ ¡éªŒè¿ç§»åè¿è¡Œæ—¶å¼€é”€åŸºæœ¬ä¸å˜ï¼Œä»…å› å‡½æ•°æ‹†åˆ†ç•¥æœ‰é¢å¤–è°ƒç”¨å±‚ï¼Œä½†å·²åœ¨ç±»å®ä¾‹åŒ–é˜¶æ®µå®Œæˆï¼Œæ•´ä½“å½±å“å¯å¿½ç•¥ã€‚  
- **æ–‡æ¡£**ï¼šæ›´æ–°æ–‡æ¡£æˆ–ç¤ºä¾‹ï¼Œè¯´æ˜ `SamplingParams`ã€`PoolingParams` ç°åœ¨è‡ªå¸¦ `verify` æ–¹æ³•ï¼Œä½¿ç”¨æ—¶éœ€æä¾›å¯¹åº”çš„ `ModelConfig`ï¼ˆä»¥åŠ tokenizerã€speculative/structured configsï¼‰ã€‚  
- **æµ‹è¯•**ï¼šç¡®ä¿å·²æœ‰å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰æ—§æ ¡éªŒè·¯å¾„ï¼›å°¤å…¶æ˜¯ç»“æ„åŒ–è¾“å‡ºã€speculative decodingã€logit_biasã€allowed_token_ids ç­‰è¾¹ç•Œæƒ…å†µï¼Œä»¥é˜²è¿ç§»å¯¼è‡´é—æ¼ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡é‡æ„å°†å‚æ•°æ ¡éªŒèŒè´£å†…èšè‡³æ•°æ®ç±»æœ¬èº«ï¼Œæå‡å¯ç»´æŠ¤æ€§ä¸å¯å¤ç”¨æ€§ï¼Œé£é™©ä¸»è¦åœ¨ API ä½¿ç”¨ä¹ æƒ¯çš„å¾®è°ƒå’Œé”™è¯¯ä¿¡æ¯çš„ç¨å¾®å˜åŒ–ã€‚ç¡®ä¿æ–‡æ¡£åŒæ­¥å¹¶è¡¥é½ç›¸åº”æµ‹è¯•å³å¯å®‰å…¨ä¸Šçº¿ã€‚

---

### [ci] Integrate AMD tests into CI (#33626)
**SHA**: `83b47f6` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/83b47f67b1dfad505606070ae4d9f83e50ad4ebd)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–ï¼ˆCI é…ç½®ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡æäº¤æŠŠ AMD è®¾å¤‡çš„æµ‹è¯•çº³å…¥ Buildkite CIã€‚æ–°å¢ `amd.yaml` æ„å»ºé•œåƒæ­¥éª¤ï¼Œå¹¶åœ¨å„æµ‹è¯•åŒºå—ï¼ˆbasic_correctnessã€entrypointsã€models_basicã€samplers ç­‰ï¼‰ä¸­åŠ å…¥ `mirror` é…ç½®ï¼ŒæŒ‡å®š `mi325_1` è®¾å¤‡å¹¶ä¾èµ– `image-build-amd`ã€‚åŒæ—¶åˆ é™¤äº†æ—§çš„ `mirror_hardwares: [amdexperimental]` æ ‡è®°ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `.buildkite` ç›®å½•ä¸‹çš„ CI é…ç½®æ–‡ä»¶ï¼ˆhardware_testsã€test_areasï¼‰  
- CI è¿è¡Œæ—¶çš„é•œåƒæ„å»ºä¸è°ƒåº¦é€»è¾‘  
- å¯èƒ½æ¶‰åŠçš„æµ‹è¯•è„šæœ¬ï¼ˆå°¤å…¶æ˜¯ä½¿ç”¨ `-m 'not skip_v1'` çš„ sampler æµ‹è¯•ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **AMD Runner å¯ç”¨æ€§**ï¼šç¡®è®¤ Buildkite å·²é…ç½® `mi325_1` æœºå™¨å¹¶å…·å¤‡æ‰€éœ€é©±åŠ¨ã€ROCm ç¯å¢ƒï¼Œå¦åˆ™é•œåƒæ„å»ºæˆ–æµ‹è¯•ä¼šç›´æ¥å¤±è´¥ã€‚  
2. **é•œåƒæ„å»ºæ­¥éª¤**ï¼š`image-build-amd` åªåœ¨ `amd.yaml` ä¸­å®šä¹‰ï¼Œç¡®ä¿å…¶åœ¨æ‰€æœ‰é•œåƒä¾èµ–çš„æµ‹è¯•å‰æˆåŠŸæ‰§è¡Œï¼›è‹¥å·²æœ‰å…¶å®ƒå¹³å°çš„ `image-build` æ­¥éª¤ï¼Œä¿æŒåç§°å”¯ä¸€é˜²æ­¢å†²çªã€‚  
3. **æ—§é…ç½®æ¸…ç†**ï¼šå·²åˆ é™¤ `mirror_hardwares`ï¼Œä½†ä»“åº“ä¸­ä»å¯èƒ½æ®‹ç•™å¯¹è¯¥å­—æ®µçš„è§£æä»£ç ï¼Œå»ºè®®å…¨é¢æœç´¢ç¡®è®¤æ— é—æ¼ã€‚  
4. **æµ‹è¯•è¿‡æ»¤**ï¼šsampler æµ‹è¯•æ–°å¢ `-m 'not skip_v1'`ï¼Œç¡®ä¿è¯¥ marker ä¸ç°æœ‰æµ‹è¯•é›†åˆå…¼å®¹ï¼Œé¿å…å› æ ‡è®°é”™è¯¯å¯¼è‡´æµ‹è¯•è¢«æ„å¤–è·³è¿‡æˆ–æ‰§è¡Œã€‚  
5. **CI æ—¶é•¿ä¸èµ„æº**ï¼šæ–°å¢ AMD é•œåƒæ„å»ºåŠå¤šå¥—é•œåƒå¹¶è¡Œè¿è¡Œä¼šå¢åŠ  CI æ—¶é•¿å’Œç®—åŠ›æ¶ˆè€—ï¼Œè¯·ç›‘æ§æ„å»ºé˜Ÿåˆ—ï¼Œå¿…è¦æ—¶åœ¨ `timeout_in_minutes` ä¸Šä½œç›¸åº”è°ƒæ•´ã€‚  
6. **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨é¡¹ç›® CI/CONTRIBUTING æ–‡æ¡£ä¸­åŠ å…¥â€œAMD æµ‹è¯•â€è¯´æ˜ï¼Œæ–¹ä¾¿è´¡çŒ®è€…äº†è§£æ–°å¹³å°çš„ CI éœ€æ±‚ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ”¹åŠ¨é›†ä¸­åœ¨ CI é…ç½®å±‚é¢ï¼Œå¯¹ä»£ç é€»è¾‘å½±å“æå°ï¼Œåªè¦ç¡®ä¿ AMD æœºå™¨å’Œé•œåƒæ„å»ºæ­¥éª¤æ­£å¸¸ï¼Œå³å¯é¡ºåˆ©å®Œæˆå¤šå¹³å°æŒç»­é›†æˆã€‚

---

### Fix CI failure - Flashinfer Kernel tests (#34316)
**SHA**: `5aff269` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/5aff2699bdcedd9ee91fe936fc21b26466203ae1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ä¸‰ä¸ª MoEï¼ˆMixtureâ€‘ofâ€‘Expertsï¼‰ç›¸å…³çš„å•å…ƒæµ‹è¯•ä¸­ï¼Œä¸º `FusedMoEConfig`/`FusedMoEQuantConfig` æ–°å¢ `num_logical_experts` å‚æ•°çš„æ˜¾å¼ä¼ å…¥ã€‚è¯¥å‚æ•°åŸæœ¬åœ¨å†…éƒ¨æœ‰é»˜è®¤å€¼ï¼Œä½†åœ¨æœ€æ–°ç‰ˆçš„ FlashInfer kernel å®ç°ä¸­å·²å˜ä¸ºå¿…å¡«ï¼Œå¯¼è‡´ CI ä¸­å¯¹åº”æµ‹è¯•å› ç¼ºå°‘è¯¥å­—æ®µè€ŒæŠ¥é”™ã€‚é€šè¿‡åœ¨æµ‹è¯•æ„é€ é…ç½®æ—¶åŒæ­¥ä¼ å…¥ `num_logical_experts`ï¼ˆä¸ `num_local_experts` ä¿æŒä¸€è‡´ï¼‰ï¼Œæ¢å¤äº†æµ‹è¯•çš„å¯è¿è¡Œæ€§ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `tests/kernels/moe/test_flashinfer.py`ã€`test_flashinfer_moe.py`ã€`test_pplx_cutlass_moe.py` ä¸‰ä¸ªæµ‹è¯•æ–‡ä»¶ã€‚  
- ç‰µæ¶‰åˆ°çš„æ ¸å¿ƒæ¨¡å—ä¸º `vllm.model_executor.layers.fused_moe`ï¼ˆ`FusedMoEConfig`ã€`FusedMoEQuantConfig`ï¼‰ä»¥åŠåº•å±‚ FlashInfer kernel çš„å‚æ•°æ ¡éªŒé€»è¾‘ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. **ä»£ç å®¡æŸ¥**ï¼šç¡®è®¤ `FusedMoEConfig` çš„æ„é€ å‡½æ•°å·²å°† `num_logical_experts` æ ‡è®°ä¸ºå¿…å¡«ä¸”é»˜è®¤å€¼åˆç†ï¼›è‹¥ä¸šåŠ¡è·¯å¾„ä»ä¾èµ–é»˜è®¤è¡Œä¸ºï¼Œè€ƒè™‘åœ¨ `__init__` ä¸­æä¾›å…¼å®¹æ€§è­¦å‘Šã€‚  
2. **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–° READMEã€API æ–‡æ¡£ä»¥åŠç¤ºä¾‹ä»£ç ï¼Œè¯´æ˜ `num_logical_experts` ä¸ `num_local_experts` çš„å…³ç³»åŠä½•æ—¶éœ€è¦æ˜¾å¼è®¾ç½®ã€‚  
3. **æŒç»­é›†æˆ**ï¼šåœ¨ CI é…ç½®ä¸­åŠ å…¥å¯¹ `FusedMoEConfig` å‚æ•°å®Œæ•´æ€§çš„æ£€æŸ¥ï¼Œé˜²æ­¢ç±»ä¼¼é—æ¼å†æ¬¡å‡ºç°ã€‚  
4. **å‘åå…¼å®¹**ï¼šè‹¥å·²æœ‰ç”¨æˆ·åœ¨ç”Ÿäº§ä»£ç ä¸­æœªä¼ å…¥è¯¥å­—æ®µï¼Œæä¾›ä¸€ä¸ªè¿‡æ¸¡æœŸçš„åŒ…è£…å‡½æ•°æˆ–åœ¨é»˜è®¤å€¼ä¸­è‡ªåŠ¨è®¾ä¸º `num_local_experts`ï¼Œé¿å…çªå‘é”™è¯¯ã€‚  

æ•´ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡ä¿®æ”¹ä»…å½±å“æµ‹è¯•å±‚é¢çš„é…ç½®å®ä¾‹ï¼Œå¯¹è¿è¡Œæ—¶é€»è¾‘æ— ç›´æ¥æ”¹åŠ¨ï¼Œä½†æé†’ç»´æŠ¤è€…åœ¨ API å˜æ›´æ—¶åŒæ­¥æ›´æ–°æ‰€æœ‰è°ƒç”¨æ–¹ï¼ˆåŒ…æ‹¬å†…éƒ¨æµ‹è¯•ã€ç¤ºä¾‹å’Œæ–‡æ¡£ï¼‰ï¼Œä»¥ç¡®ä¿åº“çš„å‘åå…¼å®¹æ€§ã€‚

---

### [Bugfix] Fix more multimodal tests for transformers V5 (#34334)
**SHA**: `527ca32` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/527ca32197b327e55bc718c0ecfea27ff8995902)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤ / å…¼å®¹æ€§è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ multimodal æµ‹è¯•ä¸­æ–°å¢å¯¹ `lfm2_vl` çš„å¿½ç•¥æ ‡è®°ã€‚  
2. `glmasr` å¤„ç†å™¨ä¿®æ­£ mask é”®åï¼ˆ`input_features_mask`ï¼‰ï¼Œå¹¶åŒæ­¥å·ç§¯è¾“å‡ºé•¿åº¦å…¬å¼ä»¥åŒ¹é… HF å®ç°ã€‚  
3. `lfm2_vl` åœ¨çº¯æ–‡æœ¬åˆ†æ”¯ä½¿ç”¨ `encode(..., add_special_tokens=False)`ï¼Œé˜²æ­¢æ„å¤–æ·»åŠ  BOS/EOSã€‚  
4. `qwen2_vl` æ„é€ å‡½æ•°æ”¹ä¸ºç›´æ¥æ¥å— `image_processor` ä¸ `video_processor`ï¼Œå¹¶é€šè¿‡ `ctx.get_hf_image_processor_config()` ç»Ÿä¸€é…ç½®ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `vllm/model_executor/models/glmasr.py`ã€`glmasr_utils.py`ï¼ˆéŸ³é¢‘/ç‰¹å¾æ©ç ã€å·ç§¯é•¿åº¦è®¡ç®—ï¼‰  
- `vllm/model_executor/models/lfm2_vl.py`ï¼ˆæ–‡æœ¬ç¼–ç è¡Œä¸ºï¼‰  
- `vllm/model_executor/models/qwen2_vl.py`ï¼ˆprocessor åˆå§‹åŒ–ç­¾åï¼‰  
- `tests/models/multimodal/processing/test_common.py`ï¼ˆæµ‹è¯•å¿½ç•¥åˆ—è¡¨ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- å¯¹ä½¿ç”¨ GLMâ€‘ASR çš„ç”¨æˆ·ï¼Œæ£€æŸ¥å·²æœ‰ä»£ç æ˜¯å¦ä»ä¾èµ–æ—§çš„ `input_feature_mask` é”®åï¼Œå¿…è¦æ—¶åšé€‚é…ã€‚  
- ç¡®è®¤å·ç§¯é•¿åº¦å…¬å¼çš„æ”¹åŠ¨åœ¨æ‰€æœ‰éŸ³é¢‘é•¿åº¦ä¸‹ä¸ HuggingFace å¤„ç†å™¨ä¿æŒä¸€è‡´ï¼Œé˜²æ­¢ token é•¿åº¦åå·®å¯¼è‡´å¯¹é½é”™è¯¯ã€‚  
- `lfm2_vl` ç°åœ¨ä¸å†è‡ªåŠ¨æ·»åŠ ç‰¹æ®Š tokenï¼Œè‹¥ä¸šåŠ¡ä¾èµ– BOS/EOSï¼Œè¯·åœ¨ä¸Šå±‚æ˜¾å¼å¤„ç†ã€‚  
- `qwen2_vl` çš„æ„é€ å‡½æ•°ç­¾åå·²å˜ï¼Œå¤–éƒ¨è‡ªå®šä¹‰ Processor çš„ä»£ç éœ€è¦æ›´æ–°ä¸ºä¼ å…¥å®ä¾‹è€Œéé…ç½®å­—å…¸ã€‚  
- è¿è¡Œå…¨å¥— multimodal å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿æ–°åŠ å…¥çš„ `lfm2_vl` å¿½ç•¥ä¸ä¼šè¯¯ä¼¤å…¶ä»–æ¨¡å‹ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æäº¤ä¸»è¦ä¿®å¤äº†ä¸åŒ Transformer ç‰ˆæœ¬é—´çš„å…¼å®¹é—®é¢˜ï¼Œæå‡äº†éŸ³é¢‘/è§†è§‰æ¨¡å‹çš„å¯é æ€§ï¼Œæ”¹åŠ¨èŒƒå›´å±€é™äº multimodal å¤„ç†è·¯å¾„ï¼Œé£é™©å¯æ§ã€‚

---

### [Multimodal] Expose `mm_processor_kwargs` for `DummyInputsBuilder` (#34330)
**SHA**: `0ab0610` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/0ab06100f469fe29b8a71cf0311b6b9da99db23e)

**å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆå¯¹ `DummyInputsBuilder` æ–°å¢ `mm_processor_kwargs` å‚æ•°ï¼‰  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­

**æ ¸å¿ƒæ”¹åŠ¨**  
- åœ¨ `vllm/multimodal/processing/dummy_inputs.py` ä¸­ä¸º `get_dummy_mm_data`ã€`get_dummy_processor_inputs` å¢åŠ  `mm_processor_kwargs`ï¼Œå¹¶åœ¨è¿”å›çš„ `ProcessorInputs` ä¸­ä¿å­˜ `hf_processor_mm_kwargs`ã€‚  
- æ‰€æœ‰æ¨¡å‹å®ç°çš„ `get_dummy_mm_data`ï¼ˆçº¦ 80+ï¼‰ç›¸åº”æ‰©å±•ç­¾åï¼Œå¹¶åœ¨éœ€è¦è·å– HF å¤„ç†å™¨ï¼ˆfeature extractorã€image/video processor ç­‰ï¼‰æ—¶æŠŠ kwargs é€ä¼ è¿›å»ã€‚  
- `vllm/multimodal/registry.py` åœ¨åˆ›å»º dummy inputs æ—¶è¯»å–æ¨¡å‹é…ç½®çš„ `mm_processor_kwargs` å¹¶ä¼ é€’ä¸‹å»ã€‚  
- å¯¹ Idefics3 ç›¸å…³å®ç°åšäº†å°å¹…æ¸…ç†ï¼šåˆ é™¤äº† `get_image_size_with_most_features` çš„é»˜è®¤å®ç°ï¼Œæ”¹ä¸ºé€šè¿‡ HF processor ç›´æ¥è·å– `max_image_size`ã€‚  

**å½±å“èŒƒå›´**  
- **æ¨¡å‹å±‚**ï¼šå‡ ä¹æ‰€æœ‰æ”¯æŒå¤šæ¨¡æ€çš„æ¨¡å‹ï¼ˆAriaã€AudioFlamingoã€LLaVAã€Qwenâ€‘VLã€Whisper ç­‰ï¼‰éƒ½è¢«ä¿®æ”¹ã€‚  
- **å¤„ç†å™¨å±‚**ï¼šæ‰€æœ‰ä½¿ç”¨ `BaseMultiModalProcessor` ç”Ÿæˆ dummy è¾“å…¥çš„è·¯å¾„éƒ½ä¼šæ¥æ”¶åˆ°é¢å¤–çš„ kwargã€‚  
- **é…ç½®å±‚**ï¼š`ModelConfig` éœ€è¦åœ¨ `multimodal_config` ä¸­æä¾› `mm_processor_kwargs`ï¼ˆé»˜è®¤ `None`ï¼‰ï¼Œå¦åˆ™ä¿æŒæ—§è¡Œä¸ºã€‚

**å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼šç›®å‰é»˜è®¤ `None`ï¼Œä¸å½±å“æ—§ä»£ç ï¼Œä½†æ–‡æ¡£å¿…é¡»æ˜ç¡® `mm_processor_kwargs` çš„ä½œç”¨åŠå¯é€‰é”®ï¼ˆå¦‚ `max_pixels`ã€`crop_size`ã€éŸ³é¢‘ extractor å‚æ•°ç­‰ï¼‰ã€‚  
2. **å•å…ƒæµ‹è¯•**ï¼šä¸ºè‡³å°‘ä¸¤ç±»æ¨¡å‹ï¼ˆå›¾åƒ+éŸ³é¢‘ï¼‰è¡¥å……æµ‹è¯•ï¼ŒéªŒè¯åœ¨ä¼ å…¥è‡ªå®šä¹‰ `max_pixels`ã€`sampling_rate` ç­‰æ—¶ dummy æ•°æ®å°ºå¯¸/é•¿åº¦éšä¹‹å˜åŒ–ï¼Œå¹¶ç¡®ä¿æ— å¼‚å¸¸ã€‚  
3. **ç±»å‹æç¤º**ï¼š`Mapping[str, object]` å·²å¤Ÿå®½ï¼Œä½†å¯è€ƒè™‘ä½¿ç”¨ `Dict[str, Any]` å¹¶åœ¨å‡½æ•°æ–‡æ¡£ä¸­åˆ—å‡ºå¸¸ç”¨é”®ï¼Œæå‡ IDE å¯è¯»æ€§ã€‚  
4. **æ€§èƒ½**ï¼šä»…åœ¨ dummy æ•°æ®ç”Ÿæˆé˜¶æ®µå¤šä¼ é€’ä¸€æ¬¡å­—å…¸ï¼Œå¼€é”€å¯å¿½ç•¥ï¼Œæ— éœ€é¢å¤–ä¼˜åŒ–ã€‚  
5. **é…ç½®è¿ç§»**ï¼šå¦‚æœå·²æœ‰æ¨¡å‹é…ç½®æ–‡ä»¶ä¸­å·²ç»æºå¸¦ç±»ä¼¼å‚æ•°ï¼ˆå¦‚ `image_size`ï¼‰ï¼Œè¯·åœ¨è¿ç§»è„šæœ¬ä¸­æŠŠå®ƒä»¬æ”¾å…¥ `mm_processor_kwargs`ï¼Œé˜²æ­¢å‡ºç°é»˜è®¤å°ºå¯¸ä¸æœŸæœ›ä¸ç¬¦çš„æƒ…å†µã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸ºå¤šæ¨¡æ€æ¨¡å‹çš„ dummy è¾“å…¥æä¾›äº†æ›´çµæ´»çš„å¤„ç†å™¨å‚æ•°æ§åˆ¶ï¼Œå¯¹ç°æœ‰åŠŸèƒ½æ²¡æœ‰ç ´åæ€§å½±å“ï¼Œåªéœ€è¡¥å……æ–‡æ¡£å’Œç›¸åº”çš„æµ‹è¯•å³å¯å¹³ç¨³ä¸Šçº¿ã€‚

---

### [CI][BugFix] Fix silent failure in shellcheck hook and baseline existâ€¦ (#32458)
**SHA**: `fa7e0bf` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/fa7e0bfacfb44ec77a4bda77ba499d320b14ae7c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤ / åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- ä¸º `tools/pre_commit/shellcheck.sh` æ·»åŠ äº† **baseline** æ–‡ä»¶ (`tools/pre_commit/shellcheck.baseline`) ç”¨äºè®°å½•å†å²çš„ ShellCheck è­¦å‘Šã€‚  
- è„šæœ¬æ”¹ä¸º `set -euo pipefail`ï¼Œå¹¶å®ç° **baseline ç”Ÿæˆ** (`--generate-baseline`) ä¸ **æ–°å¢è­¦å‘Šæ£€æµ‹**ï¼šå¦‚æœå½“å‰æ£€æŸ¥ç»“æœå‡ºç° baseline ä¸­æœªå‡ºç°çš„ `file:SCxxx`ï¼ŒCI å°†ä»¥éé›¶é€€å‡ºç æŠ¥é”™å¹¶å±•ç¤ºå…·ä½“ä»£ç ã€‚  
- å½“ baseline ç¼ºå¤±æ—¶ç»™å‡ºæ˜ç¡®æç¤ºï¼Œé˜²æ­¢ä¹‹å‰çš„â€œé™é»˜å¤±è´¥â€ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `tools/pre_commit/` ç›®å½•ä¸‹çš„ ShellCheck é¢„æäº¤é’©å­ã€‚  
- CI æµæ°´çº¿ï¼ˆGitHub Actions / Buildkiteï¼‰ä½¿ç”¨è¯¥é’©å­æ—¶çš„è¡Œä¸ºã€‚  
- æ‰€æœ‰åœ¨ä»“åº“ä¸­ç¼–è¾‘ Bash è„šæœ¬çš„å¼€å‘è€…ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **é¦–æ¬¡è¿è¡Œ**ï¼šåœ¨æœ¬åœ°æˆ– CI ä¸­æ‰§è¡Œ `./tools/pre_commit/shellcheck.sh --generate-baseline`ï¼Œå°†ç”Ÿæˆçš„ `shellcheck.baseline` æäº¤åˆ°ä»“åº“ã€‚  
2. **è„šæœ¬ä¿®æ”¹**ï¼šä»»ä½•æ–°å¢æˆ–ä¿®æ”¹çš„ `.sh` æ–‡ä»¶è‹¥è§¦å‘æœªåœ¨ baseline ä¸­çš„ SC ä»£ç ï¼Œå°†å¯¼è‡´ preâ€‘commit å¤±è´¥ï¼Œéœ€æ ¹æ®æç¤ºå®šä½å¹¶ä¿®å¤æˆ–åœ¨åˆç†æƒ…å†µä¸‹æ‰‹åŠ¨æ›´æ–° baselineã€‚  
3. **CI é…ç½®**ï¼šç¡®è®¤ CI ç¯å¢ƒå·²å®‰è£… `shellcheck`ï¼ˆå·²åœ¨è„šæœ¬é‡Œåšæ£€æµ‹ï¼‰ï¼Œå¹¶ä¸” `pre-commit` ä»å¼•ç”¨ `shellcheck.sh`ã€‚  
4. **å›¢é˜Ÿåä½œ**ï¼šå»ºè®®åœ¨ä»£ç è¯„å®¡æ—¶æ£€æŸ¥ CI æŠ¥å‘Šçš„ â€œnew warningsâ€ï¼Œé¿å…è¯¯æŠŠåŸºçº¿é—æ¼å½“ä½œä»£ç é—®é¢˜ã€‚  
5. å¦‚éœ€æš‚æ—¶å¿½ç•¥æŸæ¡æ–°è­¦å‘Šï¼Œå¯åœ¨ç›¸åº”è„šæœ¬åŠ ä¸Š `# shellcheck disable=SCxxx`ï¼Œæˆ–åœ¨ baseline ä¸­æ‰‹åŠ¨åŠ å…¥å¯¹åº” `file:SCxxx`ï¼ˆä½†æœ€å¥½å…ˆç¡®è®¤ç¡®å®æ˜¯å¯æ¥å—çš„æƒ…å½¢ï¼‰ã€‚  

æ­¤æ”¹åŠ¨æå‡äº† CI å¯¹ Bash è„šæœ¬è´¨é‡çš„å¯è§†åŒ–ä¸å¯é æ€§ï¼Œä½¿ç”¨æ—¶è¯·ç¡®ä¿åŸºçº¿åŒæ­¥ï¼Œé¿å…å› åŸºçº¿ç¼ºå¤±å¯¼è‡´ä¸å¿…è¦çš„æ„å»ºå¤±è´¥ã€‚

---

### [ROCm] [aiter] Split KV cache update for AiterFlashAttention (#33681)
**SHA**: `64f570a` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/64f570ab56cab7e8977c611b78f9a44a9a9f033c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / æ€§èƒ½ä¼˜åŒ–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `rocm_aiter_fa.py` ä¸­å°† KVâ€‘cache çš„å†™å…¥é€»è¾‘ä» `forward` æ–¹æ³•ä¸­æŠ½ç¦»ï¼Œå°è£…ä¸º `do_kv_cache_update`ã€‚  
2. æ–°å¢ `forward_includes_kv_cache_update: bool = False` æ ‡è®°ï¼Œè¡¨æ˜ `forward` ä¸å†è‡ªè¡Œæ›´æ–° KVã€‚  
3. å¼•å…¥ `get_attention_context` ç”¨ä»¥åœ¨ `do_kv_cache_update` ä¸­è·å–å½“å‰å±‚çš„æ³¨æ„åŠ›å…ƒæ•°æ®ï¼ˆslot_mappingã€scale ç­‰ï¼‰ï¼Œå¹¶åœ¨ shuffleâ€‘kvâ€‘cache å¼€å¯æ—¶å¼ºåˆ¶æ£€æŸ¥é‡åŒ–å°ºåº¦ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- ROCmâ€¯AiterFlashAttention åç«¯ (`vllm/v1/attention/backends/rocm_aiter_fa.py`)  
- ç›¸å…³çš„ Attention å±‚è°ƒåº¦é€»è¾‘ï¼ˆ`vllm/model_executor/layers/attention/*.py`ï¼‰  
- KVâ€‘cache å…±äº«ä¸é‡åŒ–è·¯å¾„ï¼ˆfp8ã€shuffleï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **è°ƒç”¨è·¯å¾„æ£€æŸ¥**ï¼šç¡®è®¤è°ƒåº¦å™¨æˆ– `Attention` çš„ `forward` ä¹‹åå·²æ˜¾å¼è°ƒç”¨ `do_kv_cache_update`ï¼Œå¦åˆ™ KVâ€‘cache å°†ä¸å†å†™å…¥ï¼Œå¯¼è‡´æ¨ç†é”™è¯¯ã€‚  
2. **è·¨å±‚ KVâ€‘å…±äº«**ï¼š`kv_sharing_target_layer_name` ä¸º `None` æ—¶æ‰æ‰§è¡Œå†™å…¥ï¼Œç¡®ä¿æ—§çš„å…±äº«æœºåˆ¶ä»å¯åœ¨æ–°è·¯å¾„ä¸‹ç”Ÿæ•ˆã€‚  
3. **é‡åŒ–å°ºåº¦ä¸€è‡´æ€§**ï¼šshuffleâ€‘kvâ€‘cache åˆ†æ”¯è¦æ±‚ `attn_metadata.k_scale/v_scale` éç©ºï¼Œæ–°å¢æ–­è¨€å¯åœ¨ profilingâ€‘run ä¸­æŠ›å¼‚å¸¸ï¼Œå»ºè®®åœ¨å•å…ƒæµ‹è¯•é‡Œè¦†ç›– both shuffleâ€‘enabled ä¸ disabled åœºæ™¯ã€‚  
4. **å‘åå…¼å®¹**ï¼š`forward_includes_kv_cache_update` è®¾ä¸º `False`ï¼Œä½†å·²æœ‰ä»£ç å¯èƒ½ä»ä¾èµ– `forward` è‡ªåŠ¨å†™å…¥ã€‚æä¾›å…¼å®¹å¼€å…³æˆ–åœ¨ `forward` ä¸­ä¿ç•™æ—§å®ç°çš„ä¸´æ—¶è·¯å¾„ï¼Œå¯å‡å°å‡çº§é£é™©ã€‚  
5. **æ€§èƒ½åŸºå‡†**ï¼šå°† KVâ€‘cache æ›´æ–°æ‹†åˆ†åï¼Œç†è®ºä¸Šèƒ½è®© `forward` æ›´è½»é‡å¹¶ä¸å¼‚æ­¥æ›´æ–°é…åˆã€‚å»ºè®®åœ¨ ROCm å¹³å°ä¸Šå¯¹ prefillã€decodeã€extend ä¸‰ç§æ¨¡å¼åšååé‡/æ—¶å»¶å¯¹æ¯”ï¼Œç¡®ä¿æ‹†åˆ†æœªå¼•å…¥é¢å¤–åŒæ­¥å¼€é”€ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº† KVâ€‘cache çš„å¯æ’æ‹”æ€§ï¼Œä¸ºåç»­å¼‚æ­¥æˆ–åˆ†å¸ƒå¼ç¼“å­˜æ›´æ–°å¥ å®šåŸºç¡€ï¼Œä½†åŠ¡å¿…åœ¨è°ƒç”¨é“¾å’Œå…±äº«æœºåˆ¶ä¸Šåšå¥½éªŒè¯ï¼Œä»¥é˜²å‡ºç°ç¼“å­˜æœªå†™å…¥æˆ–å°ºåº¦ä¸åŒ¹é…çš„å›å½’ã€‚

---

### [Bugfix]: Fix ROCm fusion attn test; use AttentionBackend utils to create kv cache (#33948)
**SHA**: `fd61887` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/fd618871b41c0cf9259379cde9cca230a56c4096)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤ / ä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
1. ä¿®å¤äº† ROCm èåˆæ³¨æ„åŠ›å•å…ƒçš„æµ‹è¯•å¤±æ•ˆé—®é¢˜ã€‚  
2. é€šè¿‡ç»Ÿä¸€çš„ `AttentionBackend` æ¥å£ï¼ˆ`get_kv_cache_shape`ã€`get_kv_cache_stride_order`ï¼‰ç”Ÿæˆ KV ç¼“å­˜ï¼Œè€Œä¸å†åœ¨æµ‹è¯•ä¸­ç¡¬ç¼–ç æ¯ç§åç«¯çš„å¼ é‡å¸ƒå±€ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `tests/compile/passes/test_fusion_attn.py`ï¼ˆä»…æµ‹è¯•ä»£ç ï¼‰  
- `vllm/v1/worker/gpu/attn_utils.py`ï¼ˆè‹¥åç«¯å®ç°æœªæä¾›ç›¸åº” APIï¼Œä¼šå¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸ï¼‰  
- ä¸ KVâ€‘cache å½¢çŠ¶/stride ç›¸å…³çš„åç«¯å®ç°ï¼ˆROCM_ATTNã€ROCM_AITER_UNIFIED_ATTNã€TRITON_ATTNã€FLASHINFERï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **åç«¯å®ç°å®Œæ•´æ€§**  
   - ç¡®è®¤æ‰€æœ‰å·²æ³¨å†Œçš„ `AttentionBackend`ï¼ˆå°¤å…¶æ˜¯ ROCm ç›¸å…³ï¼‰å®ç°äº† `get_kv_cache_shape` ä¸ `get_kv_cache_stride_order`ï¼Œå¦åˆ™ä¼šå›è½åˆ°é»˜è®¤é¡ºåºï¼Œå¯èƒ½éšè—å¸ƒå±€ä¸åŒ¹é…çš„é”™è¯¯ã€‚  
   - å¯¹æœªå®ç° `get_kv_cache_stride_order` çš„åç«¯ï¼Œå»ºè®®åœ¨åŸºç±»ä¸­æŠ›å‡º `NotImplementedError` å¹¶åœ¨å•å…ƒæµ‹è¯•ä¸­æ˜¾å¼è¦†ç›–ï¼Œä»¥é˜²æœªæ¥å¿˜è®°å®ç°ã€‚  

2. **ç¼“å­˜å¼ é‡æ„é€ çš„æ­£ç¡®æ€§**  
   - `kv_cache_shape` å…ˆæŒ‰åç«¯è¿”å›é¡ºåºæ’åˆ—ï¼Œå†é€šè¿‡ `inv_order` é‡æ–°æ’åˆ—ä¸º â€œk/v ä¸ºç¬¬ä¸€ç»´â€ çš„é€šç”¨å¸ƒå±€ã€‚éœ€è¦ç¡®ä¿ `inv_order` ä¸ `stride_order` çš„å¯¹åº”å…³ç³»åœ¨æ‰€æœ‰åç«¯ä¸Šéƒ½æ˜¯åŒå°„ï¼Œå¦åˆ™ `permute` å¯èƒ½äº§ç”Ÿç»´åº¦é”™ä½ã€‚  
   - å»ºè®®åœ¨æµ‹è¯•ä¸­åŠ å…¥å¯¹ `kv_cache.stride()` æˆ– `tensor.strides()` çš„æ–­è¨€ï¼ŒéªŒè¯ç”Ÿæˆçš„å¼ é‡åœ¨å†…å­˜å¸ƒå±€ä¸Šç¬¦åˆåç«¯æœŸæœ›ã€‚  

3. **ä»£ç å¯ç»´æŠ¤æ€§**  
   - å½“å‰æ³¨é‡Šä¸­ä»æ®‹ç•™ `TODO (Rohan138) reuse utils from vllm/v1/worker/gpu/attn_utils.py`ï¼Œåº”åˆ é™¤æˆ–å®Œæˆå¯¹åº”çš„æŠ½è±¡ï¼Œä»¥å…è¯¯å¯¼åç»­ç»´æŠ¤è€…ã€‚  
   - è‹¥åç»­éœ€è¦åœ¨ç”Ÿäº§ä»£ç ä¸­ä¹Ÿä½¿ç”¨åŒæ ·çš„ KVâ€‘cache æ„é€ é€»è¾‘ï¼Œå»ºè®®å°†è¯¥ç‰‡æ®µæŠ½è±¡ä¸ºä¸€ä¸ªå…¬å…±å‡½æ•°ï¼ˆä¾‹å¦‚ `create_dummy_kv_cache`ï¼‰ï¼Œå¹¶åœ¨æ–‡æ¡£ä¸­è¯´æ˜å…¶ä»…ç”¨äºæµ‹è¯•æˆ–è°ƒè¯•ã€‚  

4. **å›å½’æµ‹è¯•**  
   - è¯¥ä¿®æ”¹ä»…å½±å“æµ‹è¯•æ–‡ä»¶ï¼Œä½†æ¶‰åŠåº•å±‚å¼ é‡å¸ƒå±€ï¼Œå»ºè®®åœ¨ CI ä¸­ä¿ç•™å¯¹æ‰€æœ‰æ³¨æ„åŠ›åç«¯çš„èåˆæ³¨æ„åŠ›ç¼–è¯‘æµ‹è¯•ï¼Œé˜²æ­¢å› åç«¯å®ç°ç»†èŠ‚å˜åŒ–å¯¼è‡´éšè—çš„å›å½’ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨é€šè¿‡ç»Ÿä¸€åç«¯å·¥å…·å‡½æ•°æ¶ˆé™¤äº†ç¡¬ç¼–ç å¸¦æ¥çš„ç»´æŠ¤è´Ÿæ‹…ï¼Œæå‡äº†æµ‹è¯•çš„å¯æ‰©å±•æ€§ã€‚åªè¦ç¡®ä¿åç«¯å®ç°å®Œæ•´å¹¶åŠ å…¥ç›¸åº”çš„å¸ƒå±€æ ¡éªŒï¼Œé£é™©è¾ƒä½ã€‚ç¥åç»­å¼€å‘é¡ºåˆ©ï¼

---

#### ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (19)

### Add config file for fused MoE for Nemotron (TP4, B200) (#34411)
**SHA**: `dea6351` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/dea63512bb9bdf7521d591546c52138d9d79e8ce)

**å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**æ‘˜è¦**ï¼šæ–°å¢ `E=512,N=672,device_name=NVIDIA_B200.json` é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰ä¸åŒç»´åº¦ä¸‹çš„ BLOCK_SIZEã€GROUP_SIZEã€warp ä¸ stage å‚æ•°ï¼Œæ”¯æŒ Nemotron TP4 åœ¨ B200 GPU ä¸Šçš„ fused MoEã€‚

---

### [ROCm] Enable MXFP4 MoE weight pre-shuffling on gfx950 and update aiter (#34192)
**SHA**: `8a798be` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/8a798be929d62a6467fd079c03c83632f8231b11)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šæ›´æ–° ROCm åŸºç¡€é•œåƒçš„ `Dockerfile.rocm_base`ï¼Œåˆ‡æ¢åˆ°æ–°çš„ aiter åˆ†æ”¯å¹¶å»é™¤ `PREBUILD_KERNELS` æ ‡å¿—ï¼›åœ¨ `quark_moe.py` ä¸­æ–°å¢å¯¹ MoE æƒé‡çš„é¢„æ´—ç‰Œé€»è¾‘ï¼Œç”Ÿæˆå¹¶ä¿å­˜æ´—ç‰Œåçš„å‚æ•°å¹¶æ ‡è®°ä¸ºå·²æ´—ç‰Œã€‚

---

### Fix Mistral config remap to accept compressed-tensors quantization #34028 (#34104)
**SHA**: `f589761` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/f5897613fb270fb478cda362868713cc338f6be9)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `mistral.py` ä¸­åŠ å…¥å¯¹ `compressed-tensors` é‡åŒ–æ–¹å¼çš„è¯†åˆ«ä¸è½¬å‘ï¼Œå¹¶ç»Ÿä¸€å…¶ `quant_method` ä¸ºè§„èŒƒå†™æ³•ï¼Œä»¥æ”¯æŒå‹ç¼©å¼ é‡çš„é‡åŒ–é…ç½®ã€‚

---

### [bugfix] refactor FunASR's _get_data_parser  (#34397)
**SHA**: `386bfe5` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/386bfe5d08103f570a3aa03055372cbd33cf41ca)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† FunASR çš„æ•°æ®è§£æå™¨åˆ›å»ºé€»è¾‘ä» `FunASRMultiModalProcessor._get_data_parser` ç§»è‡³ `FunASRProcessingInfo.get_data_parser`ï¼Œå¹¶åˆ é™¤å·²ä¸å†éœ€è¦çš„ `skip_prompt_length_check` å±æ€§ã€‚è¿™æ ·ç®€åŒ–äº†å¤„ç†å™¨å®ç°ï¼Œæå‡äº†ä»£ç ç»„ç»‡ã€‚

---

### Fix DeepSeek-OCR tensor validation for all size variants (#34085)
**SHA**: `80f2ba6` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/80f2ba6ea6cbda0da56da65cee8402e7b5bf2aa0)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `deepseek_ocr.py` ä¸­ï¼Œå°†ç¡¬ç¼–ç çš„ `vision_config.image_size` æ›¿æ¢ä¸ºçœŸå®å¼ é‡çš„ç©ºé—´ç»´åº¦ï¼Œå¹¶æ ¹æ® `images_crop` åŠ¨æ€å†³å®š `image_size`ï¼Œä½¿ä¸åŒåˆ†è¾¨ç‡çš„æ¨¡å‹å˜ä½“å‡å¯ä½¿ç”¨ç»Ÿä¸€æƒé‡ã€‚

---

### [BugFix] Fix DP chunking  (#34379)
**SHA**: `136b0bf` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/136b0bfa59377ed2bbd3b3716036a96267cfe80b)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `default_moe_runner.py` ä¸­å°† `shared_input` å‚æ•°æ”¹åä¸º `full_shared_input`ï¼Œå¹¶åœ¨åˆ†å—å¤„ç†æ—¶æ­£ç¡®åˆ‡ç‰‡ä¸ä¼ é€’å…±äº«è¾“å…¥ï¼Œä¿®å¤äº†æ•°æ®å¹¶è¡Œï¼ˆDPï¼‰ä¸‹çš„åˆ†å—è®¡ç®—é”™è¯¯ã€‚

---

### [Bug Fix] Fix `naive_block_assignment` always defaulting to False due to arg misalignment (#33848)
**SHA**: `e1d97c3` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/e1d97c38f8689da0b11da0fac54cc277c237d5c4)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®å¤ `naive_block_assignment` å‚æ•°é”™ä½å¯¼è‡´å§‹ç»ˆä¸º False çš„é—®é¢˜ï¼Œåœ¨ `fused_moe.py` ä¸­ä¼ é€’å…³é”®å­—å‚æ•°ï¼Œå¹¶åœ¨ `punica_base.py` ä¸­ä¸º `moe_lora_align_block_size` æ·»åŠ ç›¸åº”é»˜è®¤å‚æ•°ã€‚

---

### [Bugfix] Fix MTP accuracy for GLM-5 (#34385)
**SHA**: `ec12d39` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/ec12d39d44739bee408ec1473acc09e75daf1a5d)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `eagle.py` ä¸­ä¸º MTP æ¨¡å‹æ˜¾å¼å…±äº« `lm_head`ï¼Œä¿®å¤å›  checkpoint æœªåŒ…å«å±‚çº§æƒé‡å¯¼è‡´çš„ NaN logits é—®é¢˜ã€‚æ–°å¢éå†å±‚å¹¶ç»‘å®š `shared_head.head`ï¼Œå¹¶è®°å½•æ—¥å¿—ã€‚

---

### [ROCm][CI] Revert Test Groups From mi325_8 to mi325_1 Agent Pool In AMD CI (#34384)
**SHA**: `fb7b30c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/fb7b30c7162d37d47160b46c5ddb1c82e8073e45)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `.buildkite/test-amd.yaml` ä¸­ï¼Œå°†å¤šä¸ª AMD CI æ­¥éª¤çš„ `agent_pool` ä» `mi325_8` æ¢å¤ä¸º `mi325_1`ï¼Œä»¥ç»Ÿä¸€ä½¿ç”¨æ—§çš„æµ‹è¯•ä»£ç†æ± ã€‚

---

### [Bugfix] Fix some issues with MoERunner PR #32344 (#34371)
**SHA**: `31d992d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/31d992d215a05ad2e4f17653ddff0f515f865914)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£ `gate` åœ¨é overlapped åœºæ™¯è¿”å›ï¼Œç»Ÿä¸€ä½¿ç”¨ `self.gate` åˆ¤æ–­å†…éƒ¨è·¯ç”±å™¨ï¼›åˆ é™¤ `forward_native` ä¸­çš„å†—ä½™é‡åŒ–é…ç½®åˆå§‹åŒ–ï¼›åœ¨é»˜è®¤ MoE runner ä¸­æ˜¾å¼è°ƒç”¨ `ensure_moe_quant_config_init` ä»¥å…¼å®¹è¿ç§»é˜¶æ®µã€‚

---

### [Bugfix] send None sentinel on final commit so server properly sends transcription.done (#33963)
**SHA**: `5458eb8` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/5458eb835d66323a11d4a252ad551d001ce00ac8)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„/Bugfix  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `realtime/connection.py` ä¸­æ”¹ä¸ºåœ¨éŸ³é¢‘æœ€ç»ˆæäº¤æ—¶å‘ `audio_queue` æ”¾å…¥ `None` å“¨å…µï¼Œå»é™¤å†—ä½™ `_is_input_finished` æ ‡è®°ï¼Œå¹¶ç›¸åº”è°ƒæ•´ç”Ÿæˆå¾ªç¯é€»è¾‘ï¼›åŒæ—¶æ›´æ–°å•å…ƒæµ‹è¯•çš„æœŸæœ›å­—ç¬¦ä¸²ï¼Œç¡®ä¿æœåŠ¡å™¨æ­£ç¡®å‘é€ `transcription.done`ã€‚

---

### [Benchmarks] Reduce ready checker log verbosity (#34349)
**SHA**: `144d9b7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/144d9b7cc8352c5868eb407dd970be94f02b572f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `ready_checker.py` ä¸­ä¼˜åŒ–æ—¥å¿—ï¼Œå½“ç«¯ç‚¹æœªå°±ç»ªæ—¶ï¼Œä»…è®°å½•é”™è¯¯ä¿¡æ¯çš„æœ€åä¸€è¡Œï¼Œé™ä½æ—¥å¿—å†—ä½™ã€‚

---

### [GPT-OSS] Remove unnecessary contiguous (#34337)
**SHA**: `83e26c8` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/83e26c834ef188ca84b2459199840e2d58c75c32)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `gpt_oss.py` ä¸­åˆ é™¤äº† `v = v.contiguous()`ï¼Œå»é™¤æ— æ„ä¹‰çš„å†…å­˜æ‹·è´ï¼Œä»£ç æ›´ç®€æ´ä¸”æ— åŠŸèƒ½å½±å“ã€‚

---

### [ROCm] [CI] fix test_unrecognized_env (#34350)
**SHA**: `5001211` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/500121136995ff0b261f4d2f68e4831896e32d63)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `tests/config/test_config_generation.py` ä¸­ä½¿ç”¨ `monkeypatch` æ›¿ä»£ç›´æ¥æ“ä½œ `os.environ`ï¼Œå¹¶æ¸…ç†å¯èƒ½çš„æœªè¯†åˆ« VLLM ç¯å¢ƒå˜é‡ï¼Œç¡®ä¿ `fail_on_environ_validation` å‚æ•°çš„æµ‹è¯•æ›´å¯é ã€ä¸ä¼šå—å¤–éƒ¨ç¯å¢ƒå½±å“ã€‚

---

### [Bugfix] Enable attn quantization of Llama-4 by correctly permuting scales for rope (int8, fp8) (#34243)
**SHA**: `11c7ace` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/11c7ace340610e0be376d531b677bcee1ae84ad4)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®å¤ Llamaâ€‘4 æ³¨æ„åŠ›é‡åŒ–æ—¶ Rope ç¼©æ”¾ä¸æ­£ç¡®çš„é—®é¢˜ï¼Œæ–°å¢å¯¹ compressedâ€‘tensors (int8/fp8) æƒé‡é‡è¡¨çš„ç‰¹æ®Šæ’åˆ—é€»è¾‘ã€‚

---

### [Bugfix] fix default is_neox_style is True for deepseek (#34353)
**SHA**: `be7f3d5` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/be7f3d5d2016b326d12ff582a8c9f96a68217c7a)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£ `deepseek_v2.py` ä¸­ `is_neox_style` çš„é»˜è®¤å€¼ï¼Œå°† `getattr(config, "indexer_rope_interleave", False)` æ”¹ä¸ºå–åï¼Œä»¥ç¡®ä¿é»˜è®¤è¡Œä¸ºæ­£ç¡®ï¼Œé¿å…è¯¯å°† NEoxâ€‘style ä½ç½®ç¼–ç æ‰“å¼€ã€‚

---

### [Model Runner V2] Init cuda graph pool when necessary (#33217)
**SHA**: `ffb3d55` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/ffb3d553cc9258049bf4d48214c9f4106cc67cfb)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `cudagraph_utils.py` ä¸ `eagle_cudagraph.py` ä¸­ï¼Œä»…åœ¨ `cudagraph_mode` é `NONE` æ—¶æ‰åˆ›å»º CUDA graph poolï¼Œé¿å…æ— æ„ä¹‰çš„èµ„æºåˆå§‹åŒ–ã€‚

---

### [Docs] Fix typo ("defult") and double spacing (#34348)
**SHA**: `48134a2` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/48134a2c227541dd47b1651bfd96a70a714b0f6e)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£æ–‡æ¡£ä¸­ â€œdefultâ€ æ‹¼å†™é”™è¯¯å¹¶åˆ é™¤å¤šä½™ç©ºæ ¼ï¼Œå°† â€œ-02 is used by defultâ€ æ”¹ä¸º â€œ-O2 is used by defaultâ€ã€‚ä»…æ”¹åŠ¨ä¸€è¡Œæ³¨é‡Šï¼Œæ— åŠŸèƒ½å½±å“ã€‚

---

### Don't try and run GLM-ASR with remote code (#34352)
**SHA**: `67a42b5` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/vllm-project/vllm/commit/67a42b5a44fe196250142f1e8ddee44d7061500f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `tests/models/registry.py` ä¸­ç§»é™¤ `GlmAsrForConditionalGeneration` çš„ `trust_remote_code=True`ï¼Œé¿å…åœ¨æµ‹è¯•ä¸­å°è¯•è¿è¡Œ GLMâ€‘ASR è¿œç¨‹ä»£ç ã€‚

---

