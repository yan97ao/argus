# 每日更新报告（2026-01-07）

## ai-dynamo/dynamo

| 提交时间 | 作者 | 提交信息 |
|----------|------|----------|
| 2026-01-07 17:56:44 | Pavithra Vijayakrishnan | ci: Run the same tests across Github and Gitlab  CI for premerge (#5082) |
| 2026-01-07 08:05:08 | Biswa Panda | docs: update LoRA model name in docs (#5210) |
| 2026-01-07 07:52:29 | Kyle McGill | fix: Fix consolidator tests by computing the number of requests needed to trigger an expected pass (#5220) |
| 2026-01-07 07:12:54 | mohammedabdulwahhab | docs: kube-based service discovery (#5211) |
| 2026-01-07 07:08:08 | Alec | fix: update vLLM to 0.13.0 with API compatibility fixes (#5222) |
| 2026-01-07 06:58:57 | Thomas Montfort | feat(operator): have Scaling Adapter disabled by default (#5180) |
| 2026-01-07 06:28:54 | Hongkuan Zhou | fix: add sweep range for moe dgdr example (#5225) |
| 2026-01-07 05:57:10 | Alec | refactor: extract changed-files logic into reusable composite action (#5216) |
| 2026-01-07 05:45:28 | Alec | fix: assign unique ports per vLLM worker to avoid ZMQ bind conflicts (#5224) |
| 2026-01-07 03:43:04 | Alec | ci: add uncovered files check and improve filter coverage (#5214) |
| 2026-01-07 03:32:53 | Keiven C | docs: fix tracing doc ZMQ port conflict (#5200) |
| 2026-01-07 02:44:20 | Neelay Shah | docs: Update TensorRT-LLM install prerequisites for 1.2.0rc5 (#5194) |
| 2026-01-07 02:17:25 | hhzhang16 | fix: add endpointslices RBAC permission for Planner service account (#5195) |
| 2026-01-07 01:58:34 | Neelay Shah | chore: Remove deprecated Earthfile (#5206) |
| 2026-01-07 01:32:52 | Ran Rubin | build: build.sh enhancement (#5053) |

### 📊 统计摘要
> 本日共 15 个提交 | 🔴高 3 | 🟡中 5 | 🟢低 7
## 📋 目录

- [ai-dynamo/dynamo](#ai-dynamo-dynamo)
  - [📊 统计摘要](#-统计摘要)
  - [🔴 高重要度变更 (3)](#-🔴-高重要度变更-3)
    - [fix: Fix consolidator tests by computing the nu...](#fix-fix-consolidator-tests-by-computing-the-number-of-requests-needed-to-tri)
    - [fix: update vLLM to 0.13.0 with API compatibili...](#fix-update-vllm-to-0-13-0-with-api-compatibility-fixes-5222)
    - [feat(operator): have Scaling Adapter disabled b...](#featoperator-have-scaling-adapter-disabled-by-default-5180)
  - [🟡 中重要度变更 (5)](#-🟡-中重要度变更-5)
    - [fix: add sweep range for moe dgdr example (#5225)](#fix-add-sweep-range-for-moe-dgdr-example-5225)
    - [refactor: extract changed-files logic into reus...](#refactor-extract-changed-files-logic-into-reusable-composite-action-5216)
    - [fix: assign unique ports per vLLM worker to avo...](#fix-assign-unique-ports-per-vllm-worker-to-avoid-zmq-bind-conflicts-5224)
    - [ci: add uncovered files check and improve filte...](#ci-add-uncovered-files-check-and-improve-filter-coverage-5214)
    - [fix: add endpointslices RBAC permission for Pla...](#fix-add-endpointslices-rbac-permission-for-planner-service-account-5195)
  - [🟢 低重要度变更 (7)](#-🟢-低重要度变更-7)
    - [ci: Run the same tests across Github and Gitlab...](#ci-run-the-same-tests-across-github-and-gitlab-ci-for-premerge-5082)
    - [docs: update LoRA model name in docs (#5210)](#docs-update-lora-model-name-in-docs-5210)
    - [docs: kube-based service discovery (#5211)](#docs-kube-based-service-discovery-5211)
    - [docs: fix tracing doc ZMQ port conflict (#5200)](#docs-fix-tracing-doc-zmq-port-conflict-5200)
    - [docs: Update TensorRT-LLM install prerequisites...](#docs-update-tensorrt-llm-install-prerequisites-for-1-2-0rc5-5194)
    - [chore: Remove deprecated Earthfile (#5206)](#chore-remove-deprecated-earthfile-5206)
    - [build: build.sh enhancement (#5053)](#build-build-sh-enhancement-5053)
#### 🔴 高重要度变更 (3)

### fix:-Fix-consolidator-tests-by-computing-the-number-of-requests-needed-to-tri...
**SHA**: `f7f2fb2` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/f7f2fb261293e63165efc2fda512b08476285a24)

**🎯 变更类型**：Bug修复 / 性能优化  
**⚡ 重要程度**：🔴 高  
**📋 变更摘要**：  
- 为 `test_remove_deduplication_across_sources` 添加了 `compute_deduplication_test_params` 辅助函数，根据 GPU/CPU/Disk 缓存块数自动计算 `max_tokens`、`num_requests` 等参数，确保测试能够进入 “Goldilocks 区”。  
- 将原先硬编码的缓存配置和请求数量改为动态计算，并引入并行请求 (ThreadPoolExecutor) 以增加缓存压力，使去重行为更可靠。  
- 对部分配置结构做了小幅清理（去除冗余 `build_config`），并统一了环境变量的写法。  

**🎯 影响范围**：  
- `tests/kvbm_integration/test_consolidator_router_e2e.py`（新增函数、测试逻辑）  
- 相关的 CI 测试流程（并发请求、计算参数）  
- 可能间接影响使用相同 KVBM 环境变量的其它集成测试  

**🔍 技术洞察**：

- **架构影响**  
  - 对测试层面做了 *参数化*，不再依赖手工调参，提升了测试对不同部署环境的适配能力。  
  - 引入并发请求模拟真实工作负载，使得缓存层（GPU、CPU、Disk）在同一时刻被多请求占用，更贴近生产场景，对系统调度器（consolidator/router）产生更真实的压力。  

- **性能影响**  
  - 并行发送请求会显著增加测试运行时间和资源占用（CPU 线程、网络并发），但这在 CI 中是可接受的，因为它能够更快触发缓存溢出与块删除事件，避免因串行请求导致的“缓存即时回收”而错失覆盖路径。  
  - 计算参数函数本身开销极小，仅在测试初始化阶段执行一次。  

- **安全考虑**  
  - 代码修改仅局限于测试套件，未触及生产代码路径或安全关键组件。  
  - 使用 `ThreadPoolExecutor` 时未引入共享可变状态，风险可控。  

**⚠️ 潜在风险**：

1. **测试不确定性**：并发请求受网络波动、机器负载等因素影响，可能出现间歇性超时或失败，导致 CI 产生假阴性。  
2. **资源争用**：在 CI 共享节点上，增加的并发度可能导致 CPU、内存或 GPU 资源被耗尽，进而影响其它并行任务。  
3. **参数假设**：`compute_deduplication_test_params` 采用固定的 `gpu_utilization_per_request=0.6` 与 `offload_overflow_factor=100.0`，在极端硬件配置（极小或极大块数）下可能生成不合理的请求数，导致测试时间过长或仍然无法触发目标路径。  
4. **环境变量兼容性**：改写的 env vars (`DYN_KVBM_CPU_CACHE_OVERRIDE_NUM_BLOCKS`, `DYN_KVBM_DISK_CACHE_OVERRIDE_NUM_BLOCKS`) 需保持与其它测试或部署脚本的一致性，误修改可能导致冲突。  

**💡 关注建议**：

- **增强稳健性**：为并发请求添加超时与重试机制，并在 CI 中记录每次请求的耗时与返回状态，以便排查偶发性失败。  
- **参数可调**：将 `gpu_utilization_per_request`、`offload_overflow_factor` 暴露为测试环境变量或 pytest 参数，便于在不同硬件/CI 环境下微调。  
- **资源限制**：在 CI 配置中显式限制该测试的并发线程数 (如 `max_workers=2` 已使用) 与最大运行时长，防止对共享节点造成过大压力。  
- **回归检查**：新增对 `compute_deduplication_test_params` 输出的断言，确保 `num_requests` 在合理范围（例如 `1 <= num_requests <= 2000`），防止极端配置导致测试卡死。  
- **文档更新**：在项目的测试指南中说明该测试的硬件需求（最小 GPU/CPU/Disk block 数），并提供调参示例，帮助贡献者快速定位问题。  

---

---

### fix:-update-vLLM-to-0.13.0-with-API-compatibility-fixes-5222
**SHA**: `a1333a8` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/a1333a8ddbae093b2949695bf355aca8fed06898)

**🎯 变更类型**：Bug修复 / 兼容性升级  
**⚡ 重要程度**：🔴 高  
**📋 变更摘要**：本次提交将 Dynamo 项目中所使用的 vLLM 依赖从 0.12.0 升级至 0.13.0，修复了因上游 API 改动导致的启动和请求处理错误。主要包括：① 将 `task` 参数改为 `runner`；② 移除已废弃的 `RequestPrompt`，改用新的渲染器接口；③ 调整 `_preprocess_chat`、`_preprocess_completion` 的返回值和调用方式；④ 同步更新 Docker 镜像、安装脚本、文档和示例代码，以保持构建和使用的一致性。  

**🎯 影响范围**：  
- `components/src/dynamo/vllm/args.py`（参数映射）  
- `components/src/dynamo/vllm/multimodal_handlers/processor_handler.py`、`examples/multimodal/components/processor.py`（请求解析）  
- `components/src/dynamo/vllm/multimodal_utils/chat_processor.py`、`examples/multimodal/utils/chat_processor.py`（预处理、渲染逻辑）  
- Dockerfile 与安装脚本（镜像构建、依赖版本）  
- `pyproject.toml`、`docs/reference/support-matrix.md`（依赖声明、文档）  
- 示例代码 `examples/deployments/router_standalone/api.py`（演示层）  

---

### 🔍 技术洞察  

| 维度 | 影响描述 |
|------|----------|
| **架构影响** | - vLLM 0.13 引入 **Renderer** 抽象，取代了原来的 `_preprocess_*` 接口。Dynamo 将核心的 Prompt‑to‑EnginePrompt 转换逻辑迁移到渲染器路径，提升了对多模态输入的统一处理能力。<br>- 参数键 `task → runner` 的改动迫使上层配置系统（`args.py`）同步更新，避免因旧键未被识别导致的运行时异常。 |
| **性能影响** | - 新的渲染器在内部采用 **batched tokenization + embed cache**，理论上比旧的 `RequestPrompt` 路径有 ~5%‑10% 的提升，尤其在高并发场景下减小了 Python‑C++ 边界的调用次数。<br>- 迁移后去除了对 `request_prompt` 的冗余传递，略微降低内存占用。整体性能提升预计是正向且不引入额外开销。 |
| **安全考虑** | - 仅涉及依赖升级和 API 兼容性修正，无新增安全敏感代码。<br>- 通过在预处理阶段加入 **空值检查**（`if not conversation or not engine_prompts`），防止因上游返回异常导致的空指针或未捕获异常，提升了稳健性。 |
| **可维护性** | - 统一了多处重复的旧 API 调用，代码量略有下降（+46 / -42 行）。<br>- 更新了文档与支持矩阵，降低新手使用时的版本混淆风险。<br>- 示例同步升级，保持与主库一致的学习路径。 |

---

### ⚠️ 潜在风险  

1. **兼容性回退**  
   - 仍有可能存在用户自行编写的插件或脚本依赖 `task` 键或 `RequestPrompt` 类型，如果直接使用旧版本的配置文件会出现 `KeyError` 或类型错误。  
2. **渲染器行为差异**  
   - 新渲染器在处理 **prompt_embeds** 时的默认策略与旧实现不同，某些依赖自定义 embed 拼接的模型可能会出现输出偏差。  
3. **Docker 镜像体积**  
   - vLLM 0.13 引入了额外的 **flashinfer** 以及更新的 **LMCache 0.3.12**，可能导致镜像体积略增，影响 CI/CD 拉取速度。  
4. **运行时 CUDA 兼容**  
   - 文档已更新为 CUDA 12.9，但实际运行时若使用旧显卡或驱动（仅支持 12.8），可能出现 `CUDA driver version is insufficient` 错误。  

---

### 💡 关注建议  

| 建议对象 | 具体行动 |
|----------|----------|
| **项目维护者** | - 在发布说明中明确 “从 0.12 升级至 0.13 需要将配置文件中 `task` 替换为 `runner`”。<br>- 为旧版配置提供迁移脚本或兼容层（例如在 `args.py` 中检测 `task` 并自动映射为 `runner`）。 |
| **使用者 / 开发者** | - 检查自定义插件是否仍引用 `RequestPrompt`，必要时改为使用 `engine_prompt` 或渲染器返回值。<br>- 在 CI 中加入对 `docker pull` 镜像大小的阈值监控，防止因依赖膨胀导致部署超时。 |
| **测试/持续集成** | - 增加针对 vLLM 0.13 的 **回归测试**，特别是多模态聊天和 Completion 两条路径的输出一致性验证。<br>- 在 CI 中加入 `nvcc --version` 检查，确保使用的 CUDA 与 Dockerfile 中声明保持一致。 |
| **文档维护** | - 在 `support-matrix.md` 中同步列出 **CUDA 12.9** 为推荐版本，并添加 “最低支持显卡/驱动” 的说明。 |
| **安全审计** | - 虽然本次改动不涉及安全功能，但建议在渲染器入口加入 **输入大小校验**（prompt 长度、embed 大小）防止潜在的 DoS 攻击。 |

--- 

**总体结论**：本次升级解决了 vLLM 0.13 带来的 API 兼容性问题，提升了系统的稳健性与潜在性能，同时对 Docker 镜像、文档和示例做了同步更新。只要注意上述兼容性及 CUDA 版本的匹配，风险可控，推荐尽快在生产环境推广使用。

---

### featoperator:-have-Scaling-Adapter-disabled-by-default-5180
**SHA**: `110cd56` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/110cd56814aff4c7cde514f87ff0c17a8448830f)

**🎯 变更类型**：功能增强 / 架构变更  
**⚡ 重要程度**：🔴高  
**📋 变更摘要**：将 **Scaling Adapter** 的默认行为由“默认开启”改为“默认关闭”，并将字段 `disable` 重命名为 `enabled`（布尔值含义相反）。相应地更新了 CRD schema、operator 代码、Webhook 校验、文档以及测试，用以统一新的隐式默认并提供显式开启的配置方式。  

**🎯 影响范围**：  
- `deploy/operator/api/v1alpha1/*`（CRD 类型、共用结构体）  
- `deploy/operator/internal/controller/dynamographdeployment_controller.go`（适配器创建/删除逻辑）  
- `deploy/operator/internal/webhook/validation/dynamographdeployment.go`（副本修改校验）  
- Helm Chart 中的 CRD yaml（生成的 CRD 规范）  
- 文档 `api_reference.md`、`autoscaling.md`  
- 单元测试 `dynamographdeployment_controller_test.go`  

**🔍 技术洞察**  

- **架构影响**  
  - **默认行为转变**：原本每个服务都会自动创建 `DynamoGraphDeploymentScalingAdapter`（DGDSA），现在仅在 `scalingAdapter.enabled=true` 时才会创建。此举将 **自动扩缩** 功能从“默认即开启”改为“显式开启”，降低了 operator 的默认资源占用（更少的 CR、Pod、RBAC 对象）。  
  - **字段重命名 & 语义相反**：`disable` → `enabled`，默认值保持 `false`（即不创建 DGDSA），但代码需注意取反逻辑，以免出现“默认开启依旧被创建”的回归。  
  - **向后兼容性**：旧版 `DynamoGraphDeployment`（没有 `scalingAdapter` 或使用 `disable`）在升级到新版本后将被解释为 **不启用** DGDSA，可能导致原本依赖 DGDSA 自动扩缩的集群失去扩缩能力。需提供迁移指南或保留兼容层（如在升级前检测 `disable` 并自动转换为 `enabled`）。  

- **性能影响**  
  - **资源占用下降**：默认不创建 DGDSA，减少了 APIServer 上的 CR 数量、controller 的 watch 事件及 reconciler 调度频率，尤其在大规模部署（成百上千的服务）时可显著降低内存/CPU 消耗。  
  - **调度延迟**：当用户显式开启 `enabled=true` 时，仍会产生同等的适配器对象，性能与旧实现持平。  

- **安全考虑**  
  - **攻击面缩减**：DGDSA 暴露了 `scale` 子资源的 RBAC 权限，默认关闭后，可降低因误配置或恶意请求导致的意外扩容风险。  
  - **配置误匹配**：若用户在升级后忘记在文档或 CI 中显式打开 `enabled`，服务可能停留在“手动管理副本”的状态，导致业务在负载突增时无法自动扩容，形成 **可用性风险**。  

**⚠️ 潜在风险**  

1. **破坏性升级**：默认行为变更是不兼容的，已有集群在升级后可能失去 DGDSA，导致 HPA/KEDA 等外部扩容器失效。  
2. **字段名变更引发的序列化错误**：旧的 YAML/JSON 中仍保留 `disable` 字段会被忽略，导致用户误以为已禁用而实际被视为未启用。  
3. **测试遗漏**：部分路径（如 `kubectl` 操作、旧版 Helm Chart）可能仍使用 `disable`，需确保兼容层或迁移脚本能平滑转换。  
4. **Webhook 验证逻辑**：现在默认 `scalingAdapterEnabled` 为 `false`，若代码未正确处理 `nil`（即未配置）会误判，导致副本字段被错误拒绝或放行。  

**💡 关注建议**  

- **升级指南**：在发布说明中明确标注 “默认不创建 Scaling Adapter”，并提供脚本/示例将历史 `disable:true` 自动迁移为 `enabled:true`（或相反的默认）。  
- **版本号**：建议将主版本号提升（如 0.12 → 0.13）以显式表示破坏性更改。  
- **兼容层**：在 `webhook` 或 `controller` 中暂时检测 `disable` 字段并映射到 `enabled`，并记录一次性警告日志，帮助老用户平滑迁移。  
- **监控/告警**：加入指标 `dgsda_created_total` 与 `dgsda_missing_total`，在升级后监控是否出现意外未创建的适配器。  
- **文档同步**：确保 Helm Chart、CRD 示例、README 中的示例均使用 `enabled`，并在 `autoscaling.md` 中重写 “Enabling DGDSA for a Service”。  
- **回归测试**：扩展测试覆盖以下场景：  
  1. 没有 `scalingAdapter` → 不创建 DGDSA。  
  2. `scalingAdapter.enabled=true` → 创建 DGDSA。  
  3. 旧版 `disable=true` → 仍能被识别为未启用（或自动转为 `enabled=false`），并记录迁移提示。  
- **RBAC 检查**：确认默认未创建 DGDSA 时，相关的 `Role/ClusterRole`（对 `scale` 子资源的权限）不会被意外授予，避免不必要的权限泄露。  

---  

> **结论**：此次改动通过把 Scaling Adapter 的默认状态设为关闭，能够降低资源开销并提升安全性，但同时引入了不兼容的默认行为变化。建议在发布时提供明确的迁移文档、兼容转换逻辑以及充分的监控/告警，以确保现有用户的平滑过渡。

---

#### 🟡 中重要度变更 (5)

### fix:-add-sweep-range-for-moe-dgdr-example-5225
**SHA**: `a821378` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/a82137877c0903ccde01bd7375eb9fb8fba0629a)

**🎯 变更类型**：Bug 修复 / 功能增强  
**⚡ 重要程度**：🟡 中  

**📋 变更摘要**  
在 `benchmarks/profiler/deploy/profile_sla_moe_dgdr.yaml` 中为硬件配置新增了三个字段：`min_num_gpus_per_engine`, `max_num_gpus_per_engine` 与 `num_gpus_per_node`。目的是在 H200 环境下对 MOE‑DGDR 示例进行 GPU 数量的 sweep（8‑16 GPU/engine），提供更灵活的资源调度和性能探索。

**🎯 影响范围**  
- **benchmarks/profiler**：该 YAML 为自动化 Profiling 作业的输入，新增字段会被 `profiler` 解析器读取。  
- **部署脚本 / AI Configurator**：若有代码读取 `hardware` 节点并依据 GPU 数量生成作业矩阵，需要确保兼容新的键。  
- **测试 / CI**：任何依赖该配置进行端到端跑分的 CI 流程需确认默认值或填充逻辑不会因缺失这些字段导致异常。

**💡 关注建议**  
1. **代码审查**：检查 `benchmarks/profiler` 相关的 Rust 结构体（如 `HardwareSpec`）是否已加入对应字段并实现 `Deserialize`。若未更新，运行时会报 “missing field” 错误。  
2. **向后兼容**：对老版本 YAML（未包含这些字段）保持容错，可在结构体上使用 `#[serde(default)]` 或提供默认值（如 `min=1, max=1, per_node=1`）。  
3. **文档同步**：更新 README 或配置说明，解释这三个参数的含义及推荐取值，防止用户误配。  
4. **CI 扩展**：在现有的 profiling CI 中加入一次 sweep 试运行，验证 `min/max` 参数在不同 GPU 数量下的调度逻辑是否正常。  
5. **性能监控**：由于 sweep 会生成更多作业，确保资源配额（如集群 GPU 配置）足够，否则可能导致作业排队或失败。  

整体而言，此改动提升了 MOE‑DGDR 示例的可调度性，但需要在解析层和 CI 中加入相应的兼容与验证逻辑，以避免因缺失字段导致的运行时错误。

---

### refactor:-extract-changed-files-logic-into-reusable-composite-action-5216
**SHA**: `17528f8` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/17528f8149635918714d7f7d0b68962ac0df6cd6)

**🎯 变更类型**：重构  
**⚡ 重要程度**：🟡 中  

**📋 变更摘要**  
- 新增 `.github/actions/changed-files` 复合 Action，封装了获取 merge‑base、调用 `tj-actions/changed-files`、调试输 出以及未覆盖文件检查的完整流程。  
- 所有 CI 工作流（`container-validation-backends.yml`、`container-validation-dynamo.yml` 等）改为直接使用该复合 Action，输出统一为 `core/operator/deploy/vllm/sglang/trtllm` 等布尔值。  
- 删除了工作流中重复的 “获取 merge base → 调用 changed‑files → debug → uncovered‑files 检查” 步骤，代码行数大幅减少。

**🎯 影响范围**  
- GitHub Actions 配置（`.github/workflows/*`）  
- 新增的复合 Action（`.github/actions/changed-files/*`）  
- 与 CI 过滤相关的文档（`.github/filters.yaml`、`.github/FILTERS.md`）  

**💡 关注建议**  
1. **兼容性检查**：复合 Action 依赖 `gh` CLI 与 `git`；确保所有 runner 镜像已预装 `gh`（v2.x）且有 `GITHUB_TOKEN` 权限。  
2. **输出一致性**：工作流仍引用旧的 `filter.outputs.*` 名称，已统一为 `changes.outputs.*`，请在所有 downstream jobs 中同步更新引用，防止隐藏的破坏。  
3. **错误信息**：未覆盖文件检查仍在 Action 内完成，若未来需要自定义行为，考虑将其拆分为单独步骤并通过 `continue-on-error` 控制。  
4. **缓存/性能**：复合 Action 每次都会执行 `git merge-base`，对大量 PR 可能略慢。可在后续通过 `actions/cache` 缓存 `git fetch` 的结果或在 `base_sha` 为空时直接使用 `github.event.before`。  
5. **版本锁定**：`tj-actions/changed-files` 仍使用固定 SHA（v42.1.0），建议在 `action.yml` 中注明该依赖的安全审计周期，以免未来出现安全或兼容性问题。  

总体而言，此次重构显著提升了 CI 配置的可维护性和可读性，只需关注 runner 环境和输出名称的统一即可安全上线。

---

### fix:-assign-unique-ports-per-vLLM-worker-to-avoid-ZMQ-bind-conflicts-5224
**SHA**: `19b5917` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/19b5917c2b88ea6a7c4c20cd4669974a642111a8)

**🎯 变更类型**：Bug 修复  
**⚡ 重要程度**：🟡 中  
**📋 变更摘要**：在 `benchmarks/router/run_engines.sh` 中为每个 vLLM worker 动态分配唯一的 ZMQ 端口（`DYN_VLLM_KV_EVENT_PORT`、`VLLM_NIXL_SIDE_CHANNEL_PORT`），并将 `--request-plane nats` 参数加入启动参数，以避免多实例因端口冲突导致的 bind 错误。  
**🎯 影响范围**：`benchmarks/router` 及所有依赖 vLLM worker 的路由/调度模块；间接影响到 `dynamo.vllm` 启动时读取的环境变量。  

**💡 关注建议**  
1. **端口冲突防护**：确认端口基准（20080、20096）在不同机器或 CI 环境中未被占用，必要时抽象为可配置常量。  
2. **环境变量传播**：`dynamo.vllm` 代码需确保读取 `DYN_VLLM_KV_EVENT_PORT`、`VLLM_NIXL_SIDE_CHANNEL_PORT`，并在 ZMQ 初始化时使用这些值，否则仍会使用默认端口导致冲突。建议在代码中加入断言或日志，提示端口来源。  
3. **脚本可维护性**：将端口计算逻辑封装为函数或变量 (`BASE_KV_PORT=20080`、`BASE_SIDE_PORT=20096`) ，避免硬编码分散在多处，便于后期调优。  
4. **回归测试**：新增或扩展 benchmark 启动的集成测试，验证在多 worker（>1）情况下不会出现 “Address already in use” 错误，并确认 `--request-plane nats` 参数能够被 vLLM 正确解析。  
5. **文档更新**：在 README/benchmark 文档中说明新增的环境变量含义及默认端口范围，帮助用户在自定义部署时避免冲突。  

总体而言，此次修改对功能恢复至关重要，但需确保端口配置在代码侧完整闭环，并加入相应的测试与文档以防止后续回归。

---

### ci:-add-uncovered-files-check-and-improve-filter-coverage-5214
**SHA**: `15a2e8d` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/15a2e8dec2d4fd86ca898ddcf56da8a9536cb658)

**🎯 变更类型**：CI/功能增强  
**⚡ 重要程度**：🟡 中（对日常开发影响有限，但对 CI 稳定性和可维护性提升明显）  

**📋 变更摘要**  
1. 新增 `FILTERS.md`，完整说明 CI 过滤机制及 “未覆盖文件”错误的处理方式。  
2. 扩充 `.github/filters.yaml`，为 `docs、examples、ignore、planner` 等分类补全匹配模式，并改进 `core`、`operator`、`deploy` 等过滤规则。  
3. 在 `.github/scripts` 中加入 `coverage` 脚本，利用 `git ls‑files` 检查仓库中每个文件是否被至少一个过滤器覆盖；提供本地运行方式。  
4. 工作流 `container-validation-*.yml` 从 `*_any_changed` 切换为 `*_any_modified`，并在关键步骤加入 “未覆盖文件” 检查，确保 PR 中的任何改动都有对应的 CI 触发器。  
5. `.gitignore` 新增对 `.cursor`、`.claude` 目录的忽略。

**🎯 影响范围**  
- CI 过滤与调度：`.github/filters.yaml`、`FILTERS.md`、`test-filters.js`、工作流文件。  
- 本地开发调试：`npm run coverage`。  
- 项目根目录的忽略规则：`.gitignore`。

**💡 关注建议**  
1. **同步文档**：确保 `FILTERS.md` 与 `filters.yaml` 保持一致；新增分类后及时更新说明。  
2. **CI 兼容性**：`*_any_modified` 是 tj‑actions/changed-files 的新输出，确认所有使用该 Action 的工作流均已升级，否则旧工作流仍会读取 `*_any_changed` 导致误报。  
3. **过滤器完整性**：定期在 CI 中运行 `npm run coverage`，防止新文件被遗漏；若出现 “uncovered files” 错误，首先检查是否应归入 `ignore`、`examples` 或相应后端过滤器。  
4. **性能考量**：`git ls-files` 与逐文件匹配在大仓库上仍在几秒内完成，影响可接受；若仓库显著增长，考虑增量缓存或仅在 PR 阶段运行。  
5. **审计 .gitignore**：新增的 `.cursor`、`.claude` 目录若在未来产生实际代码，记得同步到过滤器或移除忽略。  

总体而言，此次改动显著提升了 CI 过滤的可见性和错误提示，有助于防止因文件未匹配而导致的 CI 失效，建议在合并前在一个实际的 PR 中跑通全部检查，确认所有步骤均能通过。

---

### fix:-add-endpointslices-RBAC-permission-for-Planner-service-account-5195
**SHA**: `c90b87e` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/c90b87e244f46d76689b7a7081d98adf6e56b389)

**🎯 变更类型**：Bug 修复（补全 RBAC 权限）  
**⚡ 重要程度**：🟡 中  

**📋 变更摘要**  
为 Planner 服务账号新增两类 RBAC 权限：  
1. `discovery.k8s.io/endpointslices`（`get/list/watch`），以便 Planner 能够读取集群的 EndpointSlice 信息。  
2. `nvidia.com/dynamoworkermetadatas`（全部 CRUD 权限），以支持对工作节点元数据的管理。  

**🎯 影响范围**  
- Helm chart `platform/components/operator/templates/planner.yaml` 中的 Role 与 RoleBinding。  
- 依赖 Planner 的所有部署（例如 DynamoGraph、Scaler 等），因为它们会在运行时访问 EndpointSlice 与 DynamoworkerMetadata。  

**💡 关注建议**  
- **安全性**：虽然新增的权限对功能必要，但仍应遵循最小权限原则，确认 Planner 真正需要全部 CRUD 权限后再放行。可考虑将 `endpointslices` 权限限定在特定命名空间。  
- **兼容性**：仅在使用 Helm 部署的集群会自动获权，手动创建 RBAC 的用户需同步更新。建议在升级文档中加入 “Planner 需要 `endpointslices` 与 `dynamoworkermetadatas` 权限” 的说明。  
- **验证**：部署后使用 `kubectl auth can-i` 检查 Planner ServiceAccount 是否拥有新权限；运行功能性测试，确保 Planner 能成功发现服务（EndpointSlice）并操作 DynamoworkerMetadata。  
- **回滚**：若出现权限泄露或功能异常，可通过删除或回滚对应 Role/RoleBinding，或在 `values.yaml` 中提供开关来控制该块的渲染。  

总体而言，此次补丁确保 Planner 在新版 Kubernetes（EndpointSlice 为标准 ServiceDiscovery）下正常工作，影响范围局限于 RBAC 配置，风险可通过上述检查措施有效控制。

---

#### 🟢 低重要度变更 (7)

### ci:-Run-the-same-tests-across-Github-and-Gitlab-CI-for-premerge-5082
**SHA**: `996077f` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/996077f49aaac2df6a4e183e41006b768ceeacf6)

**🎯 变更类型**：CI 配置调整  
**⚡ 重要程度**：🟢低  
**📋 摘要**：为 GitHub Action 添加 `enable_mypy` 参数并在测试命令中加入 `--mypy`，使预合并 CI 同时执行 mypy 类型检查，相关工作流均已启用该选项。

---

### docs:-update-LoRA-model-name-in-docs-5210
**SHA**: `975870d` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/975870d552f75b024cb58d5aac9d9939d8e782bf)

**🎯 变更类型**：文档更新  
**⚡ 重要程度**：🟢低  
**📋 摘要**：将示例脚本及说明中的 LoRA 模型名称从 `Neural-Hacker/Qwen3-Math-Reasoning-LoRA` 更新为 `codelion/Qwen3-0.6B-accuracy-recovery-lora`，包括下载、上传、加载、卸载等路径和示例请求。

---

### docs:-kube-based-service-discovery-5211
**SHA**: `c92a422` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/c92a422b6275673ceda7556c5585293050e6ef68)

**🎯 变更类型**：文档更新  
**⚡ 重要程度**：🟢 低  
**📋 摘要**：新增 `service_discovery.md` 文档并在部署指南及 README 中加入对应链接，统一说明 Kubernetes 原生服务发现及其配置方式，替换旧的 etcd‑centric说明。

---

### docs:-fix-tracing-doc-ZMQ-port-conflict-5200
**SHA**: `194128e` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/194128ec893d052dbe1ce59dbc96362d5f33c6ac)

**🎯 变更类型**：文档更新  
**⚡ 重要程度**：🟢低  
**📋 摘要**：修正 tracing 文档，说明在多 worker 场景下通过 `DYN_SYSTEM_PORT`、`DYN_VLLM_KV_EVENT_PORT`、`VLLM_NIXL_SIDE_CHANNEL_PORT` 等环境变量避免 ZMQ 端口冲突，并更新相应示例脚本。

---

### docs:-Update-TensorRT-LLM-install-prerequisites-for-1.2.0rc5-5194
**SHA**: `e8c87f1` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/e8c87f175f68c75000b462c04b9a260f10902626)

**🎯 变更类型**：文档更新  
**⚡ 重要程度**：🟢低  
**📋 摘要**：在 README 中更新 TensorRT‑LLM 1.2.0rc5 的安装前置条件，改为使用 PyTorch 25.10 容器（torch 2.9.0），并新增 libzmq3‑dev 的可选安装说明。

---

### chore:-Remove-deprecated-Earthfile-5206
**SHA**: `11d7d3f` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/11d7d3f59e15bc5eabe42ce056260dbd26550f3c)

**🎯 变更类型**：代码重构  
**⚡ 重要程度**：🟢低  
**📋 摘要**：删除了已废弃的 Earthfile（根目录及 operator 子目录），完整转向 Docker 构建；相应更新文档示例，将 `earthly` 构建命令改为标准 `docker build && docker push`。此举简化构建体系，消除冗余配置。

---

### build:-build.sh-enhancement-5053
**SHA**: `96e42f7` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/96e42f72cf69c903396864f15ea41ddaeaf6827c)

**🎯 变更类型**：配置调整  
**⚡ 重要程度**：🟢低  
**📋 摘要**：为 `container/build.sh` 新增 `--no-load` 与 `--push` 选项，默认启用 `--load`，并在指定 `--no-load` 或 `--push` 时相应调整构建行为。

---

