# 每日更新报告（2026-02-08）

## ai-dynamo/dynamo

| 提交时间 | 作者 | 提交信息 |
|----------|------|----------|
| 2026-02-08 06:36:25 | Neal Vaidya | fix: read block size from vllm at runtime (#5713) |

### 📊 统计摘要
> 本日共 1 个提交 | 🔴高 0 | 🟡中 1 | 🟢低 0
## 📋 目录

- [ai-dynamo/dynamo](#ai-dynamo-dynamo)
  - [📊 统计摘要](#-统计摘要)
  - [🟡 中重要度变更 (1)](#-🟡-中重要度变更-1)
    - [fix: read block size from vllm at runtime (#5713)](#3d7182b)
#### 🟡 中重要度变更 (1)

### fix: read block size from vllm at runtime (#5713)
**SHA**: `3d7182b` | 🔗 [查看提交](https://github.com/ai-dynamo/dynamo/commit/3d7182b80ef11562c5882137287c1f0f268b56a4)

**🎯 变更类型**：Bug 修复  
**⚡ 重要程度**：🟡 中  

**📋 变更摘要**  
- 在 `register_vllm_model` 中不再使用 `engine_args.block_size`，改为从运行时返回的 `runtime_values["block_size"]` 动态读取 KV‑cache block 大小。  
- `get_engine_cache_info` 现在把 `block_size` 也加入返回的字典，让上层能够获取完整的缓存配置。

**🎯 影响范围**  
- **components/src/dynamo/vllm/main.py**：模型注册逻辑、缓存信息查询。  
- 任何依赖 `register_vllm_model` 或 `get_engine_cache_info` 的上层服务（如模型调度、监控面板）会看到新增的 `block_size` 字段。  

**💡 关注建议**  
1. **确认 `runtime_values` 中一定包含 `block_size`**，否则会触发 `KeyError`。如果有旧的启动脚本未注入该键，需要在 `AsyncLLM` 初始化时补齐。  
2. **向后兼容**：对外返回的字典新增键不会破坏已有字段，但如果调用方对返回结构做了严格校验，需要同步更新。  
3. **文档与监控**：在 Dynamo 文档中说明 `block_size` 已从 vLLM 动态获取，并在监控/日志（如 `engine_cache_info`）中加入该维度，方便排查 KV‑cache 相关的性能问题。  
4. **测试**：新增单元/集成测试，覆盖（a）正常启动时 `block_size` 正确传递，（b）缺失 `block_size` 时的容错路径。  
5. **回滚方案**：如果出现不兼容行为，可临时恢复 `kv_cache_block_size=config.engine_args.block_size` 并在下一个发布中同步两侧字段。

总体而言，此修改使 Dynamo 能够随 vLLM 实际配置自动适配 KV‑cache 大小，提升了部署灵活性，但需要确保运行时上下文完整并更新相应的调用方代码与文档。

---

