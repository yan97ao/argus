# æ¯æ—¥æ›´æ–°æŠ¥å‘Šï¼ˆ2026-01-07ï¼‰

## sgl-project/sglang

| æäº¤æ—¶é—´ | ä½œè€… | æäº¤ä¿¡æ¯ |
|----------|------|----------|
| 2026-01-07 23:50:28 | Simo Lin | refactor(e2e): unify RouterInstance into Gateway class, split conftest.py into modular fixtures (#16671) |
| 2026-01-07 23:45:35 | Insideyyy | Add SwapAB Optimization for triton fused_moe_kernel on SM90. (#15712) |
| 2026-01-07 23:21:19 | Baizhou Zhang | [CI] Enable dpsk v31 test on nightly H200 (#16660) |
| 2026-01-07 22:59:49 | Simo Lin | refactor(e2e_test): fix smg ci e2e test code quality (#16664) |
| 2026-01-07 22:52:24 | Yi Zhang | support page size large than 64 for mamba radix cache (#16657) |
| 2026-01-07 22:35:15 | Simo Lin | fix(e2e_test): remove dead code and fix type annotations (#16661) |
| 2026-01-07 22:16:59 | Simo Lin | [smg][ci] preserve model launch order with test collected (#16618) |
| 2026-01-07 22:10:23 | Li Jinliang | [diffusion] bench: upgrade multimodal benchmarks for diverse applications and create a prettier, more intuitive logger. (#16179) |
| 2026-01-07 21:51:30 | Douglas Yang | ci: adding llama4 placeholder test to nightly (#16599) |
| 2026-01-07 21:11:24 | JiLi | Handle Marlin weight restoration and shape recording (QAT INT4 Rollout Part1) (#15238) |
| 2026-01-07 20:52:36 | Xiaoyu Zhang | [Diffusion] Fix Ulysses/Ring process group construction under TP to enable correct Wan2.2 tensor parallelism (#16532) |
| 2026-01-07 20:41:07 | Xiaoyu Zhang | Tiny fix readme (#16654) |
| 2026-01-07 20:20:01 | Even Zhou | [NPU] update docs (#16651) |
| 2026-01-07 18:05:17 | Hudson Xing | Re-enable temp_prefill_info assertion after pairing fix (#16203) |
| 2026-01-07 17:43:11 | Hubert Lu | [AMD] Add 8-GPU MX35X test running DSR1-MXFP4 model for AMD CI (#13602) |
| 2026-01-07 17:37:40 | YC Tseng | [AMD] suppress warning for amd (#16620) |
| 2026-01-07 15:52:46 | YC Tseng | [AMD] CI - add 2 pp test cases to performance-test-2-gpu-amd (#16514) |
| 2026-01-07 15:42:18 | Alison Shao | fix: update AMD CI estimated time for test_torch_compile (#16631) |
| 2026-01-07 14:52:42 | Shangming Cai | [Doc] Optimize pipeline parallelism doc (#16630) |
| 2026-01-07 14:20:42 | Thomas Wang | Upgrade aiter version (#16619) |
| 2026-01-07 14:17:04 | Minglei Zhu | Only allocate encoder metadata for encoder-decoder models (#16527) |
| 2026-01-07 14:00:16 | Baizhou Zhang | Clean Some Environment Variables for DeepSeek V32 (#15938) |
| 2026-01-07 13:38:31 | Douglas Yang | fix: remove performance testing from nightly dpsk v32 cp single node  (#16582) |
| 2026-01-07 13:24:04 | Chi McIsaac | [diffusion] fix: fix ZImage SP sharding for 5D latents and unpad frames (#16418) |
| 2026-01-07 13:04:48 | Alison Shao | Migrate profiling tests to test/registered/profiling/ (#16459) |
| 2026-01-07 12:50:54 | Alison Shao | Migrate attention unit tests to test/registered/attention/ (#16465) |
| 2026-01-07 12:31:52 | Alison Shao | Migrate backends tests to CI registration system (#16468) |
| 2026-01-07 12:18:44 | fzyzcjy | [model-gateway] extract header extraction in policy and add (#16566) |
| 2026-01-07 12:18:10 | Alison Shao | ci: adjust partition counts for stage-b and unit tests (#16617) |
| 2026-01-07 12:15:20 | Simo Lin | [smg][ci]: migrate benchmarks to e2e_test/benchmarks/, use parent conftest (#16597) |
| 2026-01-07 12:00:09 | Yingchun Lai | fix: fill a meaningful tool_index (#16504) |
| 2026-01-07 11:41:05 | Douglas Yang | fix: adjusting vlm accuracy thresholds (#16593) |
| 2026-01-07 11:30:35 | Yuan Luo | [VLM] Fix CUDA IPC OOM (#16118) |
| 2026-01-07 11:03:57 | MOHENOO | [HiCacheStorage & PD] fix prefill bootstrap request host memory leaks (#15439) |
| 2026-01-07 10:57:15 | Yuwei An | PCG Unit Test Adjustment (#16609) |
| 2026-01-07 10:27:43 | Alison Shao | Migrate FP8/TorchAO tests to test/registered/quant/ (#16453) |
| 2026-01-07 10:22:08 | Mick | [diffusion] chore: automatically enable dit_layerwise_offload for Wan (#16499) |
| 2026-01-07 10:15:17 | fzyzcjy | Tiny support http headers in bench serving (#16606) |
| 2026-01-07 09:53:52 | fzyzcjy | Tiny add metrics for prefill delayer (#16603) |
| 2026-01-07 09:37:27 | Hexq0210 | [NPU] fix command in npu best practice (#16576) |
| 2026-01-07 08:33:29 | Chang Su | [router][openai] Rename `prepare_mcp_payload_for_streaming` and `patch_streaming_response_json` (#16596) |
| 2026-01-07 08:32:59 | Chang Su | [router][grpc] Replace `Vec<(String, String, String)>` with `ExtractedToolCall` (#16598) |
| 2026-01-07 08:32:37 | Chang Su | [model-gateway][cleanup] Fix wrong comment in manager.rs (#16601) |
| 2026-01-07 07:05:08 | Simo Lin | refactor(e2e): keep only benchmark tests in e2e_http, remove redundant tests (#16594) |
| 2026-01-07 06:55:52 | Alison Shao | ci: migrate scheduler tests to test/registered/scheduler/ (#16442) |
| 2026-01-07 06:35:57 | Alison Shao | ci: migrate Debug Utils, Ops, and Rotary Embedding tests to test/registered/ (#16422) |
| 2026-01-07 06:34:16 | Yingchun Lai | feat: add .dockerignore to ignore files when build images (#16223) |
| 2026-01-07 06:28:24 | Kangyan-Zhou | Add v1/models endpoint to diffusion model APIs so that they can be discovered by model gateway (#16425) |
| 2026-01-07 06:27:37 | Alison Shao | Remove dllm-test-1-gpu-amd job (followup to DLLM migration) (#16589) |
| 2026-01-07 06:07:45 | Simo Lin | refactor(e2e): remove old embedding tests migrated to e2e_test/embeddings (#16592) |
| 2026-01-07 05:24:37 | Simo Lin | [model-gateway] add embedding tests (#16583) |
| 2026-01-07 05:18:43 | Douglas Yang | fix: kimi k2 thinking accuracy threshold change (#16585) |
| 2026-01-07 04:44:32 | Simo Lin | [smg] clean up logs in mcp (should be info instead warn) (#16591) |
| 2026-01-07 03:09:37 | Alison Shao | ci(test): migrate OpenAI server tests to registered CI system (#16326) |
| 2026-01-07 01:53:12 | Douglas Yang | fix: adding retries for server start and increasing hf read timeout (#16523) |
| 2026-01-07 01:44:26 | Alison Shao | ci: migrate DLLM tests to test/registered/dllm/ (#16420) |
| 2026-01-07 01:23:58 | Simo Lin | [ci] fix url strips in smg ci (#16548) |

### ğŸ“Š ç»Ÿè®¡æ‘˜è¦
> æœ¬æ—¥å…± 57 ä¸ªæäº¤ | ğŸ”´é«˜ 9 | ğŸŸ¡ä¸­ 26 | ğŸŸ¢ä½ 22
## ğŸ“‹ ç›®å½•

- [sgl-project/sglang](#sgl-project-sglang)
  - [ğŸ“Š ç»Ÿè®¡æ‘˜è¦](#-ç»Ÿè®¡æ‘˜è¦)
  - [ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (9)](#-ğŸ”´-é«˜é‡è¦åº¦å˜æ›´-9)
    - [refactor(e2e): unify RouterInstance into Gatewa...](#refactore2e-unify-routerinstance-into-gateway-class-split-conftest-py-int)
    - [refactor(e2e_test): fix smg ci e2e test code qu...](#refactore2e_test-fix-smg-ci-e2e-test-code-quality-16664)
    - [fix(e2e_test): remove dead code and fix type an...](#fixe2e_test-remove-dead-code-and-fix-type-annotations-16661)
    - [[smg][ci] preserve model launch order with test...](#smgci-preserve-model-launch-order-with-test-collected-16618)
    - [[smg][ci]: migrate benchmarks to e2e_test/bench...](#smgci-migrate-benchmarks-to-e2e_test-benchmarks-use-parent-conftest)
    - [refactor(e2e): keep only benchmark tests in e2e...](#refactore2e-keep-only-benchmark-tests-in-e2e_http-remove-redundant-tests)
    - [feat: add .dockerignore to ignore files when bu...](#feat-add-dockerignore-to-ignore-files-when-build-images-16223)
    - [refactor(e2e): remove old embedding tests migra...](#refactore2e-remove-old-embedding-tests-migrated-to-e2e_test-embeddings-1)
    - [[model-gateway] add embedding tests (#16583)](#model-gateway-add-embedding-tests-16583)
  - [ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (26)](#-ğŸŸ¡-ä¸­é‡è¦åº¦å˜æ›´-26)
    - [support page size large than 64 for mamba radix...](#support-page-size-large-than-64-for-mamba-radix-cache-16657)
    - [[diffusion] bench: upgrade multimodal benchmark...](#diffusion-bench-upgrade-multimodal-benchmarks-for-diverse-applications-and)
    - [Handle Marlin weight restoration and shape reco...](#handle-marlin-weight-restoration-and-shape-recording-qat-int4-rollout-part1)
    - [[Diffusion] Fix Ulysses/Ring process group cons...](#diffusion-fix-ulysses-ring-process-group-construction-under-tp-to-enable-co)
    - [[NPU] update docs (#16651)](#npu-update-docs-16651)
    - [[AMD] Add 8-GPU MX35X test running DSR1-MXFP4 m...](#amd-add-8-gpu-mx35x-test-running-dsr1-mxfp4-model-for-amd-ci-13602)
    - [fix: update AMD CI estimated time for test_torc...](#fix-update-amd-ci-estimated-time-for-test_torch_compile-16631)
    - [Clean Some Environment Variables for DeepSeek V...](#clean-some-environment-variables-for-deepseek-v32-15938)
    - [fix: remove performance testing from nightly dp...](#fix-remove-performance-testing-from-nightly-dpsk-v32-cp-single-node-16582)
    - [[diffusion] fix: fix ZImage SP sharding for 5D ...](#diffusion-fix-fix-zimage-sp-sharding-for-5d-latents-and-unpad-frames-16418)
    - [Migrate profiling tests to test/registered/prof...](#migrate-profiling-tests-to-test-registered-profiling-16459)
    - [Migrate attention unit tests to test/registered...](#migrate-attention-unit-tests-to-test-registered-attention-16465)
    - [[model-gateway] extract header extraction in po...](#model-gateway-extract-header-extraction-in-policy-and-add-16566)
    - [fix: fill a meaningful tool_index (#16504)](#fix-fill-a-meaningful-tool_index-16504)
    - [fix: adjusting vlm accuracy thresholds (#16593)](#fix-adjusting-vlm-accuracy-thresholds-16593)
    - [Migrate FP8/TorchAO tests to test/registered/qu...](#migrate-fp8-torchao-tests-to-test-registered-quant-16453)
    - [Tiny support http headers in bench serving (#16...](#tiny-support-http-headers-in-bench-serving-16606)
    - [Tiny add metrics for prefill delayer (#16603)](#tiny-add-metrics-for-prefill-delayer-16603)
    - [[router][openai] Rename `prepare_mcp_payload_fo...](#routeropenai-rename-prepare_mcp_payload_for_streaming-and-patch_stream)
    - [[router][grpc] Replace `Vec<(String, String, St...](#routergrpc-replace-vec-string-string-string-with-extractedtoolcal)
    - [ci: migrate scheduler tests to test/registered/...](#ci-migrate-scheduler-tests-to-test-registered-scheduler-16442)
    - [Add v1/models endpoint to diffusion model APIs ...](#add-v1-models-endpoint-to-diffusion-model-apis-so-that-they-can-be-discovered)
    - [fix: kimi k2 thinking accuracy threshold change...](#fix-kimi-k2-thinking-accuracy-threshold-change-16585)
    - [ci(test): migrate OpenAI server tests to regist...](#citest-migrate-openai-server-tests-to-registered-ci-system-16326)
    - [fix: adding retries for server start and increa...](#fix-adding-retries-for-server-start-and-increasing-hf-read-timeout-16523)
    - [[ci] fix url strips in smg ci (#16548)](#ci-fix-url-strips-in-smg-ci-16548)
  - [ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (22)](#-ğŸŸ¢-ä½é‡è¦åº¦å˜æ›´-22)
    - [Add SwapAB Optimization for triton fused_moe_ke...](#add-swapab-optimization-for-triton-fused_moe_kernel-on-sm90-15712)
    - [[CI] Enable dpsk v31 test on nightly H200 (#16660)](#ci-enable-dpsk-v31-test-on-nightly-h200-16660)
    - [ci: adding llama4 placeholder test to nightly (...](#ci-adding-llama4-placeholder-test-to-nightly-16599)
    - [Tiny fix readme (#16654)](#tiny-fix-readme-16654)
    - [Re-enable temp_prefill_info assertion after pai...](#re-enable-temp_prefill_info-assertion-after-pairing-fix-16203)
    - [[AMD] suppress warning for amd (#16620)](#amd-suppress-warning-for-amd-16620)
    - [[AMD] CI - add 2 pp test cases to performance-t...](#amd-ci-add-2-pp-test-cases-to-performance-test-2-gpu-amd-16514)
    - [[Doc] Optimize pipeline parallelism doc (#16630)](#doc-optimize-pipeline-parallelism-doc-16630)
    - [Upgrade aiter version (#16619)](#upgrade-aiter-version-16619)
    - [Only allocate encoder metadata for encoder-deco...](#only-allocate-encoder-metadata-for-encoder-decoder-models-16527)
    - [Migrate backends tests to CI registration syste...](#migrate-backends-tests-to-ci-registration-system-16468)
    - [ci: adjust partition counts for stage-b and uni...](#ci-adjust-partition-counts-for-stage-b-and-unit-tests-16617)
    - [[VLM] Fix CUDA IPC OOM (#16118)](#vlm-fix-cuda-ipc-oom-16118)
    - [[HiCacheStorage & PD] fix prefill bootstrap req...](#hicachestorage-pd-fix-prefill-bootstrap-request-host-memory-leaks-15439)
    - [PCG Unit Test Adjustment (#16609)](#pcg-unit-test-adjustment-16609)
    - [[diffusion] chore: automatically enable dit_lay...](#diffusion-chore-automatically-enable-dit_layerwise_offload-for-wan-16499)
    - [[NPU] fix command in npu best practice (#16576)](#npu-fix-command-in-npu-best-practice-16576)
    - [[model-gateway][cleanup] Fix wrong comment in m...](#model-gatewaycleanup-fix-wrong-comment-in-manager-rs-16601)
    - [ci: migrate Debug Utils, Ops, and Rotary Embedd...](#ci-migrate-debug-utils-ops-and-rotary-embedding-tests-to-test-registered)
    - [Remove dllm-test-1-gpu-amd job (followup to DLL...](#remove-dllm-test-1-gpu-amd-job-followup-to-dllm-migration-16589)
    - [[smg] clean up logs in mcp (should be info inst...](#smg-clean-up-logs-in-mcp-should-be-info-instead-warn-16591)
    - [ci: migrate DLLM tests to test/registered/dllm/...](#ci-migrate-dllm-tests-to-test-registered-dllm-16420)
#### ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (9)

### refactore2e:-unify-RouterInstance-into-Gateway-class,-split-conftest.py-int...
**SHA**: `c356ed0` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/c356ed03dd8f2c6ac8e4246eebacbf35a8ad7622)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / æ¶æ„å˜æ›´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´ é«˜  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
1. å°†åŸæœ‰çš„ `RouterInstance`ï¼ˆä¸“ç”¨äºäº‘åç«¯ï¼‰æŠ½è±¡å¹¶åˆå¹¶è¿›ç»Ÿä¸€çš„ `Gateway` ç±»ï¼Œæ–°å¢ **cloud mode**ï¼ˆOpenAIã€xAIï¼‰æ”¯æŒï¼Œä½¿è·¯ç”±/ç½‘å…³çš„å¯åŠ¨é€»è¾‘é›†ä¸­åœ¨å•ä¸€å®ç°ã€‚  
2. å°†åŸæœ¬åºå¤§çš„ `conftest.py` æ‹†åˆ†ä¸º **æ¨¡å—åŒ– fixtures**ï¼ˆhooksã€markersã€poolã€setup_backend ç­‰ï¼‰ï¼Œå¹¶åœ¨ `fixtures/__init__.py` ä¸­ç»Ÿä¸€å¯¼å‡ºï¼Œæå‡å¯ç»´æŠ¤æ€§ä¸å¯è¯»æ€§ã€‚  
3. å¼•å…¥ **åå‘å…¼å®¹åˆ«å**ï¼ˆ`CLOUD_BACKENDS`ã€`launch_cloud_router`ï¼‰ï¼Œå¹¶ä¸ºåºŸå¼ƒçš„æ¨¡å—ï¼ˆportsã€router_managerï¼‰æ·»åŠ æ–‡æ¡£æç¤ºã€‚  

---

## ğŸ” æŠ€æœ¯æ´å¯Ÿ

| ç»´åº¦ | å½±å“è¯´æ˜ |
|------|----------|
| **æ¶æ„å½±å“** | â€¢ `Gateway` æˆä¸ºå”¯ä¸€å…¥å£ï¼Œå°è£…å››ç§å¯åŠ¨æ¨¡å¼ï¼ˆregularã€PDã€IGWã€cloudï¼‰ï¼Œç»Ÿä¸€äº†å­è¿›ç¨‹ç®¡ç†ã€ç¯å¢ƒå˜é‡æ³¨å…¥ã€æ—¥å¿—ç»Ÿä¸€ã€‚<br>â€¢ ä¸šåŠ¡å±‚ï¼ˆe2e æµ‹è¯•ï¼‰ä» `RouterInstance` è¿ç§»åˆ° `Gateway`ï¼Œå¤–éƒ¨è°ƒç”¨ `gateway.base_url`ã€`gateway.shutdown()` ä»ä¿æŒå…¼å®¹ã€‚<br>â€¢ `conftest` è¢«æ‹†è§£ä¸ºç‹¬ç«‹ **fixture åŒ…**ï¼Œæµ‹è¯•é›†åˆã€GPU éœ€æ±‚ã€æ ‡è®°æ³¨å†Œé€»è¾‘ä»ä¸»é…ç½®æ–‡ä»¶ä¸­æŠ½ç¦»ï¼Œé™ä½å•æ–‡ä»¶è¡Œæ•°ï¼ˆä» 1200+ è¡Œé™è‡³ ~400 è¡Œï¼‰ï¼Œä¾¿äºç‹¬ç«‹å•å…ƒæµ‹è¯•ã€‚<br>â€¢ å¼•å…¥ `cloud_backend` å‚æ•°åï¼Œ`Gateway` ä¸å†éœ€è¦å¤–éƒ¨ `launch_cloud_backend` å†åŒ…è£…å­è¿›ç¨‹ï¼Œé™ä½äº†å±‚çº§è€¦åˆã€‚ |
| **æ€§èƒ½å½±å“** | â€¢ å¯åŠ¨è·¯å¾„ç•¥æœ‰å¢åŠ ï¼š`Gateway.start` ç°åœ¨ä¼šåˆ¤æ–­å››ç§æ¨¡å¼å¹¶å‡†å¤‡ç¯å¢ƒå˜é‡ï¼Œä½†è¿™ä»…åœ¨å­è¿›ç¨‹å¯åŠ¨å‰ä¸€æ¬¡æ€§æ‰§è¡Œï¼Œå½±å“å¯å¿½ç•¥ã€‚<br>â€¢ é€šè¿‡ç»Ÿä¸€ `Gateway`ï¼Œé¿å…äº†åœ¨ e2e æµ‹è¯•ä¸­â€œrouter â†’ gatewayâ€ä¸¤å±‚å­è¿›ç¨‹çš„å†—ä½™å¯åŠ¨ï¼Œå®é™… **å¯åŠ¨æ—¶é—´å¯èƒ½ç•¥æœ‰ä¸‹é™**ï¼ˆå°¤å…¶åœ¨äº‘æ¨¡å¼ï¼ŒåŸæœ¬é€šè¿‡ `RouterInstance` å†åˆ›å»º `Gateway` çš„æƒ…å†µå·²è¢«å»é™¤ï¼‰ã€‚<br>â€¢ é€šè¿‡ `hooks.get_pool_requirements` ä»ç„¶åœ¨æ”¶é›†é˜¶æ®µä¸€æ¬¡æ€§è®¡ç®—å·¥ä½œçº¿ç¨‹éœ€æ±‚ï¼Œæœªæ”¹å˜ç°æœ‰çš„ **GPU é¢„åˆ†é…** é€»è¾‘ã€‚ |
| **å®‰å…¨è€ƒè™‘** | â€¢ äº‘æ¨¡å¼ä¸­å°† `OPENAI_API_KEY` / `XAI_API_KEY` æ³¨å…¥åˆ°å­è¿›ç¨‹çš„ **ç¯å¢ƒå˜é‡** (`self._env`) è€Œä¸æ˜¯ç›´æ¥ä¼ é€’ç»™å­è¿›ç¨‹çš„ `cmd`ï¼Œé˜²æ­¢é”®å€¼æ³„éœ²åˆ°çˆ¶è¿›ç¨‹çš„ `ps` è¾“å‡ºã€‚<br>â€¢ ä¸ºé˜²æ­¢è¯¯ç”¨ï¼Œ`Gateway.start` åœ¨ **cloud mode** å¿…é¡»æ˜¾å¼æä¾› `cloud_backend`ï¼Œå¦åˆ™æŠ›å‡º `ValueError`ï¼Œé¿å…è¯¯æŠŠæœ¬åœ°æ¨¡å¼å½“ä½œäº‘æ¨¡å¼å¯åŠ¨å¯¼è‡´æœªè®¾ç½® API Keyã€‚<br>â€¢ ä»ç„¶ä¾èµ–å¤–éƒ¨ `subprocess.Popen`ï¼Œè‹¥å­è¿›ç¨‹ä»£ç å‡ºç°å®‰å…¨æ¼æ´ï¼ˆå¦‚æœªæ­£ç¡®è¿‡æ»¤ API è¯·æ±‚ï¼‰ï¼Œå½±å“èŒƒå›´ä¸ä¹‹å‰ç›¸åŒï¼›æœ¬æ¬¡æ”¹åŠ¨æœªå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚ |
| **å¯ç»´æŠ¤æ€§** | â€¢ `conftest.py` æ‹†åˆ†åï¼Œæ¯ä¸ªæ–‡ä»¶èŒè´£å•ä¸€ï¼š<br>â€ƒ- `hooks.py` è´Ÿè´£æ”¶é›†æ ‡è®°ã€GPU éªŒè¯ã€marker æ³¨å†Œã€‚<br>â€ƒ- `markers.py` æŠ½è±¡è·å– marker å‚æ•°çš„é€šç”¨å·¥å…·ï¼Œç»Ÿä¸€é”™è¯¯å¤„ç†ã€‚<br>â€ƒ- `pool.py` åªå…³æ³¨ `ModelPool` ç”Ÿå‘½å‘¨æœŸã€‚<br>â€ƒ- `setup_backend.py` å®ç°å„åç«¯åˆ›å»ºé€»è¾‘ï¼Œå±‚æ¬¡æ¸…æ™°ã€‚<br>â€¢ é€šè¿‡ `__all__` æ˜ç¡®å…¬å¼€æ¥å£ï¼Œpytest è‡ªåŠ¨å‘ç°æ—¶æ›´æ˜“å®šä½ã€‚<br>â€¢ ä¸ºå‘åå…¼å®¹ä¿ç•™äº† `launch_cloud_router` åˆ«åï¼Œé™ä½è¿ç§»æœŸé—´çš„ç ´åã€‚ |
| **å…¼å®¹æ€§** | â€¢ è€ä»£ç ä»èƒ½ä½¿ç”¨ `launch_cloud_router`ï¼ˆå†…éƒ¨æ˜ å°„åˆ° `launch_cloud_gateway`ï¼‰ï¼Œä»¥åŠ `CLOUD_BACKENDS`ï¼ˆä¿ç•™åŸç»“æ„ï¼‰ï¼Œä¿è¯é¡¹ç›®åœ¨ `e2e_response_api` å®Œå…¨éƒ¨ç½²å‰ä¸å‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚<br>â€¢ `RouterInstance` å·²è¢«ç§»é™¤ï¼Œè‹¥å¤–éƒ¨æ’ä»¶ç›´æ¥ import è¯¥ç±»ä¼šå‡ºç° `ImportError`ï¼›ä½†é¡¹ç›®å†…éƒ¨å·²å…¨éƒ¨æ”¹ä¸ºä½¿ç”¨ `Gateway`ï¼Œé£é™©ä»…åœ¨ç¬¬ä¸‰æ–¹æ‹“å±•ã€‚ |
| **æµ‹è¯•å½±å“** | â€¢ ç”±äº `conftest` è¢«æ‹†åˆ†ï¼Œpytest é‡æ–°åŠ è½½é¡ºåºä¿æŒä¸å˜ï¼›å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ **fixture åç§°å˜æ›´**ï¼šåŸ `model_pool`ã€`model_client`ã€`model_base_url` ä»ä¿æŒä¸å˜ï¼Œå¤–éƒ¨æµ‹è¯•ä»£ç ä¸éœ€è¦æ”¹åŠ¨ã€‚<br>â€¢ æ–°å¢çš„ **cloud mode** ä¸ºç°æœ‰ e2e äº‘åç«¯æä¾›ç»Ÿä¸€å…¥å£ï¼ŒåŸæœ‰ `launch_cloud_backend` æµç¨‹ä¾æ—§å¯ç”¨ã€‚ |
| **ä¾èµ–å˜æ›´** | â€¢ `infra.Gateway` å¢åŠ äº†ä¸¤ä¸ªæ–°å±æ€§ `cloud_mode`ã€`cloud_backend` ä¸å†…éƒ¨ç¯å¢ƒ dict `_env`ï¼Œæœªå¯¹å¤–éƒ¨ API äº§ç”Ÿç ´åã€‚<br>â€¢ `backends.py` ä¸­çš„æ—§ `launch_cloud_backend` ä»ä¿ç•™ï¼Œåªæ˜¯å†…éƒ¨è°ƒç”¨ `Gateway.start(..., cloud_backend=â€¦)`ã€‚ |

---

## âš ï¸ æ½œåœ¨é£é™©

| é£é™©ç‚¹ | å¯èƒ½åæœ | éš¾åº¦/ç¼“è§£ |
|--------|----------|-----------|
| **æ—§ä»£ç ç›´æ¥å¼•ç”¨ `RouterInstance`** | è¿è¡Œæ—¶ `ImportError` æˆ– `AttributeError`ï¼Œå¯¼è‡´ CI å¤±æ•ˆã€‚ | ä¸­ç­‰ï¼šéœ€è¦åœ¨é¡¹ç›®æˆ–ç¬¬ä¸‰æ–¹æ’ä»¶ä¸­æœç´¢å¹¶æ›¿æ¢ä¸º `Gateway`ã€‚å¯åœ¨è¿ç§»æœŸé—´æä¾›å…¼å®¹ shimï¼ˆå·²å®ç°åˆ«åï¼‰ï¼Œä½†è‹¥ç›´æ¥å®ä¾‹åŒ–ç±»åˆ™ä»ä¼šæŠ¥é”™ã€‚ |
| **å­è¿›ç¨‹ç¯å¢ƒå˜é‡æ³„éœ²** | è‹¥ `self._env` ä¸º `None`ï¼Œå­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹ç¯å¢ƒï¼ŒAPI Key å¯èƒ½åœ¨ç³»ç»Ÿè¿›ç¨‹åˆ—è¡¨ä¸­çŸ­æš‚å¯è§ã€‚ | ä½ï¼šå½“å‰å®ç°ä»…åœ¨ cloud mode è®¾ç½® `_env`ï¼Œä¸”é»˜è®¤ `show_output=False`ï¼Œå­è¿›ç¨‹çš„ `stdout`/`stderr` è¢«ç®¡é“åŒ–ã€‚å»ºè®®åœ¨ç”Ÿäº§/CI ç¯å¢ƒä¸­ç¡®ä¿ `show_output` ä¸º `False`ã€‚ |
| **å¤šæ¨¡å¼å†²çªæ ¡éªŒ** | å‚æ•°ç»„åˆé”™è¯¯ï¼ˆå¦‚åŒæ—¶ä¼  `worker_urls` ä¸ `cloud_backend`ï¼‰æŠ› `ValueError`ï¼Œä½†é”™è¯¯ä¿¡æ¯å¯èƒ½ä¸å¤Ÿå‹å¥½ã€‚ | ä½ï¼šå·²åœ¨ `Gateway.start` ä¸­ç»Ÿä¸€æ ¡éªŒï¼Œå¯è¿›ä¸€æ­¥ä¼˜åŒ–æç¤ºä¿¡æ¯æˆ–æä¾›ä¸“ç”¨å¼‚å¸¸ç±»å‹ã€‚ |
| **GPU é¢„åˆ†é…é€»è¾‘æœªåŒæ­¥** | è¿ç§»å `hooks.get_pool_requirements` ä¸ `setup_backend` çš„ worker ç»Ÿè®¡å¯èƒ½å‡ºç°ä¸ä¸€è‡´ï¼ˆå¦‚ PD workers è¢«æå‰ launchï¼Œä¸¤æ¬¡è®¡æ•°ï¼‰ã€‚ | ä¸­ï¼šéœ€è¦åœ¨ CI ä¸­è¿è¡Œå®Œæ•´çš„ e2e æµ‹è¯•å¥—ä»¶éªŒè¯ï¼›è‹¥å‘ç°é‡å¤å¯åŠ¨ï¼Œå¯åœ¨ `setup_backend._setup_pd_backend` ä¸­å¢åŠ æ—¥å¿—æˆ–æ£€æŸ¥å·²å­˜åœ¨çš„ worker æ•°é‡ã€‚ |
| **äº‘æ¨¡å¼çš„å†å²åç«¯ï¼ˆmemory / oracleï¼‰** | ç›®å‰åªå°† `history_backend` å‚æ•°å‘ä¸‹ä¼ é€’ç»™å­è¿›ç¨‹ï¼Œä½†å­è¿›ç¨‹å®ç°å¯èƒ½ä»ä¾èµ–æ—§çš„è·¯ç”±å‚æ•° `--backend openai`ï¼ˆä¸åŒºåˆ† historyï¼‰ã€‚è‹¥åç«¯å®ç°ä¸å…¼å®¹ï¼Œå¯èƒ½å‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚ | ä¸­ï¼šç¡®è®¤ `sglang_router.launch_router` å¯¹ `--history-backend` ä»æ”¯æŒï¼›è‹¥ä¸å…¼å®¹ï¼Œéœ€åœ¨ `Gateway._launch` ä¸­è¡¥å……å¯¹åº”çš„ CLI å‚æ•°ã€‚ |
| **å¹¶å‘å¯åŠ¨å†²çª** | åŒä¸€æµ‹è¯•ä¼šå¹¶å‘å¯åŠ¨å¤šä¸ª `Gateway`ï¼ˆå¦‚ç±»çº§åˆ« + å‡½æ•°çº§åˆ« fixture åŒæ—¶ä½¿ç”¨ï¼‰ï¼Œå¯èƒ½å¯¼è‡´ç«¯å£å†²çªã€‚ | ä½ï¼š`Gateway.start` ä½¿ç”¨ `infra.get_open_port()` åŠ¨æ€åˆ†é…ç«¯å£ï¼›ä½†è‹¥è‡ªè¡ŒæŒ‡å®šç«¯å£ï¼ˆæœªåœ¨æœ¬æ¬¡æ”¹åŠ¨ä¸­å‡ºç°ï¼‰ï¼Œéœ€ä¿æŒå”¯ä¸€ã€‚ |
| **åºŸå¼ƒæ¨¡å—çš„è¯¯ç”¨** | `ports.py`ã€`router_manager.py` å°šåœ¨ä»“åº“ï¼Œè‹¥æœ‰äººè¯¯å¼•ç”¨ä¼šå¾—åˆ°åºŸå¼ƒæç¤ºï¼Œä½†ä»èƒ½æ­£å¸¸è¿è¡Œï¼ˆä»…å¯¼å…¥ `infra.get_open_port` ç­‰ï¼‰ã€‚ | ä½ï¼šå·²åœ¨æ–‡ä»¶é¡¶éƒ¨åŠ å…¥ clear docstringï¼Œå»ºè®®åœ¨ä¸‹ä¸€ä¸ª major ç‰ˆæœ¬ä¸­åˆ é™¤ã€‚ |

---

## ğŸ’¡ å…³æ³¨å»ºè®®

1. **è¿ç§»æŒ‡å—**  
   - åœ¨é¡¹ç›®æ ¹ç›®å½•æˆ– `README` ä¸­è¡¥å…… â€œä» `RouterInstance` åˆ° `Gateway` çš„è¿ç§»æ­¥éª¤â€ï¼ŒåŒ…æ‹¬ç¤ºä¾‹ä»£ç  `gateway = Gateway(); gateway.start

---

### refactore2e_test:-fix-smg-ci-e2e-test-code-quality-16664
**SHA**: `55b7936` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/55b7936582eeace2953d12f972f512b403f7a5f1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / è´¨é‡æå‡ï¼ˆrefactorï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤å¯¹ `sgl-model-gateway/e2e_test` ç›¸å…³ä»£ç è¿›è¡Œå¤§å¹…åº¦é‡æ„ï¼Œèšç„¦æµ‹è¯•è¿è¡Œæ—¶çš„å¥å£®æ€§ä¸å¯è¯»æ€§ã€‚ä¸»è¦åŒ…æ‹¬ï¼š  
1. ä¸º `genai-bench` å¯åŠ¨æ·»åŠ å¼‚å¸¸æ•è·ã€è¶…æ—¶æ—¥å¿—ã€å¤±è´¥è¾“å‡ºæ‰“å°ï¼Œæå‡ CI å¤±è´¥çš„å¯æ’æŸ¥æ€§ã€‚  
2. å°†æ—¥å¿—åˆ†éš”ç¬¦å®½åº¦ã€æœ€å¤§é‡è¯•æ¬¡æ•°ç­‰é…ç½®æŠ½å–ä¸ºå¸¸é‡ `LOG_SEPARATOR_WIDTH`ã€`MAX_RETRY_ATTEMPTS`ï¼Œç»Ÿä¸€ä½¿ç”¨ã€‚  
3. å°†è·¯ç”±å¥åº·æ£€æŸ¥æŠ½ç¦»è‡³ `infra.wait_for_health`ï¼Œå»é™¤é‡å¤å®ç°ã€‚  
4. ä¸ºç½‘å¡ã€GPU ä¿¡æ¯å¤„ç†åŠ å…¥å®¹é”™ï¼ˆå¦‚ `bytes.decode(..., errors="replace")`ï¼‰ä¸ç»Ÿä¸€çš„é‡è¯•é€»è¾‘ã€‚  
5. ç²¾ç®€ `Gateway` ä¸­å¯¹ `WorkerInfo` çš„æ„é€ ï¼Œç»Ÿä¸€é€šè¿‡ç§æœ‰æ–¹æ³• `_worker_from_api_response` å®Œæˆã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/e2e_test` æµ‹è¯•å¥—ä»¶åŠå…¶ä¾èµ–çš„ `infra`ã€`benchmarks`ã€`router_manager`ã€`gateway`ã€`gpu_allocator`ã€`model_pool`ã€`simple_eval_*` æ¨¡å—ã€‚  
- CI/CD æµæ°´çº¿çš„ç«¯åˆ°ç«¯ï¼ˆe2eï¼‰æµ‹è¯•æ‰§è¡Œã€‚  
- ä¸ `genai-bench`ã€OpenAI `simple-evals` ç›¸å…³çš„å¤–éƒ¨ä¸‹è½½/ç½‘ç»œè°ƒç”¨ã€‚  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  
- **æ¶æ„å½±å“**ï¼š  
  - å¢åŠ  `infra.constants` ä¸­çš„ç»Ÿä¸€é…ç½®ï¼Œä½¿å¾—è·¨æ–‡ä»¶çš„å¸¸é‡ç®¡ç†æ›´é›†ä¸­ï¼Œé™ä½ç¡¬ç¼–ç é£é™©ã€‚  
  - å°†è·¯ç”±å¥åº·æ£€æŸ¥æŠ½è±¡ä¸ºå…¬å…±å‡½æ•° `wait_for_health`ï¼Œéµå¾ª DRY åŸåˆ™ï¼Œæå‡ä»£ç å¤ç”¨åº¦ã€‚  
  - é€šè¿‡ `_worker_from_api_response` ç»Ÿä¸€ Worker ä¿¡æ¯è§£æï¼Œç®€åŒ– `Gateway` é€»è¾‘ï¼Œé™ä½æœªæ¥ API å˜æ›´çš„ç»´æŠ¤æˆæœ¬ã€‚  
- **æ€§èƒ½å½±å“**ï¼š  
  - æ–°å¢çš„å¼‚å¸¸æ•è·ä¸æ—¥å¿—æ‰“å°å¯¹æµ‹è¯•è¿è¡Œæ—¶é—´å‡ ä¹æ²¡æœ‰å½±å“ã€‚  
  - `MAX_RETRY_ATTEMPTS` å–ä»£ç¡¬ç¼–ç çš„ 6 æ¬¡é‡è¯•ï¼Œé€»è¾‘ä¸Šä¿æŒåŒç­‰æŒ‡æ•°é€€é¿ï¼Œæ€»è€—æ—¶çº¦ 63â€¯sï¼Œæœªæ”¹å˜æ€§èƒ½åŸºå‡†ã€‚  
  - `decode(..., errors="replace")` åœ¨æå°‘æ•°å‡ºç°é UTFâ€‘8 GPU åç§°æ—¶å¯é¿å…å¼‚å¸¸å¯¼è‡´çš„æå‰é€€å‡ºã€‚  
- **å®‰å…¨è€ƒè™‘**ï¼š  
  - æ•è· `FileNotFoundError`ã€`PermissionError`ã€`OSError` å¹¶ç›´æ¥åœ¨æµ‹è¯•ä¸­ `pytest.fail`ï¼Œé˜²æ­¢ CI éšå¼ç»§ç»­æ‰§è¡Œå¯¼è‡´è¯¯æŠ¥ã€‚  
  - ç»Ÿä¸€çš„æ—¥å¿—åˆ†éš”ç¬¦é˜²æ­¢æ—¥å¿—æ³¨å…¥æˆ–æ··æ·†ï¼ˆä»… UI/å¯è¯»æ€§å½±å“ï¼‰ï¼Œæœªæ¶‰åŠæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**  
1. **æµ‹è¯•è¡Œä¸ºæ”¹å˜**ï¼šåŸå…ˆå¯¹ `genai-bench` å¯åŠ¨å¤±è´¥çš„æƒ…å†µå¯èƒ½åªæ˜¯è¿”å›éé›¶ç ï¼Œç°åœ¨ä¼šç›´æ¥ `pytest.fail`ï¼Œå¯èƒ½å¯¼è‡´ CI å¤±é€Ÿï¼Œéœ€è¦ç¡®è®¤ CI ç¯å¢ƒå·²æ­£ç¡®éƒ¨ç½² `genai-bench`ã€‚  
2. **å¸¸é‡å†²çª**ï¼šæ–°åŠ å…¥çš„ `LOG_SEPARATOR_WIDTH`ã€`MAX_RETRY_ATTEMPTS` è‹¥åœ¨é¡¹ç›®å…¶ä»–ä½ç½®å·²æœ‰åŒåå¸¸é‡ï¼Œå¯èƒ½äº§ç”Ÿå‘½åå†²çªã€‚  
3. **ä¾èµ–ç½‘ç»œ**ï¼š`simple_eval_mmlu.py` å°†æ•°æ®é›† URL é‡æ–°å®šä¹‰ä¸ºå¸¸é‡ï¼Œä½†å¦‚æœå¤–éƒ¨ URL ä¸å¯è¾¾ï¼Œä¼šå¯¼è‡´è¯„ä¼°æµ‹è¯•ç›´æ¥æŠ¥é”™ã€‚  
4. **å¥åº·æ£€æŸ¥è¶…æ—¶**ï¼š`wait_for_health` è¶…æ—¶æ—¶é—´å›ºå®š 30â€¯sï¼Œè‹¥åº•å±‚å®¹å™¨å¯åŠ¨æ›´æ…¢ï¼Œå¯èƒ½è§¦å‘ä¸å¿…è¦çš„è¶…æ—¶é”™è¯¯ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **CI éªŒè¯**ï¼šåœ¨æäº¤åˆå¹¶å‰æœ¬åœ°å®Œæ•´è·‘ä¸€é `pytest -n auto`ï¼Œç¡®è®¤æ‰€æœ‰ e2e æµ‹è¯•å‡é€šè¿‡ï¼Œå°¤å…¶æ˜¯ä¾èµ– `genai-bench` çš„ç”¨ä¾‹ã€‚  
- **é…ç½®å®¡æŸ¥**ï¼šæ£€æŸ¥ `infra/constants.py` æ˜¯å¦è¢«å…¶ä»–éæµ‹è¯•æ¨¡å—å¯¼å…¥ï¼Œé¿å…æ„å¤–æš´éœ²æµ‹è¯•ä¸“ç”¨å¸¸é‡ã€‚  
- **å¼‚å¸¸ç›‘æ§**ï¼šåœ¨ CI æ—¥å¿—ä¸­å…³æ³¨ `genai-bench` å¯åŠ¨å¤±è´¥ã€`PermissionError` ç­‰æ–°æ‰“å°çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŠæ—¶å®šä½ç¯å¢ƒé—®é¢˜ã€‚  
- **å¯æ‰©å±•æ€§**ï¼šå¦‚åç»­éœ€è¦å¯¹é‡è¯•æ¬¡æ•°æˆ–æ—¥å¿—å®½åº¦è¿›è¡Œè°ƒæ•´ï¼Œåªéœ€ä¿®æ”¹ `constants.py`ï¼Œç¡®ä¿æ‰€æœ‰å¼•ç”¨åŒæ­¥ç”Ÿæ•ˆã€‚  
- **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–°é¡¹ç›® README æˆ– CI æ–‡æ¡£ï¼Œè¯´æ˜æ–°å¢çš„ç¯å¢ƒä¾èµ–ï¼ˆå¦‚ `genai-bench` å¿…é¡»åœ¨ `$PATH` ä¸­ï¼‰ä»¥åŠå¸¸é‡å«ä¹‰ï¼Œä»¥é™ä½æ–°æ‰‹ä¸Šæ‰‹é—¨æ§›ã€‚  

---

### fixe2e_test:-remove-dead-code-and-fix-type-annotations-16661
**SHA**: `8729ad5` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/8729ad5e6c389f495f1cce9dc8c11f15b3ec0cba)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBugä¿®å¤ / ä»£ç æ¸…ç†  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæ­¤æ¬¡æäº¤åœ¨ `sgl-model-gateway/e2e_test` ç›®å½•ä¸‹åˆ é™¤äº†ä¸€æ‰¹æœªä½¿ç”¨çš„å¸¸é‡ä¸è¾…åŠ©å‡½æ•°ï¼ˆå¦‚ GPU æ£€æµ‹ã€é»˜è®¤ç«¯å£ç­‰ï¼‰ï¼Œå¹¶ç»Ÿä¸€äº†ç±»å‹æ³¨è§£çš„å†™æ³•ï¼Œå°† `any` æ›¿æ¢ä¸º `Any`ã€å°† `List[str]` æ›¿æ¢ä¸º `list[str]`ï¼Œä½¿ä»£ç åœ¨ç±»å‹æ£€æŸ¥å’Œå¯è¯»æ€§ä¸Šæ›´ä¸€è‡´ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `e2e_test/conftest.py`ï¼ˆç±»å‹æ³¨è§£æ”¹åŠ¨ï¼‰  
- `e2e_test/infra/simple_eval_common.py`ï¼ˆå‡½æ•°ç­¾åæ”¹åŠ¨ï¼‰  
- `e2e_test/utils.py`ï¼ˆå¸¸é‡åˆ é™¤ã€`get_test_timeout` å®ç°ç®€åŒ–ã€ç±»å‹æ³¨è§£ä¿®æ­£ï¼‰  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**ï¼š  
- **æ¶æ„å½±å“**ï¼šä»…å±€é™äºç«¯åˆ°ç«¯æµ‹è¯•å¥—ä»¶ï¼Œä¸æ¶‰åŠä¸šåŠ¡é€»è¾‘æˆ–æ ¸å¿ƒæœåŠ¡ç»„ä»¶ã€‚åˆ é™¤çš„å¸¸é‡å‡ä¸ºæµ‹è¯•ä¸“ç”¨ï¼Œä¸€èˆ¬ä¸ä¼šè¢«ç”Ÿäº§ä»£ç å¼•ç”¨ï¼Œæ¶æ„å±‚é¢å®‰å…¨ã€‚  
- **æ€§èƒ½å½±å“**ï¼šå»é™¤æœªä½¿ç”¨çš„å…¨å±€å¸¸é‡å’Œè·¨æ¨¡å—çš„ GPU æ£€æµ‹é€»è¾‘ï¼Œå¯ç•¥å¾®é™ä½æ¨¡å—åŠ è½½æ—¶é—´å’Œå†…å­˜å ç”¨ï¼Œå¯¹æ•´ä½“æ€§èƒ½å‡ ä¹æ²¡æœ‰å¯æ„ŸçŸ¥çš„æå‡ã€‚  
- **å®‰å…¨è€ƒè™‘**ï¼šåˆ é™¤çš„ GPU æ£€æµ‹ä»£ç åœ¨å¼‚å¸¸è·¯å¾„ä¸‹ä¼šç›´æ¥ `skip` æµ‹è¯•ï¼Œæ”¹åŠ¨åä¸å†è¿›è¡Œæ£€æµ‹ã€‚è‹¥å¤–éƒ¨ä¾èµ–ï¼ˆå¦‚ CI ç¯å¢ƒï¼‰ä»æœŸå¾…è¿™äº›è·³è¿‡è¡Œä¸ºï¼Œéœ€è¦åœ¨ CI è„šæœ¬ä¸­è‡ªè¡Œæ§åˆ¶æµ‹è¯•çš„æ‰§è¡Œæ¡ä»¶ã€‚æ­¤æ¬¡ä¿®æ”¹æœªå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**ï¼š  
1. **å¼•ç”¨é—æ¼**ï¼šè‹¥é¡¹ç›®çš„å…¶ä»–æµ‹è¯•è„šæœ¬æˆ–è‡ªå®šä¹‰æ’ä»¶åœ¨è¿è¡Œæ—¶ä»æ˜¾å¼å¼•ç”¨å·²åˆ é™¤çš„å¸¸é‡ï¼ˆå¦‚ `DEFAULT_TIMEOUT`ã€`STDOUT_FILENAME` ç­‰ï¼‰ï¼Œä¼šå¯¼è‡´ `ImportError` æˆ– `AttributeError`ã€‚  
2. **ç±»å‹å…¼å®¹æ€§**ï¼šå°† `any` æ”¹ä¸º `Any`ã€`List[str]` æ”¹ä¸º `list[str]` å¯èƒ½å¯¼è‡´ä½¿ç”¨æ—§ç‰ˆ Pythonï¼ˆ<3.9ï¼‰æˆ–æœªå¼•å…¥ `typing` çš„ç¯å¢ƒå‡ºç°å…¼å®¹æ€§é—®é¢˜ã€‚  
3. **æµ‹è¯•è¡Œä¸ºå˜æ›´**ï¼šåˆ é™¤ `skip_if_no_gpu` é€»è¾‘åï¼ŒåŸæœ¬åœ¨æ—  GPU ç¯å¢ƒä¸‹è‡ªåŠ¨è·³è¿‡çš„æµ‹è¯•å°†ä¸å†è¢«è·³è¿‡ï¼Œå¯èƒ½å¯¼è‡´ CI åœ¨ç¼ºä¹ GPU çš„æœºå™¨ä¸ŠæŠ¥é”™ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
- **å…¨é“¾è·¯å›å½’**ï¼šåœ¨æœ¬åœ°ä¸ CI ç¯å¢ƒåˆ†åˆ«è¿è¡Œå®Œæ•´çš„ E2E æµ‹è¯•ï¼Œç¡®ä¿æ²¡æœ‰é—æ¼å¯¹å·²åˆ é™¤å¸¸é‡çš„å¼•ç”¨ã€‚  
- **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨é¡¹ç›®çš„æµ‹è¯•æ–‡æ¡£æˆ– CONTRIBUTING æŒ‡å—ä¸­æ³¨æ˜å·²ä¸å†æä¾› `skip_if_no_gpu` è¾…åŠ©å‡½æ•°ï¼Œç”¨æˆ·å¦‚éœ€è‡ªè¡Œæ§åˆ¶å¯è‡ªè¡Œæ·»åŠ ç›¸åº”çš„ `pytest.mark.skipif`ã€‚  
- **å…¼å®¹æ€§æ£€æŸ¥**ï¼šç¡®è®¤é¡¹ç›®çš„æœ€ä½ Python ç‰ˆæœ¬ä¸º 3.9 ä»¥ä¸Šï¼ˆå› ä½¿ç”¨äº† `list[str]` è¯­æ³•ï¼‰ï¼Œè‹¥ä»éœ€æ”¯æŒæ›´æ—§ç‰ˆæœ¬ï¼Œè¯·è€ƒè™‘ä¿ç•™ `List[str]` å¹¶ä» `typing` å¯¼å…¥ã€‚  
- **æŒç»­é›†æˆé…ç½®**ï¼šåœ¨ CI ä¸­æ˜¾å¼è®¾ç½® `E2E_TEST_TIMEOUT`ï¼Œé¿å…å› é»˜è®¤å€¼ç¡¬ç¼–ç è€Œäº§ç”Ÿçš„æ„å¤–è¶…æ—¶ã€‚  

é€šè¿‡ä¸Šè¿°æ£€æŸ¥ä¸è°ƒæ•´ï¼Œå¯ç¡®ä¿æ­¤æ¬¡ä»£ç æ¸…ç†ä¸ä¼šå¯¹ç°æœ‰æµ‹è¯•ä½“ç³»æˆ– CI æµç¨‹äº§ç”Ÿè´Ÿé¢å½±å“ï¼ŒåŒæ—¶æå‡ä»£ç è´¨é‡ä¸å¯ç»´æŠ¤æ€§ã€‚

---

### smgci-preserve-model-launch-order-with-test-collected-16618
**SHA**: `e432057` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/e432057381029ca59761729e7c268d26c370d84a)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / æ¶æ„å˜æ›´ / é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨ E2E æµ‹è¯•æ”¶é›†é˜¶æ®µå¼•å…¥å¯¹ **workerï¼ˆå¸¸è§„ã€Prefillã€Decodeï¼‰** çš„ç»Ÿä¸€æ‰«æä¸è®¡æ•°ï¼Œè®°å½•é¦–æ¬¡å‡ºç°é¡ºåºï¼Œç¡®ä¿æ¨¡å‹åœ¨æµ‹è¯•è¿è¡Œå‰æŒ‰å‡ºç°é¡ºåºé¢„å¯åŠ¨ã€‚  
- æ–°å¢ `WorkerIdentity` æ•°æ®ç±»ï¼Œç»Ÿä¸€è¡¨ç¤º â€œæ¨¡å‹â€¯+â€¯è¿æ¥æ¨¡å¼â€¯+â€¯worker ç±»å‹â€¯+â€¯åºå·â€ï¼Œå¹¶åœ¨æ¨¡å‹æ± ï¼ˆ`ModelPool`ï¼‰ä¸­å…¨éƒ¨æ”¹ä¸ºåŸºäºè¯¥æ ‡è¯†è¿›è¡Œè°ƒåº¦ã€GPU åˆ†é…å’Œå®ä¾‹ç®¡ç†ã€‚  
- `GPUAllocator.allocate_slots` æ”¯æŒ `preserve_order` å‚æ•°ï¼Œå®ç° **â€œä¿æŒæµ‹è¯•æ”¶é›†é¡ºåºâ€** çš„ GPU åˆ†é…ç­–ç•¥ï¼ˆå¯é€‰å…³é—­ï¼‰ã€‚  
- å®Œå–„ PDï¼ˆPrefill/Decodeï¼‰worker çš„å¯åŠ¨è·¯å¾„ï¼šå…±äº« bootstrap ç«¯å£ã€InfiniBand æ£€æµ‹ã€ç¼ºå¤± GPU æ—¶è‡ªåŠ¨å»¶è¿Ÿåˆ°æŒ‰éœ€å¯åŠ¨ã€‚  
- CI æµç¨‹ (`.github/workflows/pr-test-rust.yml`) ä¸­ç›¸åº”åœ°æŠŠ `router-embeddings` æµ‹è¯•æ”¹ä¸ºç»Ÿä¸€çš„ `e2e` ç»„ï¼Œä¿æŒ CI ä¸æ–°æœºåˆ¶çš„ä¸€è‡´æ€§ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/e2e_test/infra/`ï¼š`conftest.pyã€constants.pyã€gpu_allocator.pyã€model_pool.pyã€__init__.py`  
- CI é…ç½®ï¼š`.github/workflows/pr-test-rust.yml`  
- ä¾èµ–çš„å…¬å…±æšä¸¾ `ConnectionMode`ã€`WorkerType` ä»¥åŠæ¨¡å‹æ± å…¬å…±æ¥å£ `ModelPool`ã€`ModelInstance`ã€`WorkerIdentity`  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  

| ç»´åº¦ | å½±å“ |
|------|------|
| **æ¶æ„å½±å“** | 1ï¸âƒ£ å°†åŸå…ˆçš„ â€œæ¨¡å‹â€¯+â€¯æ¨¡å¼â€ äºŒå…ƒç»„åˆå‡ç»´ä¸º **å››å…ƒç»„**ï¼ˆæ¨¡å‹ã€æ¨¡å¼ã€worker ç±»å‹ã€åºå·ï¼‰ï¼Œæ‰€æœ‰è°ƒåº¦ã€å¥åº·æ£€æŸ¥ã€èµ„æºå›æ”¶ç»Ÿä¸€èµ° `WorkerIdentity`ã€‚<br>2ï¸âƒ£ é€šè¿‡ `WorkerIdentity` å®ç° **å»ä¸­å¿ƒåŒ–çš„èµ„æºé¢„åˆ†é…**ï¼Œä¸åŒ worker ç±»å‹ï¼ˆREGULARã€PREFILLã€DECODEï¼‰å…±äº«åŒä¸€å¥— `GPUAllocator` ä¸ `ModelPool`ï¼Œæ¶ˆé™¤äº†ä¹‹å‰çš„ `launch_regular_workers` ä¸ `launch_pd_workers` ä¸¤å¥—å®ç°çš„ä»£ç å†—ä½™ã€‚<br>3ï¸âƒ£ å¼•å…¥ **æµ‹è¯•æ”¶é›†é¡ºåºä¿æŒ**ï¼ˆ`_first_seen_order`ã€`preserve_order=True`ï¼‰ï¼Œä½¿å¾—æ—©æœŸå‡ºç°çš„æ¨¡å‹ä¼˜å…ˆè·å¾— GPUï¼Œæå‡äº† CI ç¨³å®šæ€§ï¼Œé¿å…å› æ¨¡å‹è°ƒåº¦é¡ºåºå˜åŒ–å¯¼è‡´çš„éšæœºå¤±è´¥ã€‚ |
| **æ€§èƒ½å½±å“** | â€¢ **GPU åˆ©ç”¨ç‡æå‡**ï¼šç»Ÿä¸€çš„ `allocate_slots(preserve_order=True)` åœ¨éœ€è¦ä¿æŒé¡ºåºæ—¶ä»é‡‡ç”¨ä¸€æ¬¡æ€§åˆ†é…ï¼Œé¿å…å¤šæ¬¡è°ƒåº¦å¯¼è‡´çš„ GPU äº‰æŠ¢ã€‚<br>â€¢ **å¯åŠ¨æ—¶é—´ç•¥å¢**ï¼šåœ¨ `startup` é‡Œä¼šå…ˆæ£€æµ‹ InfiniBandã€åˆ†é… bootstrap ç«¯å£ã€æ”¶é›†ç¼ºå¤± GPU å¹¶è®°å½• `deferred`ï¼Œè¿™äº›é¢å¤–çš„æ£€æŸ¥åœ¨å¤§æ¨¡å‹ CI åœºæ™¯ä¸‹ä»åœ¨ç§’çº§èŒƒå›´ï¼Œä¸”æ¢å–æ›´å¯é çš„é¡ºåºä¿è¯ã€‚<br>â€¢ **å¹¶è¡Œåº¦ä¸å˜**ï¼šworker å¯åŠ¨ä»æ˜¯ **é€ä¸ª Popen**ï¼ˆé¿å…èµ„æºç«äº‰ï¼‰ï¼Œä½† GPU åˆ†é…æ›´å…·å¯é¢„æµ‹æ€§ã€‚ |
| **å®‰å…¨è€ƒè™‘** | - æ–°å¢çš„ **ç¯å¢ƒå˜é‡**ï¼ˆ`ENV_SKIP_MODEL_POOL`ã€`ENV_STARTUP_TIMEOUT`ï¼‰å‡é€šè¿‡ `os.environ.get(...).lower()` è¿›è¡Œå®‰å…¨è¯»å–ï¼Œæ— ç›´æ¥æ³¨å…¥é£é™©ã€‚<br>- `GPUAllocator` å¯¹ GPU ä¿¡æ¯çš„è¯»å–åŠ äº†å¼‚å¸¸æ•è·ï¼Œé˜²æ­¢å› é©±åŠ¨å¼‚å¸¸å¯¼è‡´ CI å´©æºƒã€‚<br>- `detect_ib_device()` åªè¯»å–ç³»ç»Ÿæ–‡ä»¶ `/sys/class/infiniband`ï¼ŒåŒæ ·ä»…ä½œæ—¥å¿—æ‰“å°ï¼Œä¸å½±å“ç³»ç»Ÿå®‰å…¨ã€‚<br>æ€»ä½“ä¸Šæœªå¼•å…¥æ–°çš„å®‰å…¨å¨èƒã€‚ |
| **å¯ç»´æŠ¤æ€§** | - é€šè¿‡ `WorkerIdentity` æŠ½è±¡ï¼Œåç»­è‹¥å†åŠ å…¥æ–° worker ç±»å‹ï¼ˆå¦‚ `RERANK`ï¼‰ä»…éœ€åœ¨æšä¸¾ä¸­æ·»åŠ å³å¯ï¼Œæ— éœ€æ”¹åŠ¨è°ƒåº¦é€»è¾‘ã€‚<br>- ä»£ç åˆ†æ”¯ä» â€œregular vs PDâ€ ä¸¤å¥—å‡½æ•°åˆå¹¶ä¸º `launch_workers`ï¼Œå‡½æ•°ä½“æ›´ç®€æ´ï¼Œé‡å¤ä»£ç å¤§å¹…å‰Šå‡ã€‚<br>- `conftest.py` ä¸­çš„å…¨å±€å˜é‡æ”¹ä¸ºç»“æ„åŒ–çš„å­—å…¸/åˆ—è¡¨ï¼Œæ˜“äºé˜…è¯»ä¸è°ƒè¯•ã€‚ |

**âš ï¸ æ½œåœ¨é£é™©**  
1. **å…¼å®¹æ€§**ï¼šå¤–éƒ¨é¡¹ç›®æˆ–è„šæœ¬å¯èƒ½ä»ä½¿ç”¨æ—§çš„ `launch_regular_workers` / `launch_pd_workers` æ¥å£ï¼›è™½ç„¶è¿™äº›å‡½æ•°å·²è¢«åˆ é™¤ï¼Œè‹¥æœªåŒæ­¥æ›´æ–°ä¼šå¯¼è‡´ `ImportError`ã€‚  
2. **é”®å†²çª**ï¼š`WorkerIdentity.key` åœ¨ `REGULAR` ç±»å‹æ—¶è‹¥ `index>0` ä½¿ç”¨ `model:mode:index`ï¼Œè€Œ PD ç±»å‹ä½¿ç”¨ `...:prefill_0`ã€‚è‹¥ç”¨æˆ·è‡ªè¡Œæ„é€ è‡ªå®šä¹‰é”®ï¼Œå¯èƒ½äº§ç”Ÿæ„å¤–å†²çªã€‚  
3. **GPU é¢„åˆ†é…å¤±è´¥å¯¼è‡´å»¶è¿Ÿ**ï¼šå½“ GPU æ•°é‡ä¸è¶³ä¸” `allow_eviction=False`ï¼ˆå¦‚åœ¨èµ„æºå—é™çš„æœ¬åœ°æœºå™¨ä¸Šï¼‰ï¼Œæ‰€æœ‰éœ€è¦çš„ worker å°†è¢«åŠ å…¥ `deferred`ï¼Œåç»­æŒ‰éœ€å¯åŠ¨ï¼ˆå¯èƒ½åœ¨æµ‹è¯•è¿è¡Œæ—¶æ‰æŠ¥é”™ï¼‰ï¼Œé™ä½äº†é”™è¯¯çš„æ—©æœŸå¯è§æ€§ã€‚  
4. **InfiniBand æ£€æµ‹è¯¯åˆ¤**ï¼šæŸäº›ç¯å¢ƒä¸‹ `/sys/class/infiniband` å¯èƒ½å­˜åœ¨ä½†ä¸å¯ç”¨ï¼Œé”™è¯¯åœ°è®°å½•ä¸º â€œdetectedâ€ï¼Œè¿›è€Œåœ¨ PD worker å¯åŠ¨æ—¶å°è¯•ä½¿ç”¨éæ³•è®¾å¤‡ï¼Œå¼•å‘å¯åŠ¨å¤±è´¥ã€‚  
5. **å¹¶å‘å¥åº·æ£€æŸ¥**ï¼š`_wait_all_healthy` æŒ‰é¡ºåºè½®è¯¢æ‰€æœ‰å®ä¾‹çš„å¥åº·çŠ¶æ€ï¼Œè‹¥æŸäº› worker é•¿æ—¶é—´å¡åœ¨æ¨¡å‹åŠ è½½ï¼ˆå¤§æ¨¡å‹åŠ è½½æ…¢ï¼‰ï¼Œä¼šé˜»å¡åç»­æ‰€æœ‰ worker çš„å¥åº·ç¡®è®¤ï¼Œå¯¼è‡´æ•´ä½“å¯åŠ¨æ—¶é—´æ¿€å¢ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **æ–‡æ¡£åŒæ­¥**ï¼šåœ¨é¡¹ç›® README ä¸ `e2e_test/infra` åŒ…çš„ API æ–‡æ¡£ä¸­è¡¥å…… `WorkerIdentity`ã€`launch_workers`ã€`preserve_order` å‚æ•°çš„ä½¿ç”¨è¯´æ˜ã€‚  
- **å‘åå…¼å®¹**ï¼šæä¾›è–„åŒ…è£…å‡½æ•°ï¼ˆå¦‚ `launch_regular_workers`â†’å†…éƒ¨è°ƒç”¨ `launch_workers`ï¼‰ï¼Œé¿å…å¤–éƒ¨ç›´æ¥ç ´åã€‚å¯åœ¨ `model_pool.py` ä¸­ä¿ç•™å·²åºŸå¼ƒçš„æ¥å£å¹¶ç»™å‡º `DeprecationWarning`ã€‚  
- **å•å…ƒ/é›†æˆæµ‹è¯•**ï¼šæ–°å¢é’ˆå¯¹ä»¥ä¸‹åœºæ™¯çš„æµ‹è¯•ï¼š<br>  â€¢ å¤šæ¨¡å‹ã€å¤š worker ç±»å‹æ··åˆçš„é¡ºåºä¿æŒéªŒè¯ã€‚<br>  â€¢ GPU ä¸è¶³æ—¶çš„ `deferred` è¡Œä¸ºï¼ˆç¡®ä¿æ­£ç¡®è®°å½•å¹¶åœ¨åç»­æŒ‰éœ€å¯åŠ¨ï¼‰ã€‚<br>  â€¢ InfiniBand æ£€æµ‹å¼‚å¸¸è·¯å¾„ï¼ˆæ¨¡æ‹Ÿ `/sys/class/infiniband` å­˜åœ¨ä½†ä¸å¯è¯»ï¼‰ã€‚  
- **ç›‘æ§ä¸æ—¥å¿—**ï¼šåœ¨ CI ä¸­ä¿ç•™ `ModelPool` å¯åŠ¨å®Œæˆåçš„ `allocator.summary()` ä»¥åŠ `deferred` åˆ—è¡¨çš„æ—¥å¿—ï¼Œä»¥ä¾¿å¿«é€Ÿå®šä½èµ„æºä¸è¶³å¯¼è‡´çš„å¤±è´¥ã€‚  
- **å¯åŠ¨è¶…æ—¶è°ƒä¼˜**ï¼šåœ¨èµ„æºç´§å¼ çš„ CI ç¯å¢ƒä¸‹ï¼Œå¯é€‚å½“è°ƒé«˜ `ENV_STARTUP_TIMEOUT`ï¼Œæˆ–åœ¨æµ‹è¯•æ ‡è®°ä¸­ä½¿ç”¨ `@pytest.mark.timeout` ç»†åŒ–å•ä¸ª worker çš„å¯åŠ¨ä¸Šé™ã€‚  
- **GPU åˆ†é…ç­–ç•¥**ï¼šè‹¥é¡¹ç›®å¯¹ **ä¸¥æ ¼çš„ GPU äº²å’Œæ€§** æœ‰éœ€æ±‚ï¼Œå¯åœ¨ `GPUAllocator.allocate_slots` ä¸­åŠ å…¥å¯é€‰çš„ â€œæŒ‰æ¨¡å‹ä¼˜å…ˆçº§â€ æˆ– â€œæœ€å°ç¢ç‰‡åŒ–â€ ç®—æ³•ï¼Œè€Œä¸æ˜¯ä»…æä¾› `preserve_order`ã€‚  

> **ç»“è®º**ï¼šæœ¬æ¬¡æäº¤é€šè¿‡ç»Ÿä¸€ worker æ ‡è¯†ã€ä¿åºé¢„åˆ†é…ä»¥åŠåˆå¹¶ PD/å¸¸è§„å¯åŠ¨è·¯å¾„ï¼Œæ˜¾è‘—æå‡äº† E2E æµ‹è¯•çš„ç¡®å®šæ€§ä¸èµ„æºåˆ©ç”¨ç‡ï¼Œæ¶æ„æ›´å…·æ‰©å±•æ€§ã€‚é£é™©

---

### smgci:-migrate-benchmarks-to-e2e_test/benchmarks/,-use-parent-conftest-...
**SHA**: `d8b8198` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d8b8198192d2ef952de6d5269bc2549aa9d0f81d)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / æ¶æ„å˜æ›´ / æ€§èƒ½ä¼˜åŒ–  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´ é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- å°†æ‰€æœ‰ SMG ç›¸å…³åŸºå‡†è¿ç§»è‡³ `e2e_test/benchmarks/`ï¼Œç»Ÿä¸€ä½¿ç”¨çˆ¶ `conftest.py` æ¥æä¾› `genai_bench_runner`ã€GPU ç›‘æ§ä»¥åŠç»“æœè§£æå·¥å…·ï¼Œ CI æµç¨‹ä¹Ÿç›¸åº”æ”¹å†™ï¼Œå»æ‰äº†æ—§çš„ `pr-test-pd-router.yml` ä¸ `pr-test-rust.yml` ä¸­çš„ HTTP/Routerâ€‘benchmark ä½œä¸šã€‚  
- æ–°å¢ `sgl-model-gateway/e2e_test/infra/gpu_monitor.py`ï¼Œåœ¨ç‹¬ç«‹å­è¿›ç¨‹ä¸­ä½¿ç”¨ NVML ä½å¼€é”€é‡‡æ · GPU åˆ©ç”¨ç‡ï¼Œå¹¶åœ¨é˜ˆå€¼ä¸æ»¡è¶³æ—¶ç›´æ¥æ–­è¨€ã€‚  
- `ModelPool` é‡æ–°å®ç°äº† **MRU é©±åŠ¨çš„ GPUâ€‘eviction**ï¼Œå¹¶æ–°å¢ `launch_regular_workers` æ¥å£ï¼Œæ”¯æŒä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªæ™®é€š workerï¼ˆç”¨äºè´Ÿè½½å‡è¡¡ï¼‰ï¼ŒåŒæ—¶ä¿ç•™å¯¹ PDï¼ˆPrefill/Decodeï¼‰worker çš„å…¼å®¹ã€‚  
- æ·»åŠ äº†ä¸¤ä¸ªåŸºå‡†æµ‹è¯• `test_regular_perf.py` ä¸ `test_pd_perf.py`ï¼Œä»¥åŠç»“æœæ±‡æ€»è„šæœ¬ `summarize.py`ï¼Œåœ¨ CI ä¸­ä¼šæŠŠ `genai-bench` äº§å‡ºçš„ JSON è‡ªåŠ¨æ¸²æŸ“åˆ° GitHubâ€¯Stepâ€¯Summaryã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- CI å·¥ä½œæµï¼ˆ`.github/workflows/*`ï¼‰  
- `sgl-model-gateway/e2e_test/benchmarks/` åŠå…¶å­ç›®å½•  
- `sgl-model-gateway/e2e_test/infra/`ï¼ˆ`gpu_monitor.py`ã€`conftest.py`ã€`model_pool.py`ï¼‰  
- ä¾èµ– `genai-bench`ã€`pynvml`ã€`pytest` çš„æµ‹è¯•è¿è¡Œç¯å¢ƒ  
- å¯èƒ½æ¶‰åŠçš„ Docker é•œåƒæˆ–è‡ªæ‰˜ç®¡ Runnerï¼ˆGPU èµ„æºã€NVML é©±åŠ¨ï¼‰  

---

### ğŸ” æŠ€æœ¯æ´å¯Ÿ  

| ç»´åº¦ | å½±å“æè¿° |
|------|----------|
| **æ¶æ„å½±å“** | 1. **Benchmark æ¨¡å—ç»Ÿä¸€åŒ–**ï¼šåŸå…ˆæ•£è½åœ¨å¤šä¸ª CI ä½œä¸šçš„ `pr-test-*` è¢«åˆå¹¶è¿› `e2e_test/benchmarks/`ï¼Œæ‰€æœ‰åŸºå‡†ç°åœ¨é€šè¿‡åŒä¸€å¥— fixture (`genai_bench_runner`) æ§åˆ¶ï¼Œæå¤§æå‡å¯ç»´æŠ¤æ€§ã€‚<br>2. **GPU ç›‘æ§è§£è€¦**ï¼š`gpu_monitor.py` æŠŠ GPU åˆ©ç”¨ç‡é‡‡é›†æŠ½ç¦»æˆç‹¬ç«‹å­è¿›ç¨‹ï¼Œé¿å…å¯¹ä¸»è¿›ç¨‹çš„ GIL ä¸ IO å½±å“ï¼ŒåŒæ—¶æä¾› `GPUMonitor` ç±»çš„ç»Ÿä¸€ APIï¼Œä¾¿äºåœ¨ä»»æ„åŸºå‡†è„šæœ¬ä¸­å¤ç”¨ã€‚<br>3. **ModelPool æ‰©å±•**ï¼šåŸæœ‰çš„ `get()` åªè¿”å›å•å®ä¾‹ï¼Œæ–°å¢ `launch_regular_workers` èƒ½ä¸€æ¬¡æ€§åˆ†é… `n * tp` GPU å¹¶è¿”å›å¤šä¸ª `ModelInstance`ï¼Œå®ç°äº†çœŸæ­£çš„å¤š worker è´Ÿè½½å‡è¡¡ã€‚<br>4. **Eviction é€»è¾‘ç»†åŒ–**ï¼š`_evict_for_gpus` ç°åœ¨å¯ä»¥æ ¹æ® `model_id`+`worker_type`ï¼ˆåŠå¯é€‰ `mode`ï¼‰è¿›è¡Œç²¾å‡†æ’é™¤ï¼Œé¿å…åœ¨ PD åœºæ™¯ä¸­è¯¯åˆ  Prefill/Decode å®ä¾‹ã€‚ |
| **æ€§èƒ½å½±å“** | 1. **GPU é‡‡æ ·å¼€é”€é™ä½**ï¼šå­è¿›ç¨‹ä½¿ç”¨ `os.nice(10)` å¹¶ä¸”åªåœ¨ç›®æ ‡è¿›ç¨‹å­˜æ´»æœŸé—´é‡‡æ ·ï¼Œé‡‡æ ·é¢‘ç‡é»˜è®¤ 2â€¯sï¼Œå¯é€šè¿‡ `GPUMonitor(interval)` è°ƒæ•´ï¼ŒåŸºæœ¬ä¸å¯¹åŸºå‡†ååäº§ç”Ÿå¹²æ‰°ã€‚<br>2. **å¤š worker å¯åŠ¨å¹¶è¡Œ**ï¼š`launch_regular_workers` ä¸€æ¬¡æ€§åˆ†é… GPUã€å¹¶è¡Œå¯åŠ¨å¤šä¸ª `sglang` workerï¼Œçœå»ä¹‹å‰åœ¨å¾ªç¯ä¸­é€ä¸ª `get()` å† `wait_for_health` çš„åºåˆ—åŒ–æ­¥éª¤ï¼Œå¯æŠŠæ•´ä½“å¯åŠ¨æ—¶å»¶ä» ~30â€¯s ç¼©çŸ­è‡³ <â€¯10â€¯sï¼ˆå–å†³äºæœºå™¨ï¼‰ã€‚<br>3. **CI ä½œä¸šåˆå¹¶**ï¼šåŸæœ¬çš„ `router-http-tests`ã€`router-grpc-response-api-tests` åˆå¹¶ä¸ºä¸€ä¸ªçŸ©é˜µåŒ–ä½œä¸š `gateway-e2e`ï¼Œè¿è¡Œæ—¶é—´ä» 2â€‘3â€¯h é™è‡³çº¦ 1â€¯hï¼Œèµ„æºå ç”¨æ›´å‡åŒ€ã€‚ |
| **å®‰å…¨è€ƒè™‘** | - ä»£ç æ²¡æœ‰å¼•å…¥å¤–éƒ¨ç½‘ç»œè¯·æ±‚ï¼Œä»…åœ¨æœ¬åœ°å¯åŠ¨ `genaiâ€‘bench` ä¸ SGLang æœåŠ¡ã€‚<br>- æ–°å¢çš„ GPU ç›‘æ§ä¾èµ– `pynvml`ï¼Œåªè¯»å–æ˜¾å¡åˆ©ç”¨ç‡ï¼Œä¸æ¶‰åŠç³»ç»Ÿç‰¹æƒæ“ä½œã€‚<br>- å¯¹ CI è§¦å‘æ¡ä»¶çš„æ”¹åŠ¨ï¼ˆåˆ æ‰ `pr-test-pd-router.yml`ï¼‰ä¸å½±å“ä»£ç å®¡æŸ¥å®‰å…¨ï¼Œåªæ˜¯æŠŠ PRâ€‘label â€œrouterâ€‘benchmarkâ€ çš„ä¸“ç”¨è·‘åˆ†ä»»åŠ¡è¿åˆ°ç»Ÿä¸€çš„ `gateway-e2e` ä½œä¸šã€‚<br>- ç¯å¢ƒå˜é‡ `GPU_UTIL_LOG` ä»ç„¶æ˜¯ç™½åå•å¼çš„å¼€å…³ï¼Œæœªå¯¹å¤–æš´éœ²ã€‚æ€»ä½“æ— æ–°å¢å®‰å…¨é£é™©ã€‚ |

---

**âš ï¸ æ½œåœ¨é£é™©**  

1. **NVML ä¾èµ–ç¼ºå¤±**  
   - åœ¨æ²¡æœ‰ NVIDIA é©±åŠ¨æˆ– `pynvml` åŒ…çš„ runner ä¸Šï¼Œ`GPUMonitor.start()` ä¼šå†™å‡ºç©ºçš„ `gpu_utilization.json` å¹¶è¿”å› â€œno samplesâ€ã€‚è™½ç„¶åŸºå‡†ä»ä¼šé€šè¿‡ï¼Œä½†é˜ˆå€¼ï¼ˆå¦‚ `gpu_util_p50_min`ï¼‰ä¼šå¤±æ•ˆï¼Œå¯èƒ½å¯¼è‡´è¯¯æŠ¥ â€œGPU åˆ©ç”¨ç‡ä¸è¶³â€ã€‚  
   - è§£å†³æ–¹æ¡ˆï¼šCI å¿…é¡»åœ¨å…·æœ‰ `nvidiaâ€‘smi` ä¸ `pynvml` çš„ GPUâ€¯Runner ä¸Šæ‰§è¡Œï¼›æˆ–è€…åœ¨ `genai_bench_runner` ä¸­å¢åŠ  `skip_if_no_gpu_monitor` é€»è¾‘ã€‚  

2. **æ¨¡å‹å®ä¾‹é”®å†²çª**  
   - `launch_regular_workers` ä¸ºæ¯ä¸ª worker ç”Ÿæˆé”® `"{model_id}:{mode.value}:{i}"`ã€‚è‹¥åŒä¸€æ¨¡å‹å·²ä»¥åŒæ ·é”®åœ¨ `ModelPool` ä¸­å­˜åœ¨ï¼ˆä¾‹å¦‚ç”¨æˆ·æ‰‹åŠ¨è°ƒç”¨ `get()` å¹¶ä¼ å…¥ç›¸åŒ `mode`ï¼‰ï¼Œ`_evict_instance` å¯èƒ½é”™è¯¯åœ°åˆ é™¤æ­£åœ¨ä½¿ç”¨çš„å®ä¾‹ã€‚  
   - å»ºè®®åœ¨ `launch_regular_workers` å‰æ£€æŸ¥ `self.instances` æ˜¯å¦å·²å­˜åœ¨ç›¸åŒé”®ï¼Œè‹¥å­˜åœ¨åˆ™å¤ç”¨æˆ–æ˜¾å¼æŠ¥é”™ã€‚  

3. **MRU é€å‡ºç­–ç•¥çš„å‰¯ä½œç”¨**  
   - `_evict_for_gpus` ç°åœ¨åŸºäº `last_used` **é™åº**ï¼ˆæœ€è¿‘ä½¿ç”¨æœ€å…ˆé©±é€ï¼‰ï¼Œä¸ä¼ ç»Ÿçš„ â€œæœ€å°‘ä½¿ç”¨â€ï¼ˆLRUï¼‰ç›¸åã€‚è‹¥å¤šä¸ªæµ‹è¯•åŒæ—¶è¯·æ±‚ç›¸åŒ GPUï¼Œå¯èƒ½å¯¼è‡´æœ€è¿‘å¯åŠ¨çš„å®ä¾‹è¢«å¼ºè¡Œå›æ”¶ï¼Œå¯¼è‡´çŸ­æš‚çš„ â€œç«¯å£å†²çª / ç«¯å£è¢«å ç”¨â€ é”™è¯¯ã€‚  
   - è‹¥å‡ºç°è¯¥é—®é¢˜ï¼Œå¯ä»¥å°†æ’åºæ”¹ä¸º `key=lambda x: x[1].last_used`ï¼ˆå‡åºï¼‰æˆ–æä¾›é…ç½®å¼€å…³ã€‚  

4. **CI è¶…æ—¶/èµ„æºç«äº‰**  
   - åˆå¹¶åçš„ `gateway-e2e` ä½œä¸šåœ¨çŸ©é˜µé‡Œè·‘å››ç§åœºæ™¯ï¼Œå•æœº GPU èµ„æºä»… 4

---

### refactore2e:-keep-only-benchmark-tests-in-e2e_http,-remove-redundant-tests-...
**SHA**: `dce8b06` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/dce8b0606c06d3a191a24c7b8cbe8e238ab316c9)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆe2e æµ‹è¯•å¥—ä»¶ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæ­¤æ¬¡æäº¤æŠŠ `sgl-model-gateway/e2e_test/e2e_http` ç›®å½•ä¸‹çš„ç«¯åˆ°ç«¯ï¼ˆe2eï¼‰æµ‹è¯•å¤§å¹…ç²¾ç®€ï¼Œä»…ä¿ç•™æ€§èƒ½åŸºå‡†ï¼ˆgenâ€‘aiâ€‘benchï¼‰ç›¸å…³æµ‹è¯•ï¼Œåˆ é™¤äº†åŒ…æ‹¬ MMLU è¯„ä¼°ã€åŠ¨æ€ worker å¢åˆ ã€å®¹é”™ã€DPâ€‘aware æ‰©å®¹ä»¥åŠ TLS å¯åŠ¨ç­‰å¤šé¡¹åŠŸèƒ½éªŒè¯çš„æµ‹è¯•æ–‡ä»¶ï¼Œå…±è®¡çº¦ 354 è¡Œä»£ç è¢«ç§»é™¤ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `sgl-model-gateway/e2e_test/e2e_http/test_pd_router.py`  
- `sgl-model-gateway/e2e_test/e2e_http/test_regular_router.py`  
- `sgl-model-gateway/e2e_test/e2e_http/test_tls.py`ï¼ˆæ•´ä½“åˆ é™¤ï¼‰  
- å—å½±å“çš„ CI å·¥ä½œæµï¼ˆè¿è¡Œ e2e æµ‹è¯•çš„éƒ¨åˆ†ï¼‰  
- ä¾èµ–è¿™äº› e2e ç”¨ä¾‹çš„å¼€å‘è€…æ–‡æ¡£ä¸ç¤ºä¾‹  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  

- **æ¶æ„å½±å“**  
  - ä»…ä¿ç•™åŸºå‡†æµ‹è¯•æ„å‘³ç€è·¯ç”±å™¨ã€workerã€PDï¼ˆprefillâ€‘decodeï¼‰ æ¨¡å—çš„åŠŸèƒ½éªŒè¯åœ¨ CI ä¸­è¢«å¼±åŒ–ï¼Œç³»ç»Ÿæ•´ä½“çš„ç«¯åˆ°ç«¯è¡Œä¸ºä¸å†é€šè¿‡è‡ªåŠ¨åŒ–å›å½’éªŒè¯ã€‚  
  - åˆ é™¤ TLS æµ‹è¯•åï¼Œé¡¹ç›®å¯¹ HTTPS/TLS å¯åŠ¨è·¯å¾„çš„è‡ªåŠ¨åŒ–è¦†ç›–æ¶ˆå¤±ï¼Œè‹¥åç»­æ”¹åŠ¨æ¶‰åŠå®‰å…¨é…ç½®æˆ–è¯ä¹¦å¤„ç†ï¼Œç¼ºå°‘ç›´æ¥å›å½’æ£€æµ‹ã€‚  

- **æ€§èƒ½å½±å“**  
  - CI è¿è¡Œæ—¶é—´æ˜¾è‘—ä¸‹é™ï¼ˆåŸæœ¬çš„ e2e æµ‹è¯•ä¼šå¯åŠ¨å¤šä¸ªè¿›ç¨‹ã€å‘é€å¤§é‡è¯·æ±‚ï¼‰ï¼Œå¯¹å¼€å‘è€…æœ¬åœ°è°ƒè¯•ä¹Ÿæ›´è½»é‡ã€‚  
  - ä»…ä¿ç•™ `genai_bench`ï¼ˆåŸºå‡†ï¼‰æµ‹è¯•ï¼Œä»èƒ½æä¾›ä¸€å®šçš„æ€§èƒ½åŸºçº¿ï¼Œé¿å…å› é¢‘ç¹çš„å®Œæ•´åŠŸèƒ½å›å½’å¯¼è‡´æ€§èƒ½è¯„ä¼°å¤±çœŸã€‚  

- **å®‰å…¨è€ƒè™‘**  
  - ç§»é™¤ TLS ç«¯åˆ°ç«¯æµ‹è¯•å‰Šå¼±äº†å¯¹ **HTTPSã€è¯ä¹¦åŠ è½½ã€APIâ€‘Key é‰´æƒ** ç­‰å®‰å…¨ç‰¹æ€§çš„è‡ªåŠ¨åŒ–æ£€æŸ¥ã€‚è‹¥ä»¥ååœ¨è·¯ç”±å™¨å±‚é¢åŠ å…¥æ›´ä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ï¼ˆå¦‚ HSTSã€TLS 1.3 å¼ºåˆ¶ï¼‰ï¼Œç¼ºå°‘å¯¹åº”æµ‹è¯•å¯èƒ½å¯¼è‡´å®‰å…¨ç¼ºé™·æœªè¢«åŠæ—¶å‘ç°ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**  

1. **å›å½’ç›²åŒº**ï¼šåŠŸèƒ½æ€§å›å½’ï¼ˆMMLU è¯„ä¼°ã€åŠ¨æ€ worker å¢åˆ ã€å®¹é”™ã€DPâ€‘aware æ‰©å®¹ï¼‰ä¸å†å—è‡ªåŠ¨åŒ–ä¿éšœï¼Œä»£ç æ”¹åŠ¨åå¯èƒ½å¯¼è‡´è¿™äº›å…³é”®è¡Œä¸ºå¤±æ•ˆè€Œä¸è¢«ç«‹åˆ»æ„ŸçŸ¥ã€‚  
2. **å®‰å…¨å›å½’ç¼ºå¤±**ï¼šTLS å¯åŠ¨ã€è¯ä¹¦ç”Ÿæˆã€APIâ€‘Key æ ¡éªŒç­‰å®‰å…¨è·¯å¾„å¤±å» CI éªŒè¯ï¼Œæœªæ¥çš„å®‰å…¨ç¡¬åŒ–æˆ–åº“å‡çº§ï¼ˆå¦‚ `cryptography`ã€`urllib3`ï¼‰å¯èƒ½å¼•å…¥å…¼å®¹æ€§æˆ–æ¼æ´é—®é¢˜ã€‚  
3. **æ–‡æ¡£ä¸ç¤ºä¾‹ä¸åŒæ­¥**ï¼šé¡¹ç›® README æˆ–ç¤ºä¾‹å¯èƒ½ä»ç„¶æåˆ°å·²åˆ é™¤çš„ e2e åœºæ™¯ï¼Œå¯¼è‡´æ–°æ‰‹è¯¯ä»¥ä¸ºè¿™äº›åŠŸèƒ½åœ¨ CI ä¸­è¢«éªŒè¯ã€‚  
4. **ä¾èµ–å¤–éƒ¨èµ„æº**ï¼šè™½ç„¶å½“å‰åˆ é™¤çš„æµ‹è¯•ä¸»è¦æ˜¯ä¸€æ¬¡æ€§çš„åŠŸèƒ½éªŒè¯ï¼Œä½†è‹¥åç»­æœ‰äººä¾èµ–è¿™äº›æµ‹è¯•è„šæœ¬è¿›è¡Œè‡ªå®šä¹‰é›†æˆéªŒè¯ï¼Œå°†ä¼šå‡ºç°æ‰¾ä¸åˆ°æ–‡ä»¶çš„é”™è¯¯ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

- **ä¿æŒåŠŸèƒ½è¦†ç›–**  
  - å°†è¢«ç§»é™¤çš„å…³é”®åŠŸèƒ½æµ‹è¯•è¿ç§»è‡³ **å•å…ƒæµ‹è¯•** æˆ– **ç‹¬ç«‹çš„å¯é€‰ e2e æµ‹è¯•å¥—ä»¶**ï¼ˆå¦‚ `tests/e2e_optional/`ï¼‰ï¼Œåœ¨ CI ä¸­é€šè¿‡ `matrix` æˆ–æ‰‹åŠ¨è§¦å‘çš„æ–¹å¼è¿è¡Œã€‚è¿™æ ·æ—¢èƒ½ä¿æŒ CI é€Ÿåº¦ï¼Œåˆä¸å¤±åŠŸèƒ½å›å½’ä¿éšœã€‚  
- **è¡¥é½å®‰å…¨éªŒè¯**  
  - ä¸º TLSã€APIâ€‘Key é‰´æƒç­‰å®‰å…¨è·¯å¾„å•ç‹¬æ–°å¢ **smoke test**ï¼ˆå¯åŠ¨ä¸€æ¬¡è·¯ç”±å™¨å¹¶æ£€æŸ¥ `/health`ã€`/v1/models` çš„ TLS å“åº”ï¼‰ï¼Œç¡®ä¿æ¯æ¬¡å‘å¸ƒåä»æœ‰æœ€åŸºæœ¬çš„å®‰å…¨æ£€æŸ¥ã€‚  
- **æ–‡æ¡£åŒæ­¥**  
  - æ›´æ–°ä»“åº“çš„ READMEã€è´¡çŒ®æŒ‡å—ä»¥åŠ CI è¯´æ˜ï¼Œæ˜ç¡®å“ªäº› e2e åœºæ™¯å·²è¢«ç§»é™¤æˆ–è½¬ç§»ï¼Œé˜²æ­¢ç”¨æˆ·è¯¯è§£ã€‚  
- **ç›‘æ§åŸºå‡†å˜åŒ–**  
  - ç»§ç»­ä¿ç•™ `genai_bench` åŸºå‡†æµ‹è¯•ï¼Œå¹¶å°†å…¶ç»“æœä¸ŠæŠ¥è‡³ **performance dashboard**ï¼Œç¡®ä¿æ€§èƒ½å›å½’ä»å¯è¢«åŠæ—¶æ•è·ã€‚  
- **CI é…ç½®å®¡æŸ¥**  
  - æ£€æŸ¥ GitHub Actionsï¼ˆæˆ–å…¶å®ƒ CI ç³»ç»Ÿï¼‰ä¸­å…³äº e2e æµ‹è¯•çš„ `run-on` æ¡ä»¶ï¼Œé¿å…å› æ–‡ä»¶ç¼ºå¤±å¯¼è‡´ workflow å¤±è´¥ã€‚å¯è€ƒè™‘ä½¿ç”¨ `if: files.changed('sgl-model-gateway/e2e_test/**')` æ¥æ¡ä»¶æ‰§è¡Œã€‚  

---  

**æ€»ç»“**ï¼šæ­¤æ¬¡æäº¤é€šè¿‡åˆ é™¤å¤§é‡å†—ä½™ e2e æµ‹è¯•å¤§å¹…æå‡ CI æ•ˆç‡ï¼Œä½†ä¹Ÿå‰Šå¼±äº†ç³»ç»ŸåŠŸèƒ½ã€å®¹é”™ä¸å®‰å…¨ç‰¹æ€§çš„è‡ªåŠ¨åŒ–å›å½’ä¿éšœã€‚å»ºè®®åœ¨ä¿æŒå¿«é€Ÿ CI çš„å‰æä¸‹ï¼Œå°†å…³é”®åŠŸèƒ½æµ‹è¯•è½¬ç§»è‡³å¯é€‰æˆ–æ›´è½»é‡çš„æµ‹è¯•å±‚çº§ï¼Œå¹¶è¡¥å……æœ€å°çš„å®‰å…¨æ£€æŸ¥ï¼Œä»¥é™ä½å› æµ‹è¯•ç¼ºå¤±å¯¼è‡´çš„é£é™©ã€‚

---

### feat:-add-.dockerignore-to-ignore-files-when-build-images-16223
**SHA**: `6beb50d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/6beb50d612eff067307d8a090d036aa4a7283db8)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ä»“åº“æ ¹ç›®å½•æ–°å¢ `.dockerignore`ï¼Œä»…åŒ…å« `.gitignore`ï¼Œä»è€Œåœ¨æ„å»º Docker é•œåƒæ—¶è‡ªåŠ¨å¤ç”¨ç°æœ‰çš„ Git å¿½ç•¥è§„åˆ™ã€‚åŒæ­¥å¯¹ `.gitignore` è¿›è¡Œç»†åŒ–ï¼Œå°†å¤šæ•°ç›®å½•å‰ç¼€æ”¹ä¸ºé€’å½’é€šé… `**/`ï¼Œæå‡å¯¹å­ç›®å½•çš„å¿½ç•¥è¦†ç›–ã€‚é¢„æœŸå¯æ˜¾è‘—ç¼©å°æ„å»ºä¸Šä¸‹æ–‡ã€åŠ é€Ÿé•œåƒæ„å»ºå¹¶é˜²æ­¢ä¸å¿…è¦çš„æ–‡ä»¶æ³„æ¼ã€‚

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- Docker é•œåƒæ„å»ºæµç¨‹ï¼ˆCI/CDã€å¼€å‘è€…æœ¬åœ° `docker build`ï¼‰  
- ä»»ä½•ä¾èµ– `.gitignore` è¿›è¡Œæ–‡ä»¶è¿‡æ»¤çš„å·¥å…·/è„šæœ¬ï¼ˆå¦‚ `tar`ã€`rsync`ï¼‰  
- é¡¹ç›®æ ¹ç›®å½•çš„æ–‡ä»¶å¯è§†åŒ–ä¸ IDE è‡ªåŠ¨å¿½ç•¥è¡Œä¸º  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**ï¼š

- **æ¶æ„å½±å“**ï¼š  
  - ä¸ä¸šåŠ¡é€»è¾‘æ— å…³ï¼Œä»…å½±å“éƒ¨ç½²å±‚é¢çš„æ„å»ºæµç¨‹ã€‚  
  - é€šè¿‡æŠŠ `.gitignore` å¼•å…¥ `.dockerignore`ï¼Œå®ç°â€œä¸€ä»½è§„åˆ™ï¼Œå¤šå¤„å¤ç”¨â€ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ã€‚

- **æ€§èƒ½å½±å“**ï¼š  
  - æ„å»ºä¸Šä¸‹æ–‡ä½“ç§¯å¤§å¹…ä¸‹é™ï¼ˆé¿å…ä¸Šä¼  `build/ã€dist/ã€*.egg*` ç­‰å†—ä½™ç›®å½•ï¼‰ï¼ŒDocker Daemon è¯»å–ã€ä¼ è¾“ã€å±‚ç¼“å­˜çš„è€—æ—¶æ˜¾è‘—é™ä½ã€‚  
  - æ›´å°çš„é•œåƒå±‚æ¬¡æå‡æ‹‰å–ä¸åˆ†å‘é€Ÿåº¦ï¼Œé—´æ¥æå‡ CI/CD æ•´ä½“ååã€‚

- **å®‰å…¨è€ƒè™‘**ï¼š  
  - é˜²æ­¢æºç ã€æ„å»ºäº§ç‰©ã€æ•æ„Ÿçš„ä¸´æ—¶ç›®å½•è¢«æ„å¤–æ‰“åŒ…è¿›é•œåƒï¼Œé™ä½æ³„éœ²é£é™©ã€‚  
  - åªè¦ `.gitignore` æœ¬èº«ä¸åŒ…å«éœ€è¦ä¿å¯†çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™ç§å¤ç”¨æ˜¯å®‰å…¨çš„ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**ï¼š

1. **è¯¯è¿‡æ»¤**ï¼šå°† `build/ã€dist/ã€*.egg*` ç­‰æ¨¡å¼æ”¹ä¸º `**/build/` ç­‰é€’å½’é€šé…ï¼Œå¯èƒ½å¯¼è‡´å­æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹æ’ä»¶å†…éƒ¨çš„åŒåç›®å½•ä¹Ÿè¢«å¿½ç•¥ï¼Œè‹¥è¿™äº›ç›®å½•æœ¬åº”è¢«æ‰“åŒ…è¿›é•œåƒï¼Œä¼šå‡ºç°ç¼ºå¤±ã€‚  
2. **Docker å…¼å®¹æ€§**ï¼šDocker çš„ `.dockerignore` é‡‡ç”¨ä¸ Git ç±»ä¼¼ä½†ä¸å®Œå…¨ç›¸åŒçš„è§„åˆ™ï¼Œ`**/` åœ¨è¾ƒè€çš„ Docker ç‰ˆæœ¬å¯èƒ½ä¸è¢«å®Œå…¨æ”¯æŒï¼Œå¯¼è‡´å¿½ç•¥å¤±æ•ˆã€‚  
3. **CI è„šæœ¬ä¾èµ–**ï¼šéƒ¨åˆ† CI æ­¥éª¤å¯èƒ½æ˜¾å¼è¯»å– `.gitignore` æ¥å†³å®šè¦ç¼“å­˜çš„è·¯å¾„ï¼Œè§„åˆ™æ›´æ”¹åå¯èƒ½å¯¼è‡´ç¼“å­˜å¤±æ•ˆæˆ–é¢å¤–çš„æ„å»ºæ­¥éª¤ã€‚  
4. **ç¼ºå°‘æ¢è¡Œ**ï¼š`.dockerignore` æ–‡ä»¶æœ«å°¾ç¼ºå°‘æ¢è¡Œç¬¦ï¼Œæå°‘æƒ…å†µä¸‹ä¼šå¯¼è‡´è§£æå¼‚å¸¸ï¼ˆå¤§å¤šæ•° Docker ç‰ˆæœ¬å®¹å¿ï¼Œä½†ä»å»ºè®®è¡¥å…¨ï¼‰ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š

- **éªŒè¯æ„å»º**ï¼šåœ¨æœ¬åœ°åŠ CI ç¯å¢ƒæ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„ `docker build`ï¼Œç¡®è®¤æ‰€æœ‰å¿…é¡»çš„æ–‡ä»¶ï¼ˆå¦‚é…ç½®ã€æ¨¡å‹æ–‡ä»¶ç­‰ï¼‰æœªè¢«è¯¯è¿‡æ»¤ã€‚  
- **ç‰ˆæœ¬å…¼å®¹**ï¼šæ£€æŸ¥ CI ä½¿ç”¨çš„ Docker ç‰ˆæœ¬ï¼Œç¡®ä¿å…¶æ”¯æŒ `**/` é€šé…ç¬¦ï¼›è‹¥ä¸ç¡®å®šï¼Œå¯åœ¨ `.dockerignore` ä¸­ä¿ç•™å…³é”®ç›®å½•çš„æ˜¾å¼æ¨¡å¼ï¼ˆå¦‚ `*/build/`ï¼‰ã€‚  
- **å¢é‡æ’é™¤**ï¼šå¦‚ç¡®å®éœ€è¦ä¿ç•™æŸäº›å­ç›®å½•çš„ `build`/`dist`ï¼Œå¯åœ¨ `.dockerignore` ä¸­åŠ å…¥ `!**/specific_package/build/` ç­‰ä¾‹å¤–è§„åˆ™ã€‚  
- **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨é¡¹ç›®çš„è´¡çŒ®æŒ‡å—æˆ– CI æ–‡æ¡£ä¸­è¯´æ˜æ–°å¢çš„ `.dockerignore` åŠ `.gitignore` æ›´æ”¹çš„ç›®çš„ä¸æ³¨æ„äº‹é¡¹ï¼Œæé†’è´¡çŒ®è€…åœ¨æ·»åŠ æ–°ç›®å½•æ—¶åŒæ­¥æ›´æ–°å¿½ç•¥è§„åˆ™ã€‚  
- **æ¢è¡Œè¡¥å…¨**ï¼šç»™ `.dockerignore` æ·»åŠ æœ«å°¾æ¢è¡Œç¬¦ï¼Œä»¥ç¬¦åˆ POSIX æ–‡æœ¬æ–‡ä»¶çš„å¸¸è§„å®è·µã€‚  

é€šè¿‡ä¸Šè¿°æ£€æŸ¥ä¸è°ƒæ•´ï¼Œå¯ç¡®ä¿æ­¤åŠŸèƒ½å¢å¼ºå¸¦æ¥é¢„æœŸçš„æ„å»ºæ•ˆç‡å’Œå®‰å…¨æ”¶ç›Šï¼Œä¸”ä¸ä¼šæ„å¤–å½±å“ç°æœ‰å·¥ä½œæµã€‚

---

### refactore2e:-remove-old-embedding-tests-migrated-to-e2e_test/embeddings-1...
**SHA**: `d415d22` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d415d22daa370104eb064570b6345dc5c2b71d5f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆåˆ é™¤å·²è¿ç§»çš„æ—§ Endâ€‘toâ€‘End åµŒå…¥æµ‹è¯•ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡æäº¤åˆ é™¤äº†ä½äº `sgl-model-gateway/e2e_test/` ç›®å½•ä¸‹çš„ä¸‰ä¸ªæ—§ç‰ˆåµŒå…¥ç›¸å…³ E2E æµ‹è¯•æ–‡ä»¶ï¼ˆ`test_embedding_correctness.py`ã€`test_embedding_server.py`ã€`test_e2e_embeddings.py`ï¼‰ï¼Œè¿™äº›æµ‹è¯•å·²åœ¨æ–°çš„ `e2e_test/embeddings` ä½ç½®è¿ç§»å®ç°ã€‚åˆ é™¤çº¦ 435 è¡Œå†—ä½™æµ‹è¯•ä»£ç ï¼Œæ—¨åœ¨ç®€åŒ–æµ‹è¯•å¥—ä»¶ã€é™ä½ CI è¿è¡Œæ—¶é•¿å¹¶é¿å…é‡å¤è¦†ç›–ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `sgl-model-gateway/e2e_test/e2e_grpc/basic/`  
- `sgl-model-gateway/e2e_test/e2e_grpc/`  
- `sgl-model-gateway/e2e_test/e2e_http/`  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**ï¼š  
- **æ¶æ„å½±å“**ï¼šä»…æ¶‰åŠæµ‹è¯•å±‚ï¼Œæœªæ”¹åŠ¨ä¸šåŠ¡ä»£ç ã€è·¯ç”±å™¨æˆ–æ¨¡å‹ç½‘å…³çš„å®ç°ï¼Œç³»ç»Ÿæ¶æ„ä¿æŒä¸å˜ã€‚  
- **æ€§èƒ½å½±å“**ï¼šCI æµæ°´çº¿ä¸­æ‰§è¡Œçš„ E2E æµ‹è¯•æ•°é‡ä¸‹é™ï¼Œé¢„è®¡å¯å‡å°‘çº¦ 1â€“2 åˆ†é’Ÿçš„æµ‹è¯•æ‰§è¡Œæ—¶é—´ï¼ˆå–å†³äºæœºå™¨èµ„æºï¼‰ï¼Œæå‡æ•´ä½“æäº¤éªŒè¯é€Ÿåº¦ã€‚  
- **å®‰å…¨è€ƒè™‘**ï¼šåˆ é™¤çš„æ–‡ä»¶ä¸­æ²¡æœ‰å®‰å…¨æ•æ„Ÿé€»è¾‘ï¼ˆå¦‚èº«ä»½éªŒè¯ã€ç½‘ç»œè°ƒç”¨çš„å¼‚å¸¸å¤„ç†ï¼‰ï¼Œä¸æ¶‰åŠå®‰å…¨é£é™©ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**ï¼š  
1. **æµ‹è¯•è¦†ç›–å›é€€**ï¼šè‹¥æ–°è¿ç§»çš„ `e2e_test/embeddings` ç›®å½•ä¸‹çš„æµ‹è¯•æœªå®Œå…¨è¦†ç›–æ—§æµ‹è¯•çš„åœºæ™¯ï¼ˆä¾‹å¦‚æ‰¹é‡ã€ç»´åº¦ä¸€è‡´æ€§ã€è¯­ä¹‰ç›¸ä¼¼åº¦å®¹å·®ç­‰ï¼‰ï¼Œå¯èƒ½å¯¼è‡´å›å½’ç¼ºå¤±ã€‚  
2. **CI å¤±è¯¯**ï¼šå¦‚æœè¿ç§»è¿‡ç¨‹å‡ºç°é—æ¼ï¼Œåˆ é™¤å CI ä»ä¼šé€šè¿‡ï¼Œä½†å®é™…ç”Ÿäº§ç¯å¢ƒçš„åµŒå…¥åŠŸèƒ½å¯èƒ½å‡ºç°æœªè¢«æ£€æµ‹çš„é”™è¯¯ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
- **éªŒè¯è¿ç§»å®Œæ•´æ€§**ï¼šåœ¨åˆå¹¶å‰ç¡®ä¿æ–°ä½ç½®çš„æµ‹è¯•è¦†ç›–äº†æ—§æµ‹è¯•çš„å…¨éƒ¨æ–­è¨€ï¼ˆæ‰¹é‡ã€ç›¸ä¼¼åº¦å®¹å·®ã€ç»´åº¦ä¸€è‡´æ€§ã€ä½¿ç”¨ OpenAIâ€‘compatible å®¢æˆ·ç«¯ç­‰ï¼‰ã€‚å¯åœ¨ CI ä¸­åŠ å…¥å¯¹æ¯”æŠ¥å‘Šï¼Œæ˜¾ç¤ºæ–°æ—§æµ‹è¯•è¦†ç›–ç‡å·®å¼‚ã€‚  
- **ä¿æŒæµ‹è¯•æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–°é¡¹ç›®çš„ E2E æµ‹è¯•æŒ‡å—ï¼ŒæŒ‡å‘æ–°çš„ `e2e_test/embeddings` ç›®å½•ï¼Œé¿å…åç»­å¼€å‘è€…è¯¯ä»¥ä¸ºæ—§è·¯å¾„ä»æœ‰æ•ˆã€‚  
- **ç›‘æ§ CI æ—¶é•¿**ï¼šè§‚å¯Ÿåˆ é™¤å CI æ€»æ—¶é•¿çš„å˜åŒ–ï¼Œè‹¥ä¸‹é™æ˜¾è‘—ï¼Œå¯è€ƒè™‘è¿›ä¸€æ­¥åˆå¹¶å…¶ä»–å†—ä½™æµ‹è¯•ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–éªŒè¯æµç¨‹ã€‚  
- **å›æ»šé¢„æ¡ˆ**ï¼šä¿ç•™åˆ é™¤çš„æäº¤è®°å½•ï¼ˆå¦‚åœ¨åˆ†æ”¯ä¸­ï¼‰ï¼Œè‹¥æ–°æµ‹è¯•å‘ç°ç¼ºé™·ï¼Œå¯å¿«é€Ÿæ¢å¤å¯¹åº”æ–‡ä»¶æˆ–è¡¥å…¨ç¼ºå¤±çš„æµ‹è¯•ç”¨ä¾‹ã€‚

---

### model-gateway-add-embedding-tests-16583
**SHA**: `a49b9a6` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/a49b9a6420128a144217f3e044db4645588e00c1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨ `sgl-model-gateway` ä¸­æ–°å¢äº†ä¸€å¥—å®Œæ•´çš„ **embedding API æµ‹è¯•**ï¼ˆåŸºæœ¬åŠŸèƒ½ + æ­£ç¡®æ€§å¯¹æ¯”ï¼‰ï¼Œå¹¶åœ¨ CI æµæ°´çº¿ä¸­åŠ å…¥å¯¹åº”ä¾èµ–ï¼ˆ`numpy`ã€`sentenceâ€‘transformers` ç­‰ï¼‰ã€‚  
- é‡æ„äº†æ¨¡å‹æ ‡è®°ã€æ¨¡å‹æ± ï¼ˆ`ModelPool`ï¼‰ä»¥åŠ GPU åˆ†é…é€»è¾‘ï¼šå»é™¤äº†â€œsession / classâ€ ä¸¤ç§ä½œç”¨åŸŸï¼Œç»Ÿä¸€ä½¿ç”¨ **MRUï¼ˆæœ€è¿‘æœ€å¸¸ä½¿ç”¨ï¼‰é©±é€ç­–ç•¥**ï¼Œå¹¶æ”¯æŒåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åœ¨ç¼ºä¹ GPU æ—¶ **evictâ€‘thenâ€‘launch**ã€‚  
- CI å·¥ä½œæµåšäº†ä»¥ä¸‹å…¼å®¹æ€§è°ƒæ•´ï¼šä¸´æ—¶å…³é—­ GPU èŠ‚ç‚¹çš„ routerâ€‘benchmark ä»»åŠ¡ã€æŠŠ `pip uninstall sglang-router` æ”¹ä¸ºå®¹é”™ã€åœ¨ router e2e æµ‹è¯•ä¸­åŠ å…¥ embedding æµ‹è¯•å…¥å£ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway` æ ¸å¿ƒä»£ç ï¼ˆ`model_pool.py`ã€`infra/gateway.py`ï¼‰  
- `sgl-model-gateway/e2e_test`ï¼šå…¨éƒ¨æ–°å»º/ä¿®æ”¹çš„ embedding æµ‹è¯•æ–‡ä»¶ã€`conftest.py`ã€`router/test_worker_api.py`  
- GitHub Actions å·¥ä½œæµï¼š`.github/workflows/pr-test-pd-router.yml`ã€`.github/workflows/pr-test-rust.yml`  
- ä¾èµ–åˆ—è¡¨ï¼šæ–°å¢ `numpy`ã€`sentence-transformers`ï¼ˆé—´æ¥å¼•å…¥ `torch`ï¼‰  

---

### ğŸ” æŠ€æœ¯æ´å¯Ÿ  

| ç»´åº¦ | å½±å“æè¿° |
|------|-----------|
| **æ¶æ„å½±å“** | 1. **Embedding æ ‡è®°**ï¼šåœ¨ `conftest.py` ä¸­ç»Ÿä¸€ä½¿ç”¨ `@pytest.mark.model("embedding")`ï¼Œä¸å†åŒºåˆ† `scope='session' / 'class'`ï¼Œç®€åŒ–äº†æ¨¡å‹æ ‡è®°çš„è§£æé€»è¾‘ã€‚<br>2. **ModelPool é‡æ„**ï¼š<ul><li>åˆ é™¤äº† `register_class_scoped_models`ã€`_class_scoped_models`ã€`_queued_models` ç­‰æ¦‚å¿µã€‚</li><li>æ”¹ä¸º **MRU é©±é€**ï¼ˆ`last_used` è¶Šå¤§è¶Šå…ˆè¢«é©±é€ï¼‰ï¼Œä»£æ›¿åŸæ¥çš„ LRUï¼›è¿™æ›´ç¬¦åˆæµ‹è¯• â€œå…ˆè·‘å®Œçš„æ¨¡å‹å¾€å¾€å·²ç»ä¸å†éœ€è¦ï¼Œåç»­æ¨¡å‹æ‰æ˜¯çƒ­ç‚¹â€ã€‚</li><li>åœ¨ `get()` ä¸­ç¼ºå¤±å®ä¾‹æ—¶ç›´æ¥ **onâ€‘demand å¯åŠ¨**ï¼Œå¹¶åœ¨å¿…è¦æ—¶è°ƒç”¨ `_evict_for_gpus` ä»¥é‡Šæ”¾ GPUã€‚</li></ul> |
| **æ€§èƒ½å½±å“** | - **å¯åŠ¨æ—¶ GPU åˆ©ç”¨ç‡æå‡**ï¼š`startup()` ä¼šé¢„å…ˆå æ»¡å¯ç”¨ GPUï¼Œå‰©ä½™æ¨¡å‹æ”¹ä¸ºæŒ‰éœ€å¯åŠ¨ï¼Œé¿å…ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ¨¡å‹æ‹‰æ»¡å¯¼è‡´ OOMã€‚<br>- **é©±é€æˆæœ¬**ï¼šMRU é©±é€ä¼šæŠŠåˆšä½¿ç”¨å®Œçš„æ¨¡å‹ç›´æ¥æ€æ‰ï¼Œå¯èƒ½å¯¼è‡´åŒä¸€æ¨¡å‹åœ¨åŒä¸€æ¬¡æµ‹è¯•å¥—ä»¶ä¸­è¢«å¤šæ¬¡é‡æ–°å¯åŠ¨ï¼Œå¢åŠ å¯åŠ¨æ—¶é—´ï¼ˆå°¤å…¶æ˜¯å¤§å‹æ¨¡å‹ï¼‰ã€‚<br>- **CI æ—¶é•¿**ï¼šæ–°å¢ `sentence-transformers` ä¸ `torch` ä¾èµ–ï¼Œä¼šæ˜¾è‘—å¢åŠ  CI é•œåƒæ‹‰å–ä¸ CPU è®¡ç®—çš„æ—¶é—´ã€‚ |
| **å®‰å…¨è€ƒè™‘** | - **CI éšè”½é£é™©**ï¼š`pr-test-pd-router.yml` è¢«ç¡¬ç¼–ç ä¸º `if: false`ï¼Œå¯¼è‡´ **routerâ€‘benchmark** ç±»çš„ PR æ°¸ä¸æ‰§è¡Œï¼Œå¯èƒ½è®©æ€§èƒ½å›å½’æˆ–å®‰å…¨å›å½’ç¼ºå¤±æ£€æµ‹ã€‚<br>- **ä¾èµ–å®‰å…¨**ï¼šæ–°å¢çš„ `torch`ã€`sentence-transformers` å¼•å…¥äº†å¤§é‡äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€ç¡®è®¤å®˜æ–¹é•œåƒçš„ç­¾åä¸æ¼æ´æ‰«æé€šè¿‡ï¼ˆå°¤å…¶åœ¨å…¬å¼€ CI ç¯å¢ƒï¼‰ã€‚ |
| **å¯ç»´æŠ¤æ€§** | - **ä»£ç ç®€åŒ–**ï¼šç§»é™¤ `scope` å‚æ•°åï¼Œ`ModelPool.get` çš„ç­¾åå˜ä¸º `get(model_id, mode, worker_type=â€¦)`ï¼Œè°ƒç”¨æ–¹æ›´å°‘å‡ºé”™ã€‚<br>- **æ—¥å¿—å¢å¼º**ï¼šåœ¨ `gateway.py` å¢åŠ  `debug` çº§åˆ«çš„å¯åŠ¨å‘½ä»¤æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥å¯åŠ¨å‚æ•°é—®é¢˜ã€‚<br>- **æ ‡è®°ç»Ÿä¸€**ï¼š`conftest.py` åªä¿ç•™ `model(name)` æ ‡è®°ï¼Œé™ä½äº†è‡ªå®šä¹‰ marker çš„å­¦ä¹ æˆæœ¬ã€‚ |

---

### âš ï¸ æ½œåœ¨é£é™©  

1. **MRU é©±é€å¯¼è‡´ä¸ç¨³å®š**  
   - åœ¨åŒä¸€æµ‹è¯•æ–‡ä»¶ä¸­å¤šæ¬¡åˆ‡æ¢æ¨¡å‹ï¼ˆå¦‚å…ˆ `llama-8b` å† `qwen-7b`ï¼‰ï¼ŒMRU ä¼šä¼˜å…ˆé©±é€æœ€è¿‘ä½¿ç”¨çš„æ¨¡å‹ï¼Œè‹¥åç»­è¿˜æœ‰å…¶ä»–æµ‹è¯•éœ€è¦åŒæ¨¡å‹ï¼Œä¼šäº§ç”Ÿ **é¢‘ç¹çš„å¯åŠ¨/å…³é—­**ï¼Œå¯èƒ½å¯¼è‡´ CI è¶…æ—¶æˆ–å‡ºç°â€œmodel not foundâ€é”™è¯¯ã€‚  

2. **GPU èµ„æºç«äº‰**  
   - `launch_pd_workers` ç°åœ¨ä¼šåœ¨ GPU ä¸è¶³æ—¶è‡ªåŠ¨é©±é€ï¼ˆ`allow_eviction=True`ï¼‰ï¼Œä½†é©±é€çš„ç›®æ ‡å¯èƒ½æ­£æ˜¯ **PD éœ€è¦çš„æ¨¡å‹**ï¼Œå¯¼è‡´ PD worker å¯åŠ¨åç«‹å³è¢«é©±é€ã€‚è‹¥æµ‹è¯•ä¾èµ– PDï¼Œéœ€æ˜¾å¼ä¼ å…¥ `allow_eviction=False` æˆ–åœ¨ CI ä¸­é¢„ç•™è¶³å¤Ÿ GPUã€‚  

3. **CI è¦†ç›–ç¼ºå¤±**  
   - å…³é—­ `pr-test-pd-router.yml` çš„æ¡ä»¶ä¼šè®© **routerâ€‘benchmark** æ°¸ä¸è·‘ï¼Œä»»ä½•é’ˆå¯¹è¯¥èŠ‚ç‚¹çš„å›å½’ï¼ˆæ€§èƒ½æˆ–å®‰å…¨ï¼‰éƒ½ä¸ä¼šè¢«æ•è·ã€‚  

4. **æ–°å¢ä¾èµ–ä½“ç§¯**  
   - `torch` + `sentence-transformers` åœ¨ CPU ç¯å¢ƒä¸‹ä»å å‡ ç™¾ MBï¼ŒCI å®¹å™¨çš„ç£ç›˜/ç½‘ç»œå‹åŠ›å¢åŠ ï¼Œå¯èƒ½å¯¼è‡´ â€œdisk out of spaceâ€ æˆ– â€œnetwork timeoutâ€ã€‚  

5. **æ¨¡å‹æ ‡è®°å…¼å®¹æ€§**  
   - å·²æœ‰çš„è‡ªå®šä¹‰ `@pytest.mark.model(..., scope="class")` ç”¨ä¾‹åœ¨æ›´æ–°åä¼šè¢«è¯¯åˆ¤ä¸º **æ— æ¨¡å‹æ ‡è®°**ï¼Œè¿›è€Œé»˜è®¤ä½¿ç”¨ `DEFAULT_MODEL`ï¼Œå¯èƒ½å¯¼è‡´ä¸ç¬¦åˆé¢„æœŸçš„æ¨¡å‹è¢«æµ‹è¯•ã€‚  

---

### ğŸ’¡ å…³æ³¨å»ºè®®  

| æ–¹å‘ | å»ºè®® |
|------|------|
| **å›æ»š/å®¹é”™** | - åœ¨ `ModelPool.get` ä¸­åŠ å…¥ **fallback**ï¼ˆå¦‚ `if eviction fails â†’ raise clear error`ï¼‰ï¼Œå¹¶åœ¨ CI ä¸­æ•è· `RuntimeError` ä»¥æç¤º â€œGPU resources exhaustedâ€ã€‚ |
| **é©±é€ç­–ç•¥** | - è€ƒè™‘æä¾› **å¯é…ç½®çš„é©±é€ç­–ç•¥**ï¼ˆ`--eviction=mr u / lru`ï¼‰ï¼Œè®©ç”¨æˆ·æ ¹æ®å·¥ä½œè´Ÿè½½è‡ªè¡Œå†³å®šã€‚<br>- åœ¨ MRU é©±é€å‰è®°å½• `last_used` æ—¶é—´æˆ³ï¼Œä¾¿äºåæœŸåˆ†æå“ªäº›æ¨¡å‹é¢‘ç¹è¢«é©±é€ã€‚ |
| **CI ç¨³å®šæ€§** | - é‡æ–°å¯ç”¨ `pr-test-pd-router.yml`ï¼Œæˆ–è€…åœ¨ `README` ä¸­æ˜ç¡®è¯´æ˜è¯¥ workflow å·²è¢«æš‚æ—¶ç¦ç”¨ä¸”ä½•æ—¶é‡æ–°æ‰“å¼€ã€‚<br>- ä¸º embedding æµ‹è¯•å•ç‹¬å¼€è¾Ÿ **èµ„æºéš”ç¦»**ï¼ˆä¾‹å¦‚åœ¨ `pr-test-embeddings.yml`ï¼‰ï¼Œé˜²æ­¢ä¸ç°æœ‰ GPU å¯†é›†å‹æµ‹è¯•äº‰æŠ¢ã€‚ |
| **ä¾èµ–ç®¡ç†** | - å°† `torch` ä¸ `sentence-transformers` çš„ **CPU ç‰ˆ**ï¼ˆ`torch==2.x+ -f https://download.pytorch.org/whl/cpu/torch_stable.html`ï¼‰é”å®šåœ¨ `requirements.txt`ï¼Œå¹¶åœ¨ CI ä¸­æ˜¾å¼ä½¿ç”¨ `pip install -r requirements.txt`. |
| **æ–‡æ¡£ä¸ç¤ºä¾‹** | - åœ¨ `docs/embedding.md` ä¸­è¡¥é½ **embedding model æ ‡è®°** ç”¨æ³•ç¤ºä¾‹ï¼Œè§£é‡Š `--is-embedding` å‚æ•°çš„æ„ä¹‰ã€‚<br>- æ›´æ–° `conftest.py` æ³¨é‡Šï¼Œè¯´æ˜ä¸å†æ”¯æŒ `scope` å‚æ•°ï¼Œé¿å…ç”¨æˆ·ä»åœ¨æ—§ä»£ç é‡Œä½¿ç”¨ã€‚ |
| **æµ‹è¯•è¦†ç›–** | - ä¸º **MRU é©±é€** å¢åŠ å•å…ƒæµ‹è¯•ï¼šæ„é€  3â€‘4 ä¸ªæ¨¡å‹ï¼Œä½¿ç”¨ `ModelPool.get` äº¤å‰è¯·æ±‚ï¼ŒéªŒè¯

---

#### ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (26)

### support-page-size-large-than-64-for-mamba-radix-cache-16657
**SHA**: `7fc12e0` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/7fc12e0bfa3ae1808b7ae3c1afa3b4c979bac57e)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- å¼•å…¥ `MAMBA_CACHE_V2_CHUNK_SIZE = max(FLA_CHUNK_SIZE, page_size)`ï¼Œä½¿å¾— Mamba Radix Cache èƒ½å¤Ÿåœ¨ pageâ€‘size å¤§äº 64 æ—¶æ­£å¸¸å·¥ä½œã€‚  
- æ‰€æœ‰æ¶‰åŠ FLA_CHUNK_SIZE å¯¹é½ã€æ©ç è®¡ç®—ã€åˆ†æ”¯åºåˆ—é•¿åº¦å¯¹é½çš„åœ°æ–¹ç»Ÿä¸€æ”¹ä¸ºä½¿ç”¨è¯¥åŠ¨æ€ chunk å¤§å°ã€‚  
- åœ¨ `server_args` ä¸­æ”¾å®½äº†å¯¹ `page_size` ä¸ `FLA_CHUNK_SIZE` å…³ç³»çš„æ–­è¨€ï¼Œæ”¹ä¸ºä¸¤è€…çš„æœ€å¤§æœ€å°å€¼å¿…é¡»ç›¸äº’æ•´é™¤ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/managers/schedule_batch.py`ï¼ˆæ‰¹å¤„ç†è°ƒåº¦é€»è¾‘ï¼‰  
- `python/sglang/srt/mem_cache/mamba_radix_cache.py`ï¼ˆMamba Radix ç¼“å­˜å®ç°ï¼‰  
- `python/sglang/srt/server_args.py`ï¼ˆæ¨¡å‹å¯åŠ¨å‚æ•°æ ¡éªŒï¼‰  
- å…³è”çš„ `token_to_kv_pool_allocator.page_size` é…ç½®ä»¥åŠ `mamba_track_interval` çš„æ ¡éªŒã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šç¡®è®¤æ‰€æœ‰è°ƒç”¨ `FLA_CHUNK_SIZE` çš„æ¨¡å—å·²åŒæ­¥æ”¹ä¸ºä½¿ç”¨ `MAMBA_CACHE_V2_CHUNK_SIZE`ï¼Œé¿å…å‡ºç°æ··ç”¨å¯¼è‡´å¯¹é½é”™è¯¯ã€‚  
2. **é…ç½®å…¼å®¹**ï¼šåœ¨æ–‡æ¡£å’Œç¤ºä¾‹ä¸­è¯´æ˜ `--page-size` å¯å¤§äº 64ï¼Œä½†ä»éœ€æ»¡è¶³ `max % min == 0`ï¼Œå¹¶æé†’ç”¨æˆ·åœ¨æ›´æ”¹ `page_size` æ—¶åŒæ­¥æ›´æ–° `mamba_track_interval`ã€‚  
3. **æµ‹è¯•è¦†ç›–**ï¼šæ–°å¢é’ˆå¯¹ä¸åŒ `page_size`ï¼ˆå¦‚ 128ã€256ï¼‰ çš„å•å…ƒ/é›†æˆæµ‹è¯•ï¼Œç¡®ä¿ç¼“å­˜æ‰©å±•ã€åˆ†æ”¯ç‚¹è®¡ç®—å’Œæ‰¹æ¬¡è°ƒåº¦åœ¨å¤§é¡µå¤§å°ä¸‹ä¿æŒæ­£ç¡®ã€‚  
4. **æ€§èƒ½è¯„ä¼°**ï¼šå¤§å—å¯¹é½ä¼šæ”¹å˜ KVâ€‘pool çš„åˆ†é…é¢—ç²’ï¼Œå»ºè®®åœ¨å®é™…æ¨ç†åœºæ™¯ä¸‹å¯¹ååå’Œæ˜¾å­˜ä½¿ç”¨è¿›è¡ŒåŸºå‡†å¯¹æ¯”ï¼Œç¡®è®¤æ²¡æœ‰æ„å¤–å›é€€ã€‚  
5. **å›æ»šè·¯å¾„**ï¼šè‹¥å‡ºç°æ—§æ¨¡å‹å…¼å®¹æ€§é—®é¢˜ï¼Œä¿ç•™ `FLA_CHUNK_SIZE` ä½œä¸ºé»˜è®¤å€¼å³å¯å›åˆ°åŸè¡Œä¸ºï¼Œç¡®ä¿ä¸ç ´åå·²æœ‰éƒ¨ç½²ã€‚  

æ•´ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸ºæ”¯æŒæ›´å¤§ pageâ€‘size çš„éœ€æ±‚æä¾›äº†å¿…è¦çš„å¯¹é½é€»è¾‘ï¼Œå½±å“èŒƒå›´é›†ä¸­åœ¨ç¼“å­˜å’Œè°ƒåº¦å±‚ï¼Œå»ºè®®åœ¨å‘å¸ƒå‰å®Œæˆä¸Šè¿°å…¼å®¹æ€§ä¸æ€§èƒ½éªŒè¯ã€‚

---

### diffusion-bench:-upgrade-multimodal-benchmarks-for-diverse-applications-and...
**SHA**: `4d902c8` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4d902c82119cbe56b7faf0e6e6f46f1ef35dba38)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / ä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
1. ä¸ºå¤šæ¨¡æ€åŸºå‡†è„šæœ¬ `bench_serving.py` å¼•å…¥ç»Ÿä¸€ã€å¯é…ç½®çš„æ—¥å¿—ç³»ç»Ÿï¼ˆ`configure_logger / init_logger`ï¼‰ï¼Œå°†å¤§é‡ `print` æ›¿æ¢ä¸ºç»“æ„åŒ– `logger`ã€‚  
2. é€šè¿‡ HuggingFace Hub çš„ `pipeline_tag` è‡ªåŠ¨æ¨æ–­ä»»åŠ¡ç±»å‹ï¼ŒåºŸé™¤ `--backend` ä¸ `--task` çš„ç¡¬ç¼–ç æ ¡éªŒï¼Œå®ç°â€œä¸€é”®æœåŠ¡â€‘ä¸€é”®åŸºå‡†â€ã€‚  
3. å¯¹ VBench æ•°æ®é›†çš„ä¸‹è½½ã€åŠ è½½æµç¨‹åšç»†åŒ–ï¼ˆå¼‚å¸¸æ—¥å¿—ã€å ä½å›¾åˆ›å»ºï¼‰ï¼Œå¹¶ç»Ÿä¸€é”™è¯¯æç¤ºé£æ ¼ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `python/sglang/multimodal_gen/benchmarks/bench_serving.py`ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰  
- æ–°å¢/ä¿®æ”¹ `sglang/multimodal_gen/runtime/utils/logging_utils.py`ï¼ˆæ—¥å¿—ç»Ÿä¸€ï¼‰  
- ä¾èµ– `huggingface_hub`ï¼ˆç”¨äºè¯»å– `pipeline_tag`ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼š`--backend`ã€`--task` å·²è®¾ä¸ºå¯é€‰ä¸”é»˜è®¤ `None`ï¼Œä½†å·²æœ‰è„šæœ¬ä»å¯èƒ½æ˜¾å¼ä¼ å‚ï¼Œå»ºè®®åœ¨æ–‡æ¡£å’Œ Release Note ä¸­æ˜ç¡®è¿™äº›å‚æ•°å°†äºä¸‹ä¸ªå¤§ç‰ˆæœ¬ç§»é™¤ï¼Œå¹¶åœ¨ä»£ç é‡ŒåŠ å…¥ `DeprecationWarning` æç¤ºã€‚  
2. **æ¨¡å‹ pipeline_tag å¯é æ€§**ï¼šå¹¶éæ‰€æœ‰æ¨¡å‹åœ¨ Hub ä¸Šéƒ½æœ‰ `pipeline_tag`ï¼Œå½“å‰å®ç°ä¼šåœ¨å¼‚å¸¸æ—¶å›é€€åˆ° `args.task`ã€‚è¯·ç¡®ä¿åœ¨æ—  `pipeline_tag` æ—¶ä¿ç•™åŸæœ‰ `--task` å‚æ•°çš„å®Œæ•´å…¼å®¹è·¯å¾„ï¼Œæˆ–æä¾› `--fallback-task` é€‰é¡¹ã€‚  
3. **æ—¥å¿—é…ç½®**ï¼š`configure_logger(args)` åœ¨å…¥å£å¤„è°ƒç”¨ï¼Œç¡®ä¿ `args.log_level` èƒ½è¦†ç›–æ‰€æœ‰å­æ¨¡å—çš„æ—¥å¿—çº§åˆ«ï¼›è‹¥åº“å†…éƒ¨å·²æœ‰å…¶ä»– loggerï¼Œæ£€æŸ¥æ˜¯å¦å‡ºç°é‡å¤å¤„ç†æˆ–æ—¥å¿—é‡å¤ã€‚  
4. **ä¾èµ–ç®¡ç†**ï¼šæ–°å¢ `huggingface_hub` å¯¼å…¥ï¼Œéœ€è¦åœ¨ `requirements.txt` æˆ– `pyproject.toml` ä¸­å£°æ˜ç›¸åº”ç‰ˆæœ¬ï¼Œé˜²æ­¢è¿è¡Œæ—¶ `ImportError`ã€‚  
5. **æµ‹è¯•è¦†ç›–**ï¼šåŠ å…¥å¯¹ä»¥ä¸‹åœºæ™¯çš„å•å…ƒ/é›†æˆæµ‹è¯•ï¼š  
   - æœ‰ `pipeline_tag` çš„æ¨¡å‹ â†’ æ­£ç¡®æ¨æ–­ä»»åŠ¡ï¼›  
   - æ—  `pipeline_tag` ä¸”æä¾› `--task` â†’ æ­£å¸¸è¿è¡Œï¼›  
   - æ—§ç‰ˆå‘½ä»¤è¡Œï¼ˆä»ä¼  `--backend`/`--task`ï¼‰â†’ å‘å‡ºè­¦å‘Šä¸”ä¿æŒåŠŸèƒ½ã€‚  
6. **æ–‡æ¡£æ›´æ–°**ï¼šç¤ºä¾‹ CLI å·²æ”¹ä¸ºâ€œ`sglang serve â€¦` + `bench_serving --port â€¦`â€ï¼Œè¯·åŒæ­¥åˆ° READMEã€API æ–‡æ¡£ä»¥åŠ benchmark ä½¿ç”¨æŒ‡å—ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†è„šæœ¬çš„å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œä½†éœ€æ³¨æ„å‘åå…¼å®¹å’Œå¯¹ç¼ºå¤± `pipeline_tag` çš„å®¹é”™å¤„ç†ï¼Œä»¥é¿å…åœ¨å·²æœ‰æµæ°´çº¿ä¸­äº§ç”Ÿçªå‘é”™è¯¯ã€‚

---

### Handle-Marlin-weight-restoration-and-shape-recording-QAT-INT4-Rollout-Part1...
**SHA**: `fd16c91` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/fd16c91cb8dff7afc68a4033dec047907d5ea1d1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆQATâ€‘INT4 é‡åŒ–è·¯å¾„çš„æƒé‡å›æ»šä¸å½¢çŠ¶è®°å½•ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `create_weights` ä¸­ä¸º MoE å±‚æ–°å¢ `_original_shapes` å­—å…¸ï¼Œè®°å½• GPTâ€‘Qâ€‘style æƒé‡ã€scale çš„åŸå§‹ shapeã€‚  
2. `process_weights_after_loading` åŠ å…¥ `is_marlin_converted` æ ‡è®°ï¼Œé˜²æ­¢åŒä¸€å±‚è¢«äºŒæ¬¡ Marlin é‡æ’ï¼›ç»Ÿä¸€ä½¿ç”¨ `replace_tensor`ï¼ˆåŸºäº `resize_`+`copy_`ï¼‰æ›¿æ¢å¼ é‡ï¼ŒåŒæ—¶åœ¨é¦–æ¬¡æ›¿æ¢å‰ä¿å­˜åŸå§‹ shapeã€‚  
3. æ–°å¢ `restore_weights_before_loading`ï¼Œåœ¨åŠ è½½æƒé‡å‰æŠŠå¼ é‡å¼ºåˆ¶æ¢å¤åˆ°è®°å½•çš„åŸå§‹ shapeï¼Œå¹¶æ¸…é™¤ `is_marlin_converted` æ ‡è®°ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/layers/quantization/compressed_tensors/compressed_tensors_moe.py`ï¼ˆMoE å‹ç¼©å¼ é‡æ¨¡å—ï¼‰  
- å—å½±å“çš„å¯¹è±¡ï¼šæ‰€æœ‰ä½¿ç”¨ `GPTQMarlinState.REPACK` çš„ MoE å±‚ï¼ˆ`w13_weight_*`ã€`w2_weight_*` åŠå¯¹åº” scaleï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **å…¼å®¹æ€§æ£€æŸ¥**ï¼šç¡®è®¤åœ¨æœªèµ° Marlin æµç¨‹çš„æ—§æ¨¡å‹åŠ è½½æ—¶ï¼Œ`_original_shapes` ä»èƒ½æ­£ç¡®åˆå§‹åŒ–ï¼›è‹¥æ¨¡å‹å·²ç»è¢« Marlin è½¬æ¢å†å†æ¬¡è°ƒç”¨ `process_weights_after_loading`ï¼Œ`is_marlin_converted` èƒ½æœ‰æ•ˆæ‹¦æˆªï¼Œé¿å… shape å†æ¬¡è¢«å‹ç¼©ã€‚  
2. **å†…å­˜å®‰å…¨**ï¼š`resize_` ä¼šåœ¨åŸå§‹å¼ é‡ä¸Šå°±åœ°æ”¹å˜ shapeï¼Œç¡®ä¿è¿™äº›å¼ é‡åœ¨ `torch.nn.Parameter` çš„ leaf çŠ¶æ€ä¸‹ä½¿ç”¨ï¼Œå¦åˆ™å¯èƒ½è§¦å‘ autograd è­¦å‘Šã€‚å»ºè®®åœ¨åˆ›å»ºå‰ä½¿ç”¨ `torch.nn.Parameter(..., requires_grad=False)` æˆ–åœ¨ `replace_tensor` å‰è°ƒç”¨ `param.detach_()`ã€‚  
3. **çŠ¶æ€æ¢å¤**ï¼š`restore_weights_before_loading` åªä¾æ® `_original_shapes` æ¢å¤ shapeï¼Œè‹¥åœ¨è¿è¡ŒæœŸé—´æ‰‹åŠ¨ä¿®æ”¹äº†æƒé‡ shapeï¼ˆä¾‹å¦‚è‡ªå®šä¹‰ fineâ€‘tuneï¼‰ï¼Œå¯èƒ½å¯¼è‡´ä¸ä¸€è‡´ã€‚å»ºè®®åœ¨æ¨¡å‹ä¿å­˜å‰åŒæ­¥ `_original_shapes`ï¼Œæˆ–åœ¨æ¢å¤å‰åŠ ä¸€æ¬¡ shape æ ¡éªŒã€‚  
4. **åºåˆ—åŒ–/åŠ è½½**ï¼š`is_marlin_converted` ä¸ `_original_shapes` éœ€è¦åœ¨ `state_dict` ä¸­æ’é™¤ï¼ˆæˆ–è‡ªè¡Œå®ç° `__getstate__`/`__setstate__`ï¼‰ï¼Œé˜²æ­¢ä¿å­˜ä¸ºä¸å¿…è¦çš„é¢å¤–å­—æ®µã€‚  
5. **å•å…ƒæµ‹è¯•**ï¼šæ–°å¢å¯¹ä»¥ä¸‹åœºæ™¯çš„è¦†ç›–ï¼š  
   - æ­£å¸¸åˆ›å»º â†’ Marlin é‡æ’ â†’ ä¿å­˜ â†’ æ¢å¤ â†’ å†æ¬¡é‡æ’ï¼ˆåº”ä¿æŒä¸€è‡´ï¼‰  
   - å·²ç» `is_marlin_converted=True` çš„å±‚å†æ¬¡è°ƒç”¨ `process_weights_after_loading`ï¼ˆåº”ç›´æ¥è¿”å›ï¼‰  
   - å…¼å®¹æ—§æ¨¡å‹ï¼ˆæ²¡æœ‰ `_original_shapes`ï¼‰çš„åŠ è½½è·¯å¾„ã€‚  

å®Œæˆä¸Šè¿°æ£€æŸ¥åï¼ŒåŠŸèƒ½å¢å¼ºå¯¹ QATâ€‘INT4 çš„ rollout å°†æ›´ç¨³å¥ï¼Œé¿å…å›  shape å¤±é…å¯¼è‡´çš„åŠ è½½é”™è¯¯æˆ–æ¨ç†å¼‚å¸¸ã€‚

---

### Diffusion-Fix-Ulysses/Ring-process-group-construction-under-TP-to-enable-co...
**SHA**: `32a6540` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/32a6540afcd798d139163a0cd81b85d8f33169a6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / Bug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ TP>1 åœºæ™¯ä¸‹ï¼Œé‡æ–°å®ç° Ulysses/Ring å­ç»„çš„æ„é€  (`set_seq_parallel_pg_by_sp_groups`)ï¼Œä¿è¯è·¨ SP çš„å¼ é‡å¹¶è¡Œèƒ½å¤Ÿæ­£ç¡®åˆ’åˆ†ã€‚  
2. å°†å¤šä¸ªæ¨¡å‹å±‚çš„ `ReplicatedLinear` æ›¿æ¢ä¸º `ColumnParallelLinear`ï¼Œå¹¶åœ¨ `ColumnParallelLinear` ä¸­ç»Ÿä¸€ä½¿ç”¨ `gather_output=True`ï¼Œæå‡å¼ é‡å¹¶è¡Œçš„ç®—å­å…¼å®¹æ€§ã€‚  
3. ä¸º warmâ€‘up è¯·æ±‚ä¿ç•™åŸå§‹ `num_inference_steps`ï¼Œé¿å… Cacheâ€‘DIT åˆå§‹åŒ–æ—¶æ­¥æ•°è¢«é”™è¯¯æˆªæ–­ã€‚  
4. `ServerArgs.adjust_offload` æ”¹ä¸ºä»…åœ¨æœªæ˜¾å¼æŒ‡å®šæ—¶å¡«é»˜è®¤å€¼ï¼Œå¹¶åœ¨æ··åˆ SP+TP æ—¶æ”¹ä¸º warning è€Œéå¼‚å¸¸ã€‚  
5. Cacheâ€‘DIT é›†æˆæ”¹ä¸ºä¼˜å…ˆä½¿ç”¨ SGLang æä¾›çš„ DIT ç»„ (`get_dit_group`) è¿›è¡Œè·¨ TPÃ—SP çš„ä¸€è‡´æ€§åˆ¤æ–­ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sglang/multimodal_gen/runtime/distributed/*`ï¼ˆè¿›ç¨‹ç»„æ„é€ ï¼‰  
- `sglang/multimodal_gen/runtime/layers/linear.py`ï¼ˆçº¿æ€§å±‚å®ç°ï¼‰  
- `visual_embedding.pyã€wanvideo.py`ï¼ˆæ¨¡å‹å±‚ï¼‰  
- `scheduler.pyã€denoising.py`ï¼ˆè¯·æ±‚è°ƒåº¦ä¸ warmâ€‘upï¼‰  
- `server_args.py`ï¼ˆoffload é…ç½®ã€æ··åˆå¹¶è¡Œè­¦å‘Šï¼‰  
- `utils/cache_dit_integration.py`ï¼ˆCacheâ€‘DIT ä¸è¿›ç¨‹ç»„çš„ç»‘å®šï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **å¼€å‘è€…**ï¼šåœ¨å¤šèŠ‚ç‚¹ TP>1 ç¯å¢ƒä¸‹è·‘å•å…ƒæµ‹è¯•ï¼Œç¡®è®¤æ‰€æœ‰è¿›ç¨‹ç»„çš„åˆ›å»ºé¡ºåºä¸€è‡´ï¼›æ£€æŸ¥ `ColumnParallelLinear` çš„æ¢¯åº¦èšåˆæ˜¯å¦ä¸æ—§å®ç°ç­‰ä»·ã€‚  
- **ç”¨æˆ·**ï¼šä½¿ç”¨æ··åˆ SP+TP æ—¶ç•™æ„å¯åŠ¨æ—¥å¿—çš„ warningï¼Œè‹¥å‡ºç°å¼‚å¸¸è¯·æ˜ç¡®ç¦ç”¨ `cache_dit` æˆ–å•ç‹¬ä½¿ç”¨ SP/TPã€‚  
- **éƒ¨ç½²**ï¼šè‹¥è‡ªè¡ŒæŒ‡å®š offload å¼€å…³ï¼Œç¡®ä¿ä¸è¢« `adjust_offload` éšå¼è¦†ç›–ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨è§£å†³äº†é«˜é˜¶å¼ é‡å¹¶è¡Œä¸‹çš„è¿›ç¨‹ç»„é”™ä¹±é—®é¢˜ï¼Œå¹¶ç»Ÿä¸€äº†çº¿æ€§å±‚å¹¶è¡Œå®ç°ï¼Œæå‡äº† SGLang åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼æ¨ç†ä¸­çš„å¯é æ€§ã€‚

---

### NPU-update-docs-16651
**SHA**: `d4b717c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d4b717c01ead29bae6f73286d0df345a6a203908)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–ï¼ˆæ–‡æ¡£æ¸…ç†ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåˆ é™¤äº† `docs/platforms/ascend_npu_best_practice.md`ï¼ˆçº¦ 3600 è¡Œï¼‰å¹¶åœ¨ `docs/platforms/ascend_npu_support.rst` ä¸­å»æ‰äº†å¯¹åº”çš„å¼•ç”¨ã€‚æ­¤ä¸¾æ—¨åœ¨ç§»é™¤å·²è¿‡æ—¶æˆ–å†—ä½™çš„ Ascend NPU æœ€ä½³å®è·µæ–‡æ¡£ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- æ–‡æ¡£ç”Ÿæˆ/æ„å»ºæµç¨‹ï¼ˆSphinxï¼‰ï¼Œç‰¹åˆ«æ˜¯ `platforms` ç« èŠ‚çš„ç´¢å¼•ã€‚  
- ä¾èµ–è¯¥æ–‡ä»¶çš„å¤–éƒ¨é“¾æ¥æˆ–æœç´¢ç´¢å¼•ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. **æ„å»ºéªŒè¯**ï¼šåœ¨ CI ä¸­ç¡®è®¤æ–‡æ¡£æ„å»ºä¸å†å› ç¼ºå¤±æ–‡ä»¶æŠ¥é”™ï¼Œè‹¥æœ‰ `toctree` æˆ–è·¨æ–‡ä»¶é“¾æ¥ä»æŒ‡å‘è¢«åˆ æ–‡ä»¶ï¼Œéœ€è¦ç›¸åº”è¡¥é½æˆ–åˆ é™¤ã€‚  
2. **è¿ç§»å†…å®¹**ï¼šå¦‚æœå…¶ä¸­çš„å…³é”®å®è·µä»æœ‰ä»·å€¼ï¼Œè€ƒè™‘å°†ç²¾åæ¬å…¥å…¶ä»–å·²æœ‰æ–‡æ¡£æˆ–å¦å»ºç®€åŒ–ç‰ˆï¼Œä»¥å…ç”¨æˆ·åœ¨æœç´¢æ—¶å¤±å»ä¿¡æ¯ã€‚  
3. **é“¾æ¥æ›´æ–°**ï¼šæ£€æŸ¥ä»“åº“å¤–ï¼ˆå¦‚å®˜æ–¹ç½‘ç«™ã€READMEã€åšå®¢ï¼‰å¯¹ `ascend_npu_best_practice.md` çš„å¼•ç”¨ï¼ŒåŠæ—¶æ”¹ä¸ºæ–°ä½ç½®æˆ–ç§»é™¤ã€‚  
4. **æç¤ºç”¨æˆ·**ï¼šåœ¨ `ascend_npu_support.rst` çš„ç« èŠ‚å¼€å¤´åŠ å…¥ç®€çŸ­è¯´æ˜ï¼Œå‘ŠçŸ¥æœ€ä½³å®è·µå·²åˆå¹¶æˆ–ä¸å†ç»´æŠ¤ï¼Œé¿å…ç”¨æˆ·å›°æƒ‘ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡ä¿®æ”¹ä»…å½±å“æ–‡æ¡£å±‚é¢ï¼Œä¸ä¼šå¯¼è‡´è¿è¡Œæ—¶æˆ–åŠŸèƒ½å›å½’ï¼Œé‡ç‚¹ç¡®ä¿æ–‡æ¡£æ„å»ºé¡ºç•…å¹¶æä¾›ç›¸åº”çš„è¿ç§»/è¯´æ˜å³å¯ã€‚

---

### AMD-Add-8-GPU-MX35X-test-running-DSR1-MXFP4-model-for-AMD-CI-13602
**SHA**: `b86bbf8` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/b86bbf841e813716fa82c9e1cd08e3c267feb682)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–ï¼ˆCI æ‰©å±• / æ–°å¢æµ‹è¯•ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨ `.github/workflows/pr-test-amd.yml` ä¸­ä¸º AMDâ€¯MI35Xï¼ˆ1â€¯GPU ä¸ 8â€¯GPUï¼‰æ–°å¢äº†ä¸“å± CI ä½œä¸šï¼Œå¹¶å°†å…¶åŠ å…¥æ€»ä½“è°ƒåº¦ã€‚  
- `scripts/ci/amd_ci_exec.sh` åŠ å…¥äº†å¯¹ç¬¬ä¸€æ¬¡æ‰§è¡Œå¤±è´¥çš„è¿”å›ç æ•è·ï¼Œä»¥ä¾¿åç»­ç¦»çº¿é‡è¯•ã€‚  
- `scripts/ci/amd_ci_install_dependency.sh` è°ƒæ•´äº† mi35x é•œåƒä¸‹çš„ä¾èµ–å®‰è£…é€»è¾‘ï¼Œå»æ‰äº† `--noâ€‘deps` å¹¶ç»Ÿä¸€ä½¿ç”¨ `install_with_retry`ã€‚  
- åœ¨æµ‹è¯•å¥—ä»¶ `run_suite.py` ä¸­æ³¨å†Œäº† `per-commit-8-gpu-amd-mi35x`ï¼Œå¹¶æ–°å¢äº†å®Œæ•´çš„ `test_deepseek_r1_mxfp4_8gpu.py`ï¼Œè¦†ç›– 8â€¯GPU ä¸‹çš„ DeepSeekâ€‘R1â€‘MXFP4 åŸºç¡€è¯„æµ‹ä¸ MTPï¼ˆspeculativeï¼‰è¯„æµ‹ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- CI å·¥ä½œæµï¼ˆAMDâ€¯MI35Xï¼‰  
- Docker å®¹å™¨å¯åŠ¨ä¸ä¾èµ–å®‰è£…è„šæœ¬  
- æµ‹è¯•å¥—ä»¶ï¼ˆæ–°å¢ 8â€‘GPU DeepSeekâ€‘R1 æµ‹è¯•ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **CI ç¨³å®šæ€§**ï¼šæ–°å¢ä½œä¸šçš„ `timeoutâ€‘minutes` å·²åˆ†åˆ«è®¾ä¸º 15â€¯minï¼ˆ1â€‘GPUï¼‰å’Œ 30â€¯minï¼ˆ8â€‘GPUï¼‰ï¼Œä½†å®é™…è¿è¡Œ 8â€¯GPU å¯èƒ½å—ç¡¬ä»¶è°ƒåº¦æ³¢åŠ¨å½±å“ï¼Œå»ºè®®åœ¨ CI å¤±è´¥æ—¶æä¾›æ›´æ˜ç¡®çš„æ—¥å¿—ï¼ˆå¦‚å®¹å™¨å†…æ˜¾å­˜ä½¿ç”¨ã€GPU åˆ©ç”¨ç‡ï¼‰ï¼Œæ–¹ä¾¿æ’æŸ¥ã€‚  
2. **ä¾èµ–å®‰è£…**ï¼šmi35x ç°åœ¨ä¸ä½¿ç”¨ `--noâ€‘deps`ï¼Œè‹¥ä¸Šæ¸¸ä¾èµ–æœ‰å†²çªå¯èƒ½å¯¼è‡´é•œåƒæ„å»ºå˜æ…¢æˆ–å¤±è´¥ã€‚å»ºè®®åœ¨ `install_with_retry` å‰å…ˆæ£€æŸ¥å·²æœ‰ä¾èµ–ç‰ˆæœ¬ï¼Œæˆ–åœ¨ `pyproject_other.toml` ä¸­æ˜ç¡®é”å®šå…¼å®¹ç‰ˆæœ¬ã€‚  
3. **è¿”å›ç å¤„ç†**ï¼š`amd_ci_exec.sh` æ–°å¢ `FIRST_EXIT_CODE=$?` çš„æ•è·ï¼Œä½†éšåä»ä½¿ç”¨ `FIRST_EXIT_CODE` æ‰“å°ï¼Œè‹¥ç¬¬ä¸€æ¬¡æˆåŠŸåˆ™å˜é‡æœªå®šä¹‰ã€‚å»ºè®®åœ¨æˆåŠŸè·¯å¾„æ˜¾å¼è®¾ä¸º `0`ï¼Œæˆ–åœ¨ `else` åˆ†æ”¯å¤–ç»Ÿä¸€æ‰“å°ã€‚  
4. **æµ‹è¯•èµ„æº**ï¼š`test_deepseek_r1_mxfp4_8gpu.py` å¯åŠ¨äº† 8â€‘GPU serverï¼Œä½¿ç”¨ `--tp 8`ã€å¤§ prefill ç¼“å†²ç­‰ï¼Œå¯èƒ½å ç”¨å¤§é‡æ˜¾å­˜ã€‚ç¡®ä¿ CI runner çš„æ˜¾å­˜è¶³å¤Ÿï¼ˆâ‰¥ 128â€¯GBï¼‰ï¼Œå¦åˆ™ä¼šå‡ºç° OOMã€‚å¯åœ¨è„šæœ¬ä¸­åŠ å…¥æ˜¾å­˜æ£€æŸ¥å¹¶æå‰é€€å‡ºã€‚  
5. **ç»“æœä¸ŠæŠ¥**ï¼šæµ‹è¯•ä¸­é€šè¿‡ `write_github_step_summary` ä¸ŠæŠ¥äº† accuracy ä¸ speedï¼Œè‹¥æœªæ¥åœ¨é CI ç¯å¢ƒè¿è¡Œï¼Œè¿™äº›è°ƒç”¨ä¼šæŠ¥é”™ã€‚å»ºè®®åœ¨é CI åœºæ™¯åŠ ä¸€ä¸ª guardï¼ˆå¦‚ `if is_in_ci():`ï¼‰åŒ…è£¹æ‰€æœ‰å†™å…¥æ­¥éª¤ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸º AMDâ€¯MI35X å¹³å°æä¾›äº†å®Œæ•´çš„ 1â€‘GPU ä¸ 8â€‘GPU éªŒè¯ï¼Œæå‡äº†è·¨ç¡¬ä»¶å…¼å®¹æ€§ã€‚ä½†è¯·æ³¨æ„ CI èµ„æºã€ä¾èµ–ä¸€è‡´æ€§ä»¥åŠé”™è¯¯ä¿¡æ¯çš„å®Œæ•´æ€§ï¼Œä»¥å…å› ç¯å¢ƒå·®å¼‚å¯¼è‡´ä¸æ˜“å®šä½çš„ CI å¤±æ•ˆã€‚

---

### fix:-update-AMD-CI-estimated-time-for-test_torch_compile-16631
**SHA**: `6b8a9d7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/6b8a9d7058825c71f09a59cb31a46814aa35fd76)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°† `test_torch_compile` åœ¨ AMD CI ç¯å¢ƒä¸‹çš„é¢„ä¼°è¿è¡Œæ—¶é•¿ç”± 169â€¯ç§’æå‡è‡³ 993â€¯ç§’ï¼Œä»¥é¿å… CI è¶…æ—¶å¯¼è‡´çš„è¯¯æŠ¥ã€‚  
**ğŸ¯ å½±å“èŒƒå›´**ï¼šä»… `test/registered/backends/test_torch_compile.py` ä¸­çš„ CI æ³¨å†Œå‡½æ•° `register_amd_ci`ï¼›æ¶‰åŠçš„æ¨¡å—ä¸º CI é…ç½®å±‚ï¼ˆCI è°ƒåº¦ã€è¶…æ—¶åˆ¤æ–­ï¼‰ï¼Œä¸å½±å“ä¸šåŠ¡ä»£ç é€»è¾‘ã€‚  
**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **ç¡®è®¤ä¼°ç®—**ï¼šè¯·ç¡®è®¤ 993â€¯ç§’çš„é¢„ä¼°å€¼ä¸å®é™…è·‘å®Œæ•´å¥—æµ‹è¯•çš„è€—æ—¶ç›¸ç¬¦ï¼Œé˜²æ­¢èµ„æºå ç”¨è¿‡é«˜æˆ–å¯¼è‡´ CI é˜Ÿåˆ—é˜»å¡ã€‚  
2. **CI è¶…æ—¶è®¾ç½®**ï¼šæ£€æŸ¥å¯¹åº”çš„ Azure / GitHub Actions è¶…æ—¶é˜ˆå€¼ï¼Œç¡®ä¿æ–°ä¼°ç®—æœªè¶…è¿‡ä¸Šé™ï¼Œå¦åˆ™ä»ä¼šè¢«å¼ºåˆ¶ä¸­æ­¢ã€‚  
3. **æ–‡æ¡£åŒæ­¥**ï¼šè‹¥é¡¹ç›®æ–‡æ¡£æˆ– CI è¿è¡ŒæŠ¥å‘Šä¸­è®°å½•äº†è¯¥æµ‹è¯•çš„é¢„ä¼°æ—¶é•¿ï¼Œè¯·ä¸€å¹¶æ›´æ–°ï¼Œä¿æŒä¿¡æ¯ä¸€è‡´ã€‚  
4. **å›å½’æ ¡éªŒ**ï¼šåœ¨æäº¤åè§‚å¯Ÿ AMD CI çš„è¿è¡Œæƒ…å†µï¼Œç¡®ä¿æµ‹è¯•ä¸å†å› è¶…æ—¶è€Œè¢«æ ‡è®°å¤±è´¥ï¼Œä¸”æ•´ä½“ CI è¿è¡Œæ—¶é•¿ä»åœ¨å¯æ¥å—èŒƒå›´å†…ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä»…æ¶‰åŠ CI é…ç½®ï¼Œé£é™©æä½ï¼›ä½†å»ºè®®åœ¨åç»­ CI è¿è¡Œä¸­ç›‘æ§å®é™…è€—æ—¶ï¼Œä»¥ä¾¿åŠæ—¶è°ƒæ•´ã€‚

---

### Clean-Some-Environment-Variables-for-DeepSeek-V32-15938
**SHA**: `7d757d6` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/7d757d6f17ef3f48a3eb41257e3baecd89bf6e46)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / ä»£ç æ¸…ç†  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨æ–‡æ¡£ä¸­æ–°å¢ *DeepSeek V3.2*ï¼ˆDSAï¼‰ä¸“ç”¨çš„ç¯å¢ƒå˜é‡ `SGLANG_NSA_FUSE_TOPK`ã€`SGLANG_NSA_ENABLE_MTP_PRECOMPUTE_METADATA`ã€‚  
- `python/sglang/srt/environ.py` æŠŠè¿™ä¸¤ä¸ªå˜é‡ç»Ÿä¸€æ”¾å…¥ `Envs` ç±»ï¼Œé»˜è®¤å‡ä¸º `True`ã€‚  
- å¤§é‡åŸæœ‰çš„ NSA ç›¸å…³å¼€å…³ï¼ˆ`NSA_DUAL_STREAM`ã€`NSA_FUSE_TOPK`ã€`NSA_FLASHMLA_BACKEND_DECODE_COMPUTE_FP8`ã€`NSA_QUANT_K_CACHE_FAST`ã€`NSA_DEQUANT_K_CACHE_FAST` ç­‰ï¼‰ä»ä»£ç ä¸­åˆ æ‰ï¼Œæ”¹ä¸ºç›´æ¥èµ° **fast** å®ç°æˆ–ä½¿ç”¨ `envs.SGLANG_NSA_*` è¯»å–ã€‚  
- ç›¸åº”çš„ Triton kernel è°ƒç”¨å·²åˆ é™¤æ…¢è·¯å¾„çš„å›é€€é€»è¾‘ï¼Œå¹¶åœ¨ `nsa_backend.py`ã€`quant_k_cache.py`ã€`dequant_k_cache.py` ä¸­å¼ºåˆ¶ä½¿ç”¨ fast å®ç°ã€‚  
- æ—¥å¿—æ–‡å­—ä» â€œNSAâ€ æ”¹ä¸º â€œDSAâ€ï¼Œå¹¶åœ¨ `server_args.py` ä¸­ç›¸åº”è°ƒæ•´æç¤ºä¿¡æ¯ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sglang/srt/environ.py`ï¼ˆç¯å¢ƒå˜é‡ç»Ÿä¸€ï¼‰  
- `sglang/srt/layers/attention/nsa/*`ï¼ˆkernel è°ƒç”¨ã€topâ€‘k é€»è¾‘ã€kvâ€‘cache é‡åŒ–/åé‡åŒ–ï¼‰  
- `sglang/srt/server_args.py`ï¼ˆæ¨¡å‹å¯åŠ¨æ—¶çš„é»˜è®¤åç«¯/æ—¥å¿—ï¼‰  
- æ–‡æ¡£ `environment_variables.md`  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§**ï¼šåˆ é™¤æ…¢è·¯å¾„åï¼Œè‹¥ `fast` å®ç°å‡ºç°é”™è¯¯æˆ–åœ¨æ—§ç¡¬ä»¶ä¸Šä¸æ”¯æŒï¼Œè¿è¡Œæ—¶å°†ç›´æ¥æŠ¥é”™ã€‚å»ºè®®åœ¨å‘å¸ƒå‰åŠ å…¥ **fallback** æˆ–åœ¨ `Envs` ä¸­æä¾› `SGLANG_NSA_DISABLE_FAST` ä¹‹ç±»çš„ä¸´æ—¶å¼€å…³ï¼Œä»¥é˜²æ­¢ç”Ÿäº§ç¯å¢ƒè¢«ç¡¬æŒ‚ã€‚  
2. **æµ‹è¯•è¦†ç›–**ï¼šé‡ç‚¹è¦†ç›– `quant_k_cache`ã€`dequant_k_cache`ã€`topk_transform` ä¸‰å¤§è·¯å¾„ï¼Œç¡®ä¿åœ¨ `torch.float16/bfloat16`ã€`fp8` KVâ€‘cache ä¸‹çš„æ•°å€¼æ­£ç¡®æ€§å’Œæ€§èƒ½æå‡ã€‚  
3. **æ–‡æ¡£ä¸æ—¥å¿—**ï¼šæ–‡æ¡£å·²æ›´æ–°ï¼Œä½†ä»£ç ä¸­ä»æœ‰å°‘é‡æ—§åï¼ˆå¦‚ `NSA_` å‰ç¼€çš„å¸¸é‡æ®‹ç•™ï¼‰ï¼Œè¯·ç»Ÿä¸€ä¸º `SGLANG_NSA_`ï¼Œé¿å…ç”¨æˆ·åœ¨æºç æœç´¢æ—¶äº§ç”Ÿæ··æ·†ã€‚  
4. **ç›‘æ§**ï¼šåœ¨ `nsa_backend.py` ä¸­ä¿ç•™ `print_nsa_bool_env_vars`ï¼ˆæˆ–ä½¿ç”¨æ—¥å¿—ï¼‰ä»¥ä¾¿åœ¨å¯åŠ¨æ—¶å¿«é€ŸéªŒè¯ç¯å¢ƒå˜é‡å®é™…å€¼ï¼Œå¸®åŠ©å®šä½å›  env è¯¯è®¾å¯¼è‡´çš„å¼‚å¸¸è¡Œä¸ºã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ç®€åŒ–äº† NSAï¼ˆDSAï¼‰åç«¯çš„é…ç½®è·¯å¾„ï¼Œæå‡äº†é»˜è®¤æ€§èƒ½ï¼Œä½†éœ€ç¡®ä¿åœ¨æ‰€æœ‰ç›®æ ‡ç¡¬ä»¶ä¸Š fast å®ç°å¯é ï¼Œä¸”æä¾›å›é€€æˆ–è­¦å‘Šæœºåˆ¶ï¼Œä»¥é™ä½æ½œåœ¨çš„å…¼å®¹æ€§é£é™©ã€‚

---

### fix:-remove-performance-testing-from-nightly-dpsk-v32-cp-single-node-16582
**SHA**: `5c04088` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/5c04088b3a6b0ccae3992a11daec3424a789407d)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ `test/registered/8-gpu-models/test_deepseek_v32_cp_single_node.py` ä¸­ç§»é™¤å¯¹ `PerformanceTestParams` çš„å¯¼å…¥ï¼Œå¹¶å°†è¯¥æµ‹è¯•çš„ `performance_params` è®¾ä¸º `None`ï¼Œä»è€Œå–æ¶ˆåœ¨ nightly CI ä¸­å¯¹ DeepSeekâ€‘V32â€‘CP å•èŠ‚ç‚¹æ¨¡å‹çš„æ€§èƒ½åŸºå‡†è·‘åˆ†ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- å—å½±å“çš„ä»…ä¸º CI/æµ‹è¯•å±‚ä»£ç ï¼Œç‰¹åˆ«æ˜¯ `sglang/test/registered/8-gpu-models` ä¸‹çš„è¯¥æ–‡ä»¶ã€‚  
- è¿è¡Œæ—¶åº“ä»£ç ã€æ¨¡å‹å®ç°åŠå…¶å®ƒä¸šåŠ¡é€»è¾‘ä¸å—å½±å“ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. ç¡®è®¤ `run_combined_tests` èƒ½æ­£ç¡®å¤„ç† `performance_params=None`ï¼Œé¿å…å› ç©ºæŒ‡é’ˆå¯¼è‡´çš„å¼‚å¸¸ã€‚  
2. æœ¬æ¬¡ç§»é™¤å¯èƒ½å¯¼è‡´æ€§èƒ½å›å½’å¤±å»ç›‘æ§ï¼Œå»ºè®®åœ¨å…¶ä»– CIï¼ˆå¦‚æ¯æ—¥æˆ–æ¯å‘¨ï¼‰ä¿ç•™ç›¸åŒæ€§èƒ½æµ‹è¯•ï¼Œæˆ–åœ¨æäº¤è¯´æ˜ä¸­æ ‡æ˜åŸå› ã€‚  
3. æœ¬åœ°è°ƒè¯•æ—¶è‹¥ä»æƒ³è·‘æ€§èƒ½åŸºå‡†ï¼Œå¯æ‰‹åŠ¨æ¢å¤ `PerformanceTestParams` å¹¶æŒ‡å®š `batch_sizes`ã€‚  
4. æ›´æ–° CI æ–‡æ¡£æˆ–æ³¨é‡Šï¼Œè¯´æ˜è¯¥æµ‹è¯•å·²ä» nightly ä¸­å‰”é™¤ï¼Œé˜²æ­¢åç»­ç»´æŠ¤è€…è¯¯ä»¥ä¸ºé—æ¼ã€‚  

æ€»ä½“é£é™©ä½ï¼Œä¸»è¦æ˜¯ CI è¿è¡Œæ—¶é•¿å’Œèµ„æºå ç”¨å¾—åˆ°ä¼˜åŒ–ï¼Œä»£ç è·¯å¾„æœªæ”¹å˜ã€‚è¯·åœ¨åˆå¹¶å‰è·‘ä¸€éå®Œæ•´çš„å•å…ƒ/å‡†ç¡®åº¦æµ‹è¯•ï¼Œç¡®ä¿ `None` å‚æ•°å¤„ç†æ— è¯¯ã€‚

---

### diffusion-fix:-fix-ZImage-SP-sharding-for-5D-latents-and-unpad-frames-16418
**SHA**: `f066036` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/f066036c8bac1970209551e1acfafc545af4bbd6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / Bugä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. ä¸º ZImage æµç¨‹æ–°å¢å¯¹ 5 ç»´ latentï¼ˆ`[B, C, T, H, W]`ï¼‰çš„ SP åˆ†ç‰‡ä¸åˆå¹¶æ”¯æŒï¼Œé¿å…åœ¨å¤šå¸§ï¼ˆvideoâ€‘likeï¼‰æƒ…å½¢ä¸‹å‡ºç°ç»´åº¦ä¸åŒ¹é…çš„é”™è¯¯ã€‚  
2. åœ¨åå¤„ç†é˜¶æ®µåŠ å…¥å¯¹ `raw_latent_shape` çš„è£å‰ªï¼ˆunpadï¼‰ï¼Œå¹¶åœ¨å¸§æ•°å¤§äº 1 æ—¶ç›´æ¥è¿”å›ç¬¬ä¸€å¸§ï¼Œä»¥å…¼å®¹å½“å‰ä»…æ”¯æŒå•å¸§è¾“å‡ºçš„å®ç°ã€‚  
3. åœ¨æ€§èƒ½åŸºå‡†æ–‡ä»¶ä¸­åŠ å…¥ `zimage_image_t2i_2_gpus` çš„é¢„æœŸæ—¶å»¶ï¼›å¹¶åœ¨æµ‹è¯•ç”¨ä¾‹é…ç½®ä¸­åŠ å…¥å¯¹åº”çš„ä¸¤å¡è¿è¡Œé…ç½®ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/multimodal_gen/configs/pipeline_configs/zimage.py`ï¼ˆæ ¸å¿ƒç®¡çº¿é€»è¾‘ï¼‰  
- æ€§èƒ½åŸºå‡† JSON ä¸æµ‹è¯•ç”¨ä¾‹é…ç½®ï¼ˆ`perf_baselines.json`ã€`testcase_configs.py`ï¼‰  
- ä¾èµ– `PipelineConfig.shard_latents_for_sp` / `gather_latents_for_sp` çš„å…¶ä»–å¤šæ¨¡æ€æ¨¡å‹ï¼ˆè‹¥å¤ç”¨è¯¥åŸºç±»ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§æ£€æŸ¥**ï¼š`shard_latents_for_sp` ä¸ `gather_latents_for_sp` ç°åœ¨åœ¨ 5â€‘D æƒ…å½¢ä¸‹ç›´æ¥è°ƒç”¨ `PipelineConfig` å®ç°ï¼Œç¡®ä¿è¯¥å®ç°èƒ½å¤Ÿæ­£ç¡®å¤„ç† `batch` ä¿¡æ¯ï¼ˆå°¤å…¶æ˜¯ `batch.raw_latent_shape`ï¼‰ã€‚è‹¥å…¶ä»–æ¨¡å‹ä»ä½¿ç”¨ 4â€‘D latentsï¼Œä¿æŒç°æœ‰ `super()` è°ƒç”¨å³å¯ã€‚  
2. **æ–‡æ¡£ä¸æ³¨é‡Š**ï¼šåœ¨ `zimage.py` æ·»åŠ ç®€è¦æ³¨é‡Šï¼Œè¯´æ˜ä½•æ—¶ä¼šå‡ºç° 5â€‘D latentsã€ä¸ºä½•éœ€è¦è£å‰ªå¸§æ•°ä»¥åŠè¿”å›å•å¸§çš„ä¸šåŠ¡å‡è®¾ï¼Œé¿å…åç»­ç»´æŠ¤äº§ç”Ÿè¯¯è§£ã€‚  
3. **å•å…ƒ/é›†æˆæµ‹è¯•**ï¼šè¡¥å……é’ˆå¯¹å¤šå¸§ latentï¼ˆä¾‹å¦‚ 2â€‘3 å¸§ï¼‰è¾“å…¥çš„å›å½’æµ‹è¯•ï¼ŒéªŒè¯åˆ†ç‰‡ã€åˆå¹¶ä»¥åŠ `post_denoising_loop` çš„æ­£ç¡®æ€§ï¼Œé˜²æ­¢éšè—çš„ç»´åº¦é”™ä½ã€‚  
4. **æ€§èƒ½åŸºå‡†éªŒè¯**ï¼šç¡®è®¤æ–°å¢çš„åŸºå‡†æ•°æ®ä¸å®é™…äºŒå¡éƒ¨ç½²ç»“æœç›¸ç¬¦ï¼Œè‹¥å‡ºç°è¾ƒå¤§åå·®éœ€æ£€æŸ¥ `ulysses_degree=2` ä¸åˆ†ç‰‡å®ç°æ˜¯å¦äº§ç”Ÿé¢å¤–é€šä¿¡å¼€é”€ã€‚  
5. **å¼‚å¸¸å¤„ç†**ï¼šåœ¨ `post_denoising_loop` ä¸­å¯¹ `raw_latent_shape` ä¸º `None` çš„æƒ…å†µä¿æŒåŸæœ‰è¡Œä¸ºï¼›å¦‚å‡ºç°ä¸ç¬¦åˆé¢„æœŸçš„å¸§æ•°ï¼ˆä¾‹å¦‚ `num_frames < raw_latent_shape[2]`ï¼‰ï¼Œå»ºè®®æŠ›å‡ºæ˜ç¡®é”™è¯¯æç¤ºï¼Œä»¥ä¾¿å¿«é€Ÿå®šä½é—®é¢˜ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨è§£å†³äº† ZImage åœ¨å¤šå¸§ latent åœºæ™¯ä¸‹çš„å´©æºƒé—®é¢˜ï¼Œå¹¶ä¸ºåŒå¡åŠ é€Ÿæä¾›äº†åŸºå‡†éªŒè¯ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨åˆ†ç‰‡/åˆå¹¶è·¯å¾„çš„å…¼å®¹æ€§ï¼Œå»ºè®®åœ¨å¤šæ¨¡æ€æ¨¡å‹ä¸Šåšä¸€æ¬¡ smokeâ€‘testã€‚

---

### Migrate-profiling-tests-to-test/registered/profiling/-16459
**SHA**: `52de807` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/52de807dd7670d403810598f0a73d1c10988c62f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆCI æ³¨å†Œä¸æµ‹è¯•ç»„ç»‡ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- å°†åŸæœ‰çš„ profiling ç›¸å…³å•å…ƒæµ‹è¯•ï¼ˆ`test_profile_merger*`ã€`test_start_profile`ï¼‰è¿ç§»åˆ° `test/registered/profiling/` ç›®å½•ï¼Œå¹¶åœ¨æ–‡ä»¶å¤´éƒ¨è°ƒç”¨ `register_cuda_ci` / `register_amd_ci`ï¼Œä¸ºä¸åŒç¡¬ä»¶å¹³å°å£°æ˜é¢„ä¼°æ‰§è¡Œæ—¶é—´å’Œ CI åˆ†ç»„ã€‚  
- éšååœ¨ `test/srt/run_suite.py` ä¸­å‰”é™¤è¿™äº›æµ‹è¯•çš„ç¡¬ç¼–ç æ¡ç›®ï¼Œæ”¹ç”±æ³¨å†Œæœºåˆ¶ç»Ÿä¸€ç®¡ç†ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- **æµ‹è¯•æ¡†æ¶**ï¼š`test/srt/run_suite.py`ã€`sglang.test.ci.ci_register`ã€‚  
- **Profiling åŠŸèƒ½**ï¼š`sglang.srt.utils.profile_merger`ã€`sglang.srt.managers.io_struct`ï¼ˆé—´æ¥å—å½±å“ï¼‰ã€‚  
- **CI/CD æµæ°´çº¿**ï¼šæ–°å¢ CUDA ä¸ AMD çš„åˆ†æ”¯è°ƒåº¦ï¼Œå½±å“ Github Actions/è‡ªå»º CI é…ç½®ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **CI æ³¨å†ŒéªŒè¯**ï¼šç¡®ä¿ `register_cuda_ci`ã€`register_amd_ci` åœ¨ CI ç¯å¢ƒä¸­è¢«æ­£ç¡®åŠ è½½ï¼›å¦‚æœ‰è‡ªå®šä¹‰ CI è„šæœ¬ï¼Œéœ€è¦åŒæ­¥æ›´æ–° `suite` åç§°ä¸é¢„ä¼°æ—¶é—´ã€‚  
2. **æœ¬åœ°è°ƒè¯•**ï¼šåœ¨æœ¬åœ°è¿è¡Œ `pytest -q test/registered/profiling/`ï¼Œç¡®è®¤æµ‹è¯•ä»èƒ½è¢«å‘ç°å¹¶é€šè¿‡ï¼›è‹¥å‡ºç° import é”™è¯¯ï¼Œæ£€æŸ¥ `sglang.test.ci` åŒ…çš„ PYTHONPATH é…ç½®ã€‚  
3. **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–°é¡¹ç›®çš„æµ‹è¯•è¿è¡Œè¯´æ˜ï¼Œè¯´æ˜ profiling æµ‹è¯•å·²è¿ç§»è‡³ â€œregisteredâ€ ç›®å½•ï¼Œå¹¶è¯´æ˜å¦‚ä½•é€šè¿‡ `ci_register` æ‰‹åŠ¨åŠ å…¥è‡ªå®šä¹‰å¹³å°ã€‚  
4. **å›å½’æ£€æŸ¥**ï¼šåœ¨ç§»é™¤ `run_suite.py` ä¸­çš„ç¡¬ç¼–ç æ¡ç›®åï¼Œå»ºè®®åœ¨å®Œæ•´çš„ CI æµæ°´çº¿ï¼ˆåŒ…æ‹¬ GPU ä¸ AMD å®ä¾‹ï¼‰ä¸Šæ‰§è¡Œä¸€æ¬¡å…¨é‡å›å½’ï¼Œä»¥é˜²é—æ¼çš„æµ‹è¯•æœªè¢«æ³¨å†Œã€‚  

é€šè¿‡ä¸Šè¿°æªæ–½ï¼Œå¯ç¡®ä¿ profiling æµ‹è¯•åœ¨å¤šç¡¬ä»¶ CI ç¯å¢ƒä¸‹ç¨³å®šæ‰§è¡Œï¼ŒåŒæ—¶ä¿æŒ `run_suite.py` çš„ç®€æ´å¯ç»´æŠ¤æ€§ã€‚

---

### Migrate-attention-unit-tests-to-test/registered/attention/-16465
**SHA**: `70933f3` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/70933f34f173c43e43e1f95c70f9fa1e6d5384ad)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–ï¼ˆæµ‹è¯•è¿ç§» & CI æ³¨å†Œï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. å°†æ³¨æ„åŠ›ç›¸å…³å•å…ƒæµ‹è¯• `test_mamba_unittest.py`ã€`test_swa_unittest.py` ç§»åŠ¨åˆ° `test/registered/attention/` å¹¶åŠ å…¥ CI æ³¨å†Œä»£ç ã€‚  
2. é€šè¿‡ `register_cuda_ci`ï¼ˆä»¥åŠ `register_amd_ci`ï¼‰ä¸ºè¿™äº›æµ‹è¯•è®¾å®šé¢„ä¼°æ—¶é•¿å’Œå¥—ä»¶æ ‡ç­¾ `stage-b-test-small-1-gpu`ã€‚  
3. ä» `test/srt/run_suite.py` çš„æµ‹è¯•åˆ—è¡¨ä¸­åˆ é™¤è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»¥é¿å…é‡å¤æ‰§è¡Œã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `test/registered/attention/` ç›®å½•ä¸‹çš„æµ‹è¯•æ–‡ä»¶ã€‚  
- CI è„šæœ¬ `sglang.test.ci.ci_register` çš„æ³¨å†Œæœºåˆ¶ã€‚  
- `test/srt/run_suite.py` ä¸­çš„æµ‹è¯•è°ƒåº¦é€»è¾‘ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **å¼€å‘è€…**ï¼šç¡®è®¤ `ci_register` ä¸­çš„ `suite` åç§°ä¸ CI é…ç½®ä¿æŒä¸€è‡´ï¼Œé¿å…å› å¥—ä»¶æ ‡è®°é”™è¯¯å¯¼è‡´æµ‹è¯•è¢«é—æ¼æˆ–è¯¯è·‘ï¼›è‹¥æœ‰æ–°å¹³å°ï¼ˆå¦‚ CPUï¼‰éœ€è¡¥å……ç›¸åº” `register_*_ci`ã€‚  
- **CI ç»´æŠ¤**ï¼šæ›´æ–° CI æµæ°´çº¿çš„æµ‹è¯•è¿‡æ»¤è§„åˆ™ï¼Œç¡®ä¿ `stage-b-test-small-1-gpu` èƒ½è¢«è°ƒåº¦åˆ°å¯¹åº”çš„ GPU å®ä¾‹ä¸Šï¼Œå¹¶æ£€æŸ¥é¢„ä¼°æ—¶é•¿æ˜¯å¦ç¬¦åˆå®é™…æ‰§è¡Œæ—¶é—´ï¼Œé˜²æ­¢è¶…æ—¶ã€‚  
- **ç”¨æˆ·/è´¡çŒ®è€…**ï¼šæœ¬æ¬¡æ”¹åŠ¨ä¸å½±å“è¿è¡Œæ—¶åº“åŠŸèƒ½ï¼Œä»…å½±å“æµ‹è¯•è¿è¡Œæ–¹å¼ï¼›è‹¥æœ¬åœ°æ‰‹åŠ¨æ‰§è¡Œ `pytest`ï¼Œè¯·æ³¨æ„æ–°è·¯å¾„ `test/registered/attention/` å·²è¢«åŠ å…¥é»˜è®¤æµ‹è¯•é›†ã€‚  

æ€»ä½“ä¸Šï¼Œæ­¤æ¬¡è¿ç§»æå‡äº†æµ‹è¯•ç»„ç»‡ä¸ CI å¯è§†åŒ–ï¼Œä½†éœ€åŒæ­¥ CI é…ç½®ä»¥ä¿è¯æ–°æ³¨å†Œçš„æµ‹è¯•è¢«æ­£ç¡®è°ƒåº¦ã€‚

---

### model-gateway-extract-header-extraction-in-policy-and-add-16566
**SHA**: `3be1e73` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/3be1e734eec1d5ac5fbc8391140cccffbf086fb1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆæå– Header é€»è¾‘ç»Ÿä¸€åŒ–ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `sgl-model-gateway` ä¸­æ–°å¢ `header_utils.rs`ï¼Œç»Ÿä¸€å°è£… â€œx-smgâ€‘targetâ€‘workerâ€ ä¸ â€œx-smgâ€‘routing-keyâ€ çš„è§£æå·¥å…· `extract_target_worker`ã€`extract_routing_key`ã€‚  
2. `ConsistentHashingPolicy` ä¸ `ManualPolicy` æ”¹ä¸ºè°ƒç”¨ä¸Šè¿°å·¥å…·ï¼Œå»æ‰å„è‡ªé‡å¤çš„ Header è¯»å–å®ç°ã€‚  
3. åŒæ—¶åˆ é™¤äº†åŸå…ˆåœ¨ä¸¤ä¸ªç­–ç•¥æ–‡ä»¶ä¸­å¯¹ `http::header::HeaderName` çš„å±€éƒ¨å£°æ˜ï¼Œæ”¹ä¸ºç»Ÿä¸€å¼•ç”¨ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/src/policies/consistent_hashing.rs`  
- `sgl-model-gateway/src/policies/manual.rs`  
- æ–°å¢ `sgl-model-gateway/src/routers/header_utils.rs`ï¼ˆä»¥åŠå…¶å•å…ƒæµ‹è¯•ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **ä»£ç å®¡æŸ¥**ï¼šç¡®è®¤ `extract_header_value` åªè¿”å›éç©ºå­—ç¬¦ä¸²ï¼Œé¿å…å› ç©ºå€¼å¯¼è‡´çš„è¯¯è·¯ç”±ï¼›æ£€æŸ¥ `HeaderName` çš„é™æ€å®ä¾‹æ˜¯å¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®‰å…¨ï¼ˆå·²æ˜¯ `static`ï¼Œåº”æ— é—®é¢˜ï¼‰ã€‚  
- **æ€§èƒ½**ï¼šæ–°å·¥å…·ä»…åšä¸€æ¬¡ `HeaderMap` æŸ¥æ‰¾å’Œä¸€æ¬¡ `to_str`ï¼Œä¸åŸå®ç°æŒå¹³ï¼Œä¸”å‡å°‘äº†ä»£ç é‡å¤ï¼Œç»´æŠ¤æˆæœ¬ä¸‹é™ã€‚  
- **å…¼å®¹æ€§**ï¼šè‹¥å¤–éƒ¨æ¨¡å—ç›´æ¥ä½¿ç”¨æ—§çš„ `HEADER_*` å¸¸é‡ï¼Œéœ€è¦æ›´æ–°ä¸º `header_utils` ä¸­çš„å…¬å¼€å‡½æ•°ï¼›å»ºè®®åœ¨ `mod.rs` ä¸­é‡æ–°å¯¼å‡º `extract_*` ä¾›å¤–éƒ¨è°ƒç”¨ã€‚  
- **æµ‹è¯•**ï¼šæ–°å¢çš„å•å…ƒæµ‹è¯•è¦†ç›–äº†ç©ºå€¼ã€ç¼ºå¤±ã€`None` ä¸‰ç±»æƒ…å†µï¼Œå»ºè®®åœ¨ CI ä¸­ä¿æŒè¯¥æ–‡ä»¶çš„è¦†ç›–ç‡ï¼›è‹¥åç»­å¢åŠ æ–°çš„è·¯ç”± Headerï¼Œè¯·åŒæ­¥æ›´æ–° `header_utils`ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æŠ½å–æå‡äº†ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¯¹è¿è¡Œæ—¶è¡Œä¸ºæ— å½±å“ï¼Œé£é™©ä½ã€‚ ğŸš€

---

### fix:-fill-a-meaningful-tool_index-16504
**SHA**: `913b688` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/913b688f21fa2cb380713c879216d53f3eb4f651)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ `srt/function_call/base_format_detector.py` ä¸­ï¼Œå°† `ToolCallItem.tool_index` çš„é»˜è®¤å ä½å€¼ `-1` æ›¿æ¢ä¸º `tool_indices.get(name, -1)`ï¼Œä½¿å¾—åœ¨è§£æåŸºäº JSON çš„å‡½æ•°è°ƒç”¨æ—¶èƒ½å¤Ÿè‡ªåŠ¨å¡«å…¥å¯¹åº”å·¥å…·åœ¨ `tools` åˆ—è¡¨ä¸­çš„çœŸå®ä¸‹æ ‡ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `python/sglang/srt/function_call/` ç›¸å…³æ¨¡å—ï¼ˆå°¤å…¶æ˜¯ BaseFormatDetector çš„è§£æé€»è¾‘ï¼‰  
- ä»»ä½•ä¾èµ– `ToolCallItem.tool_index` æ¥å®šä½å…·ä½“å·¥å…·çš„ä¸Šå±‚ä¸šåŠ¡ï¼Œå¦‚å‡½æ•°è°ƒç”¨è°ƒåº¦ã€æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. ç¡®è®¤ `tool_indices` åœ¨è°ƒç”¨ `parse_base_json` å‰å·²æ­£ç¡®æ„å»ºï¼ˆkey ä¸ºå·¥å…·åç§°ï¼Œvalue ä¸ºä¸‹æ ‡ï¼‰ï¼Œå¦åˆ™ä»ä¼šå¾—åˆ° `-1`ï¼Œå¯èƒ½å¯¼è‡´åç»­å®šä½å¤±æ•ˆã€‚  
2. è‹¥ä¸šåŠ¡æ–¹åŸæœ¬ä¾èµ–æ‰‹åŠ¨åœ¨å¤–éƒ¨è¡¥å…¨ `tool_index`ï¼Œéœ€æ£€æŸ¥æ˜¯å¦ä»éœ€è¦æ­¤æ­¥éª¤ï¼Œä»¥å…äº§ç”Ÿé‡å¤èµ‹å€¼æˆ–å†²çªã€‚  
3. è¿è¡Œå®Œæ•´å•å…ƒæµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠå¤šå·¥å…·è°ƒç”¨çš„åœºæ™¯ï¼Œç¡®ä¿ä¸‹æ ‡å¡«å……æ­£ç¡®ä¸”ä¸ä¼šå¼•å…¥æ„å¤–çš„ `KeyError`ã€‚  
4. å¦‚æœ‰è‡ªå®šä¹‰ `Tool` å®ç°ï¼Œä¿è¯å…¶ `name` ä¸ `tool_indices` é”®ä¿æŒä¸€è‡´ã€‚  

æ­¤æ”¹åŠ¨æå‡äº†å·¥å…·è°ƒç”¨çš„å¯è¿½æº¯æ€§ï¼Œé™ä½äº†ä¸Šå±‚ä»£ç çš„ç»´æŠ¤æˆæœ¬ï¼Œå»ºè®®åœ¨ä¸‹ä¸€ä¸ªå‘å¸ƒå‘¨æœŸä¸­åŒæ­¥æ›´æ–°ç›¸å…³æ–‡æ¡£è¯´æ˜ã€‚

---

### fix:-adjusting-vlm-accuracy-thresholds-16593
**SHA**: `951d16c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/951d16c8902849bee460d6cad4f16f1b00709d3d)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤ï¼ˆè°ƒæ•´ VLM è¯„ä¼°é˜ˆå€¼ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æ­¤æ¬¡æäº¤åªä¿®æ”¹äº† `test/registered/eval/test_vlms_mmmu_eval.py` ä¸­å¯¹è‹¥å¹²æ¨¡å‹çš„æœŸæœ› `ModelEvalMetrics`ï¼ˆå‡†ç¡®ç‡â€¯/â€¯è€—æ—¶ï¼‰æ•°å€¼ã€‚ä¸»è¦æ˜¯æŠŠæ—§çš„é˜ˆå€¼å¾®è°ƒä¸ºæ›´è´´åˆæœ€æ–°æ¨¡å‹è¡¨ç°çš„æ•°å€¼ï¼ˆå¦‚ InternVL2_5â€‘2B çš„è€—æ—¶ä» 17.0 â†’ 18.0ï¼ŒMiniCPMâ€‘oâ€‘2_6 çš„è€—æ—¶ä» 29.3 â†’ 29.5 ç­‰ï¼‰ï¼Œå¹¶å¯¹ Qwen2.5â€‘VLâ€‘7Bâ€‘Instructã€unsloth/Mistralâ€‘Smallâ€‘3.1â€‘24Bâ€‘Instructâ€‘2503 ç­‰æ¨¡å‹çš„å‡†ç¡®ç‡åšç»†å¾®ä¸‹è°ƒã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- **æµ‹è¯•å±‚**ï¼š`test_vlms_mmmu_eval.py` ä¸å…¶å¼•ç”¨çš„è¯„ä¼°åŸºå‡†æ•°æ®ã€‚  
- **CI æµæ°´çº¿**ï¼šæ‰€æœ‰è¿è¡Œè¯¥æµ‹è¯•çš„ CI ç¯å¢ƒä¼šå—åˆ°å½±å“ï¼ŒåŸæœ‰çš„ â€œfailure â†’ successâ€ è½¬å˜å¯èƒ½å¯¼è‡´å†å²çš„ CI è®°å½•ä¸å†å¯æ¯”ã€‚  
- **æ–‡æ¡£/READMEï¼ˆè‹¥æœ‰ï¼‰**ï¼šè‹¥æ–‡æ¡£ä¸­åˆ—ä¸¾äº†ç›¸åŒçš„é˜ˆå€¼ï¼Œéœ€è¦åŒæ­¥æ›´æ–°ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **éªŒè¯é˜ˆå€¼æ¥æº**ï¼šç¡®è®¤è¿™äº›æ•°å€¼æ˜¯åŸºäºæœ€æ–°çš„æ¨¡å‹è¯„æµ‹æŠ¥å‘Šï¼Œé¿å…å› è¯¯å·®å¯¼è‡´æµ‹è¯•è¯¯åˆ¤ã€‚  
2. **ä¿æŒä¸€è‡´æ€§**ï¼šå¦‚é¡¹ç›®æ–‡æ¡£ã€benchmark æŠ¥å‘Šæˆ–å…¶ä»–è¯„ä¼°è„šæœ¬é‡Œå‡ºç°ç›¸åŒçš„é˜ˆå€¼ï¼Œè¯·åŒæ­¥æ›´æ–°ï¼Œé˜²æ­¢ä¿¡æ¯ä¸ä¸€è‡´ã€‚  
3. **å›å½’æ£€æŸ¥**ï¼šè¿è¡Œå®Œæ•´çš„è¯„ä¼°å¥—ä»¶ï¼Œç¡®ä¿ä»…æœ¬æ–‡ä»¶çš„é˜ˆå€¼å˜æ›´æœªæ„å¤–å½±å“å…¶ä»–è¯„æµ‹ï¼ˆå¦‚äº¤å‰å¼•ç”¨çš„å‡½æ•°æˆ–æ•°æ®ç»“æ„ï¼‰ã€‚  
4. **å†å²å…¼å®¹**ï¼šå¦‚æœéœ€è¦ä¿ç•™å¯¹æ—§é˜ˆå€¼çš„å…¼å®¹æ€§ï¼Œå¯è€ƒè™‘åœ¨æµ‹è¯•ä¸­åŠ å…¥æ³¨é‡Šæˆ– `# TODO` æ ‡è®°ï¼Œè¯´æ˜è¯¥é˜ˆå€¼çš„æ›´æ–°æ—¶é—´å’Œä¾æ®ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€é¡¹ä½é£é™©çš„å›å½’ä¿®æ­£ï¼Œä¸»è¦å½±å“æµ‹è¯•é€šè¿‡ç‡ã€‚åªè¦ç¡®è®¤æ–°é˜ˆå€¼ä¸å®é™…æ¨¡å‹è¡¨ç°åŒ¹é…ï¼Œå¹¶åœ¨æ–‡æ¡£ä¸­åšå¥½åŒæ­¥è¯´æ˜ï¼Œå³å¯å¹³ç¨³åˆå¹¶ã€‚

---

### Migrate-FP8/TorchAO-tests-to-test/registered/quant/-16453
**SHA**: `90eac38` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/90eac38a12973231388f12f23055f0262aeff603)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / é‡æ„ï¼ˆæµ‹è¯•ç”¨ä¾‹è¿ç§»ä¸ CI æ³¨å†Œç»Ÿä¸€ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤å°† FP8ã€TorchAOã€ä»¥åŠå…¶ä»–é‡åŒ–ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶ç»Ÿä¸€è¿ç§»åˆ° `test/registered/quant/` ç›®å½•ï¼Œå¹¶é€šè¿‡ `ci_register` ä¸ºæ¯ä¸ªæµ‹è¯•æ·»åŠ  `register_cuda_ci / register_amd_ci` å…ƒæ•°æ®ã€‚ç›¸åº”åœ°ï¼ŒCI å·¥ä½œæµ `.github/workflows/pr-test-amd.yml` ç§»é™¤ç›´æ¥è°ƒç”¨ `test_eval_fp8_accuracy.py` çš„æ­¥éª¤ï¼Œ`test/srt/run_suite.py` ä¹Ÿåˆ æ‰äº†è¿™äº›æµ‹è¯•çš„æ‰‹å·¥åˆ—å…¥ã€‚æ•´ä½“ç›®æ ‡æ˜¯è®©é‡åŒ–æµ‹è¯•åªåœ¨æ³¨å†Œçš„ CI é˜¶æ®µæ‰§è¡Œï¼Œé¿å…åœ¨æ™®é€šæäº¤è·‘å®Œå…¨éƒ¨æµ‹è¯•å¯¼è‡´èµ„æºæµªè´¹ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- CI é…ç½® (`.github/workflows/pr-test-amd.yml`)  
- æµ‹è¯•æ³¨å†Œæ¨¡å— `sglang.test.ci.ci_register`ï¼ˆæ–°å¢/ä¿®æ”¹è°ƒç”¨ï¼‰  
- å¤šä¸ªé‡åŒ–ç›¸å…³æµ‹è¯•æ–‡ä»¶ï¼ˆ`test_eval_fp8_accuracy.py`, `test_fp8_kernel.py`, `test_fp8_utils.py`, `test_torchao.py` ç­‰ï¼‰  
- `test/srt/run_suite.py` ä¸­çš„æµ‹è¯•å¥—é›†åˆå¹¶åˆ—è¡¨  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **CI å¯é æ€§**ï¼šç¡®è®¤ `register_*_ci` åœ¨ CI å¯åŠ¨æ—¶èƒ½å¤Ÿæ­£ç¡®è§£æå¹¶è°ƒåº¦å¯¹åº”çš„æµ‹è¯•ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´è¿™äº›æµ‹è¯•è¢«é—æ¼ã€‚å»ºè®®åœ¨ CI æ—¥å¿—ä¸­æ˜¾å¼æ‰“å°æ³¨å†Œä¿¡æ¯ã€‚  
2. **æœ¬åœ°è°ƒè¯•**ï¼šè¿ç§»åæœ¬åœ° `pytest` ä»èƒ½ç›´æ¥è¿è¡Œè¿™äº›æ–‡ä»¶å—ï¼Ÿè‹¥åªèƒ½é€šè¿‡æ³¨å†Œå…¥å£æ‰§è¡Œï¼Œéœ€åœ¨å¼€å‘æ–‡æ¡£ä¸­è¡¥å……è¯´æ˜ã€‚  
3. **å…¼å®¹æ€§**ï¼šAMD ä¸ CUDA çš„æ³¨å†Œæ ‡è®°ä¸åŒï¼Œç¡®ä¿å¯¹åº”çš„ç¡¬ä»¶ç¯å¢ƒå·²åœ¨ CI ä¸­é…ç½®ï¼ˆå¦‚ `SGLANG_USE_AITER`ã€HIP ç¯å¢ƒå˜é‡ï¼‰ã€‚  
4. **å¥—ä»¶æ—¶é•¿**ï¼šæ–°å¢çš„ `est_time` è¾ƒå¤§ï¼ˆå¦‚ FP8 250~303 ç§’ï¼‰ï¼Œè¯·å…³æ³¨ CI è¶…æ—¶æˆ–èµ„æºå ç”¨æ˜¯å¦ä¼šå½±å“å…¶å®ƒ PRã€‚å¯ä»¥è€ƒè™‘æ‹†åˆ†ä¸ºæ›´ç»†çš„å­å¥—ä»¶æˆ–æä¾› `--skip-fp8` ç­‰é€‰é¡¹ã€‚  
5. **å›æ»šè·¯å¾„**ï¼šå¦‚æœæ³¨å†Œæœºåˆ¶å‡ºç°é—®é¢˜ï¼Œä¿ç•™åŸå§‹ `test/srt/run_suite.py` ä¸­çš„æ¡ç›®ä½œä¸ºä¸´æ—¶å›é€€æ‰‹æ®µã€‚  

æ•´ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†é‡åŒ–æµ‹è¯•çš„ç»„ç»‡ä¸€è‡´æ€§ä¸ CI è°ƒåº¦çµæ´»æ€§ï¼Œä½†éœ€ç¡®ä¿æ³¨å†Œæœºåˆ¶åœ¨æ‰€æœ‰å¹³å°ä¸Šå¯é ï¼Œé¿å…å› æµ‹è¯•æ¼è·‘æˆ– CI è¶…æ—¶å¯¼è‡´å›å½’é£é™©ã€‚

---

### Tiny-support-http-headers-in-bench-serving-16606
**SHA**: `d874c8b` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d874c8bba4c2d2e5d65c1b95e005bffff7dbf980)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- ä¸º `bench_serving` æ·»åŠ  `--header` å‚æ•°ï¼Œæ”¯æŒåœ¨åŸºå‡†è¯·æ±‚ä¸­è‡ªå®šä¹‰ HTTP Headerï¼ˆKey=Value å½¢å¼ï¼‰ã€‚  
- æ–°å¢ `parse_custom_headers` ä¸ `get_request_headers` ä¸¤ä¸ªå·¥å…·å‡½æ•°ï¼Œå®ç°è§£æå¹¶åˆå¹¶ç”¨æˆ·è‡ªå®šä¹‰ Header ä¸èº«ä»½è®¤è¯ Headerã€‚  
- ç›¸å…³è¯·æ±‚è·¯å¾„ï¼ˆ`/v1/models`, `/generate`, `/chat/completions`, `/trt-llm` ç­‰ï¼‰ç»Ÿä¸€ä½¿ç”¨ `get_request_headers`ã€‚  
- å•å…ƒæµ‹è¯•ä¸­åŠ å…¥ `HeaderEchoHandler`ï¼ŒéªŒè¯è‡ªå®šä¹‰ Header èƒ½æ­£ç¡®éšè¯·æ±‚å‘é€è‡³æœåŠ¡å™¨ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/bench_serving.py`ï¼ˆæ ¸å¿ƒè¯·æ±‚æ„é€ é€»è¾‘ï¼‰  
- `python/sglang/test/test_utils.py`ï¼ˆåŸºå‡†å‚æ•°æ„é€ ï¼‰  
- `test/registered/bench_fn/test_bench_serving_functionality.py`ï¼ˆæ–°å¢åŠŸèƒ½æµ‹è¯•ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‚æ•°éªŒè¯**ï¼šå½“å‰ `parse_custom_headers` å¯¹ç¼ºå¤± `=` æˆ–ç©ºé”®çš„æƒ…å†µç®€å•å¿½ç•¥ï¼Œå»ºè®®åœ¨ CLI ä¸­åŠ å…¥æ›´å‹å¥½çš„é”™è¯¯æç¤ºï¼Œé˜²æ­¢ç”¨æˆ·è¯¯å†™å¯¼è‡´ Header ä¸¢å¤±ã€‚  
2. **å®‰å…¨æ€§**ï¼šè‡ªå®šä¹‰ Header å¯èƒ½è¢«ç”¨äºæ³¨å…¥æ•æ„Ÿä¿¡æ¯ï¼Œç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯¹ `--header` å‚æ•°è¿›è¡Œæƒé™æˆ–å†…å®¹å®¡è®¡ã€‚  
3. **å…¼å®¹æ€§**ï¼š`get_auth_headers` ä»ä¿ç•™ç‹¬ç«‹å®ç°ï¼Œè‹¥åç»­æ‰©å±•å…¶ä»–å…¨å±€ Headerï¼ˆå¦‚ tracingï¼‰ï¼Œå¯è€ƒè™‘ç»Ÿä¸€åˆ° `get_request_headers` ä¸­ï¼Œé¿å…é—æ¼ã€‚  
4. **æµ‹è¯•å¯é æ€§**ï¼šå½“å‰æµ‹è¯•æ•è·å¼‚å¸¸åç›´æ¥ `pass`ï¼Œå¯èƒ½æ©ç›–çœŸå®é”™è¯¯ã€‚å»ºè®®åœ¨ `except` ä¸­è®°å½•æ—¥å¿—æˆ–æ–­è¨€ï¼Œä»¥ä¿è¯ CI å¤±æ•ˆæ—¶èƒ½è¢«æ„ŸçŸ¥ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†åŸºå‡†æµ‹è¯•çš„çµæ´»æ€§ï¼Œå½±å“èŒƒå›´å±€é™åœ¨è¯·æ±‚å±‚å’Œç›¸åº”æµ‹è¯•ï¼Œé£é™©è¾ƒä½ã€‚åªè¦æ³¨æ„è¾“å…¥æ ¡éªŒå’Œæ—¥å¿—è®°å½•ï¼Œä¾¿å¯å®‰å…¨åˆå…¥ä¸»çº¿ã€‚

---

### Tiny-add-metrics-for-prefill-delayer-16603
**SHA**: `9a21d89` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/9a21d89c5ba9d00c7db8b565a58d5937608e55cf)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆä¸º PrefillDelayer å¢åŠ ç›‘æ§æŒ‡æ ‡ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `PrefillDelayer` ä¸­åŠ å…¥ `_DelayInfo` æ•°æ®ç»“æ„ï¼Œç”¨äºè®°å½•å»¶è¿Ÿæ¬¡æ•°ã€èµ·å§‹æ—¶é—´ï¼Œå¹¶åœ¨å»¶è¿Ÿç»“æŸæ—¶å‘ `SchedulerMetricsCollector` ä¸ŠæŠ¥ `forward_passes`ã€`wait_seconds` ä¸è¶…æ—¶è®¡æ•°ã€‚  
2. `Scheduler` åˆ›å»º `PrefillDelayer` æ—¶æ³¨å…¥å¯é€‰çš„ `metrics_collector`ã€‚  
3. `SchedulerMetricsCollector` æ–°å¢ä¸‰ä¸ª Prometheus æŒ‡æ ‡ï¼ˆä¸¤ä¸ªç›´æ–¹å›¾ã€ä¸€ä¸ªè®¡æ•°å™¨ï¼‰ï¼Œå¹¶å®ç° `observe_prefill_delayer_wait` æ¥å£ã€‚  
4. å•å…ƒæµ‹è¯•åŠ å…¥å¯¹æŒ‡æ ‡é¡µé¢çš„æ£€æŸ¥ä¸æ‰“å°ï¼Œç¡®ä¿å¼€å¯/å…³é—­ `prefill_delayer` æ—¶å¯¹åº”æŒ‡æ ‡çš„å‡ºç°ä¸å¦ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/managers/prefill_delayer.py`  
- `python/sglang/srt/managers/scheduler.py`  
- `python/sglang/srt/metrics/collector.py`  
- `test/srt/test_prefill_delayer.py`

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å¯é€‰ä¾èµ–å®‰å…¨**ï¼š`PrefillDelayer` åœ¨æœªä¼ å…¥ `metrics_collector` æ—¶ä»ä¼šåœ¨ `_record_metrics` ä¸­æ£€æŸ¥ `self._metrics_collector`ï¼Œè¿™å·²æ»¡è¶³ç©ºæŒ‡é’ˆå®‰å…¨ï¼Œå»ºè®®åœ¨æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜è¯¥å‚æ•°ä¸ºå¯é€‰ã€‚  
2. **å¹¶å‘/çº¿ç¨‹å®‰å…¨**ï¼š`_curr_delay_info` ä¸ºå®ä¾‹å±æ€§ï¼Œè‹¥åŒä¸€ `PrefillDelayer` å¯èƒ½è¢«å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨ï¼ˆå¦‚å¤š GPU åˆ†ç‰‡ï¼‰ï¼Œéœ€ç¡®è®¤ä¸ä¼šå‡ºç°ç«äº‰å†™å…¥ï¼›å¯è€ƒè™‘ä½¿ç”¨ `threading.local` æˆ–åœ¨è°ƒåº¦å™¨å±‚é¢ç¡®ä¿å•çº¿ç¨‹ä½¿ç”¨ã€‚  
3. **æŒ‡æ ‡æ¡¶é…ç½®**ï¼š`prefill_delayer_wait_forward_passes` çš„ bucket `[5, 20, max_delay_passes - 1]` å‡è®¾ `max_delay_passes > 21`ï¼Œå¦åˆ™ä¼šå‡ºç°å€’åºæˆ–è´Ÿå€¼æ¡¶ã€‚å»ºè®®åœ¨åˆå§‹åŒ–æ—¶å¯¹ `max_delay_passes` åšä¸‹é™æ ¡éªŒæˆ–åŠ¨æ€ç”Ÿæˆåˆç† bucketã€‚  
4. **è¶…æ—¶åˆ¤å®š**ï¼šç›®å‰ `is_timeout = global_mixed_prefillable`ï¼Œå³åªè¦å‡ºç°æ··åˆå¯prefill å³è§†ä¸ºè¶…æ—¶ã€‚è‹¥åç»­æ”¹åŠ¨æ”¹å˜åˆ¤å®šé€»è¾‘ï¼Œéœ€è¦åŒæ­¥æ›´æ–° `_record_metrics` ä¸­çš„ `is_timeout` å«ä¹‰ã€‚  
5. **æµ‹è¯•å¯é æ€§**ï¼šæµ‹è¯•ä¸­é€šè¿‡ç¯å¢ƒå˜é‡ `SGLANG_TEST_WORLD_SIZE` æ§åˆ¶ TP/DP å¤§å°ï¼Œç¡®ä¿åœ¨ CI ç¯å¢ƒä¸‹è¯¥å˜é‡è¢«è®¾ç½®ï¼Œå¦åˆ™ä¼šå‡ºç°é»˜è®¤ 8 ä½†å®é™…èµ„æºä¸è¶³çš„æƒ…å†µã€‚å¯åœ¨ CI è„šæœ¬ä¸­æ˜¾å¼å£°æ˜ã€‚  
6. **æŒ‡æ ‡å¯¼å‡ºè·¯å¾„**ï¼š`_print_prefill_delayer_metrics` ç›´æ¥è¯·æ±‚ `/{base_url}/metrics` å¹¶è§£ææ–‡æœ¬ï¼Œè‹¥åç»­æ·»åŠ å‰ç¼€æˆ–å‹ç¼©è¾“å‡ºï¼Œéœ€åŒæ­¥æ›´æ–°æ­¤æ£€æŸ¥ä»£ç ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ”¹åŠ¨ä¸º PrefillDelayer å¢åŠ äº†æœ‰ä»·å€¼çš„å¯è§‚æµ‹æ€§ï¼Œä»£ç ç»“æ„æ¸…æ™°ä¸”å¯¹å·²æœ‰åŠŸèƒ½å½±å“æœ€å°ã€‚åªéœ€ç•™æ„å¹¶å‘å®‰å…¨ä¸ bucket åˆç†æ€§ï¼Œå³å¯æŠ•å…¥ä¸»çº¿ã€‚

---

### routeropenai-Rename-`prepare_mcp_payload_for_streaming`-and-`patch_stream...
**SHA**: `fb5b71d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/fb5b71d015a24ea1786c10b1d41a5b36fd12d0de)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / è½»é‡åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°† MCP å·¥å…·åœ¨ payload ä¸­çš„è½¬æ¢å‡½æ•° `prepare_mcp_payload_for_streaming` é‡å‘½åä¸º `prepare_mcp_tools_as_functions`ï¼Œå¹¶ç»Ÿä¸€è¯¥å‡½æ•°åœ¨æµå¼ä¸éæµå¼è·¯å¾„çš„è°ƒç”¨ï¼›åŒæ—¶æŠŠåŸæ¥ä»…ç”¨äºæµå¼çš„ `patch_streaming_response_json` æ”¹åä¸ºæ›´é€šç”¨çš„ `patch_response_with_request_metadata`ï¼Œå¹¶åœ¨æ‰€æœ‰è¿”å›å¤„ç†å¤„ä½¿ç”¨ï¼Œä»¥ä¿è¯åŸå§‹è¯·æ±‚çš„ `previous_response_idã€instructionsã€metadataã€storeã€modelã€safety_identifier` ç­‰å­—æ®µåœ¨æœ€ç»ˆå“åº”ä¸­è¢«ä¿ç•™ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/src/routers/openai/responses/mcp.rs`ï¼ˆå‡½æ•°ç­¾åæ›´æ”¹ï¼‰  
- `sgl-model-gateway/src/routers/openai/responses/streaming.rs`ã€`non_streaming.rs`ï¼ˆæ‰€æœ‰è°ƒç”¨ç‚¹æ”¹åï¼‰  
- `sgl-model-gateway/src/routers/openai/responses/utils.rs`ï¼ˆå®ç°æ”¹åå¹¶è¡¥å……æ³¨é‡Šï¼Œæ‰©å±•è¡¥ä¸å­—æ®µï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§æ£€æŸ¥**ï¼šè‹¥å¤–éƒ¨ä»£ç ç›´æ¥å¼•ç”¨æ—§å‡½æ•°åï¼ˆä¾‹å¦‚è‡ªå®šä¹‰æ’ä»¶æˆ–ç›‘æ§è„šæœ¬ï¼‰ï¼Œå°†å› ç¬¦å·æœªå¯¼å‡ºè€Œç¼–è¯‘å¤±è´¥ã€‚å»ºè®®åœ¨ `mod.rs` ä¸­ä¿ç•™ `pub(super) fn prepare_mcp_payload_for_streaming` çš„åˆ«åæˆ–åœ¨æ–‡æ¡£ä¸­æ˜ç¡®è¿ç§»è·¯å¾„ã€‚  
2. **å•å…ƒ/é›†æˆæµ‹è¯•**ï¼šæ–°å¢çš„å­—æ®µè¡¥ä¸é€»è¾‘æœªå˜æ›´åŸæœ‰è¡Œä¸ºï¼Œä½†åº”é€šè¿‡å›å½’æµ‹è¯•éªŒè¯åœ¨å¤šç§è¯·æ±‚ç»„åˆï¼ˆæœ‰/æ—  `store`ã€ä¸åŒ `model`ï¼‰ä¸‹å“åº”ä»ç¬¦åˆ OpenAI æ¥å£çº¦å®šã€‚  
3. **æ—¥å¿—/ç›‘æ§**ï¼š`patch_response_with_request_metadata` ç°åœ¨å¤„ç†æ›´å¤šå­—æ®µï¼Œè‹¥åç»­æ·»åŠ æ–°å…ƒæ•°æ®ï¼Œè®°å¾—åŒæ­¥æ›´æ–°æ­¤å‡½æ•°ï¼Œä»¥å…é—æ¼ã€‚  
4. **ä»£ç å¯è¯»æ€§**ï¼šå‡½æ•°åå·²æ›´å…·è¯­ä¹‰ï¼Œå»ºè®®åœ¨æ³¨é‡Šä¸­ä¿ç•™æ—§åç§°çš„å†å²è¯´æ˜ï¼Œå¸®åŠ©åç»­ç»´æŠ¤è€…å¿«é€Ÿå®šä½æ”¹åŠ¨ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†ä»£ç è¯­ä¹‰ä¸€è‡´æ€§ï¼Œå¯¹åŠŸèƒ½æ²¡æœ‰å®è´¨å½±å“ï¼Œåªéœ€æ³¨æ„å¯¹å¤–éƒ¨è°ƒç”¨çš„è¿ç§»å’Œå®Œæ•´çš„å›å½’æµ‹è¯•ã€‚

---

### routergrpc-Replace-`Vec<String,-String,-String>`-with-`ExtractedToolCal...
**SHA**: `05b54b6` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/05b54b6d7bde70f5a46e228b48f92f1614efc906)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆç±»å‹å®‰å…¨æå‡ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
å°†åŸå…ˆåœ¨å·¥å…·è°ƒç”¨æµç¨‹ä¸­ä½¿ç”¨çš„ `Vec<(String,String,String)>` æ›¿æ¢ä¸ºä¸“ç”¨ç»“æ„ä½“ `ExtractedToolCall { call_id, name, arguments }`ï¼Œå¹¶åœ¨ `common.rs`ã€`non_streaming.rs`ã€`streaming.rs` ä¸­ç›¸åº”æ›´æ–°æå–ã€åˆ†ç¦»ã€éå†ã€è®°å½•åŠäº‹ä»¶æ„é€ çš„ä»£ç ï¼Œä½¿å·¥å…·è°ƒç”¨çš„è¯­ä¹‰æ›´æ˜ç¡®ã€å¯è¯»æ€§æ›´é«˜ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/src/routers/grpc/regular/responses/common.rs`ï¼ˆæ–°å¢ `ExtractedToolCall`ã€è¿”å›ç±»å‹æ”¹åŠ¨ï¼‰  
- `sgl-model-gateway/src/routers/grpc/regular/responses/non_streaming.rs`ï¼ˆåˆ†åŒºã€éå†ã€æ—¥å¿—ã€åº¦é‡ä»¥åŠ `ToolLoopState::record_call` å‚æ•°æ”¹ä¸ºç»“æ„ä½“å­—æ®µï¼‰  
- `sgl-model-gateway/src/routers/grpc/regular/responses/streaming.rs`ï¼ˆåŒä¸Šï¼Œæ¶‰åŠæµå¼äº‹ä»¶çš„æ„é€ ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **ç¼–è¯‘æ£€æŸ¥**ï¼šç¡®è®¤æ‰€æœ‰ `use` è¯­å¥å·²åŠ å…¥ `ExtractedToolCall`ï¼Œå¹¶ä¸”æ—§çš„ `(String,String,String)` å…ƒç»„å·²ä¸å†è¢«è¯¯ç”¨ã€‚  
2. **å•å…ƒ/é›†æˆæµ‹è¯•**ï¼šè¿è¡Œå·¥å…·è°ƒç”¨ç›¸å…³çš„æµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯å¹¶è¡Œå·¥å…·è°ƒç”¨å’Œæµå¼å“åº”åœºæ™¯ï¼Œç¡®ä¿åˆ†åŒºã€è®°å½•å’Œäº‹ä»¶é¡ºåºä¿æŒä¸å˜ã€‚  
3. **æ—¥å¿—/åº¦é‡**ï¼šæ—¥å¿—ä¿¡æ¯å·²æ”¹ä¸ºä½¿ç”¨ç»“æ„ä½“å­—æ®µï¼Œæ£€æŸ¥æ—¥å¿—æ ¼å¼æ˜¯å¦ä»æ»¡è¶³æ—§ç‰ˆç›‘æ§çš„æ­£åˆ™åŒ¹é…ã€‚  
4. **æ–‡æ¡£/æ³¨é‡Š**ï¼šåœ¨ `common.rs` ä¸º `ExtractedToolCall` æ·»åŠ æ–‡æ¡£æ³¨é‡Šï¼Œè¯´æ˜å…¶åœ¨ MCP ä¸ Function tool è°ƒç”¨ä¸­çš„è§’è‰²ï¼Œå¸®åŠ©åç»­ç»´æŠ¤ã€‚  
5. **å‘åå…¼å®¹**ï¼šå¦‚æœå¤–éƒ¨ä»£ç ä»ä¾èµ– `extract_all_tool_calls_from_chat` è¿”å›å…ƒç»„ï¼Œå»ºè®®ä¿ç•™ä¸€ä¸ªå…¼å®¹åŒ…è£…å‡½æ•°æˆ–åœ¨ `CHANGELOG` ä¸­æ³¨æ˜æ¥å£å·²å˜æ›´ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†ç±»å‹å®‰å…¨å’Œå¯è¯»æ€§ï¼Œé£é™©ä¸»è¦åœ¨æ¥å£å˜æ›´å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯æˆ–ç›‘æ§æŠ¥è­¦ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥å¯¹åº”çš„å…¼å®¹æ€§æ£€æŸ¥ã€‚

---

### ci:-migrate-scheduler-tests-to-test/registered/scheduler/-16442
**SHA**: `399d528` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/399d5283f8a3eae7619be079b7edeb44b534fdae)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šCIâ€¯ç›¸å…³ï¼ˆæµ‹è¯•ç»„ç»‡/æ³¨å†Œï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°†ä¸€æ‰¹è°ƒåº¦å™¨ç›¸å…³çš„å•å…ƒæµ‹è¯•è¿ç§»åˆ° `test/registered/scheduler/`ï¼Œå¹¶åœ¨æ¯ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­é€šè¿‡ `register_cuda_ci` / `register_amd_ci` å£°æ˜ç¡®åˆ‡çš„ CI è¿è¡Œæ—¶é—´ä¸å¥—ä»¶æ ‡ç­¾ï¼›ç›¸åº”åœ°åœ¨ `test/srt/run_suite.py` ä¸­åˆ é™¤äº†è¿™äº›æµ‹è¯•çš„ç¡¬ç¼–ç æ¡ç›®ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- **æµ‹è¯•å­ç³»ç»Ÿ**ï¼š`test/registered/scheduler/*`ã€`test/srt/run_suite.py`ã€`sglang.test.ci.ci_register`ã€‚  
- **CI é…ç½®**ï¼šCUDA/AMD CI è°ƒåº¦å™¨ä¾èµ–çš„æ³¨å†Œä¿¡æ¯ã€‚  
- **å¯èƒ½çš„è¿è¡Œæ—¶ä¾èµ–**ï¼šä»»ä½•é€šè¿‡ `run_suite.py` æ‰‹åŠ¨æŒ‡å®šå¥—ä»¶çš„è„šæœ¬æˆ– CI pipelineã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **ä¿è¯ç›®å½•è¢«æ­£ç¡®æ‰«æ**ï¼šCI è„šæœ¬éœ€é€’å½’æœç´¢ `test/registered/**`ï¼Œå¦åˆ™æ–°åŠ å…¥çš„è°ƒåº¦å™¨æµ‹è¯•ä¼šè¢«é—æ¼ã€‚å¯åœ¨ CI æ–‡æ¡£æˆ– `run_suite.py` ä¸­æ·»åŠ æ³¨é‡Šè¯´æ˜ã€‚  
2. **ç»Ÿä¸€æ—¶é—´ä¼°ç®—**ï¼š`est_time` å‚æ•°åº”ä¸ `run_suite.py` ä¸­çš„å†å²æ—¶é—´ä¿æŒå¤§è‡´ä¸€è‡´ï¼Œé˜²æ­¢ CI è¶…æ—¶æˆ–èµ„æºæµªè´¹ã€‚  
3. **å…¼å®¹æ€§æ£€æŸ¥**ï¼šåœ¨é CI æœ¬åœ°è¿è¡Œæ—¶ï¼Œç¡®ä¿ `register_*` è°ƒç”¨ä¸ä¼šå› ç¼ºå°‘ç¯å¢ƒå˜é‡è€ŒæŠ›å¼‚å¸¸ï¼ˆç›®å‰æ˜¯è£…é¥°å™¨æ–¹å¼ï¼Œå»ºè®®æ•è·å¼‚å¸¸æˆ–åœ¨ `if is_in_ci` ä¸­è°ƒç”¨ï¼‰ã€‚  
4. **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–° README / CONTRIBUTING ä¸­çš„ â€œCI è¿è¡Œå¥—ä»¶â€ ç« èŠ‚ï¼Œåˆ—å‡º `test/registered/scheduler` æ‰€åœ¨è·¯å¾„åŠå¯¹åº”å¥—ä»¶æ ‡ç­¾ã€‚  
5. **å›å½’éªŒè¯**ï¼šåœ¨ CI ä¸Šæ‰§è¡Œæ‰€æœ‰ `stage-b-test-small-1-gpu*` å¥—ä»¶ï¼Œç¡®è®¤åŸå…ˆåœ¨ `run_suite.py` é‡Œçš„æµ‹è¯•ä»æŒ‰é¢„æœŸé€šè¿‡ï¼Œä¸”æ–°å¢æ³¨å†Œä¸ä¼šå¯¼è‡´é‡å¤æ‰§è¡Œã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†æµ‹è¯•çš„å¯æ³¨å†ŒåŒ–ä¸å¹³å°åˆ†å±‚ï¼Œä½†éœ€ç¡®ä¿ CI å‘ç°æœºåˆ¶å’Œæœ¬åœ°è¿è¡Œå…¼å®¹ï¼Œä»¥å…å‡ºç°æµ‹è¯•ç¼ºå¤±æˆ–è¯¯æŠ¥ã€‚

---

### Add-v1/models-endpoint-to-diffusion-model-APIs-so-that-they-can-be-discovered...
**SHA**: `18e2ef0` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/18e2ef09d7e712ce4c14f4722b5d4b10967de0f6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. å°†åŸ `/models` æ¥å£æ ‡è®°ä¸º deprecatedï¼Œå¢åŠ æ–‡æ¡£æç¤ºä½¿ç”¨æ–°ç‰ˆ `/v1/models`ã€‚  
2. åœ¨ `openai/common_api.py` ä¸­å®ç° OpenAIâ€‘compatible çš„ `/v1/models` ä¸ `/v1/models/{model}` ä¸¤ä¸ªå…¥å£ï¼Œè¿”å› `DiffusionModelCard`ï¼Œæºå¸¦ GPU æ•°é‡ã€ä»»åŠ¡ç±»å‹ã€ç²¾åº¦ã€pipeline åç§°ç­‰æ‰©å±•å­—æ®µã€‚  
3. ä¸ºæ–°æ¥å£è¡¥å…… ORJSON å“åº”ã€é”™è¯¯å¤„ç†ä»¥åŠå®Œæ•´çš„å•å…ƒæµ‹è¯•ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- **http_server**ï¼šæ—§æ¥å£ä»å¯ä½¿ç”¨ä½†ä¼šåœ¨æœªæ¥è¢«ç§»é™¤ã€‚  
- **openai API å±‚**ï¼šæ–°å¢è·¯ç”±ã€æ¨¡å‹å¡ç»“æ„åŠåºåˆ—åŒ–é€»è¾‘ã€‚  
- **æµ‹è¯•å¥—ä»¶**ï¼šå¯¹æ¨¡å‹å‘ç°æ¥å£çš„è¦†ç›–ç‡å¤§å¹…æå‡ã€‚  
- **ä¾èµ–**ï¼šå¢åŠ  `orjson`ï¼ˆå·²æ˜¯é¡¹ç›®ä¾èµ–ï¼‰å’Œ `ModelCard` çš„ importã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- ä¸šåŠ¡æ–¹åº”å°½å¿«è¿ç§»åˆ° `/v1/models`ï¼Œé¿å…åœ¨åç»­ç‰ˆæœ¬ä¸­å› æ—§æ¥å£åˆ é™¤å¯¼è‡´æœåŠ¡ä¸­æ–­ã€‚  
- æ£€æŸ¥é›†ç¾¤éƒ¨ç½²çš„ `server_args.pipeline_config` æ˜¯å¦å®Œæ•´ï¼Œä»¥å…åœ¨è¿”å›å­—æ®µæ—¶æŠ›å‡ºå±æ€§é”™è¯¯ã€‚  
- å¦‚æœ‰è‡ªå®šä¹‰ API æ–‡æ¡£æˆ– SDKï¼Œéœ€åŒæ­¥æ›´æ–° OpenAPI schemaï¼ˆ`deprecated=True` ä¼šåœ¨ Swagger ä¸­æ ‡è®°ï¼‰ã€‚  
- å…³æ³¨ `orjson` åºåˆ—åŒ–å…¼å®¹æ€§ï¼Œç¡®ä¿è¿è¡Œç¯å¢ƒå·²è£…ç›¸åº”åº“ã€‚  
- è¿è¡Œ CI æ—¶ä¿æŒ `run_suite.py` çš„æ–‡ä»¶é™åˆ¶é€»è¾‘ï¼Œä»¥é˜²å› æ–°å¢æµ‹è¯•å¯¼è‡´å…¨ä»“åº“æ‰«æã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸ºæ¨¡å‹ç½‘å…³æä¾›äº†æ ‡å‡†åŒ–çš„å‘ç°æ¥å£ï¼Œå…¼å®¹æ€§è‰¯å¥½ï¼Œå”¯ä¸€æ³¨æ„ç‚¹æ˜¯åŠæ—¶åˆ‡æ¢åˆ°æ–°ç‰ˆè·¯å¾„å¹¶éªŒè¯ `pipeline_config` çš„å®Œæ•´æ€§ã€‚

---

### fix:-kimi-k2-thinking-accuracy-threshold-change-16585
**SHA**: `5349764` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/53497642985aa1184cfa63378612b6db10599782)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°† Kimiâ€‘K2â€‘Thinking æ¨¡å‹çš„å‡†ç¡®ç‡é˜ˆå€¼ä» 0.95 é™è‡³ 0.94ï¼Œé˜²æ­¢å› é˜ˆå€¼è¿‡é«˜å¯¼è‡´æµ‹è¯•è¯¯æŠ¥å¤±è´¥ã€‚  
**ğŸ¯ å½±å“èŒƒå›´**ï¼š`test/registered/8-gpu-models/test_kimi_k2.py` åŠå…¶å…³è”çš„ CI è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **é˜ˆå€¼æ¥æº**ï¼šç¡®è®¤ 0.94 æ˜¯åŸºäºæœ€æ–°æ¨¡å‹è¯„æµ‹å¾—åˆ°çš„çœŸå®åŸºçº¿ï¼Œé¿å…æŠŠå®é™…æ€§èƒ½å›é€€çš„é”™è¯¯å½“ä½œ â€œé€šè¿‡â€ã€‚  
2. **å›å½’é£é™©**ï¼šæœ¬æ¬¡ä»…ä¿®æ”¹æµ‹è¯•å‚æ•°ï¼Œä¸å½±å“è¿è¡Œæ—¶é€»è¾‘ï¼Œä½† CI é€šè¿‡ç‡ä¼šéšé˜ˆå€¼å˜åŒ–è€Œæ³¢åŠ¨ã€‚å»ºè®®åœ¨æœ¬åœ°è·‘å®Œæ•´å¥— `run_combined_tests`ï¼ŒéªŒè¯æ‰€æœ‰å­é¡¹ä»æ»¡è¶³æœŸæœ›ã€‚  
3. **æ–‡æ¡£åŒæ­¥**ï¼šè‹¥é¡¹ç›®æ–‡æ¡£æˆ–å‘å¸ƒè¯´æ˜ä¸­æåˆ° Kimiâ€‘K2â€‘Thinking çš„å‡†ç¡®ç‡åŸºå‡†ï¼ŒåŠæ—¶æ›´æ–°å¯¹åº”æ•°å€¼ã€‚  
4. **åç»­ç›‘æ§**ï¼šæ¨¡å‹è‹¥å†æ¬¡æå‡ï¼Œå¯åœ¨ä¸‹ä¸ªé‡Œç¨‹ç¢‘é‡æ–°è¯„ä¼°é˜ˆå€¼ï¼›è‹¥å‡ºç°é€€åŒ–ï¼Œåˆ™éœ€è¦å›æ»šæˆ–ä¿®å¤æ¨¡å‹æœ¬èº«ï¼Œè€Œä¸æ˜¯ä»…è°ƒä½é˜ˆå€¼ã€‚  

æ€»ä½“é£é™©ä½ï¼Œä¸»è¦æ˜¯ç¡®ä¿ CI çš„é€šè¿‡æ ‡å‡†ä¸å®é™…æ¨¡å‹è¡¨ç°ä¿æŒä¸€è‡´ã€‚

---

### citest:-migrate-OpenAI-server-tests-to-registered-CI-system-16326
**SHA**: `0cbd8f3` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/0cbd8f3247b94fadfd9c6ba6861fcbb9dd4b47c6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šCI é‡æ„ / åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤å°† OpenAI Server ç³»åˆ—æµ‹è¯•è¿ç§»è‡³ç»Ÿä¸€çš„ CI æ³¨å†Œæœºåˆ¶ã€‚æ‰€æœ‰ `test/registered/openai_server/**` ä¸‹çš„ç”¨ä¾‹æ–°å¢ `register_cuda_ci` / `register_amd_ci` è°ƒç”¨ï¼Œå¹¶åœ¨ `test/srt/run_suite.py` ä¸­åˆ é™¤äº†å¯¹è¿™äº›ç”¨ä¾‹çš„ç¡¬ç¼–ç åˆ—è¡¨ã€‚ä¸æ­¤åŒæ—¶ï¼Œ`pynccl_allocator.py` ä¸­çš„ `torch.utils.cpp_extension` å¯¼å…¥ä½ç½®å¾®è°ƒï¼Œé˜²æ­¢åœ¨æœªä½¿ç”¨æ—¶æå‰åŠ è½½ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- æµ‹è¯•æ¡†æ¶ï¼š`test/registered/openai_server/*`ã€`test/srt/run_suite.py`  
- è®¾å¤‡åˆ†é…å·¥å…·ï¼š`python/sglang/srt/distributed/device_communicators/pynccl_allocator.py`  
- CI ç¯å¢ƒï¼šCUDA ä¸ AMD ä¸¤ç±»ç¡¬ä»¶çš„æµ‹è¯•è°ƒåº¦é€»è¾‘ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **CI æ³¨å†Œæœ‰æ•ˆæ€§**ï¼šç¡®è®¤ `register_*_ci` å‚æ•°ï¼ˆ`est_time`ã€`suite`ã€`disabled`ï¼‰åœ¨æ–°ç‰ˆ CI ç³»ç»Ÿä¸­è¢«æ­£ç¡®è§£æï¼Œé¿å…å› æ—¶é—´ä¼°ç®—æˆ– suite åä¸åŒ¹é…å¯¼è‡´è°ƒåº¦å¤±è´¥ã€‚  
2. **è·¨å¹³å°å…¼å®¹**ï¼šå¯¹ AMD å—é™çš„æµ‹è¯•ï¼ˆå¦‚ hiddenâ€‘statesï¼‰å·²åŠ  `disabled` æ³¨é‡Šï¼Œåç»­éœ€è·Ÿè¿›å¯¹åº” Issue #11127ï¼Œé˜²æ­¢è¯¯æŠ¥ã€‚  
3. **å¯¼å…¥é¡ºåº**ï¼š`pynccl_allocator.py` ä¸­çš„å»¶è¿Ÿå¯¼å…¥å·²è§£å†³æ½œåœ¨çš„é‡å¤åŠ è½½é—®é¢˜ï¼Œå»ºè®®è¿è¡Œå®Œæ•´çš„å•å…ƒæµ‹è¯•ç¡®ä¿æœªå¼•å…¥æ–°çš„ import å¾ªç¯ã€‚  
4. **æ—§åˆ—è¡¨æ¸…ç†**ï¼š`run_suite.py` å·²å»é™¤å¯¹åº”æ¡ç›®ï¼Œç¡®ä¿ CI ä¸å†ä½¿ç”¨æ‰‹åŠ¨ç»´æŠ¤çš„å®éªŒåˆ—è¡¨ï¼Œåç»­å¦‚æ–°å¢æµ‹è¯•è¯·ä»…é€šè¿‡æ³¨å†Œå‡½æ•°åŠ å…¥ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨å¯¹åŠŸèƒ½æ— ç›´æ¥å½±å“ï¼Œä¸»è¦æå‡ CI å¯ç»´æŠ¤æ€§ä¸è·¨ç¡¬ä»¶è°ƒåº¦çš„çµæ´»æ€§ã€‚è¯·åœ¨ CI ç¯å¢ƒä¸‹å®Œæ•´è·‘ä¸€éæ‰€æœ‰ suiteï¼ŒéªŒè¯æ³¨å†Œä¸è¿è¡Œæ—¶é•¿ç¬¦åˆé¢„æœŸã€‚

---

### fix:-adding-retries-for-server-start-and-increasing-hf-read-timeout-16523
**SHA**: `6e3fff1` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/6e3fff13521df33de34597c025ae6f7d9740cdd6)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ GitHub Actions çš„ Nightlyâ€‘testâ€‘NVIDIA å·¥ä½œæµä¸­æ–°å¢ä¸¤ä¸ªç¯å¢ƒå˜é‡ `HF_HUB_DOWNLOAD_TIMEOUT=300` ä¸ `HF_HUB_ETAG_TIMEOUT=300`ï¼Œå°† HuggingFace Hub çš„ä¸‹è½½åŠ ETag æŸ¥è¯¢è¶…æ—¶ä»é»˜è®¤çš„å‡ ç§’æå‡è‡³ 5â€¯åˆ†é’Ÿï¼Œä»¥é¿å…å› ç½‘ç»œæ³¢åŠ¨å¯¼è‡´çš„ CI å¤±æ•ˆã€‚æäº¤ä¿¡æ¯è¿˜æåˆ°ä¸ºæœåŠ¡å™¨å¯åŠ¨åŠ å…¥äº†é‡è¯•æœºåˆ¶ï¼ˆä»£ç æœ¬ä½“å·²åœ¨å…¶ä»–æ–‡ä»¶å®Œæˆï¼‰ï¼Œæœ¬æ¬¡åªåŒæ­¥ CI ç¯å¢ƒçš„è¶…æ—¶é…ç½®ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `.github/workflows/nightly-test-nvidia.yml`ï¼ˆCI è¿è¡Œæ—¶ï¼‰  
- ä»»ä½•åœ¨ CI ä¸­è°ƒç”¨ `huggingface_hub` ä¸‹è½½æ¨¡å‹æˆ–æ£€æŸ¥ç¼“å­˜ ETag çš„æ­¥éª¤ï¼ˆå¦‚ `tests/`ã€ç¤ºä¾‹è„šæœ¬ç­‰ï¼‰ã€‚  
- è‹¥é¡¹ç›®åœ¨æœ¬åœ°æˆ–ç”Ÿäº§ç¯å¢ƒå¤ç”¨ç›¸åŒç¯å¢ƒå˜é‡ï¼Œä¹Ÿä¼šå—æ­¤è¶…æ—¶æå‡å½±å“ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **éªŒè¯é‡è¯•é€»è¾‘**ï¼šç¡®è®¤æœåŠ¡å™¨å¯åŠ¨çš„é‡è¯•å®ç°ä¸ä¼šåœ¨ç½‘ç»œå¼‚å¸¸æ—¶äº§ç”Ÿæ— é™å¾ªç¯æˆ–è¿‡é•¿é˜»å¡ã€‚  
2. **è¶…æ—¶è®¾ç½®åˆç†æ€§**ï¼š300â€¯ç§’çš„è¶…æ—¶å¯¹ CI æœ‰å¸®åŠ©ï¼Œä½†åœ¨æœ¬åœ°å¼€å‘æˆ–ç”Ÿäº§ç¯å¢ƒå¯èƒ½å¯¼è‡´å¼‚å¸¸å¡ä½ï¼Œå»ºè®®åœ¨æ–‡æ¡£ä¸­è¯´æ˜è¯¥å˜é‡çš„ç”¨é€”ï¼Œå¹¶æä¾›å¯è°ƒèŠ‚çš„é»˜è®¤å€¼ã€‚  
3. **CI èµ„æºæ¶ˆè€—**ï¼šæ›´é•¿çš„ä¸‹è½½è¶…æ—¶ä¼šå»¶é•¿ä½œä¸šè¿è¡Œæ—¶é—´ï¼Œè§‚å¯Ÿ nightlyâ€‘testâ€‘NVIDIA çš„è€—æ—¶è¶‹åŠ¿ï¼Œå¿…è¦æ—¶å¯¹å¤§å‹æ¨¡å‹åšç¼“å­˜æˆ–åˆ†ç‰‡ä¸‹è½½ã€‚  
4. **å›å½’æµ‹è¯•**ï¼šè¿è¡Œå®Œæ•´çš„å•å…ƒ/é›†æˆæµ‹è¯•ï¼Œç¡®ä¿åœ¨è¶…æ—¶è¢«è§¦å‘æ—¶ä»èƒ½æ­£å¸¸æ•è·å¼‚å¸¸å¹¶ç»§ç»­åç»­æ­¥éª¤ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº† CI ç¨³å®šæ€§ï¼Œå¯¹æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å½±å“æœ‰é™ï¼Œä½†éœ€æ³¨æ„è¶…æ—¶é…ç½®å¯¹æ•´ä½“æ„å»ºæ—¶é•¿çš„æ½œåœ¨å½±å“ã€‚

---

### ci-fix-url-strips-in-smg-ci-16548
**SHA**: `a3656cb` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/a3656cbb96968fb7df291e8a26c865f460059eac)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šBug ä¿®å¤ï¼ˆCI è„šæœ¬ä¸­ URL å¤„ç†ä¸å½“ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `model_pool.py` ä¸­ï¼Œå°†å¥åº·æ£€æŸ¥æ—¥å¿—ä¸­æ‰“å°çš„åœ°å€ä» `instance.base_url` æ”¹ä¸º `instance.worker_url`ï¼Œé¿å…å› ä¸åŒå®ä¾‹å¯èƒ½ä½¿ç”¨ä¸åŒçš„ URL å‰ç¼€è€Œäº§ç”Ÿè¯¯å¯¼ã€‚  
2. `run_eval.py` ä¸­å¯¹ç”¨æˆ·ä¼ å…¥çš„ `base_url` ç»Ÿä¸€åš `rstrip("/")` å¤„ç†ï¼Œé˜²æ­¢åœ¨åç»­æ‹¼æ¥ `/v1` æ—¶å‡ºç°åŒæ–œæ ã€‚  
3. å¤šä¸ªè·¯ç”±æµ‹è¯•æ–‡ä»¶ï¼ˆ`test_mmlu.py`ã€`test_pd_mmlu.py`ï¼‰å»æ‰äº†åŸå…ˆå¯¹ `client.base_url` çš„ `rstrip("/v1")`ï¼Œç›´æ¥ä½¿ç”¨å®Œæ•´çš„ `client.base_url`ï¼Œé…åˆä¸Šä¸€æ­¥çš„ URL æ ‡å‡†åŒ–ï¼Œç¡®ä¿æµ‹è¯•åœ¨ä¸åŒç¯å¢ƒä¸‹éƒ½èƒ½æ­£ç¡®è®¿é—®ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/e2e_test/infra/`ï¼ˆæ¨¡å‹æ± ç®¡ç†ã€è¯„ä¼°è„šæœ¬ï¼‰  
- `sgl-model-gateway/e2e_test/router/`ï¼ˆMMLUã€PDâ€‘MMLU æµ‹è¯•ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **å…¼å®¹æ€§æ£€æŸ¥**ï¼šç¡®è®¤ `ModelInstance` åœ¨æ‰€æœ‰å¯åŠ¨è·¯å¾„ä¸Šå‡æ‹¥æœ‰ `worker_url` å±æ€§ï¼Œé¿å…å› å±æ€§ç¼ºå¤±å¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸ã€‚  
- **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨ CI è„šæœ¬æˆ–ä½¿ç”¨è¯´æ˜ä¸­æ ‡æ˜ `base_url` ç°åœ¨ä¼šè‡ªåŠ¨å»é™¤å°¾éƒ¨æ–œæ ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨å¤„ç†ã€‚  
- **é¢å¤–å•å…ƒæµ‹è¯•**ï¼šå¯ä»¥æ–°å¢ä¸€ä¸ªé’ˆå¯¹ `run_eval` çš„å°æµ‹è¯•ï¼ŒéªŒè¯ä¼ å…¥ `http://host/` ä¸ `http://host` ä¸¤ç§å½¢å¼å‡ä¼šå¾—åˆ°ç»Ÿä¸€çš„ `http://host/v1`ã€‚  
- **å›å½’éªŒè¯**ï¼šåœ¨æœ¬åœ°æˆ– CI ä¸­å®Œæ•´è·‘ä¸€éæ‰€æœ‰ e2e æµ‹è¯•ï¼Œç¡®ä¿å› ä¸º URL å˜åŠ¨æ²¡æœ‰å¼•å…¥æ–°çš„ç½‘ç»œè¯·æ±‚é”™è¯¯ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡ä¿®æ”¹é€šè¿‡ç»Ÿä¸€ URL è§„èŒƒæå‡äº† CI ç¨³å®šæ€§ï¼Œé£é™©æœ‰é™ï¼Œåªéœ€æ³¨æ„ `worker_url` çš„å®Œæ•´æ€§å¹¶é€‚å½“è¡¥å……æ–‡æ¡£ä¸æµ‹è¯•ã€‚

---

#### ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (22)

### Add-SwapAB-Optimization-for-triton-fused_moe_kernel-on-SM90.-15712
**SHA**: `ee4d228` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/ee4d2287ab64a196adb316255eb768cdf826962a)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„/åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `fused_moe_triton_kernels.py` ä¸­åŠ å…¥ `SwapAB` ä¼˜åŒ–ï¼Œä»…åœ¨æ”¯æŒ SM90 çš„ H20 GPU ä¸Šã€ä¸”ä½¿ç”¨ fp8â€‘w8a8 æ—¶å¯ç”¨ï¼Œé€šè¿‡è½¬ç½®çŸ©é˜µåŠ é€Ÿè®¡ç®—å¹¶æ›´æ–°ç›¸å…³è°ƒç”¨å‚æ•°ã€‚æ–°å¢ `should_enable_swap_ab` ç¼“å­˜å‡½æ•°ä»¥åŠå¯¹åº”çš„é…ç½®ä¼ é€’ã€‚

---

### CI-Enable-dpsk-v31-test-on-nightly-H200-16660
**SHA**: `153c69f` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/153c69f63d6b03bae2a0ae64a7991e8a80c88807)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šç§»é™¤ Blackwell ç³»ç»Ÿæ£€æµ‹ï¼Œå–æ¶ˆå¯¹ B200 çš„é™å®šï¼Œä½¿ DeepSeekâ€‘V3.1 æµ‹è¯•åœ¨ H200 nightly ç¯å¢ƒä¸‹æ‰§è¡Œã€‚

---

### ci:-adding-llama4-placeholder-test-to-nightly-16599
**SHA**: `2ff8723` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2ff872311b4d3e8e5c0416e948dabbe6ff5adf87)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šæ–°å¢ nightlyâ€‘8â€‘gpuâ€‘common å¥—ä»¶çš„ Llamaâ€‘4â€‘Scoutï¼ˆTP=8ï¼‰ç»Ÿä¸€æ€§èƒ½+å‡†ç¡®æ€§æµ‹è¯•è„šæœ¬ã€‚

---

### Tiny-fix-readme-16654
**SHA**: `62d0280` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/62d0280f629cb96a4e57073db353d15eb52eb8d2)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† README ä¸­çš„å¯¼èˆªé“¾æ¥æ”¹ä¸ºå±…ä¸­åŠ ç²—çš„ HTML é“¾æ¥ï¼Œæå‡é¡µé¢æ’ç‰ˆä¸å¯è¯»æ€§ã€‚

---

### Re-enable-temp_prefill_info-assertion-after-pairing-fix-16203
**SHA**: `98a107d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/98a107d491f4cbb6bcbe1bb3f156a35f5d31c4f0)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `scheduler_metrics_mixin.py` ä¸­é‡æ–°å¯ç”¨ `assert self.temp_prefill_info is None`ï¼Œç¡®ä¿åœ¨è®°å½•å‰ç½®ç»Ÿè®¡å‰ä¸´æ—¶ä¿¡æ¯å·²è¢«æ¸…ç©ºï¼Œæ¢å¤åŸå…ˆçš„å®‰å…¨æ£€æŸ¥ã€‚

---

### AMD-suppress-warning-for-amd-16620
**SHA**: `48381c3` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/48381c3b6da092a681798046db89609d2c7bf723)

**å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**æ‘˜è¦**ï¼šåœ¨ `awq.py` ä¸­å°† HIP è­¦å‘Šä»æ¨¡å—å¯¼å…¥å¤„ç§»è‡³ç±»åˆå§‹åŒ–ï¼›åœ¨ `gguf.py` ä¸­ä»…åœ¨é HIP ç¯å¢ƒä¸‹å‘å‡º CUDA é™åˆ¶è­¦å‘Šï¼Œå¹¶åœ¨ HIP ç¯å¢ƒä¸‹é¢å¤–æç¤ºã€‚

---

### AMD-CI---add-2-pp-test-cases-to-performance-test-2-gpu-amd-16514
**SHA**: `8bce085` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/8bce0853216264978c160dec7abae8ce2ad7cbb0)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ AMD CI å·¥ä½œæµä¸­æ–°å¢ä¸¤é¡¹ PP=2 çš„ç¦»çº¿åååŸºå‡†æµ‹è¯•ï¼›ç›¸åº”å•å…ƒæµ‹è¯• `test_pp_long_context_prefill` æ·»åŠ  `--mem-fraction-static` å‚æ•°åœ¨ AMD ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¹¶å°†é˜ˆå€¼ä» 4000 æ”¾å®½è‡³ 3000ã€‚

---

### Doc-Optimize-pipeline-parallelism-doc-16630
**SHA**: `973116e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/973116e6bb2262885ca0ffd0b683a8dc825979f2)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå®Œå–„äº† pipeline parallelism æ–‡æ¡£ï¼ŒåŠ å…¥å¯¹å¤§æ¨¡å‹ã€è¶…é•¿ä¸Šä¸‹æ–‡ä¸‹çš„åŠ¨æ€åˆ†å—é¢„å¡«ã€å¼‚æ­¥å¾®æ‰¹äº‹ä»¶å¾ªç¯ç­‰å®ç°ç»†èŠ‚å’Œè°ƒä¼˜æŒ‡å—ï¼Œæ›´æ–°ç¤ºä¾‹å‘½ä»¤å¹¶ç»†åŒ–å‚æ•°è¯´æ˜ã€‚

---

### Upgrade-aiter-version-16619
**SHA**: `820e97d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/820e97d6c9bf2b906a8e81414db3564412395a27)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `docker/rocm.Dockerfile` ä¸­å°† AITER çš„ç‰ˆæœ¬ä» `v0.1.7.post5` å‡çº§è‡³ `v0.1.9.post1`ï¼Œåˆ†åˆ«åœ¨å…¨é‡æ„å»ºå’Œéå…¨é‡æ„å»ºçš„ç¯å¢ƒå˜é‡ä¸­æ›´æ–°ã€‚

---

### Only-allocate-encoder-metadata-for-encoder-decoder-models-16527
**SHA**: `4c85f9d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4c85f9d039a2d0848e91f06d53d84ceba3e97c49)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `flashattention_backend.py` ä¸­æ–°å¢ `is_encoder_decoder` æ ‡è¯†ï¼Œä»…ä¸º encoderâ€‘decoder æ¨¡å‹åˆ†é… encoder å…ƒæ•°æ®ï¼Œè§£ç å™¨æ¨¡å‹è·³è¿‡æ­¤åˆ†é…ï¼Œå‡å°‘æ— ç”¨å†…å­˜å ç”¨ã€‚

---

### Migrate-backends-tests-to-CI-registration-system-16468
**SHA**: `ce453fa` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/ce453fa43b4a80f0d76e1e3d7497f6bf504c484c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°†åç«¯æµ‹è¯•è¿ç§»è‡³ CI æ³¨å†Œç³»ç»Ÿï¼Œæ–°å¢ `register_cuda_ci`ã€`register_amd_ci` è°ƒç”¨ï¼Œå¹¶åœ¨ `run_suite.py` ä¸­ç§»é™¤æ‰‹åŠ¨åˆ—å‡ºçš„ `test_torch_compile.py`ã€‚

---

### ci:-adjust-partition-counts-for-stage-b-and-unit-tests-16617
**SHA**: `38895a0` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/38895a00642301ea0edd92057b1a23c60d0b4bce)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† CI å·¥ä½œæµä¸­ `stage-b-test-small-1-gpu` çš„è‡ªåŠ¨åˆ†åŒºæ•°ç”± 8 å¢è‡³ 11ï¼Œæ‰©å±•çŸ©é˜µè‡³ 0â€‘10ï¼›åŒæ—¶å°† `per-commit-1-gpu` çš„åˆ†åŒºæ•°ç”± 6 é™è‡³ 2ï¼Œç¼©å‡çŸ©é˜µèŒƒå›´ï¼Œä»…ä¿ç•™ 0ã€1ã€‚æ­¤ä¿®æ”¹ç”¨äºä¼˜åŒ–é˜¶æ®µâ€‘B ä¸å•å…ƒæµ‹è¯•çš„å¹¶è¡Œç²’åº¦ã€‚

---

### VLM-Fix-CUDA-IPC-OOM-16118
**SHA**: `5384674` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/53846746bf76082855ad067912d5e1e9ab544515)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨è°ƒåº¦æ‰¹å¤„ç†æ—¶åˆ é™¤å·²ä¼ è¾“çš„ `pixel_values` é˜²æ­¢ GC å˜æ…¢ï¼›åœ¨å¤šæ¨¡æ€å¤„ç†å™¨ä¸­ä¾æ® `keep_mm_feature_on_device` å°†ç‰¹å¾å’Œé¢„è®¡ç®—åµŒå…¥è½¬å› CPUï¼Œé¿å… CUDA IPC OOMã€‚

---

### HiCacheStorage-&-PD-fix-prefill-bootstrap-request-host-memory-leaks-15439
**SHA**: `534ac38` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/534ac384db14cc382f6e7e813cd44500c9798fbd)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„ï¼ˆbug ä¿®å¤ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `pop_bootstrapped` ä¸­æ–°å¢åœ¨å¯ç”¨ hicache å­˜å‚¨æ—¶è°ƒç”¨ `scheduler.tree_cache.release_aborted_request(req.rid)`ï¼Œé‡Šæ”¾é¢„å–äº‹ä»¶ä»¥è§£å†³é¢„å¡«å¼•å¯¼è¯·æ±‚å¯¼è‡´çš„ä¸»æœºå†…å­˜æ³„æ¼ã€‚

---

### PCG-Unit-Test-Adjustment-16609
**SHA**: `2a8d549` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2a8d5493f3a4c53f5e9ba457234e87d072f2b829)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† CUDA å›¾å•å…ƒæµ‹è¯•ä¸­çš„ç±»åä» `TestPiecewiseCudaGraphFusedMoE` æ”¹ä¸º `TestPiecewiseCudaGraphTP`ï¼Œå¹¶å»é™¤ `--ep-size 2` å‚æ•°ï¼Œä»…ä¿ç•™ `--tp 2`ï¼Œå¯¹åº”æ™®é€š TP åœºæ™¯çš„æµ‹è¯•è°ƒæ•´ã€‚

---

### diffusion-chore:-automatically-enable-dit_layerwise_offload-for-Wan-16499
**SHA**: `badcd02` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/badcd0289623ca18bc56e154bbdc961b789758f1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šæ–°å¢å¯¹ `envs` çš„å¼•ç”¨ï¼Œåœ¨ `check_server_args` ä¸­è‡ªåŠ¨ä¸ºåŒ…å« â€œwanâ€ çš„æµæ°´çº¿å¼€å¯ `dit_layerwise_offload`ï¼ˆå‰ææ˜¯æœªå¯ç”¨ cacheâ€‘ditï¼‰ï¼Œå¹¶ç›¸åº”è°ƒæ•´ç›¸å…³æ£€æŸ¥é€»è¾‘ã€‚

---

### NPU-fix-command-in-npu-best-practice-16576
**SHA**: `4c9ac85` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4c9ac8566cf5fcf000763934456de8c179689043)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `ascend_npu_best_practice.md` ä¸­ä¿®æ­£ NPU ç¤ºä¾‹å‘½ä»¤ï¼Œè°ƒæ•´ `SGLANG_DEEPEP_NUM_MAX_DISPATCH_TOKENS_PER_RANK`ã€`dp-size`ã€`cuda-graph-bs`ã€`HCCL_BUFFSIZE` ç­‰å‚æ•°ï¼Œå¹¶æ–°å¢ `--device npu` ç­‰é€‰é¡¹ï¼Œä»¥æå‡æœ€ä½³å®è·µçš„å‡†ç¡®æ€§ã€‚

---

### model-gatewaycleanup-Fix-wrong-comment-in-manager.rs-16601
**SHA**: `4f443f4` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4f443f445acd0fdaa3afcb993977a215c98f7946)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£ `manager.rs` ä¸­çš„æ³¨é‡Šæ–‡å­—ï¼Œæ˜ç¡®ç”ŸæˆæœåŠ¡å™¨å”¯ä¸€é”®æ˜¯åŸºäºå…¶ `transport` ä¿¡æ¯ã€‚

---

### ci:-migrate-Debug-Utils,-Ops,-and-Rotary-Embedding-tests-to-test/registered/-...
**SHA**: `2e0527d` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2e0527dd743a27b901746bc2ffbe5f11e2bff5dc)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† Debug Utilsã€Opsã€Rotary Embedding ç­‰æµ‹è¯•è¿ç§»è‡³ `test/registered/`ï¼Œå¹¶åœ¨ç›¸åº”æ–‡ä»¶ä¸­åŠ å…¥ CI æ³¨å†Œï¼ˆCUDA/AMDï¼‰ï¼ŒåŒæ—¶ä»åŸæœ‰æµ‹è¯•å¥—ä»¶åˆ—è¡¨ä¸­ç§»é™¤è¿™äº›æ¡ç›®ã€‚

---

### Remove-dllm-test-1-gpu-amd-job-followup-to-DLLM-migration-16589
**SHA**: `3271e0e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/3271e0e76d0e2cb3a43f654179b8af931571741c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `pr-test-amd.yml` ä¸­åˆ é™¤äº† `dllm-test-1-gpu-amd` CI ä½œä¸šï¼Œå¹¶ç›¸åº”ç§»é™¤å…¶åœ¨åç½®æ­¥éª¤ä¸­çš„å¼•ç”¨ï¼Œç®€åŒ– AMD CI æµç¨‹ã€‚

---

### smg-clean-up-logs-in-mcp-should-be-info-instead-warn-16591
**SHA**: `d57d8e7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d57d8e7e5f21c49b195775a90e44aaa1904a7674)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `McpManager` ä¸­ï¼Œå°†â€œæœªè¿æ¥é™æ€ MCP æœåŠ¡å™¨â€ çš„æ—¥å¿—çº§åˆ«ç”± `warn` æ”¹ä¸º `info`ï¼Œä»¥é¿å…ä¸å¿…è¦çš„è­¦å‘Šã€‚

---

### ci:-migrate-DLLM-tests-to-test/registered/dllm/-16420
**SHA**: `2210155` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2210155a45105c6a08ca04f7efcd77f547c8c1e0)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† DLLM æµ‹è¯•è¿ç§»è‡³ `test/registered/dllm/`ï¼Œæ–°å¢ CUDA/AMD CI æ³¨å†Œè£…é¥°ï¼Œåˆ é™¤æ—§è·¯å¾„åœ¨ `run_suite.py` ä¸­çš„å¼•ç”¨ã€‚

---

