# æ¯æ—¥æ›´æ–°æŠ¥å‘Šï¼ˆ2026-02-22ï¼‰

## sgl-project/sglang

| æäº¤æ—¶é—´ | ä½œè€… | æäº¤ä¿¡æ¯ |
|----------|------|----------|
| 2026-02-22 23:18:35 | Mick | [diffusion] refactor: rename quantized model path server arg (#19142) |
| 2026-02-22 20:33:27 | Talor Abramovich | Fix corrupted JSONL metrics file due to concurrent writes (#19011) |
| 2026-02-22 20:26:56 | Baizhou Zhang | [CI]Extend timeout for test_text_models_perf.py (#19155) |
| 2026-02-22 20:02:12 | Mick | [diffusion] CI: relax perf check threshold (#19154) |
| 2026-02-22 19:07:25 | Mick | [diffusion] chore: minor cleanups (#19123) |
| 2026-02-22 16:24:33 | fzyzcjy | Support kwargs and megatron core tensor parsing in dumper (#19138) |
| 2026-02-22 16:20:51 | Ziang Li | [DSv32] [GLM5] Improve Model Quality by Avoiding FP32 Precision Loss in `weights_proj` (#19041) |
| 2026-02-22 16:20:08 | fzyzcjy | Fix wrongly large dumped file and handle non intrusive hook reset in dumper (#19124) |
| 2026-02-22 16:17:41 | fzyzcjy | Enhance reset, states, http in dumper (#19095) |
| 2026-02-22 16:16:15 | fzyzcjy | Support multi colocated dumper, named exp cleanup, argparse config (#19094) |
| 2026-02-22 16:14:27 | fzyzcjy | Configure and call dumper in main SGLang logic (#19093) |
| 2026-02-22 16:13:38 | fzyzcjy | Enhance hook mechanism in dumper (#19073) |
| 2026-02-22 16:10:43 | fzyzcjy | Extract framework plugins in dumper (#19072) |
| 2026-02-22 16:08:48 | fzyzcjy | Auto annotate context in dumper (#19071) |
| 2026-02-22 16:07:45 | fzyzcjy | Support enabling partial non intrusive dump in dumper (#19069) |
| 2026-02-22 16:04:02 | fzyzcjy | Support non-intrusive dumping in dumper (#19068) |
| 2026-02-22 16:03:27 | fzyzcjy | Refactor dumper and change on_forward_pass_start API (#19065) |
| 2026-02-22 14:20:16 | Shangming Cai | [PD] Change bootstrap_room metadata dtype from int64 to uint64 (#19141) |
| 2026-02-22 13:57:17 | YAMY | [Qwen3-Next] Enable fused_qkvzba_split_reshape_cat also for prefill (#18917) |
| 2026-02-22 13:46:15 | Qiaolin Yu | Fix spec v2+dp attention in nsa backend (#19134) |
| 2026-02-22 13:38:56 | Bhavneek Singh | [BUG] [DLLM] Missing max_running_requests value (#18740) |
| 2026-02-22 12:55:28 | fy1214 | [diffusion] quant: adapt FP8 linear to sgld and support quant in flux (#17023) |
| 2026-02-22 12:00:33 | YAMY | [Fix] Quick fix for int32 overflow in Mooncakes' send_kvcache_slice (#19076) |
| 2026-02-22 10:29:31 | Kangyan-Zhou | Fix dev Docker build OOM on ARM64 cu13 by adding docker system prune (#18947) |
| 2026-02-22 07:54:24 | Liangsheng Yin | Revert "[jit kernel] Support per_token_group_quant_8bit jit kernel" (#19131) |
| 2026-02-22 06:30:30 | Liangsheng Yin | [Benchmark] Remove re-exports from bench_serving.py (#19130) |
| 2026-02-22 05:50:11 | Ratish P | [Refactor] Benchmark Phase 1: extract utils and datasets from bench_serving (#19077) |
| 2026-02-22 05:46:01 | Liangsheng Yin | Tiny rename `cuda_graph` tests to `piecewise_cuda_graph` (#19128) |
| 2026-02-22 00:07:16 | Mohammad Miadh Angkad | [FlashInfer] Switch FlashInfer allreduce fusion to unified API (#18341) |

### ğŸ“Š ç»Ÿè®¡æ‘˜è¦
> æœ¬æ—¥å…± 29 ä¸ªæäº¤ | ğŸ”´é«˜ 3 | ğŸŸ¡ä¸­ 17 | ğŸŸ¢ä½ 9
## ğŸ“‹ ç›®å½•

- [sgl-project/sglang](#sgl-project-sglang)
  - [ğŸ“Š ç»Ÿè®¡æ‘˜è¦](#-ç»Ÿè®¡æ‘˜è¦)
  - [ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (3)](#-ğŸ”´-é«˜é‡è¦åº¦å˜æ›´-3)
    - [[diffusion] quant: adapt FP8 linear to sgld and support q...](#ae62898)
    - [Revert "[jit kernel] Support per_token_group_quant_8bit j...](#4653939)
    - [[Refactor] Benchmark Phase 1: extract utils and datasets ...](#f158869)
  - [ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (17)](#-ğŸŸ¡-ä¸­é‡è¦åº¦å˜æ›´-17)
    - [[diffusion] refactor: rename quantized model path server ...](#45095ba)
    - [[diffusion] chore: minor cleanups (#19123)](#8782372)
    - [Support kwargs and megatron core tensor parsing in dumper...](#1a1c768)
    - [[DSv32] [GLM5] Improve Model Quality by Avoiding FP32 Pre...](#eddf193)
    - [Fix wrongly large dumped file and handle non intrusive ho...](#326b788)
    - [Enhance reset, states, http in dumper (#19095)](#c1f497e)
    - [Support multi colocated dumper, named exp cleanup, argpar...](#4091b72)
    - [Configure and call dumper in main SGLang logic (#19093)](#31f0c11)
    - [Enhance hook mechanism in dumper (#19073)](#cc63c99)
    - [Extract framework plugins in dumper (#19072)](#fdf80b5)
    - [Auto annotate context in dumper (#19071)](#e32b536)
    - [Support enabling partial non intrusive dump in dumper (#1...](#8bc0751)
    - [Support non-intrusive dumping in dumper (#19068)](#0384c45)
    - [Refactor dumper and change on_forward_pass_start API (#19...](#5eccc3c)
    - [[Benchmark] Remove re-exports from bench_serving.py (#19130)](#1f2da82)
    - [Tiny rename `cuda_graph` tests to `piecewise_cuda_graph` ...](#3fb457b)
    - [[FlashInfer] Switch FlashInfer allreduce fusion to unifie...](#7b0fb43)
  - [ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (9)](#-ğŸŸ¢-ä½é‡è¦åº¦å˜æ›´-9)
    - [Fix corrupted JSONL metrics file due to concurrent writes...](#c6a99e4)
    - [[CI]Extend timeout for test_text_models_perf.py (#19155)](#1f7a813)
    - [[diffusion] CI: relax perf check threshold (#19154)](#7d4860b)
    - [[PD] Change bootstrap_room metadata dtype from int64 to u...](#eccee4c)
    - [[Qwen3-Next] Enable fused_qkvzba_split_reshape_cat also f...](#5995bfe)
    - [Fix spec v2+dp attention in nsa backend (#19134)](#8cf003c)
    - [[BUG] [DLLM] Missing max_running_requests value (#18740)](#8612358)
    - [[Fix] Quick fix for int32 overflow in Mooncakes' send_kvc...](#cef353f)
    - [Fix dev Docker build OOM on ARM64 cu13 by adding docker s...](#b2d8cc8)
#### ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (3)

### [diffusion] quant: adapt FP8 linear to sgld and support quant in flux (#17023)
**SHA**: `ae62898` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/ae62898ffb3b639c809966949041a642527466e1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / é‡æ„ / æ¶æ„å˜æ›´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤ä¸º SGLang å¼•å…¥å¯¹ **FP8 é‡åŒ–** çš„å…¨é“¾è·¯æ”¯æŒï¼Œä¸»è¦åŒ…æ‹¬  
1. æ–°å¢ FP8 é‡åŒ–é…ç½® `Fp8Config` ä¸å¯¹åº”çš„çº¿æ€§å®ç° `Fp8LinearMethod`ï¼Œå¹¶æŠŠå…¶æ³¨å†Œåˆ°é‡åŒ–æ¡†æ¶ã€‚  
2. æ”¹é€  `ColumnParallelLinear / RowParallelLinear` æ¥å£ï¼Œä½¿å…¶æ¥å— `quant_config`ï¼Œåœ¨æ„é€ æ—¶è‡ªåŠ¨é€‰æ‹© FP8 çº¿æ€§å®ç°ã€‚  
3. åœ¨ `MLP` ä¸ `Flux` æ¨¡å‹ç­‰æ ¸å¿ƒæ¨¡å—ä¸­é€ä¼  `quant_config`ï¼Œå¹¶è¡¥å……äº†ä¸€ä¸ªé€šç”¨çš„ `FeedForward` å®ç°ã€‚  
4. å®Œå–„åŠ è½½é€»è¾‘ï¼šåœ¨ `transformer_loader` ä¸ `hf_diffensors_utils` ä¸­è§£ææ¨¡å‹çš„ `quantization_config`ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ¨¡å‹æ„é€ å‡½æ•°ã€‚  
5. æ–°å¢æ¨¡å‹è½¬æ¢å·¥å…· `convert_hf_to_fp8.py`ï¼Œæ”¯æŒ blockã€channelã€tensor ä¸‰ç§é‡åŒ–æ–¹å¼ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ HF é…ç½®æ–‡ä»¶ã€‚  
6. æ–‡æ¡£è¡¥å…… FP8 ä½¿ç”¨æŒ‡å—ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sglang/multimodal_gen/runtime/layers/*`ï¼ˆlinearã€mlpã€quantizationï¼‰  
- `sglang/multimodal_gen/runtime/models/dits/flux.py`ï¼ˆæ ¸å¿ƒ Transformer ç»“æ„ï¼‰  
- `sglang/multimodal_gen/runtime/loader/*`ï¼ˆtransformer_loaderã€fsdp_loadï¼‰  
- `sglang/multimodal_gen/tools/convert_hf_to_fp8.py`ï¼ˆæ¨¡å‹è½¬æ¢å·¥å…·ï¼‰  
- æ–‡æ¡£ `quantization.md`  

---

### ğŸ” æŠ€æœ¯æ´å¯Ÿ  

| ç»´åº¦ | å½±å“æè¿° |
|------|----------|
| **æ¶æ„å½±å“** | â€¢ **é‡åŒ–æŠ½è±¡å±‚**ï¼šæ–°å¢ `QuantizationConfig` å­ç±» `Fp8Config`ï¼Œå¹¶åœ¨ `LinearMethodBase` ä¸­å®ç° `Fp8LinearMethod`ï¼Œå½¢æˆâ€œé‡åŒ–æ’ä»¶åŒ–â€ã€‚<br>â€¢ **å‚æ•°åŠ è½½**ï¼š`create_weights` æ ¹æ® `is_checkpoint_fp8_serialized` åŠ¨æ€å†³å®šæƒé‡ dtypeï¼ˆ`float8_e4m3fn`ï¼‰å¹¶åˆ›å»ºå¯¹åº”çš„ scale å‚æ•°ï¼ˆå—å¼æˆ– perâ€‘tensorï¼‰ã€‚<br>â€¢ **æ¨¡å‹å±‚çº§**ï¼š`ColumnParallelLinear`ã€`RowParallelLinear` ä»¥åŠ `MLP` ç°åœ¨å¯ä»¥æ¥å— `quant_config`ï¼Œä½¿ FP8 é‡åŒ–å¯¹ç°æœ‰å¹¶è¡Œå®ç°é€æ˜ã€‚<br>â€¢ **åŠ è½½è·¯å¾„**ï¼š`get_quant_config` è´Ÿè´£ä» HF é…ç½®æˆ– `quantization_config` å­—æ®µè¯»å–å¹¶å®ä¾‹åŒ– `Fp8Config`ï¼Œå¹¶åœ¨ `transformer_loader` ä¸­æ³¨å…¥ã€‚<br>â€¢ **åç«¯å…¼å®¹**ï¼šåœ¨ GPU ä¸Šä¼˜å…ˆä½¿ç”¨ CUTLASS/Fp8 kernelï¼›è‹¥ç¡¬ä»¶ä¸æ”¯æŒ FP8ï¼Œåˆ™è‡ªåŠ¨å›é€€ Marlin/DeepGemMï¼›CPU åˆ™å°è¯• Intel AMX åŠ é€Ÿã€‚ |
| **æ€§èƒ½å½±å“** | â€¢ **æ˜¾å­˜/å­˜å‚¨**ï¼šFP8 æƒé‡é‡åŒ–å°†æƒé‡å¤§å°ç¼©å‡è‡³ 1/4ï¼ˆç›¸è¾ƒäº FP16ï¼‰å¹¶åŒæ­¥é™ä½æ¿€æ´»ç¼“å­˜éœ€æ±‚ï¼Œæ˜¾è‘—æå‡å¤§æ¨¡å‹ï¼ˆå¦‚ FLUXï¼‰åœ¨å•å¡ä¸Šçš„å¯è£…è½½æ€§ã€‚<br>â€¢ **è®¡ç®—é€Ÿåº¦**ï¼šåœ¨æ”¯æŒåŸç”Ÿ FP8 çš„ GPUï¼ˆH100ã€Adaï¼‰ä¸Šï¼Œ`apply_fp8_linear` è°ƒç”¨ `torch._scaled_mm`ï¼Œç†è®ºä¸Šå¯è·å¾— ~2Ã— FLOPS æå‡ï¼›åœ¨ä¸æ”¯æŒçš„ GPU ä¸Šä½¿ç”¨ Marlin/DeepGemMï¼Œä»èƒ½ä¿æŒæ¯” FP16 æ›´é«˜çš„å¸¦å®½åˆ©ç”¨ç‡ã€‚<br>â€¢ **å¯åŠ¨å¼€é”€**ï¼šåŠ è½½ FP8 checkpoint æ—¶éœ€é¢å¤–è¯»å– `weight_scale_inv`ï¼ˆæˆ– `weight_scale`ï¼‰å¹¶åœ¨ `process_weights_after_loading` ä¸­å®Œæˆå½’ä¸€åŒ–/é‡æ ‡å®šï¼Œå¯èƒ½å¢åŠ æ•°ç§’çš„åˆå§‹åŒ–æ—¶é—´ã€‚<br>â€¢ **åŠ¨æ€ vs é™æ€æ¿€æ´»**ï¼šé»˜è®¤ `dynamic`ï¼Œä¸é¢å¤–å­˜å‚¨æ¿€æ´» scaleï¼›è‹¥ç”¨æˆ·æ˜¾å¼é…ç½® `static`ï¼Œä¼šé¢å¤–ä¿å­˜ `input_scale`ï¼Œç•¥å¾®å¢å¤§å†…å­˜å ç”¨ã€‚ |
| **å®‰å…¨è€ƒè™‘** | â€¢ **æ¨¡å‹å®Œæ•´æ€§**ï¼šé‡åŒ–è¿‡ç¨‹ä¼šå¯¹æƒé‡è¿›è¡Œè£å‰ªï¼ˆ`clamp`ï¼‰å¹¶é‡æ–°æ ‡å®š `scale`ï¼Œè‹¥æƒé‡æ–‡ä»¶è¢«ç¯¡æ”¹æˆ–ç¼ºå¤± scaleï¼Œä¼šè§¦å‘ `torch.finfo` æå°å€¼å¡«å……ï¼Œå¯¼è‡´æ¨ç†ç»“æœå¼‚å¸¸ã€‚<br>â€¢ **ä»£ç æ‰§è¡Œ**ï¼šæ–°å¢çš„ `convert_hf_to_fp8.py` ç›´æ¥åœ¨ GPU ä¸ŠåŠ è½½å®Œæ•´æ¨¡å‹å¹¶å†™å› quantized æƒé‡ï¼Œéœ€ç¡®ä¿åœ¨å¯ä¿¡ç¯å¢ƒè¿è¡Œï¼Œé˜²æ­¢æ¶æ„æ¨¡å‹å¯¼è‡´ OOM æˆ– CUDA å¼‚å¸¸ã€‚<br>â€¢ **åç«¯ä¾èµ–**ï¼šå¼•å…¥ `sg_kernel` ä¸ Intel AMX æ¥å£ï¼Œè‹¥ç³»ç»Ÿç¼ºå°‘ç›¸åº”åº“ï¼Œä»£ç ä¼šåœ¨è¿è¡Œæ—¶å›é€€ï¼Œä½†ä»éœ€ç¡®è®¤åŠ¨æ€åº“åŠ è½½è·¯å¾„å®‰å…¨ã€‚ |
| **å¯ç»´æŠ¤æ€§** | â€¢ å°†é‡åŒ–å®ç°æ‹†åˆ†ä¸ºé…ç½®ç±» + æ–¹æ³•ç±»ï¼Œä¿æŒä¸å·²æœ‰ `QuantizationConfig` æ¡†æ¶ä¸€è‡´ï¼Œä¾¿äºæœªæ¥æ·»åŠ  W4A8ã€GPTQ ç­‰å…¶å®ƒæ–¹æ¡ˆã€‚<br>â€¢ `mlp.py` ä¸­æ–°å¢çš„ `FeedForward` ä¸åŸ `MLP` å¹¶å­˜ï¼Œé¿å…ç ´åå·²æœ‰æ£€æŸ¥ç‚¹å…¼å®¹æ€§ã€‚<br>â€¢ æ–‡æ¡£ä¸è½¬æ¢å·¥å…·åŒæ­¥æ›´æ–°ï¼Œé™ä½ä½¿ç”¨é—¨æ§›ã€‚<br>â€¢ ä»£ç é‡å¢å¤§çº¦ 1k è¡Œï¼Œæ¶‰åŠå¤šæ–‡ä»¶ä¿®æ”¹ï¼Œå»ºè®®å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›– `Fp8LinearMethod.create_weights` ä¸ `process_weights_after_loading` ä¸¤æ¡å…³é”®è·¯å¾„ã€‚ |

---

**âš ï¸ æ½œåœ¨é£é™©**  
1. **ç¡¬ä»¶å…¼å®¹æ€§**ï¼šåœ¨ä¸æ”¯æŒåŸç”Ÿ FP8 çš„ GPU ä¸Šè‹¥ `SGLANG_FORCE_FP8_MARLIN` ç¯å¢ƒå˜é‡æœªæ˜¾å¼è®¾ç½®ï¼Œå¯èƒ½è¯¯é€‰ `cutlass_fp8_supported=False` ä¸” `use_marlin=False`ï¼Œå¯¼è‡´å›é€€åˆ°æ…¢é€Ÿ FP32 è·¯å¾„æˆ–ç›´æ¥æŠ¥é”™ã€‚  
2. **å—é‡åŒ–çº¦æŸ**ï¼š`weight_block_size` åªèƒ½åœ¨ **fp8â€‘serialized checkpoint** ä¸” **dynamic** æ¿€æ´»ä¸‹ä½¿ç”¨ï¼›è¯¯é…ç½®ï¼ˆå¦‚ static+blockï¼‰ä¼šåœ¨ `Fp8Config.__init__` æŠ›å¼‚å¸¸ï¼Œå½±å“æ¨¡å‹åŠ è½½ã€‚  
3. **scale å‚æ•°ç¼ºå¤±**ï¼šå¯¹éâ€‘checkpointâ€‘fp8 æ¨¡å‹ï¼Œ`process_weights_after_loading` ä¼šé‡æ–°é‡åŒ–æƒé‡ï¼›è‹¥ `cutlass_fp8_supported` ä¸º False ä¸” `use_marlin` ä¸º Falseï¼Œä»ä¼šèµ° `input_to_float8`ï¼Œè¯¥è·¯å¾„åœ¨ CPU ä¸Šå¯èƒ½æ€§èƒ½æå·®ã€‚  
4. **å¹¶è¡ŒåŠ è½½å†²çª**ï¼š`fsdp_load` ä¸­å¯¹ `meta_sharded_param.dtype` çš„å¤„ç†æ”¹åŠ¨ï¼Œè‹¥æŸäº›å‚æ•°åœ¨ checkpoint ä¸­è¢«é”™è¯¯æ ‡è®°ä¸º `float8`ï¼ˆè€Œå®é™…ä¸º `float16`ï¼‰ï¼Œå°†å¯¼è‡´ dtype é”™é…ï¼Œè§¦å‘è¿è¡Œæ—¶é”™è¯¯ã€‚  
5. **ä¾èµ–å‡çº§**ï¼šæ–°å¢å¯¹ `diffusers.models.activations` çš„ importï¼Œå¯èƒ½åœ¨æ—§ç‰ˆ diffusers ä¸­ä¸å­˜åœ¨å¯¹åº”ç±»ï¼Œå¼•èµ· ImportErrorã€‚  
6. **è½¬æ¢å·¥å…· OOM**ï¼š`convert_hf_to_fp8.py` åœ¨ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ª safetensors æ–‡ä»¶åˆ° GPUï¼ˆ`device="cuda"`ï¼‰ï¼Œå¯¹æå¤§æ¨¡å‹ï¼ˆ>30Bï¼‰ä¼šå‡ºç°æ˜¾å­˜ OOMã€‚  

---

**ğŸ’¡ å…³æ³¨å»ºè®®**  

| å¯¹è±¡ | å»ºè®® |
|------|------|
| **å¼€å‘è€…** | - ä¸º `Fp8Config` æ·»åŠ å•å…ƒæµ‹è¯•ï¼Œè¦†ç›– `block`ã€`channel`ã€`tensor` ä¸‰ç§è·¯å¾„ä»¥åŠ `static`/`dynamic` æ¿€æ´»ç»„åˆã€‚<br>- åœ¨ CI ä¸­åŠ å…¥å¤šç¡¬ä»¶çŸ©é˜µæµ‹è¯•ï¼šH100ï¼ˆåŸç”Ÿ FP8ï¼‰ã€A100ï¼ˆMarlin fallbackï¼‰ã€CPUï¼ˆAMXï¼‰ä»¥åŠä¸æ”¯æŒ FP8 çš„ GPUã€‚<br>- ä¸º `transformer_loader` å¢åŠ å¼‚å¸¸æ•è·ï¼Œè‹¥ `get_quant_config` è¿”å› `None`ï¼Œåº”å›é€€åˆ°æ— é‡åŒ–è·¯å¾„è€Œä¸æ˜¯æŠ›å¼‚å¸¸ã€‚ |
| **ç”¨æˆ·** | - åœ¨ä½¿ç”¨ FP8 å‰ï¼Œå…ˆæ£€æŸ¥ `torch.cuda.get_device_capability

---

### Revert "[jit kernel] Support per_token_group_quant_8bit jit kernel" (#19131)
**SHA**: `4653939` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4653939cdafac898ac1cd680f1efa4bb697631a1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / åŠŸèƒ½å›é€€  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤æ’¤é”€äº†å¯¹ *per_token_group_quant_8bit* JIT kernel çš„å…¨éƒ¨å®ç°ï¼ŒåŒ…æ‹¬ CUDA kernelã€Python åŒ…è£…ã€åŸºå‡†æµ‹è¯•è„šæœ¬åŠå¯¹åº”å•å…ƒæµ‹è¯•ã€‚ä¸æ­¤åŒæ—¶ï¼Œ`utils.py` ä¸­çš„ dtype æ˜ å°„è¡¨è¢«ç®€åŒ–ï¼ˆç§»é™¤ `torch.float8_e4m3fn` ä¸ `torch.int8` çš„æ˜ å°„ï¼‰ï¼Œ`fp8_kernel.py` çš„å¯¼å…¥é€»è¾‘ä¸è°ƒç”¨è·¯å¾„åšäº†ç›¸åº”è°ƒæ•´ï¼Œä»¥é˜²æ­¢åœ¨ JIT å®ç°ç¼ºå¤±æ—¶å‡ºç°æœªå®šä¹‰å¼•ç”¨ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/jit_kernel/per_token_group_quant_8bit.py`  
- `python/sglang/jit_kernel/csrc/gemm/per_token_group_quant_8bit.cuh`  
- `python/sglang/jit_kernel/benchmark/bench_per_token_group_quant_8bit.py`  
- `python/sglang/jit_kernel/tests/test_per_token_group_quant_8bit.py`  
- `python/sglang/jit_kernel/utils.py`ï¼ˆdtype æ˜ å°„ï¼‰  
- `python/sglang/srt/layers/quantization/fp8_kernel.py`ï¼ˆè°ƒç”¨è·¯å¾„ï¼‰  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  

- **æ¶æ„å½±å“**  
  - åˆ é™¤äº†å®Œæ•´çš„ JIT ç¼–è¯‘é“¾ï¼ˆCUDA ç¼–è¯‘ã€Python åŒ…è£…ã€æµ‹è¯•ï¼‰ï¼Œç³»ç»Ÿæ¶æ„ä»â€œå¯é€‰çš„ JIT + Triton åŒå®ç°â€ç®€åŒ–ä¸ºä»…ä¿ç•™ Triton å®ç°ï¼ˆæˆ– CPU fallbackï¼‰ã€‚  
  - `fp8_kernel.py` ä¸­çš„ `enable_sgl_per_token_group_quant_8bit` æ ‡å¿—ä»ä¿ç•™ï¼Œä½†å¯¹åº”çš„ JIT æ¨¡å—å·²ä¸å¯ç”¨ï¼Œä»£ç è·¯å¾„è¢«æ”¹å†™ä¸ºç›´æ¥è°ƒç”¨é JIT å®ç°ï¼Œé¿å…è¿è¡Œæ—¶ `ImportError`ã€‚  
  - é€šè¿‡ç§»é™¤ `CPP_DTYPE_MAP` ä¸­å¯¹ `torch.float8_e4m3fn` ä¸ `torch.int8` çš„æ˜ å°„ï¼Œé™ä½äº† JIT ç¼–è¯‘æ—¶å¯¹è¿™äº› dtype çš„ç¡¬ç¼–ç ä¾èµ–ï¼Œå‡å°‘äº†å¹³å°å·®å¼‚ï¼ˆHIP vs CUDAï¼‰å¯¼è‡´çš„æ½œåœ¨å…¼å®¹æ€§é—®é¢˜ã€‚  

- **æ€§èƒ½å½±å“**  
  - åŸ JIT kernel æ—¨åœ¨åœ¨ Blackwellï¼ˆSM90ï¼‰ç­‰æ–°ä¸€ä»£ GPU ä¸Šåˆ©ç”¨ä½ä½é‡åŒ–çš„ç‰¹åŒ–æŒ‡ä»¤ï¼Œæä¾›æ¯” Triton å®ç°æ›´ä½çš„ latency ä¸æ›´é«˜çš„ååã€‚æ’¤é”€åï¼Œæ‰€æœ‰ä½¿ç”¨ `per_token_group_quant_8bit` çš„åœºæ™¯å°†å›é€€åˆ° Tritonï¼ˆæˆ– Pythonï¼‰å®ç°ï¼Œé¢„è®¡åœ¨å¤§æ‰¹é‡ `num_tokens`ã€`hidden_dim` åœºæ™¯ä¸‹ä¼šå‡ºç° **5â€‘30%** çš„æ€§èƒ½è¡°å‡ï¼Œå°¤å…¶æ˜¯åœ¨ `group_size=128`ã€`scale_ue8m0=True` ç­‰é«˜ç«¯é…ç½®ä¸Šã€‚  
  - å¯¹äº CI ç¯å¢ƒï¼ˆæµ‹è¯•è§„æ¨¡è¢«å¼ºåˆ¶ç¼©å°ï¼‰å½±å“ä¸å¤§ï¼Œä½†åœ¨ç”Ÿäº§æ¨ç†/å¾®è°ƒä¸­å¯èƒ½å¯¼è‡´ååä¸‹é™ï¼Œè¿›è€Œå½±å“æ•´ä½“ LLM æœåŠ¡çš„ QPSã€‚  

- **å®‰å…¨è€ƒè™‘**  
  - æœ¬æ¬¡æ”¹åŠ¨ä»…æ˜¯åŠŸèƒ½åˆ é™¤ï¼Œä¸æ¶‰åŠæ–°çš„ä»£ç è·¯å¾„æˆ–å¤–éƒ¨ä¾èµ–ï¼Œå®‰å…¨é£é™©åŸºæœ¬ä¸º **é›¶**ã€‚ç›¸åï¼Œç§»é™¤æœªå……åˆ†æµ‹è¯•çš„ JIT ä»£ç å¯é™ä½æ½œåœ¨çš„å†…å­˜è¶Šç•Œã€æœªåˆå§‹åŒ–å˜é‡ç­‰éšè”½é”™è¯¯çš„æ”»å‡»é¢ã€‚  

**âš ï¸ æ½œåœ¨é£é™©**  

1. **å‘åå…¼å®¹æ€§**  
   - ä»»ä½•å¤–éƒ¨é¡¹ç›®æˆ–å†…éƒ¨è„šæœ¬ç›´æ¥ `import sglang.jit_kernel.per_token_group_quant_8bit` å°†æŠ›å‡º `ModuleNotFoundError`ã€‚  
   - å·²ç»åœ¨æ¨¡å‹åºåˆ—åŒ–æ–‡ä»¶ï¼ˆe.g., TorchScriptã€ONNXï¼‰ä¸­è®°å½•äº†ä½¿ç”¨ JIT kernel çš„å…ƒä¿¡æ¯çš„æ¨¡å‹é‡æ–°åŠ è½½æ—¶å¯èƒ½å‡ºç°ä¸åŒ¹é…ã€‚  

2. **æ€§èƒ½å›é€€**  
   - å¯¹ä¾èµ–è¯¥ JIT å®ç°çš„é«˜å¹¶å‘æ¨ç†æœåŠ¡é¢„æœŸ QPS ä¸‹é™ï¼Œå¯èƒ½éœ€è¦é‡æ–°è¯„ä¼°ç¡¬ä»¶é€‰å‹æˆ–è°ƒå‚ï¼ˆå¦‚å¢å¤§ batch sizeã€æ”¹ç”¨æ›´é«˜æ•ˆçš„é‡åŒ–ç­–ç•¥ï¼‰ã€‚  

3. **æµ‹è¯•è¦†ç›–ç¼ºå¤±**  
   - ç›¸å…³å•å…ƒæµ‹è¯•å…¨éƒ¨åˆ é™¤ï¼Œåç»­å¯¹è¯¥åŠŸèƒ½çš„æ”¹åŠ¨å°†ç¼ºä¹ç›´æ¥å›å½’éªŒè¯ï¼Œå¢åŠ  bug éšè”½æ¦‚ç‡ã€‚  

4. **æ–‡æ¡£/ç¤ºä¾‹ä¸åŒæ­¥**  
   - è‹¥é¡¹ç›®æ–‡æ¡£ä»ç„¶æåŠ â€œperâ€‘tokenâ€‘groupâ€‘quantâ€‘8bit JIT kernelâ€ï¼Œç”¨æˆ·åœ¨æŸ¥æ‰¾ä½¿ç”¨æ–¹æ³•æ—¶ä¼šäº§ç”Ÿå›°æƒ‘ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **æ·»åŠ  deprecation è­¦å‘Š**  
   - åœ¨ `fp8_kernel.py` ä¸­ä¿ç•™ä¸€ä¸ªå…¥å£å‡½æ•°ï¼ˆå¦‚ `per_token_group_quant_8bit_jit`) å¹¶åœ¨è¿è¡Œæ—¶æŠ›å‡ºæ¸…æ™°çš„ `RuntimeError`ï¼Œæç¤ºç”¨æˆ·è¯¥åŠŸèƒ½å·²è¢«ç§»é™¤æˆ–å³å°†åºŸå¼ƒã€‚  

2. **æ›´æ–°ä¾èµ–ä¸æ–‡æ¡£**  
   - åœ¨ READMEã€API æ–‡æ¡£ä»¥åŠç¤ºä¾‹è„šæœ¬ä¸­åˆ é™¤æˆ–æ³¨æ˜è¯¥ JIT å®ç°å·²ä¸å†æä¾›ï¼Œé˜²æ­¢è¯¯å¯¼ã€‚  

3. **å›å½’æ€§èƒ½åŸºå‡†**  
   - åœ¨ CI ä¸­ä¿ç•™å¯¹ Triton å®ç°çš„åŸºå‡†ï¼ˆ`bench_per_token_group_quant_8bit.py` å·²è¢«åˆ é™¤ï¼‰ï¼Œä»¥ç¡®ä¿åç»­æ”¹åŠ¨ä¸ä¼šæ„å¤–å¼•å…¥æ›´å¤§çš„æ€§èƒ½å›é€€ã€‚  

4. **å…¼å®¹æ€§æ£€æŸ¥**  
   - åœ¨é¡¹ç›®çš„å…¥å£ï¼ˆå¦‚ `sglang/__init__.py`ï¼‰æˆ–è‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬ä¸­éªŒè¯æ˜¯å¦è¿˜æœ‰ä»£ç å¼•ç”¨å·²åˆ é™¤çš„æ¨¡å—ï¼Œæå‰æ•è·æ½œåœ¨çš„ ImportErrorã€‚  

5. **è€ƒè™‘é€æ­¥è¿ç§»æ–¹æ¡ˆ**  
   - è‹¥ç¤¾åŒºå¯¹è¯¥ç‰¹åŒ– kernel æœ‰å¼ºçƒˆéœ€æ±‚ï¼Œå¯åœ¨æœªæ¥ä»¥ **å¯é€‰æ’ä»¶** çš„å½¢å¼é‡æ–°æä¾›ï¼ˆä¾‹å¦‚é€šè¿‡ç‹¬ç«‹çš„ `sglang-jit-per-token-quant` åŒ…ï¼‰ï¼Œè¿™æ ·æ ¸å¿ƒåº“çš„å‘å¸ƒå‘¨æœŸä¸å—å®éªŒæ€§ä»£ç çš„å½±å“ã€‚  

6. **ç›‘æ§ç”Ÿäº§æŒ‡æ ‡**  
   - åœ¨å·²éƒ¨ç½²çš„æœåŠ¡ä¸­å¼€å¯ `per_token_group_quant_8bit` ç›¸å…³çš„ latency/throughput ç›‘æ§ï¼Œè§‚å¯Ÿæœ¬æ¬¡å›é€€åæ˜¯å¦å‡ºç°å¼‚å¸¸ä¸‹é™ï¼ŒåŠæ—¶è¿›è¡Œè°ƒå‚æˆ–ç¡¬ä»¶å‡çº§ã€‚  

---  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡å›é€€è™½ç„¶é™ä½äº†ä»£ç å¤æ‚åº¦ã€ç§»é™¤äº†æ½œåœ¨çš„æœªæˆç†Ÿ CUDA å®ç°ï¼Œä½†ä¹Ÿç‰ºç‰²äº†åœ¨ç‰¹å®šç¡¬ä»¶ä¸Šå¯èƒ½è·å¾—çš„æ˜¾è‘—æ€§èƒ½æå‡ã€‚å»ºè®®åœ¨æ­£å¼å‘å¸ƒå‰åšå¥½å…¼å®¹æ€§æ£€æŸ¥ã€æ–‡æ¡£åŒæ­¥ä»¥åŠæ€§èƒ½åŸºå‡†çš„å¯¹æ¯”ï¼Œä»¥å…å¯¹å·²æœ‰ç”¨æˆ·é€ æˆæ„å¤–å›å½’ã€‚

---

### [Refactor] Benchmark Phase 1: extract utils and datasets from bench_serving (#19077)
**SHA**: `f158869` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/f158869c2cc3e4915669bc1e2a94049b06264723)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆå°† benchmark ç›¸å…³çš„ utils ä¸æ•°æ®é›†åŠ è½½é€»è¾‘æŠ½ç¦»åˆ°ç‹¬ç«‹æ¨¡å—ï¼‰

**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´ é«˜  
*æ­¤æ¬¡æäº¤æ¶‰åŠ 1â€¯k+ è¡Œä»£ç è¿ç§»ï¼Œå½±å“ `bench_serving.py`ã€`sglang.benchmark` åŒ…çš„æ•´ä½“ç»“æ„å’Œå…¬å…± APIï¼Œè‹¥æœªåŒæ­¥æ›´æ–°å¼•ç”¨æˆ–æœªå¤„ç†å¥½ä¾èµ–ï¼Œå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶ ImportErrorã€åŠŸèƒ½å›å½’æˆ–èµ„æºé™åˆ¶å¼‚å¸¸ã€‚*

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- æŠŠåŸæœ¬æ•£è½åœ¨ `python/sglang/bench_serving.py` ä¸­çš„å·¥å…·å‡½æ•°ã€æ•°æ®é›†ä¸‹è½½ã€æ•°æ®é›†é‡‡æ ·ã€éšæœº prompt ç”Ÿæˆç­‰å®ç°æŠ½å–åˆ° `python/sglang/benchmark/utils.py` ä¸ `python/sglang/benchmark/datasets/` ç³»åˆ—å­æ¨¡å—ã€‚  
- `bench_serving.py` åªä¿ç•™åè®®å±‚ã€è¯·æ±‚è°ƒåº¦ç­‰æ ¸å¿ƒé€»è¾‘ï¼Œæ”¹ä¸º `from sglang.benchmark.utils import â€¦`ã€`from sglang.benchmark.datasets import get_dataset` ç­‰ç»Ÿä¸€å…¥å£ã€‚  
- æ–°å¢ `__all__` å¯¼å‡ºåˆ—è¡¨ï¼Œç»Ÿä¸€å¯¹å¤–æš´éœ²å¸¸ç”¨å¸¸é‡ä¸å‡½æ•°ã€‚  
- åˆ é™¤ `bench_serving.py` ä¸­å¯¹ `resource`ã€`io`ã€`pickle` ç­‰çš„ç›´æ¥å¼•ç”¨ï¼Œå°†å…¶è¿ç§»è‡³æ–°æ¨¡å—ã€‚  
- æ–°å¢å¯¹ HuggingFaceâ€‘hubã€å›¾ç‰‡ç”Ÿæˆã€Mooncakeã€MMMUã€OpenAI æ ¼å¼ç­‰å¤šç§åŸºå‡†æ•°æ®é›†çš„ç‹¬ç«‹å®ç°ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/bench_serving.py`ï¼ˆæ ¸å¿ƒ benchmark æœåŠ¡å…¥å£ï¼‰  
- `python/sglang/benchmark/` ç›®å½•ä¸‹å…¨éƒ¨æ–°å»ºæ–‡ä»¶ï¼ˆ`utils.py`ã€`datasets/*`ã€`__init__.py`ï¼‰  
- ä¾èµ– `bench_serving.py` çš„ CI æµ‹è¯•ã€æ–‡æ¡£ã€ç¤ºä¾‹è„šæœ¬ä»¥åŠå¤–éƒ¨é¡¹ç›®çš„ import è·¯å¾„ã€‚  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  

| ç»´åº¦ | å½±å“è¯´æ˜ |
|------|----------|
| **æ¶æ„å½±å“** | - å°†ä¸šåŠ¡é€»è¾‘ä»å•æ–‡ä»¶æ‹†åˆ†ä¸ºåŠŸèƒ½å±‚ï¼ˆutilsï¼‰+æ•°æ®å±‚ï¼ˆdatasetsï¼‰ï¼Œå®ç° **å•ä¸€èŒè´£**ï¼Œæå‡å¯ç»´æŠ¤æ€§ä¸å¯æ‰©å±•æ€§ã€‚<br>- æ–°å¢ `sglang.benchmark.datasets` åŒ…ï¼Œå½¢æˆ **æ¸…æ™°çš„å‘½åç©ºé—´**ï¼Œæœªæ¥å¯ä»¥æ— ç—›æ·»åŠ æ–°æ•°æ®é›†å®ç°ã€‚<br>- `bench_serving.py` ç°åœ¨åªè´Ÿè´£è¯·æ±‚è°ƒåº¦ï¼Œæ¨¡å—è€¦åˆåº¦å¤§å¹…ä¸‹é™ã€‚ |
| **æ€§èƒ½å½±å“** | - ä»£ç æœ¬èº«çš„æ‰§è¡Œè·¯å¾„æœªå˜ï¼Œ**è¿è¡Œæ—¶æ€§èƒ½åŸºæœ¬ä¿æŒä¸å˜**ã€‚<br>- é¢å¤–çš„ **æ¨¡å—åŠ è½½æˆæœ¬**ï¼ˆPython importï¼‰æå°ï¼Œå‡ æ¯«ç§’çº§ï¼Œå¿½ç•¥ä¸è®¡ã€‚<br>- è¿ç§»çš„ä¸‹è½½/ç¼“å­˜é€»è¾‘ä¿æŒåŸå®ç°ï¼Œæœªå¼•å…¥é¢å¤– I/Oã€‚ |
| **å®‰å…¨è€ƒè™‘** | - æ–°å¢ `download_and_cache_file`ã€`download_and_cache_hf_file` ä»ä½¿ç”¨ `requests.get`ï¼Œæœªå¼•å…¥æ ¡éªŒæˆ–ç­¾åï¼Œå®‰å…¨é£é™©ä¸åŸä»£ç ç›¸åŒã€‚<br>- `utils.set_ulimit` ä»ä¾èµ– `resource`ï¼ˆPOSIXï¼‰ï¼Œåœ¨ Windows ç¯å¢ƒä¸‹ä¼šæŠ› `ImportError`ï¼Œéœ€åœ¨æ–‡æ¡£æˆ–ä»£ç ä¸­åŠ ä¸Šå¹³å°æ£€æµ‹ã€‚ |
| **å¯ç»´æŠ¤æ€§** | - **ä»£ç å¤ç”¨**ï¼šå¤šä¸ªæ•°æ®é›†å…±ç”¨ `is_file_valid_jsonã€remove_prefix/suffixã€parse_custom_headers` ç­‰å…¬ç”¨å·¥å…·ã€‚<br>- **å•å…ƒæµ‹è¯•**ï¼šå¯é’ˆå¯¹æ¯ä¸ªæ•°æ®é›†æ¨¡å—ç‹¬ç«‹ç¼–å†™æµ‹è¯•ï¼Œæå‡è¦†ç›–ç‡ã€‚<br>- **æ–‡æ¡£**ï¼šæ–°åŒ…ç»“æ„éœ€è¦åŒæ­¥æ›´æ–° `README` ä¸ç¤ºä¾‹è„šæœ¬çš„å¯¼å…¥è·¯å¾„ã€‚ |
| **å…¼å®¹æ€§** | - ç ´åæ€§æ”¹åŠ¨ï¼šå¤–éƒ¨ä»£ç å¦‚æœç›´æ¥ `from sglang.bench_serving import get_dataset`ï¼ˆæˆ–å…¶ä»–è¢«æŠ½ç¦»çš„å‡½æ•°ï¼‰å°†å¤±æ•ˆã€‚<br>- éœ€è¦ä¿è¯ **å‘åå…¼å®¹çš„åˆ«å**ï¼ˆå¦‚åœ¨ `bench_serving.py` ä¸­ä¿ç•™æ—§å‡½æ•°çš„åŒ…è£…ï¼‰æˆ–åœ¨å‘å¸ƒè¯´æ˜ä¸­æ˜ç¡®è¿ç§»æ­¥éª¤ã€‚ |
| **é”™è¯¯é£é™©** | - å¾ªç¯å¯¼å…¥é£é™©ï¼š`datasets/__init__.py` åŒæ—¶å¯¼å…¥ `utils`ï¼Œè€Œ `utils` ä¹Ÿå¯èƒ½å¯¼å…¥ `datasets`ï¼ˆå¦‚ `download_and_cache_file` ç”¨åˆ° `MOONCAKE_DATASET_URL`ï¼‰ï¼Œéœ€è¦ç¡®ä¿æ²¡æœ‰å¾ªç¯ä¾èµ–ã€‚<br>- èµ„æºé™åˆ¶å‡½æ•° `set_ulimit` ä»åœ¨ utilsï¼Œè‹¥è°ƒç”¨æ–¹ä»åœ¨ `bench_serving.py` ä¸­ä½¿ç”¨ï¼Œéœ€è¦ç¡®è®¤å·²å¯¼å…¥ã€‚ |

**âš ï¸ æ½œåœ¨é£é™©**  
1. **ImportError / å¾ªç¯ä¾èµ–**ï¼šæ–°åŒ…çš„ `__init__` åŒæ—¶å¯¼å…¥å¤§é‡å­æ¨¡å—ï¼Œè‹¥å­æ¨¡å—ä¹‹é—´ç›¸äº’ importï¼Œå¯èƒ½åœ¨è§£é‡Šå™¨åŠ è½½é˜¶æ®µè§¦å‘ `ImportError`ã€‚  
2. **è·¨å¹³å°å…¼å®¹**ï¼š`resource` åªåœ¨ Unix ç³»ç»Ÿå¯ç”¨ï¼ŒWindows ç¯å¢ƒè¿è¡Œ benchmarkï¼ˆå°¤å…¶æ˜¯ CIï¼‰ä¼šå›  `set_ulimit` æŠ›å¼‚å¸¸ã€‚  
3. **ç‰ˆæœ¬å…¼å®¹**ï¼š`datasets` å­æ¨¡å—ä¾èµ– `datasets.load_dataset`ã€`huggingface_hub`, ä½†æœªåœ¨ `setup.cfg`/`requirements.txt` ä¸­æ˜¾å¼å£°æ˜ï¼Œå¯èƒ½å¯¼è‡´ **è¿è¡Œæ—¶ç¼ºå°‘ä¾èµ–**ã€‚  
4. **ç¼“å­˜è·¯å¾„å˜æ›´**ï¼šåŸå…ˆçš„ç¼“å­˜æ–‡ä»¶é»˜è®¤å­˜æ”¾åœ¨ `/tmp`ï¼Œæ–°å®ç°ä»ä½¿ç”¨ç›¸åŒè·¯å¾„ï¼Œä½† `get_gen_prefix_cache_path` å°†ç¼“å­˜å†™å…¥ `~/.cache/sglang/benchmark`ï¼Œè‹¥ç”¨æˆ·æ— å†™æƒé™ä¼šå¤±è´¥ã€‚  
5. **è¡Œä¸ºå·®å¼‚**ï¼š`sample_random_requests` é‡Œçš„ `return_text` é€»è¾‘åœ¨æ–°æ–‡ä»¶ä¸­ä¿æŒä¸å˜ï¼Œä½†è‹¥æœ‰ subtle import é¡ºåºå·®å¼‚ï¼ˆå¦‚ `numpy` ç‰ˆæœ¬ï¼‰ï¼Œå¯èƒ½å¯¼è‡´ token é•¿åº¦è®¡ç®—ç•¥æœ‰åå·®ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

| å¯¹è±¡ | å»ºè®® |
|------|------|
| **å¼€å‘è€…** | - åœ¨ `bench_serving.py` é¡¶éƒ¨åŠ å…¥ **å‘åå…¼å®¹çš„åŒ…è£…**ï¼ˆä¾‹å¦‚ `def get_dataset(...): return datasets.get_dataset(...)`ï¼‰ï¼Œé˜²æ­¢ç¬¬ä¸‰æ–¹ç›´æ¥å¼•ç”¨æ—§è·¯å¾„æ—¶æŠ¥é”™ã€‚<br>- ä¸º `sglang.benchmark.utils.set_ulimit` æ·»åŠ å¹³å°æ£€æµ‹ (`if sys.platform != "win32": â€¦`) å¹¶åœ¨æ–‡æ¡£ä¸­è¯´æ˜ä»…æ”¯æŒ POSIXã€‚<br>- å°†æ–°ä¾èµ– (`datasets`, `huggingface_hub`, `pybase64`, `tqdm`) å†™å…¥ `requirements.txt` æˆ– `pyproject.toml`ã€‚<br>- ä¸ºæ¯ä¸ª `datasets/*.py` ç¼–å†™ **å•å…ƒæµ‹è¯•**ï¼Œå°¤å…¶æ˜¯ç½‘ç»œä¸‹è½½ã€ç¼“å­˜å¤±æ•ˆã€JSON ç ´æŸç­‰å¼‚å¸¸åˆ†æ”¯ã€‚ |
| **CI / è‡ªåŠ¨åŒ–** | - åœ¨ CI ä¸­è¿è¡Œä¸€æ¬¡ **å®Œæ•´çš„ benchmark å…¥å£**ï¼ˆåŒ…æ‹¬ `bench_serving` ä¸ `sglang.benchmark.datasets`ï¼‰ï¼Œç¡®ä¿ import é“¾è·¯å®Œæ•´ã€‚<br>- åœ¨ Windows runner ä¸ŠéªŒè¯ `set_ulimit` ä¸ä¼šå¯¼è‡´æ•´ä¸ª benchmark è¿›ç¨‹é€€å‡ºã€‚ |
| **ç”¨æˆ· / æ–‡æ¡£** | - æ›´æ–° READMEã€ç¤ºä¾‹è„šæœ¬ï¼ˆå¦‚ `benchmark_demo.py`ï¼‰çš„ import è¯­å¥ï¼ŒæŒ‡å‘ `sglang.benchmark.datasets` ä¸ `sglang.benchmark.utils`ã€‚<br>- åœ¨å‘å¸ƒè¯´æ˜ä¸­æ˜ç¡® â€œ`bench_serving.get_dataset` å·²è¿ç§»è‡³ `sglang.benchmark.datasets.get_dataset`â€ã€‚ |
| **é•¿æœŸç»´æŠ¤** | - è€ƒè™‘æŠŠ **å…¬å…±å¸¸é‡**ï¼ˆ`ASSISTANT_SUFFIX`, `SHAREGPT_REPO_ID` ç­‰ï¼‰æŠ½åˆ° `sglang.benchmark.constants`ï¼Œé¿å…åœ¨å¤šä¸ªå­æ¨¡å—é‡å¤å¯¼å…¥ã€‚<br>- ä¸º `sglang.benchmark.datasets` æ·»åŠ  **æŠ½è±¡

---

#### ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (17)

### [diffusion] refactor: rename quantized model path server arg (#19142)
**SHA**: `45095ba` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/45095bac70ef1382425cb86f4b7af66dc6e7641c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°†åŸå…ˆçš„ `--quantized-model-path` å‚æ•°å…¨é¢æ”¹åä¸º `--transformer-weights-path`ï¼Œç»Ÿä¸€ç”¨äºæ‰€æœ‰é¢„é‡åŒ–æƒé‡ï¼ˆSVDQuantã€FP8 å•æ–‡ä»¶ç­‰ï¼‰ã€‚å¯¹åº” dataclassã€CLIã€æ–‡æ¡£ã€é…ç½®ç»“æ„ä»¥åŠåŠ è½½é€»è¾‘å‡åšäº†é€‚é…ï¼Œå¹¶åŠ å…¥äº†ä» safetensors å…ƒæ•°æ®è¯»å–é‡åŒ–é…ç½®çš„å…¼å®¹å®ç°ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/multimodal_gen/configs/quantization.py`ã€`runtime/loader/transformer_loader.py`ã€`runtime/server_args.py`ã€`runtime/layers/quantization/configs/nunchaku_config.py`  
- æ–‡æ¡£ `quantization.md`ã€å•å…ƒæµ‹è¯• `testcase_configs.py`  
- ç›¸å…³çš„ CLI å‚æ•°è§£æã€æ—¥å¿—ä¿¡æ¯ä»¥åŠé”™è¯¯æç¤º  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼š`NunchakuSVDQuantArgs.from_dict` å·²å…¼å®¹æ—§é”® `quantized_model_path`ï¼Œä½†è¿è¡Œæ—¶ä»ä¼šæŠŠè¯¥é”®å†™å…¥ `ServerArgs.transformer_weights_path`ã€‚å»ºè®®åœ¨ `add_cli_args` ä¸­ä¿ç•™ `--quantized-model-path` çš„éšè—åˆ«åï¼Œé¿å…å·²æœ‰è„šæœ¬å› ç¼ºå°‘è¯¥å‚æ•°è€Œç›´æ¥æŠ¥é”™ã€‚  
2. **è·¯å¾„æ ¡éªŒ**ï¼š`transformer_weights_path` æ—¢å¯èƒ½æ˜¯æœ¬åœ°æ–‡ä»¶ã€ç›®å½•ï¼Œä¹Ÿå¯èƒ½æ˜¯ HFâ€¯Repo IDã€‚`maybe_download_model` å·²åŠ å…¥ä¸‹è½½é€»è¾‘ï¼Œä½†åœ¨ `ServerArgs._adjust_quant_config` ä¸­å¯¹è·¯å¾„çš„å­˜åœ¨æ€§æ£€æŸ¥ä»åŸºäº `os.path.isfile`ï¼Œè‹¥æ˜¯ Repo ID ä¼šè¯¯æŠ¥ã€‚å¯åœ¨æ­¤å¤„ç»Ÿä¸€ä½¿ç”¨ `maybe_download_model` æˆ–æ·»åŠ  `is_hf_repo` åˆ¤å®šã€‚  
3. **é‡åŒ–é…ç½®è§£æ**ï¼šæ–°å®ç° `get_quant_config_from_safetensors_metadata` è¯»å– `_quantization_metadata` å¹¶å…¼å®¹ FP8 å…ƒæ•°æ®ã€‚ç¡®ä¿æ‰€æœ‰ç”Ÿæˆçš„ safetensors å‡éµå¾ªè¯¥å­—æ®µï¼Œå¦åˆ™ä¼šå›é€€åˆ° `None`ï¼Œå¯¼è‡´åç»­ `quant_config` ä¸º `None` å¹¶è§¦å‘è­¦å‘Šã€‚å»ºè®®åœ¨æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜å…ƒæ•°æ®é”®ååŠæ ¼å¼ã€‚  
4. **é”™è¯¯ä¿¡æ¯**ï¼š`NunchakuSVDQuantArgs.validate` ç°åœ¨æ£€æŸ¥ `transformer_weights_path`ï¼Œä½†åœ¨ CLI ä»ä¼šå‡ºç° â€œ--enable-svdquant requires --transformer-weights-path to be setâ€ çš„æç¤ºï¼Œä¿æŒä¸€è‡´å³å¯ã€‚  
5. **æµ‹è¯•è¦†ç›–**ï¼šå·²åœ¨ `testcase_configs.py` ä¸­æ ‡è®°äº† fluxâ€‘FP8 åœºæ™¯ä¸º TODOã€‚å»ºè®®è¡¥å……å¯¹åº”çš„é›†æˆæµ‹è¯•ï¼ŒéªŒè¯ `--transformer-weights-path` èƒ½æ­£ç¡®è§£æ HFâ€¯Repo å¹¶è‡ªåŠ¨è¯»å– `quantization_config`ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨ç»Ÿä¸€äº†é‡åŒ–æƒé‡çš„å…¥å£ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°ã€‚ä½†éœ€æ³¨æ„å…¼å®¹æ€§å’Œè·¯å¾„/å…ƒæ•°æ®æ ¡éªŒçš„ç»†èŠ‚ï¼Œä»¥é¿å…ç”¨æˆ·åœ¨è¿ç§»æ—§å‘½ä»¤è¡Œæˆ–ä½¿ç”¨ HFâ€¯Repo æ—¶å‡ºç°æ„å¤–é”™è¯¯ã€‚

---

### [diffusion] chore: minor cleanups (#19123)
**SHA**: `8782372` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/87823722b379724c7d609a50e3d865fecfa575c9)

**å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / é‡æ„  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡æäº¤åœ¨å¤šæ¨¡æ€è¿è¡Œæ—¶åšäº†è‹¥å¹²æ¸…ç†ä¸åŠŸèƒ½è¡¥å…¨ï¼šâ‘  å°† TurboWan è­¦å‘Šæ”¹ä¸º `logger.warning_once`ï¼Œé¿å…é‡å¤è¾“å‡ºï¼›â‘¡ å°† `image_encoder_loader` ä¸ `text_encoder_loader` çš„é…ç½®è¯»å–ç»Ÿä¸€ä¸º `get_diffusers_component_config` å¹¶åœ¨å†…éƒ¨ç»Ÿä¸€è°ƒç”¨ `_clean_hf_config_inplace`ï¼Œå»é™¤å†—ä½™çš„ `json`/`os` æ‰‹å·¥è¯»å–ï¼›â‘¢ `gpu_worker` ä¸­å±‚çº§ç¦»çº¿(offload)é€»è¾‘æ”¹ä¸ºéå†åç§°åˆ—è¡¨ï¼Œä»£ç æ›´ç®€æ´ä¸”é¿å…ç©ºæŒ‡é’ˆè¯¯åˆ¤ï¼›â‘£ åœ¨ `hf_diffusers_utils` ä¸­æŠ½å–äº† `_verify_diffusers_model_complete`ã€`get_quant_config_from_safetensors_metadata` ç­‰å®ç”¨å‡½æ•°ï¼Œå¢å¼ºæ¨¡å‹å®Œæ•´æ€§æ ¡éªŒå’Œ safetensors é‡åŒ–ä¿¡æ¯è¯»å–ï¼›â‘¤ `convert_hf_to_fp8` ä¸­è®¡æ•°æ–¹å¼æ”¹ä¸º `v.numel()`ï¼Œé˜²æ­¢è¯¯ç®—ã€‚

**å½±å“èŒƒå›´**ï¼š`sglang/multimodal_gen/runtime/attention/turbo_layer.py`ã€`.../loader/component_loaders/*`ã€`gpu_worker.py`ã€`utils/hf_diffusers_utils.py`ã€`tools/convert_hf_to_fp8.py`ã€‚

**å…³æ³¨å»ºè®®**  

1. **å…¼å®¹æ€§**ï¼šç¡®è®¤é¡¹ç›®ä¸­å·²æœ‰çš„ `logger.warning_once` å®ç°ï¼ˆæˆ–è‡ªè¡Œå®ç°ï¼‰èƒ½å¤Ÿæ¥å—ç›¸åŒå‚æ•°ï¼›è‹¥æœªå®ç°ï¼Œéœ€è¦åœ¨ `logging_utils` ä¸­è¡¥å……è¯¥å°è£…ã€‚  
2. **é…ç½®æ¸…ç†**ï¼š`_clean_hf_config_inplace` å·²è¢«ç§»åŠ¨è‡³ `loader/utils.py`ï¼Œè¯·æ£€æŸ¥æ‰€æœ‰è°ƒç”¨è·¯å¾„æ˜¯å¦å·²æ›´æ–°ï¼Œé¿å…é—æ¼å¯¼è‡´é…ç½®ä¸­æ®‹ç•™æ— æ•ˆå­—æ®µã€‚  
3. **ç¦»çº¿é€»è¾‘**ï¼šæ–°å¾ªç¯åªåœ¨æ¨¡å—å­˜åœ¨æ—¶å°è¯• `configure_layerwise_offload`ï¼Œåº”åœ¨ CI ä¸­åŠ å…¥åŒ…å«/ä¸åŒ…å« `audio_dit` ç­‰ç»„ä»¶çš„æ¨¡å‹æµ‹è¯•ï¼Œç¡®ä¿æ—§æ¨¡å‹ä»èƒ½æ­£å¸¸å¯åŠ¨ã€‚  
4. **æ¨¡å‹å®Œæ•´æ€§**ï¼š`_verify_diffusers_model_complete` ç°åœ¨ç»Ÿä¸€æ£€æµ‹ `model_index.json` æˆ– `transformer/vae` ç»“æ„ï¼Œè¯·ç¡®ä¿æœ¬åœ°ç¼“å­˜ç›®å½•ç¬¦åˆè¯¥çº¦å®šï¼Œå¦åˆ™ä¼šå¼ºåˆ¶é‡æ–°ä¸‹è½½ã€‚  
5. **é‡åŒ–å…ƒæ•°æ®**ï¼šæ–°å¢ `get_quant_config_from_safetensors_metadata` ä¾èµ– safetensors æ–‡ä»¶ä¸­ `quantization_config` å­—æ®µï¼Œå»ºè®®åœ¨è¿ç§»è‡³ fp8 é‡åŒ–çš„æ¨¡å‹ä¸Šåšä¸€æ¬¡ç«¯åˆ°ç«¯éªŒè¯ï¼ˆåŠ è½½â€‘æ¨ç†â€‘æ€§èƒ½ï¼‰ï¼Œå¹¶åœ¨æ–‡æ¡£ä¸­è¯´æ˜è¯¥å…ƒæ•°æ®çš„ç”Ÿæˆæ–¹å¼ã€‚  
6. **æ€§èƒ½**ï¼š`convert_hf_to_fp8` ä¸­çš„è®¡æ•°æ”¹ä¸º `numel()`ï¼Œå¯¹å¤§æ¨¡å‹è®¡æ•°æ›´å‡†ç¡®ï¼Œæš‚æ— è´Ÿé¢å½±å“ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ”¹åŠ¨æå‡äº†ä»£ç å¯ç»´æŠ¤æ€§å’Œå®‰å…¨æ€§ï¼Œä½†æ¶‰åŠæ—¥å¿—ã€é…ç½®æ¸…ç†ã€ç¦»çº¿åˆ¤å®šçš„ç»†èŠ‚éœ€é€šè¿‡å®Œæ•´çš„å•å…ƒ/é›†æˆæµ‹è¯•ç¡®è®¤ã€‚å»ºè®®åœ¨ä¸‹ä¸€ä¸ªå‘å¸ƒå‰æ‰§è¡Œè·¨æ¨¡å‹ï¼ˆæ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ã€éŸ³é¢‘ï¼‰å…¨é“¾è·¯å›å½’ã€‚

---

### Support kwargs and megatron core tensor parsing in dumper (#19138)
**SHA**: `1a1c768` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/1a1c768d44e707dfe7e37ad6114a31082a21d68e)

**å˜æ›´æ¦‚è§ˆ**  
æœ¬æ¬¡æäº¤å›´ç»• `debug_utils/dumper.py` åšäº†è¾ƒå¤§å¹…åº¦çš„åŠŸèƒ½æ‰©å±•ï¼šâ‘  å‰å‘é’©å­æ”¹ä¸ºåŒæ—¶æ¥å— `*args` ä¸ `**kwargs`ï¼Œä»è€Œæ”¯æŒå…³é”®å­—å‚æ•°çš„æ¨¡å‹è°ƒç”¨ï¼›â‘¡ å¼•å…¥ `_core_fields` åŠ¨æ€èšåˆæ’ä»¶æä¾›çš„æ ¸å¿ƒå¼ é‡åï¼Œå–ä»£åŸå…ˆç¡¬ç¼–ç çš„ `{"input_ids","positions"}`ï¼›â‘¢ ä¸ºæ’ä»¶åŸºç±»æ–°å¢ `core_fields()` æ¥å£å¹¶åœ¨ SGLangã€Megatron ä¸¤ä¸ªæ’ä»¶å®ç°ä¸­åˆ†åˆ«è¿”å›å„è‡ªçš„æ ¸å¿ƒå­—æ®µé›†åˆï¼›â‘£ å¯¹ `dump_value` çš„å‘½åä¸è·¯å¾„æ‹¼æ¥åšäº†ç»Ÿä¸€ï¼Œå»é™¤ â€œroleâ€ æ¦‚å¿µï¼Œæ”¹ç”¨ `sub_name`ï¼›â‘¤ æ›´æ–°ç›¸å…³å•å…ƒæµ‹è¯•ï¼Œè¦†ç›– kwargsã€æ··åˆå‚æ•°ã€Megatron `PackedSeqParams` ç­‰è·¯å¾„ã€‚  

**å½±å“èŒƒå›´**  
- **æ ¸å¿ƒæ¨¡å—**ï¼š`sglang/srt/debug_utils/dumper.py`ï¼ˆé’©å­æ³¨å†Œã€è½¬åŒ–ã€è¿‡æ»¤é€»è¾‘ï¼‰  
- **æ’ä»¶ä½“ç³»**ï¼š`_FrameworkPlugin`ã€`_SGLangPlugin`ã€`_MegatronPlugin`ï¼ˆæ–°å¢ `core_fields`ï¼‰  
- **æµ‹è¯•å¥—ä»¶**ï¼š`test/registered/debug_utils/test_dumper.py`ï¼ˆå¤§é‡æ–°å¢/ä¿®æ”¹çš„ç”¨ä¾‹ï¼‰  
- **ä¾èµ–æ¨¡å—**ï¼šMegatron çš„ `PackedSeqParams`ï¼ˆé€šè¿‡ `monkeypatch` æ¨¡æ‹Ÿï¼‰  

**å…³é”®é£é™© & å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼š`module.register_forward_pre_hook` æ–°å¢ `with_kwargs=True` å‚æ•°ï¼Œä»…åœ¨ PyTorchâ‰¥1.12 ä¸­å¯ç”¨ï¼Œå»ºè®®åœ¨ `setup.py` æˆ–æ–‡æ¡£ä¸­æ ‡æ˜æœ€ä½ç‰ˆæœ¬è¦æ±‚ã€‚  
2. **æ’ä»¶å­—æ®µå†²çª**ï¼š`_core_fields` é€šè¿‡ `union` åˆå¹¶æ‰€æœ‰æ’ä»¶è¿”å›çš„é›†åˆï¼Œè‹¥ä¸åŒæ’ä»¶å‡ºç°åŒåä½†è¯­ä¹‰ä¸åŒçš„å­—æ®µï¼ˆå¦‚ `input_ids` ä¸ `position_ids`ï¼‰ï¼Œä¼šè¢«ç»Ÿä¸€å¤„ç†ï¼Œå¯èƒ½å¯¼è‡´è¯¯åˆ æˆ–é‡å¤ã€‚å»ºè®®åœ¨æ’ä»¶å®ç°ä¸­æ˜¾å¼å£°æ˜å†²çªå¤„ç†æˆ–åœ¨ `_dump_value` ä¸­æ·»åŠ å†²çªæ£€æµ‹æ—¥å¿—ã€‚  
3. **æ€§èƒ½**ï¼šæ¯æ¬¡å‰å‘æ—¶ `self._core_fields` ä¼šè¢«éå†ï¼Œé›†åˆæŸ¥è¯¢æˆæœ¬ä½ä½† `self._convert_value` ä»è¿”å›å®Œæ•´å­—å…¸åå†è¿‡æ»¤ï¼Œè‹¥æ¨¡å‹è¾“å‡ºå¤§è§„æ¨¡å¼ é‡ï¼Œä»ä¼šäº§ç”Ÿä¸å¿…è¦çš„æ‹·è´ã€‚å¯ä»¥æå‰åœ¨æ’ä»¶å±‚é¢åªè¿”å›æ ¸å¿ƒå­—æ®µæˆ–åœ¨ `_dump_value` å‰åšä¸€æ¬¡ `if key not in self._core_fields and self._mode!="all": continue`ã€‚  
4. **æ–‡æ¡£ä¸ç¤ºä¾‹**ï¼šæ–°å¢ `sub_name` å‚æ•°çš„è¯­ä¹‰ä¸æ—§ç‰ˆ `role` ä¸åŒï¼Œéœ€åœ¨ README/API æ–‡æ¡£ä¸­è¡¥å……è¯´æ˜ï¼Œå¹¶ç»™å‡º kwargs è°ƒç”¨çš„ç¤ºä¾‹ã€‚  
5. **å¼‚å¸¸å®‰å…¨**ï¼š`_register_forward_hook_or_replace_fn` åœ¨ `replace_fn` åˆ†æ”¯é‡Œä»è°ƒç”¨ `pre_hook(module, args, kwargs)`ï¼Œè‹¥æ’ä»¶å®ç°çš„å‰ç½®é’©å­æŠ›å¼‚å¸¸ï¼ŒåŸ `forward` ä»ä¼šæ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´ä¸ä¸€è‡´çŠ¶æ€ã€‚å»ºè®®åœ¨é’©å­è°ƒç”¨å‰åšå¥½å¼‚å¸¸æ•è·å¹¶åœ¨å¿…è¦æ—¶ä¸­æ­¢åç»­è°ƒç”¨ã€‚  

**å¯¹å¼€å‘è€…çš„æ“ä½œå»ºè®®**  
- ç¡®è®¤é¡¹ç›®çš„ PyTorch ç‰ˆæœ¬æ»¡è¶³ `register_forward_pre_hook(..., with_kwargs=True)` çš„è¦æ±‚ã€‚  
- å¦‚æœ‰è‡ªå®šä¹‰æ’ä»¶ï¼ŒåŠ¡å¿…å®ç° `core_fields()` å¹¶è¿”å›å®Œæ•´çš„æ ¸å¿ƒå¼ é‡åé›†åˆã€‚  
- åœ¨å¼•å…¥æ–°æ¨¡å‹æˆ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Megatronï¼‰æ—¶ï¼Œåˆ©ç”¨ç°æœ‰æ’ä»¶æœºåˆ¶æˆ–è‡ªè¡Œå®ç°æ’ä»¶ï¼Œä»¥ä¿è¯å…³é”®å¼ é‡èƒ½å¤Ÿè¢« `non_intrusive` æ¨¡å¼æ•è·ã€‚  

**å¯¹ç”¨æˆ·çš„ä½¿ç”¨å»ºè®®**  
- åœ¨è°ƒè¯•æ¨¡å‹æ—¶ï¼Œå¯ç›´æ¥é€šè¿‡å…³é”®å­—å‚æ•°ä¼ é€’ `input_ids`ã€`position_ids` ç­‰ï¼ŒDumper ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä»¥å¹²å‡€çš„åç§°ä¿å­˜ã€‚  
- è‹¥å¯¹æ‰€æœ‰ä¸­é—´å¼ é‡æ„Ÿå…´è¶£ï¼Œä»å¯ä½¿ç”¨ `non_intrusive_mode="all"`ï¼Œä½†è¯·æ³¨æ„ä¼šäº§ç”Ÿè¾ƒå¤§çš„æ—¥å¿—æ–‡ä»¶ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨æ˜¾è‘—æå‡äº† Dumper å¯¹å…³é”®å­—å‚æ•°å’Œå¤šæ¡†æ¶å¼ é‡çš„å…¼å®¹æ€§ï¼Œé£é™©ä¸»è¦é›†ä¸­åœ¨ç‰ˆæœ¬ä¾èµ–ä¸æ’ä»¶å†²çªä¸Šï¼ŒæŒ‰ç…§ä¸Šè¿°å»ºè®®è¿›è¡Œæ£€æŸ¥å³å¯å¹³ç¨³è¿ç§»ã€‚

---

### [DSv32] [GLM5] Improve Model Quality by Avoiding FP32 Precision Loss in `weights_proj` (#19041)
**SHA**: `eddf193` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/eddf193292d310b416473815cffb0c9d13985be2)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ€§èƒ½ä¼˜åŒ– / è´¨é‡æå‡  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨ `nsa_indexer.py` ä¸­ä¸º `weights_proj` å¢åŠ äº† `_weights_proj_bf16_in_fp32_out`ï¼Œåœ¨æ”¯æŒçš„ GPU ä¸Šä½¿ç”¨ BF16 è¾“å…¥ã€BF16 æƒé‡ã€FP32 è¾“å‡ºçš„æ·±åº¦ GEMMï¼Œé¿å…ç›´æ¥åœ¨ BF16â†’FP32 ä¹‹é—´çš„ç²¾åº¦æŸå¤±ã€‚  
- `deep_gemm_wrapper` æ–°å¢ `GEMM_NT_BF16BF16F32` å†…æ ¸ç±»å‹ã€å¯¹åº”çš„ warmâ€‘up executor ä¸å…¥å£å‡½æ•° `gemm_nt_bf16bf16f32`ã€‚  
- å•æµ‹å°† `index_n_heads` ä» 1 æå‡åˆ° 32ï¼ŒéªŒè¯å¤§è§„æ¨¡ head åœºæ™¯ä¸‹çš„æ­£ç¡®æ€§ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/layers/attention/nsa/nsa_indexer.py`ï¼ˆæŠ•å½±ä¸å°ºåº¦è®¡ç®—ï¼‰  
- `python/sglang/srt/layers/deep_gemm_wrapper/*`ï¼ˆå†…æ ¸æ³¨å†Œã€å†…å­˜ä¼°ç®—ã€æ‰§è¡Œè·¯å¾„ï¼‰  
- æµ‹è¯• `test/registered/kernels/test_nsa_indexer.py`  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **å›é€€è·¯å¾„**ï¼š`_weights_proj_bf16_in_fp32_out` åœ¨ `ENABLE_JIT_DEEPGEMM` ä¸º False æˆ–åœ¨ HIP ç¯å¢ƒä¸‹ä»ä¼šèµ°åŸæœ‰ `self.weights_proj(x)`ï¼Œè¯·ç¡®ä¿è¿™ä¸¤æ¡è·¯å¾„çš„æ•°å€¼ä¸€è‡´å¹¶åŠ å…¥å¯¹åº”å•å…ƒæµ‹è¯•ã€‚  
2. **dtype æ£€æŸ¥**ï¼šå½“å‰å®ç°ç›´æ¥æŠŠ `x` ä¼ ç»™ `deep_gemm.gemm_nt_bf16bf16f32`ï¼Œè‹¥æ¨¡å‹æ¿€æ´»ä¸º FP16ã€FP32 ç­‰é BF16ï¼Œä¼šè§¦å‘ CUDA ç±»å‹ä¸åŒ¹é…é”™è¯¯ã€‚å»ºè®®åœ¨å‡½æ•°å…¥å£æ·»åŠ  `assert x.dtype == torch.bfloat16`ï¼ˆæˆ–æ˜¾å¼è½¬å‹ï¼‰ä»¥é˜²éšè— bugã€‚  
3. **çƒ­èº«ï¼ˆwarmâ€‘upï¼‰**ï¼šæ–°å¢çš„ `_BF16F32WarmupExecutor` åªåˆ›å»ºä¸€æ¬¡ `lhs/rhs/out`ï¼Œä½†åœ¨å®é™…æ‰§è¡Œæ—¶å¯èƒ½å‡ºç° `out` ä¸ºé contiguous çš„åˆ‡ç‰‡ã€‚ç¡®è®¤ `deep_gemm.bf16_gemm_nt` èƒ½æ¥å— `out[:m]` è¿™ç§è§†å›¾ï¼Œè‹¥ä¸è¡Œè¯·æ”¹ä¸º `out.narrow(0,0,m)`ã€‚  
4. **å†…å­˜è¯„ä¼°**ï¼š`compile_utils.get_memory_requirement` å·²åŠ å…¥ BF16â€‘BF16â€‘FP32 ä¼°ç®—ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥ `--dry-run` æ£€æŸ¥æ˜¯å¦å‡ºç°è´Ÿæ•°æˆ–æº¢å‡ºã€‚  
5. **æ–‡æ¡£ä¸ä¾èµ–**ï¼šREADME æˆ–ä»£ç æ³¨é‡Šä¸­è¡¥å……æ–°å†…æ ¸çš„ä½¿ç”¨å‰ç½®æ¡ä»¶ï¼ˆCUDA â‰¥11.8ã€GPU å¿…é¡»æ”¯æŒ BF16ï¼‰ï¼Œä»¥åŠ `deep_gemm_wrapper` åœ¨ `setup.cfg` ä¸­çš„å¯é€‰ä¾èµ–è¯´æ˜ã€‚  
6. **æµ‹è¯•è¦†ç›–**ï¼šå½“å‰æµ‹è¯•ä»…æ”¹åŠ¨äº† `index_n_heads`ï¼Œå»ºè®®å†æ·»åŠ ä¸€ä¸ª **pure fp32** ä¸ **bf16â€‘fp32** å¯¹æ¯”çš„æ•°å€¼ä¸€è‡´æ€§æµ‹è¯•ï¼Œç¡®ä¿åœ¨é JIT ç¯å¢ƒä¸‹ç»“æœä¸å˜ã€‚  

ä»¥ä¸Šå»ºè®®å¯ä»¥å¸®åŠ©ç¡®è®¤æ–° BF16â€‘FP32 è·¯å¾„çš„ç¨³å®šæ€§ï¼ŒåŒæ—¶é˜²æ­¢åœ¨ä¸åŒç¡¬ä»¶/é…ç½®ä¸‹å‡ºç°éšè—çš„ dtype æˆ–å†…å­˜é”™è¯¯ã€‚

---

### Fix wrongly large dumped file and handle non intrusive hook reset in dumper (#19124)
**SHA**: `326b788` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/326b788ab4bb0a422989005cdbd9f9cfaf0079e3)

**ğŸ”§ å˜æ›´ç±»å‹**â€ƒåŠŸèƒ½å¢å¼º / Bug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**â€ƒğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. ä¿®å¤ `Dumper` åœ¨ä¿å­˜å¼ é‡è§†å›¾æ—¶ä¼šæŠŠå®Œæ•´å­˜å‚¨åºåˆ—åŒ–å¯¼è‡´çš„å¼‚å¸¸å·¨å¤§çš„ dump æ–‡ä»¶â€”â€”é€šè¿‡ ` _clone_if_view` æ£€æµ‹å¹¶å…‹éš†å®é™…å ç”¨çš„å­˜å‚¨ã€‚  
2. ä¸º **éä¾µå…¥å¼ Hook**ï¼ˆ`register_non_intrusive_dumper`ï¼‰å¼•å…¥ç»Ÿä¸€ç®¡ç†ï¼šåœ¨ `Dumper` å®ä¾‹ä¸­ç»´æŠ¤ `_non_intrusives` åˆ—è¡¨ï¼Œ`reset()` æ—¶ç»Ÿä¸€è°ƒç”¨ `remove()`ï¼Œé¿å…æ®‹ç•™çš„å‰å‘é’©å­ã€‚  
3. å°† `register_forward_hook_or_replace_fn` æ”¹ä¸ºè¿”å› **å¯ç§»é™¤çš„ handle åˆ—è¡¨**ï¼Œå¹¶åœ¨ `replace_fn` åœºæ™¯å®ç°è‡ªå®šä¹‰ `_Handle.remove()`ï¼Œä»è€Œé…åˆ `reset` æœºåˆ¶å®‰å…¨æ’¤é”€ã€‚  
4. é»˜è®¤é…ç½®ä¸­ `enable_model_value/grad` ç”± `True` æ”¹ä¸º `False`ï¼Œé˜²æ­¢åœ¨ä¸éœ€è¦æ—¶è‡ªåŠ¨ dump å¤§é‡æ¨¡å‹å‚æ•°ã€‚  
5. æ–°å¢é€šç”¨å·¥å…· `_map_tensor`ã€`_clone_if_view`ã€`_strip_parameter`ï¼Œå¹¶ç›¸åº”æ›´æ–°æµ‹è¯•è¦†ç›–ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- **æ ¸å¿ƒæ¨¡å—**ï¼š`python/sglang/srt/debug_utils/dumper.py`ï¼ˆä»¥åŠå†…éƒ¨çš„ `_NonIntrusiveDumper`ã€`_register_forward_hook_or_replace_fn`ï¼‰ã€‚  
- **é…ç½®ä½¿ç”¨è€…**ï¼šæ‰€æœ‰ä¾èµ– `DumperConfig`ã€`_Dumper` çš„è°ƒè¯•/æ€§èƒ½åˆ†æè„šæœ¬ã€‚  
- **æµ‹è¯•**ï¼š`test/registered/debug_utils/*` å……åˆ†éªŒè¯æ–°è¡Œä¸ºã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **ä¸Šçº¿å‰æ£€æŸ¥é…ç½®**ï¼šç”±äºé»˜è®¤å…³é—­äº†æ¨¡å‹å‚æ•°/æ¢¯åº¦çš„ dumpï¼Œè‹¥ä¸šåŠ¡ä»éœ€è¿™äº›ä¿¡æ¯ï¼Œè¯·åœ¨å¯åŠ¨å‰æ˜¾å¼å¼€å¯ `enable_model_value=True` æˆ– `enable_model_grad=True`ã€‚  
2. **å…¼å®¹æ€§éªŒè¯**ï¼šå¦‚æœé¡¹ç›®ä¸­ç›´æ¥è°ƒç”¨ `_register_forward_hook_or_replace_fn` å¹¶å‡è®¾è¿”å› `None`ï¼Œéœ€æ”¹ä¸ºæ¥å—è¿”å›çš„ handle åˆ—è¡¨ï¼ˆå³ä½¿ä¸ä½¿ç”¨ä¹Ÿä¸ä¼šå½±å“åŠŸèƒ½ï¼‰ã€‚  
3. **èµ„æºæ¸…ç†**ï¼šé‡ç½® `Dumper` å‰åŠ¡å¿…è°ƒç”¨ `reset()`ï¼Œå¦åˆ™æ®‹ä½™é’©å­ä»ä¼šåœ¨åç»­æ¨ç†ä¸­è§¦å‘ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–çš„æ—¥å¿—æˆ–æ€§èƒ½å¼€é”€ã€‚  
4. **è§†å›¾å­˜å‚¨**ï¼šæ–°å®ç°åªåœ¨å¼ é‡çš„åº•å±‚å­˜å‚¨å¤§äºå®é™…å…ƒç´ å¤§å°æ—¶å…‹éš†ï¼Œç†è®ºä¸Šä¸ä¼šå½±å“æ­£å¸¸çš„å¼ é‡ä¿å­˜ï¼›ä½†åœ¨æç«¯è‡ªå®šä¹‰å­˜å‚¨å®ç°ä¸Šä»å»ºè®®è·‘ä¸€æ¬¡å›å½’æµ‹è¯•ã€‚  
5. **æ–‡æ¡£æ›´æ–°**ï¼šåœ¨ä½¿ç”¨è¯´æ˜ä¸­è¡¥å…… â€œéä¾µå…¥å¼ Hook çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†â€ ä»¥åŠ â€œé»˜è®¤ä¸å†è‡ªåŠ¨ dump æ¨¡å‹å‚æ•°â€ ä¸¤ç‚¹ï¼Œä»¥å…ä½¿ç”¨è€…äº§ç”Ÿè¯¯è§£ã€‚  

---

### Enhance reset, states, http in dumper (#19095)
**SHA**: `c1f497e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/c1f497e20e565cf2d7bd10704f790bf6f582a95f)

**ğŸ”§ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆé‡æ„ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“ å˜æ›´æ¦‚è§ˆ**  
1. **çŠ¶æ€ç»Ÿä¸€**ï¼šåŸæ¥çš„ `_stepã€_dump_indexã€_global_ctxã€_captured_output_dataã€_cleanup_previous_handled` ä» `_Dumper` å®ä¾‹å±‚ç§»åˆ°äº†æ–°çš„ `@dataclass _DumperState`ï¼Œé€šè¿‡ `self._state` ç»Ÿä¸€ç®¡ç†ã€‚  
2. **é…ç½®ç±»æ”¹å**ï¼š`_DumperConfig` â†’ `DumperConfig`ï¼ˆä¿æŒåŒåçš„ `from_env`ã€`from_kv_pairs` æ¥å£ï¼‰ï¼Œå¹¶åŠ å…¥ `field`ã€`server_port_parsed` ç­‰æ–°å±æ€§çš„è§£æã€‚  
3. **HTTP ç®¡ç†å™¨æŠ½ç¦»**ï¼šåŸå…ˆ `_ensure_http_server`ã€`_handle_http_control_request*` è¢«ç²¾ç®€ä¸º `@cached_property _http_manager` ä¸æ–°ç±» `_DumperHttpManager`ï¼Œå®ç° HTTPâ€‘ZMQ å¯åŠ¨ã€è¯·æ±‚åˆ†å‘çš„èŒè´£åˆ†ç¦»ã€‚  
4. **å®¹é”™ä¸æ¸…ç†**ï¼š`_torch_save` åœ¨é‡åˆ°ä¸å¯ pickle çš„ `nn.Parameter` æ—¶ä¼šå…ˆ `value.data`ï¼Œå¹¶æ–°å¢ `_strip_parameter`ã€‚`_cleanup_old_dumps` ç°åœ¨ä½¿ç”¨ `_collective_with_timeout`ï¼Œé˜²æ­¢å¡æ­»ã€‚  
5. **æ·±æ‹·è´æ”¹è¿›**ï¼š`_deepcopy_or_clone` ç»Ÿä¸€å¤„ç† Tensor ä¸æ™®é€šå¯¹è±¡ï¼Œæ–°å¢å¯¹åº”å•å…ƒæµ‹è¯•ã€‚  
6. **æµ‹è¯•ä¸è°ƒç”¨æ–¹åŒæ­¥**ï¼š`dump_loader.load`ã€`scheduler.handle_dumper_control`ã€å¤§é‡å•å…ƒæµ‹è¯•å…¨éƒ¨æ”¹ä¸ºä½¿ç”¨æ–° APIï¼Œè¦†ç›–äº† `reset`ã€`cleanup_previous`ã€å¤šå®ä¾‹ ZMQ éš”ç¦»ç­‰æ–°åœºæ™¯ã€‚  

**ğŸ“¦ å½±å“èŒƒå›´**  
- `sglang/srt/debug_utils/dumper.py`ï¼ˆæ ¸å¿ƒå®ç°ï¼‰  
- `sglang/srt/debug_utils/dump_loader.py`ï¼ˆè¯»å–æ—¶ä½¿ç”¨æ–° stateï¼‰  
- `sglang/srt/managers/scheduler.py`ï¼ˆè°ƒåº¦å±‚å¯¹ HTTP æ§åˆ¶çš„è°ƒç”¨ï¼‰  
- ç›¸å…³å•å…ƒæµ‹è¯•æ–‡ä»¶ä»¥åŠå¯¼å…¥è·¯å¾„ï¼ˆ`_DumperConfig` â†’ `DumperConfig`ï¼‰  
- ä¾èµ– `dumper` çš„å¤–éƒ¨è„šæœ¬ï¼ˆè‹¥ç›´æ¥è®¿é—® `_step`ã€`_dump_index` ç­‰ç§æœ‰å±æ€§ï¼Œéœ€è¦æ”¹ä¸º `dumper._state.*`ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼šç§æœ‰å±æ€§å·²æ”¹åï¼Œè‹¥æœ‰å¤–éƒ¨ä»£ç ç›´æ¥å¼•ç”¨ `_step`ã€`_dump_index` ç­‰ï¼Œéœ€è¦åœ¨æ–‡æ¡£æˆ–å‘å¸ƒè¯´æ˜ä¸­æ˜ç¡®è¿ç§»è·¯å¾„ã€‚å¯ä»¥è€ƒè™‘ä¿ç•™æ—§å±æ€§çš„åªè¯»å±æ€§ï¼ˆpropertyï¼‰åšå…¼å®¹ã€‚  
2. **HTTP åˆå§‹åŒ–æ—¶æœº**ï¼š`self._http_manager` ä¸ºæƒ°æ€§å±æ€§ï¼Œé¦–æ¬¡è°ƒç”¨ `_http_manager` æ‰ä¼šè§¦å‘ ZMQ/HTTP å¯åŠ¨ã€‚ç¡®è®¤æ‰€æœ‰è°ƒç”¨ç‚¹ï¼ˆå¦‚ `step`ã€`dump`ï¼‰å·²ç»æ”¹ä¸ºä½¿ç”¨ `self._http_manager`ï¼Œé˜²æ­¢é—æ¼å¯¼è‡´ â€œæœªå¯åŠ¨æœåŠ¡å™¨â€ çš„å¼‚å¸¸ã€‚  
3. **å¹¶å‘å®‰å…¨**ï¼š`_state` åªåœ¨å•è¿›ç¨‹å†…éƒ¨ä¿®æ”¹ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä»ä¾èµ–å¤–éƒ¨åŒæ­¥ï¼ˆå¦‚ `dist.barrier`ï¼‰ï¼Œå»ºè®®åœ¨æ–‡æ¡£ä¸­æé†’ç”¨æˆ·åœ¨å¤šè¿›ç¨‹/å¤šèŠ‚ç‚¹ä¸‹å…ˆå®Œæˆ `step` å†è°ƒç”¨ `reset`ã€‚  
4. **å¼‚å¸¸ä¿¡æ¯**ï¼š`_strip_parameter` ä¸ `_torch_save` çš„æŠ¥é”™ä»ä¼šæ‰“å°ï¼Œä½†è¿”å›åä¼š silentlyè·³è¿‡ä¿å­˜ã€‚è‹¥ä¸šåŠ¡å¯¹ç¼ºå¤±æ–‡ä»¶æ•æ„Ÿï¼Œå»ºè®®åœ¨ `_torch_save` ä¸­è¿”å›å¸ƒå°”æˆ–æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ï¼Œä»¥ä¾¿ä¸Šå±‚æ•è·ã€‚  
5. **æµ‹è¯•è¦†ç›–**ï¼šæ–°å¢çš„ ZMQ ç«¯å£éš”ç¦»æµ‹è¯•è¾ƒä¸ºä¾èµ–æœ¬æœºå¯ç”¨ç«¯å£ï¼ŒCI ç¯å¢ƒå¯èƒ½éœ€è¦é¢„ç•™ç«¯å£èŒƒå›´æˆ–ä½¿ç”¨åŠ¨æ€ç«¯å£åˆ†é…ã€‚ç¡®è®¤ CI é…ç½®å·²åŠ å…¥ `requests`ã€`multiprocessing` çš„ä¾èµ–ã€‚  
6. **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–° `README/usage` ä¸­å…³äº `DumperConfig.server_port`ã€`cleanup_previous`ã€`reset` è¡Œä¸ºçš„è¯´æ˜ï¼Œå°¤å…¶æ˜¯ â€œreset ä¼šæŠŠ cleanup_previous_handled é‡ç½®ä¸º Falseï¼Œåç»­ç¬¬ä¸€æ¬¡ dump ä¼šå†æ¬¡æ¸…ç†æ—§æ•°æ®â€ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†çŠ¶æ€ç®¡ç†çš„å¯ç»´æŠ¤æ€§ã€HTTP æ§åˆ¶çš„æ¨¡å—åŒ–ä»¥åŠé”™è¯¯å®¹é”™èƒ½åŠ›ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°ã€‚åªè¦æ³¨æ„å‘åå…¼å®¹ä¸å¹¶å‘ä½¿ç”¨çš„ç»†èŠ‚ï¼Œä¾¿å¯å¹³æ»‘è¿ç§»ã€‚

---

### Support multi colocated dumper, named exp cleanup, argparse config (#19094)
**SHA**: `4091b72` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/4091b720c53c76b415b4640afd1db7162b3c920f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. å°†åŸæœ¬çš„åªè¯» `_FrozenConfig` æŠ½è±¡ä¸ºå¯å¤ç”¨çš„ `_BaseConfig`ï¼Œå¹¶æ–°å¢ `from_kv_pairs` ä¸ `_kv_pairs_to_dict`ï¼Œæ”¯æŒé€šè¿‡å‘½ä»¤è¡Œ `key=value` å‚æ•°ç›´æ¥æ„é€  dumper é…ç½®ã€‚  
2. é‡‡ç”¨æ›´å…·å¯è¯»æ€§çš„é»˜è®¤å®éªŒç›®å½•å‰ç¼€ `dump_`ï¼Œåœ¨ç”Ÿæˆé»˜è®¤å®éªŒåæ—¶åŠ å…¥æ—¶é—´ã€æ¯«ç§’åŠéšæœºåç¼€ï¼Œé™ä½å†²çªæ¦‚ç‡ã€‚  
3. `_cleanup_old_dumps` ç°åœ¨æ¥å—å¯é€‰ `exp_name`ï¼Œåœ¨æ¸…ç†æ—§ dump ç›®å½•æ—¶ä¼šåŒæ—¶åˆ é™¤ç”¨æˆ·æ˜¾å¼æŒ‡å®šçš„å®éªŒç›®å½•ï¼Œæ”¯æŒâ€œå¤šå®ä¾‹å…±å­˜â€ã€‚  
4. ZMQ RPC ç«¯å£ä¸å†å›ºå®šåŸºäº `DUMPER_ZMQ_BASE_PORT` + rankï¼Œè€Œæ˜¯åŠ¨æ€ç»‘å®š (port=0) å¹¶åœ¨æ‰€æœ‰è¿›ç¨‹é—´å…±äº«å®é™…ç»‘å®šç«¯å£ï¼Œè§£å†³å¤šå®ä¾‹ç«¯å£å†²çªã€‚  
5. å¤§é‡å•å…ƒæµ‹è¯•æ›´æ–°ï¼Œæ–°å¢ kvâ€‘pair è§£æã€æ¸…ç†é€»è¾‘ä»¥åŠå¤šå®ä¾‹ç«¯å£éš”ç¦»çš„éªŒè¯ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/debug_utils/dumper.py`ï¼ˆé…ç½®ç±»ã€æ¸…ç†é€»è¾‘ã€ZMQ åˆå§‹åŒ–ï¼‰  
- ç›¸å…³æµ‹è¯• `test/registered/debug_utils/test_dumper.py`ï¼ˆè¦†ç›–æ–°ç‰¹æ€§ï¼‰  
- å¯èƒ½å—å½±å“çš„ä¸Šå±‚è°ƒç”¨ï¼šé€šè¿‡ç¯å¢ƒå˜é‡æˆ– `sglang.dump` CLI ä¼ å‚çš„ç”¨æˆ·è„šæœ¬ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
- **å…¼å®¹æ€§**ï¼š`_BaseConfig` ä»ä¿æŒ `frozen=True`ï¼Œä½† `from_env`ã€`with_defaults` è¿”å›åŸºç±»ï¼Œç¡®ä¿æ—§ä»£ç ä¸å—å½±å“ã€‚è‹¥å·²æœ‰ä»£ç ç›´æ¥å¼•ç”¨ `_FrozenConfig`ï¼Œå»ºè®®æ”¹ä¸º ` _BaseConfig` æˆ–ä½¿ç”¨åˆ«åä¿æŒå…¼å®¹ã€‚  
- **é…ç½®å…¥å£**ï¼šæ–°å¢çš„ `--dumper.kv_pairs`ï¼ˆæˆ–ç±»ä¼¼ï¼‰éœ€åœ¨æ–‡æ¡£ä¸­è¯´æ˜ï¼Œé¿å…ç”¨æˆ·ä»ä½¿ç”¨æ—§çš„ `DUMPER_*` ç¯å¢ƒå˜é‡æ—¶äº§ç”Ÿæ··æ·†ã€‚  
- **å¤šå®ä¾‹ä½¿ç”¨**ï¼šåœ¨åˆ†å¸ƒå¼æˆ–å¤šè¿›ç¨‹åœºæ™¯ä¸‹å¯åŠ¨å¤šä¸ª dumper æ—¶ï¼Œç¡®è®¤æ¯ä¸ªå®ä¾‹çš„ `exp_name` å”¯ä¸€ï¼›å¦åˆ™æ¸…ç†é€»è¾‘ä¼šè¯¯åˆ å…¶ä»–å®ä¾‹æ•°æ®ã€‚  
- **ç«¯å£å†²çª**ï¼šZMQ ç«¯å£å·²æ”¹ä¸ºåŠ¨æ€åˆ†é…ï¼Œä½†ä»ä¾èµ– `socket.getsockopt(zmq.LAST_ENDPOINT)` è·å–å®é™…ç«¯å£ï¼Œè¯·ç¡®ä¿æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨ç›¸åŒçš„ `handler` å¯¹è±¡ï¼Œå¦åˆ™å¯èƒ½å‡ºç°é€šä¿¡ä¸é€šã€‚  
- **æµ‹è¯•å¯é æ€§**ï¼šæ–°å¢çš„éšæœºåç¼€å¯èƒ½åœ¨æç«¯é«˜å¹¶å‘ä¸‹äº§ç”Ÿé‡å¤ï¼Œè‹¥å‡ºç°å¼‚å¸¸å¯é€‚å½“æ‰©å¤§éšæœºç©ºé—´æˆ–åŠ å…¥ UUIDã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æäº¤æå‡äº† dumper çš„å¯é…ç½®æ€§ã€å¹¶è¡Œå®‰å…¨æ€§ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°ï¼Œä½†éœ€è¦åœ¨ä½¿ç”¨æ‰‹å†Œå’Œ CI ä¸­åŒæ­¥æ›´æ–°è¯´æ˜ï¼Œé˜²æ­¢å› æ—§å‚æ•°å¤±æ•ˆæˆ–å®éªŒç›®å½•å†²çªå¯¼è‡´ç”¨æˆ·è¯¯åˆ æ•°æ®ã€‚

---

### Configure and call dumper in main SGLang logic (#19093)
**SHA**: `31f0c11` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/31f0c11405a2da00422dcbb337f717459b2d1b08)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  

**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `dumper.py` ä¸­æ–°å¢ `may_enable` å±æ€§ï¼Œç»Ÿä¸€åˆ¤æ–­æ˜¯å¦éœ€è¦å¯åŠ¨ dumperï¼ˆ`enable` æˆ– `server_port` ä¸ä¸ºç©ºï¼‰ã€‚  
2. `register_non_intrusive_dumper` åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶å¼ºåˆ¶è°ƒç”¨ `_ensure_http_server`ï¼Œä¿è¯ HTTP æœåŠ¡åœ¨éœ€è¦æ—¶ä¸€å®šå·²åˆ›å»ºã€‚  
3. `model_runner.py` åœ¨æ¨¡å‹åŠ è½½åã€æ¯è½®æ¨ç†ç»“æŸæ—¶åˆ†åˆ«è°ƒç”¨ `dumper.register_non_intrusive_dumper` ä¸ `dumper.step`ï¼Œå®Œæˆéä¾µå…¥å¼ dump çš„æ³¨å†Œä¸æ­¥è¿›è®¡æ•°ã€‚  
4. è°ƒæ•´ `dump_comparator.py` çš„ assert ä¹¦å†™é£æ ¼ï¼Œä¿æŒä»£ç æ•´æ´ã€‚  
5. æ–°å¢å¤§é‡å•å…ƒ/ç«¯åˆ°ç«¯æµ‹è¯•ï¼ŒéªŒè¯ `may_enable` çš„é»˜è®¤è¡Œä¸ºã€æœåŠ¡å™¨å¯åŠ¨ã€é…ç½®æ¥å£ã€è·¨ rank æ­¥è¿›åŒæ­¥ä»¥åŠå®é™… dump æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sglang/srt/debug_utils/dumper.py`ï¼ˆæ ¸å¿ƒ dumper å®ç°ï¼‰  
- `sglang/srt/model_executor/model_runner.py`ï¼ˆæ¨¡å‹æ‰§è¡Œä¸»æµç¨‹ï¼‰  
- `sglang/srt/debug_utils/dump_comparator.py`ï¼ˆå…ƒæ•°æ®å¯¹æ¯”å·¥å…·ï¼‰  
- æµ‹è¯•å¥—ä»¶ `test/registered/debug_utils/test_dumper.py`  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **çº¿ç¨‹å®‰å…¨**ï¼š`_ensure_http_server` åœ¨å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½è¢«å¹¶å‘è°ƒç”¨ï¼Œå»ºè®®åœ¨å®ç°é‡ŒåŠ å…¥ `Lock` é˜²æ­¢é‡å¤å¯åŠ¨ã€‚  
2. **å¯åŠ¨æ—¶æœº**ï¼šç›®å‰åœ¨ `register_non_intrusive_dumper` ä¸ `forward` æœ«å°¾éƒ½æ£€æŸ¥ `may_enable`ï¼Œç¡®è®¤ä¸ä¼šåœ¨ä¸éœ€è¦ dumper æ—¶åˆ›å»º HTTP ç«¯å£ï¼Œé¿å…èµ„æºæµªè´¹ã€‚  
3. **é…ç½®åŠ¨æ€æ›´æ–°**ï¼š`/dumper/configure` é€šè¿‡ HTTP æ”¹å˜ `enable`ï¼Œä½†å·²æœ‰ `dumper.may_enable` ç¼“å­˜ï¼Œéœ€ç¡®è®¤åç»­è°ƒç”¨èƒ½åŠæ—¶æ„ŸçŸ¥æœ€æ–°é…ç½®ï¼ˆå¦‚åœ¨ `step` å‰é‡æ–°è¯»å–ï¼‰ã€‚  
4. **å¼‚å¸¸å®¹å¿**ï¼šè‹¥ HTTP æœåŠ¡å™¨å¯åŠ¨å¤±è´¥æˆ–ç«¯å£è¢«å ç”¨ï¼Œå½“å‰é€»è¾‘ä¼šæŠ›å¼‚å¸¸ä¸­æ–­æ¨¡å‹åŠ è½½ï¼Œå»ºè®®æ•è·å¹¶å›é€€åˆ°â€œå…³é—­ dumperâ€æ¨¡å¼ï¼Œä»¥å…å½±å“æ­£å¸¸æ¨ç†ã€‚  
5. **æ€§èƒ½è¯„ä¼°**ï¼šå¼€å¯ nonâ€‘intrusive dump ä¼šåœ¨æ¯æ­¥ä¿å­˜å¼ é‡ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒåŠ å…¥å¼€å…³é™åˆ¶é¢‘ç‡æˆ–æ–‡ä»¶å¤§å°ï¼Œé˜²æ­¢ I/O æˆä¸ºç“¶é¢ˆã€‚  
6. **æµ‹è¯•è¦†ç›–**ï¼šç°æœ‰ E2E æµ‹è¯•å·²è¦†ç›–åŸºæœ¬è·¯å¾„ï¼Œå»ºè®®è¡¥å……å¼‚å¸¸è·¯å¾„ï¼ˆå¦‚æœåŠ¡å™¨ç«¯å£å†²çªã€é…ç½®éæ³•å­—æ®µï¼‰ä»¥åŠå¤šæœºå™¨ï¼ˆTP>1ï¼‰ä¸‹çš„å¹¶å‘ä¸€è‡´æ€§éªŒè¯ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸º SGLang å¼•å…¥äº†å¯åœ¨è¿è¡Œæ—¶æ‰“å¼€çš„è°ƒè¯• dump åŠŸèƒ½ï¼Œé€»è¾‘æ¸…æ™°ã€æµ‹è¯•å®Œå¤‡ï¼Œåªéœ€å…³æ³¨å¹¶å‘å¯åŠ¨ä¸å¼‚å¸¸æ¢å¤å³å¯å®‰å…¨ä¸Šçº¿ã€‚

---

### Enhance hook mechanism in dumper (#19073)
**SHA**: `cc63c99` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/cc63c99f112f781605017db018fced686cdc94de)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / å°å¹…é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. å°†åŸæ¥çš„ `partial_name` å‡çº§ä¸ºç»Ÿä¸€çš„å®éªŒåç§° `exp_name`ï¼Œå¹¶æŠŠé»˜è®¤ä¿å­˜ç›®å½•æ”¹ä¸º `/tmp/dumper`ã€‚  
2. é‡æ„â€¯`_Dumper` çš„ hook æœºåˆ¶ï¼š  
   - æ–°å¢å‰ç½®é’©å­ `forward_pre_hook`ï¼Œåœ¨ `forward` æ‰§è¡Œå‰è®°å½•è¾“å…¥ï¼Œé˜²æ­¢åç»­ç®—å­å°±åœ°ä¿®æ”¹å¯¼è‡´æŠ“å–çš„å€¼è¢«ç¯¡æ”¹ã€‚  
   - ä¸ºæ ¹æ¨¡å‹æä¾› `replace_fn` æ¨¡å¼ï¼Œç›´æ¥ monkeyâ€‘patch `module.forward`ï¼Œä¿è¯å³ä½¿ä½¿ç”¨ `model.forward()`ï¼ˆè€Œé `model.__call__`ï¼‰ä¹Ÿèƒ½è§¦å‘é’©å­ã€‚  
3. å¢åŠ  `_register_forward_hook_or_replace_fn` é€šç”¨æ³¨å†Œå‡½æ•°ã€`_get_default_exp_name` ç»Ÿä¸€ç”Ÿæˆå®éªŒç›®å½•åä»¥åŠæ¸…ç†æ—§ dump ç›®å½•çš„é€»è¾‘ã€‚  
4. ç›¸åº”å•å…ƒæµ‹è¯•å…¨éƒ¨è¿ç§»è‡³æ–°è·¯å¾„/å‘½åï¼Œå¹¶åŠ å…¥ **â€œinputs_dumped_before_forwardâ€** ç”¨ä¾‹éªŒè¯å‰ç½®é’©å­çš„æ­£ç¡®æ€§ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- **æ ¸å¿ƒä»£ç **ï¼š`python/sglang/srt/debug_utils/dumper.py`ï¼ˆé…ç½®ã€è·¯å¾„å¤„ç†ã€hook æ³¨å†Œã€dump æµç¨‹ï¼‰ã€‚  
- **æµ‹è¯•**ï¼š`test/registered/debug_utils/test_dumper.py`ã€`test/registered/debug_utils/test_dump_comparator.py`ã€‚  
- **ä½¿ç”¨æ–¹**ï¼šæ‰€æœ‰ä¾èµ– `Dumper.register_non_intrusive_dumper` æˆ–ç›´æ¥è¯»å– dump ç›®å½•çš„è„šæœ¬/å·¥å…·ï¼Œéœ€è¦æ”¹ä¸º `exp_name` å‚æ•°ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼šè‹¥å¤–éƒ¨é¡¹ç›®ä»ä½¿ç”¨æ—§çš„ `partial_name`ï¼Œå»ºè®®åœ¨ `Dumper.configure` ä¸­åŠ å…¥å…¼å®¹å±‚æˆ–åœ¨æ–‡æ¡£æ˜ç¡®è¿ç§»æ­¥éª¤ã€‚  
2. **å¹¶å‘å®‰å…¨**ï¼š`replace_fn` é€šè¿‡ `functools.wraps` æ›¿æ¢ `forward`ï¼Œè¯·ç¡®è®¤åœ¨å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é‡å¤åŒ…è£…æˆ–ç«äº‰ã€‚  
3. **ç¯å¢ƒå˜é‡**ï¼šé»˜è®¤ç›®å½•ä» `/tmp` æ”¹ä¸º `/tmp/dumper`ï¼Œè‹¥å·²æœ‰æ–‡ä»¶åœ¨æ—§ç›®å½•ï¼Œéœ€è¦æ‰‹åŠ¨è¿ç§»æˆ–åœ¨å¯åŠ¨è„šæœ¬ä¸­è®¾å®š `SGDUMPER_DIR`ã€‚  
4. **æ€§èƒ½å½±å“**ï¼šå‰ç½®é’©å­åœ¨æ¯å±‚æ¨¡å—éƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¯èƒ½å¢åŠ  CPU å¼€é”€ï¼›åœ¨å¤§æ¨¡å‹æˆ–é«˜é¢‘è°ƒç”¨åœºæ™¯ä¸‹å»ºè®®å…³é—­ `enable_output_console` æˆ–ä»…åœ¨è°ƒè¯•é˜¶æ®µæ‰“å¼€ã€‚  
5. **æ¸…ç†æ—§æ•°æ®**ï¼š`cleanup_previous` ä»ä¿æŒé»˜è®¤ `False`ï¼Œè‹¥å¼€å¯è¯·ç¡®è®¤ `base_dir.glob("dump_*")` ä¸å®é™…ç›®å½•ç»“æ„åŒ¹é…ï¼Œé¿å…è¯¯åˆ ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨æ˜¾è‘—æå‡äº†è°ƒè¯•æ•°æ®çš„å®Œæ•´æ€§ï¼ˆè¾“å…¥åœ¨è¢«æ¨¡å‹ä¿®æ”¹å‰å³è¢«æ•è·ï¼‰ï¼Œå¹¶æä¾›äº†æ›´çµæ´»çš„ hook æ³¨å…¥æ–¹å¼ã€‚å¼€å‘è€…åœ¨å‡çº§ååº”æ£€æŸ¥é…ç½®å­—æ®µåç§°ã€è·¯å¾„ä»¥åŠæ˜¯å¦ä»éœ€è¦æ‰‹åŠ¨è°ƒç”¨ `model.__call__` ä»¥è·å¾—ç›¸åŒçš„è¡Œä¸ºã€‚  

---

### Extract framework plugins in dumper (#19072)
**SHA**: `fdf80b5` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/fdf80b503161439194b46f52fdd64c9fffe8ede8)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / å…¶å®ƒ  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
å°†åŸæœ¬åœ¨ `sglang/srt/debug_utils/dumper.py` ä¸­ç¡¬ç¼–ç çš„ SGLang ä¸ Megatron ä¸“å±é€»è¾‘æŠ½è±¡ä¸ºç»Ÿä¸€çš„ **framework plugin** æ¥å£ã€‚æ–°å¢ `_FrameworkPlugin` æŠ½è±¡åŸºç±»ï¼Œå¹¶å®ç° `_SGLangPlugin`ã€`_MegatronPlugin` ä¸¤ä¸ªæ’ä»¶ã€‚æ‰€æœ‰å±‚å·æ£€æµ‹ã€valueâ€‘è½¬æ¢ã€å¹¶è¡Œä¿¡æ¯é‡‡é›†ç»Ÿä¸€èµ°æ’ä»¶åˆ—è¡¨ `_plugins`ï¼ŒåŸæœ‰çš„ `_collect_*_parallel_info`ã€`_convert_value`ã€`_detect_module_ctx` ç­‰å‡½æ•°è¢«ç›¸åº”åˆ å‡ã€‚å¯¹åº”å•å…ƒæµ‹è¯•ä¹Ÿæ”¹ä¸ºç›´æ¥è°ƒç”¨æ’ä»¶å®ä¾‹çš„ `collect_parallel_info` æ–¹æ³•ã€‚

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- **æ ¸å¿ƒæ¨¡å—**ï¼š`python/sglang/srt/debug_utils/dumper.py`ï¼ˆæ’ä»¶æŠ½è±¡ã€æ’ä»¶æ³¨å†Œã€è°ƒç”¨ç‚¹ä¿®æ”¹ï¼‰  
- **æµ‹è¯•æ¨¡å—**ï¼š`test/registered/debug_utils/test_dumper.py`ï¼ˆæ”¹ç”¨æ’ä»¶ APIï¼‰  
- **å¯èƒ½å—å½±å“çš„å¤–éƒ¨ä»£ç **ï¼šä»»ä½•ç›´æ¥è°ƒç”¨å·²åˆ é™¤çš„ `_collect_sglang_parallel_info`ã€`_collect_megatron_parallel_info`ã€`_convert_value`ã€`_detect_module_ctx` ç§æœ‰å‡½æ•°çš„ç”¨æˆ·ä»£ç ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. **æ’ä»¶å¯æ‰©å±•æ€§**ï¼šæ–°æ’ä»¶æœºåˆ¶ä¸ºåç»­æ”¯æŒå…¶ä»–æ¡†æ¶ï¼ˆå¦‚ DeepSpeedã€ColossalAIï¼‰æä¾›äº†å…¥å£ï¼Œå»ºè®®åœ¨æ’ä»¶å®ç°æ—¶ä¿æŒè¿”å›ç©ºå­—å…¸æˆ– `None` çš„å®¹é”™è¡Œä¸ºï¼Œé˜²æ­¢é¦–æ¬¡å¯¼å…¥æ—¶æŠ›å¼‚å¸¸ã€‚  
2. **å‘åå…¼å®¹**ï¼šè‹¥ç¤¾åŒºå·²æœ‰ä»£ç ä¾èµ–å·²åˆ é™¤çš„ç§æœ‰å‡½æ•°ï¼Œè€ƒè™‘åœ¨ `dumper.py` ä¸­ä¿ç•™ thinâ€‘wrapperï¼ˆè°ƒç”¨å¯¹åº”æ’ä»¶ï¼‰ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ `ImportError`ã€‚  
3. **æµ‹è¯•è¦†ç›–**ï¼šå½“å‰ä»…è¦†ç›–äº† SGLang ä¸ Megatron ä¸¤ä¸ªæ’ä»¶ï¼Œæ–°å¢æ¡†æ¶æ—¶åŠ¡å¿…è¡¥å…¨ç›¸åº”çš„å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ `collect_parallel_info`ã€`convert_value`ã€`detect_layer_id` çš„è¿”å›ä¸€è‡´æ€§ã€‚  
4. **æ€§èƒ½æ³¨æ„**ï¼šæ’ä»¶åˆ—è¡¨åœ¨æ¯æ¬¡è°ƒç”¨ `_detect_module_ctx`ã€`_convert_value`ã€`_compute_static_meta` æ—¶éå†ï¼Œä¸€èˆ¬æ’ä»¶æ•°ç›®å¾ˆå°‘ï¼Œå½±å“å¯å¿½ç•¥ï¼›è‹¥åç»­æ’ä»¶æ•°é‡æ˜¾è‘—å¢é•¿ï¼Œå¯è€ƒè™‘ç¼“å­˜æˆ–æå‰åˆ¤å®šå¯ç”¨æ’ä»¶ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†ä»£ç çš„æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§ï¼Œä½†éœ€è¦æ³¨æ„ä¿æŒå¯¹æ—§ç§æœ‰ API çš„å…¼å®¹æˆ–åœ¨æ–‡æ¡£ä¸­æ˜ç¡®å·²ä¸å†æ”¯æŒï¼Œä»¥å…ç ´åå·²æœ‰çš„è°ƒè¯•è„šæœ¬ã€‚

---

### Auto annotate context in dumper (#19071)
**SHA**: `e32b536` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/e32b5364a289e9a9f1a1e06b0a54e28ce9e033d0)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
åœ¨ `NonIntrusiveDumper` ä¸­æ–°å¢å¯¹ â€œlayers.Nâ€ æ¨¡å—çš„è‡ªåŠ¨ `layer_id` ä¸Šä¸‹æ–‡æ³¨å…¥ã€‚é€šè¿‡æ­£åˆ™åŒ¹é…æ¨¡å—å…¨åï¼Œè‹¥æ¨¡å—æ‹¥æœ‰ `layer_number`ï¼ˆMegatronï¼Œ1â€‘basedï¼‰æˆ– `layer_id`ï¼ˆSGLangï¼‰å±æ€§ï¼Œå³åœ¨å‰å‘ä¼ æ’­å‰è°ƒç”¨ `self._dumper.set_ctx(layer_id=â€¦)`ï¼Œå‰å‘ç»“æŸåæ¸…é™¤ã€‚ç›¸åº”å•å…ƒæµ‹è¯•è¦†ç›–äº† Megatronâ€‘styleã€SGLangâ€‘styleã€æ— å±æ€§ä»¥åŠè¿‡æ»¤åŠŸèƒ½ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/debug_utils/dumper.py`ï¼ˆæ ¸å¿ƒå®ç°ï¼‰  
- `test/registered/debug_utils/test_dumper.py`ï¼ˆæ–°å¢ 140 è¡Œæµ‹è¯•ï¼‰  
- ä¾èµ– `NonIntrusiveDumper` çš„è°ƒè¯•/å¯è§†åŒ–å·¥å…·  

**ğŸ’¡ å…³æ³¨å»ºè®®**  

1. **æ­£åˆ™å…¼å®¹æ€§**ï¼š`_LAYER_NAME_RE = r"(?:.+\.)?layers\.(\d+)$"` ä»…åŒ¹é…æœ«å°¾ä¸º `layers.N` çš„è·¯å¾„ï¼Œå¯èƒ½é—æ¼å¦‚ `model.encoder.layers.N` ä¸­çš„ä¸­é—´å±‚ã€‚å»ºè®®æ”¾å®½åŒ¹é…æˆ–åœ¨æ–‡æ¡£ä¸­è¯´æ˜ä½¿ç”¨å‰æã€‚  
2. **æ€§èƒ½æˆæœ¬**ï¼šä¸ºæ¯ä¸ªç¬¦åˆæ¡ä»¶çš„å±‚é¢å¤–æ³¨å†Œå‰ç½®/åç½® hookï¼Œè¿è¡Œæ—¶ä¼šå¤šå‡ºä¸¤æ¬¡å‡½æ•°è°ƒç”¨ã€‚è‹¥æ¨¡å‹å±‚æ•°ä¸Šåƒï¼Œå»ºè®®åœ¨ `register_non_intrusive_dumper` æ—¶æä¾›å¼€å…³ï¼Œä»¥å…åœ¨ä¸éœ€è¦ `layer_id` æ—¶å…³é—­æ­¤ç‰¹æ€§ã€‚  
3. **ä¸Šä¸‹æ–‡æ¸…ç†**ï¼šå½“å‰é€šè¿‡ `clear_ctx = {k: None for k in ctx}` åœ¨ forwardâ€hook ä¸­æ¸…ç©ºã€‚è‹¥åç»­ä»£ç åœ¨åŒä¸€æ¬¡å‰å‘ä¼ æ’­çš„ä¸åŒå­æ¨¡å—é—´å…±äº« `self._dumper`ï¼Œè¯·ç¡®è®¤ `None` èƒ½è¢«å®‰å…¨å¿½ç•¥ï¼Œé¿å…è¯¯å†™å…¥ `meta`ã€‚  
4. **å‘åå…¼å®¹**ï¼š`_detect_module_ctx` è¿”å› `None` æ—¶ä¿æŒåŸè¡Œä¸ºï¼Œæ— ç ´åæ€§ã€‚è‹¥å·²æœ‰ç”¨æˆ·è‡ªè¡Œåœ¨ hook ä¸­æ³¨å…¥ `layer_id`ï¼Œæ–°çš„è‡ªåŠ¨æ³¨å…¥ä¼šè¦†ç›–ï¼Œå»ºè®®åœ¨æ–‡æ¡£æˆ– README ä¸­æ³¨æ˜å†²çªè§„åˆ™ã€‚  
5. **æ–‡æ¡£ & ç¤ºä¾‹**ï¼šæ›´æ–° `debug_utils` ä½¿ç”¨è¯´æ˜ï¼Œæ¼”ç¤º `filter='layer_id=0'`ã€Megatron ä¸ SGLang ä¸¤ç§å±æ€§çš„åŒºåˆ«ï¼Œå¸®åŠ©ä½¿ç”¨è€…å¿«é€Ÿå®šä½ã€‚  
6. **æµ‹è¯•è¦†ç›–**ï¼šæ–°å¢çš„å››ä¸ªæµ‹è¯•å·²è¦†ç›–ä¸»è¦è·¯å¾„ï¼Œå»ºè®®åœ¨ CI ä¸­ä¿ç•™ `--cov` ç»Ÿè®¡ï¼Œä»¥é˜²åç»­æ”¹åŠ¨è¯¯åˆ  hook æ³¨å†Œé€»è¾‘ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ­¤æ¬¡æ”¹åŠ¨æå‡äº†è°ƒè¯•ä¿¡æ¯çš„å¯è¿½æº¯æ€§ï¼Œå½±å“èŒƒå›´å±€é™äºéä¾µå…¥å¼ dump å®ç°ï¼Œé£é™©å¯æ§ã€‚åªè¦æ³¨æ„æ­£åˆ™åŒ¹é…èŒƒå›´å’Œæ½œåœ¨çš„æ€§èƒ½å¼€é”€å³å¯å®‰å…¨ä¸Šçº¿ã€‚

---

### Support enabling partial non intrusive dump in dumper (#19069)
**SHA**: `8bc0751` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/8bc0751376c563cf3e0fecd3107a8b8070a53e69)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `_DumperConfig` ä¸­æ–°å¢ `non_intrusive_mode`ï¼ˆé»˜è®¤ `"core"`ï¼‰ï¼Œå¹¶é€šè¿‡ç¯å¢ƒå˜é‡å¯é…ç½®ã€‚  
2. `register_non_intrusive_dumper` æ”¹ä¸ºè¿”å› `Optional[_NonIntrusiveDumper]`ï¼Œåœ¨ `"off"` æ¨¡å¼ä¸‹ç›´æ¥è¿”å› `None`ã€‚  
3. `_NonIntrusiveDumper` å¼•å…¥ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼š`off`ã€`core`ã€`all`ã€‚  
   - `core` ä»…è½¬å‚¨ `ForwardBatch` çš„æ ¸å¿ƒå­—æ®µ `input_ids`ã€`positions`ï¼Œä¸”ä½¿ç”¨å¹²å‡€çš„é”®åã€‚  
   - `all` åœ¨ `core` åŸºç¡€ä¸Šé¢å¤–è½¬å‚¨å…¶å®ƒå­—æ®µï¼Œå¹¶ä¿æŒ `non_intrusive__` å‰ç¼€ã€‚  
   - `off` å®Œå…¨ä¸æ³¨å…¥ hookã€‚  
4. ä¸ºé¿å…å­æ¨¡å—é‡å¤è½¬å‚¨ `ForwardBatch`ï¼Œåœ¨å­æ¨¡å—çš„ hook ä¸­è·³è¿‡è¯¥å¯¹è±¡çš„è½¬å‚¨ã€‚  
5. æ–°å¢/è°ƒæ•´å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰æ¨¡å¼åŠè¾¹ç•Œæƒ…å†µã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/debug_utils/dumper.py`ï¼ˆæ ¸å¿ƒå®ç°ï¼‰  
- `test/registered/debug_utils/test_dumper.py`ï¼ˆæµ‹è¯•ï¼‰  
- ä»»ä½•ç›´æ¥ä½¿ç”¨ `Dumper.register_non_intrusive_dumper` çš„ä¸Šå±‚ä¸šåŠ¡ä»£ç ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  

| å»ºè®® | åŸå›  |
|------|------|
| **æ–‡æ¡£/ç¯å¢ƒå˜é‡è¯´æ˜** | æ–°å¢ `SGLANG_NON_INTRUSIVE_MODE`ï¼ˆæ¨æµ‹çš„ env å‰ç¼€ï¼‰éœ€è¦åœ¨ä½¿ç”¨æ‰‹å†Œä¸­æ³¨æ˜é»˜è®¤å€¼å’Œå¯é€‰å€¼ (`off|core|all`)ã€‚ |
| **è¿”å›å€¼å…¼å®¹** | ä¹‹å‰ `register_non_intrusive_dumper` å¿…å®šè¿”å›å¯¹è±¡ï¼Œå¤–éƒ¨è‹¥ä»å‡è®¾é `None` å¯èƒ½è§¦å‘ `AttributeError`ã€‚å»ºè®®åœ¨è°ƒç”¨æ–¹åŠ å…¥ `if dumper:` æ£€æŸ¥æˆ–æä¾›å‘åå…¼å®¹çš„åŒ…è£…å‡½æ•°ã€‚ |
| **å‚æ•°æ ¡éªŒ** | ç›®å‰ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå»ºè®®åœ¨ `_DumperConfig` åˆå§‹åŒ–æ—¶æ ¡éªŒåˆæ³•å–å€¼ï¼Œé˜²æ­¢ typo å¯¼è‡´é™é»˜å¤±æ•ˆã€‚å¯è€ƒè™‘æ”¹ä¸º `Enum`ã€‚ |
| **æ€§èƒ½è¯„ä¼°** | `all` æ¨¡å¼ä¼šåœ¨æ¯ä¸ª forward hook ä¸­éå†å¹¶è½¬å‚¨å¤§é‡å¼ é‡ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒé»˜è®¤ä¿æŒ `core`ï¼Œå¹¶åœ¨ profiling ä¸­ç¡®è®¤é¢å¤–å¼€é”€æ˜¯å¦åœ¨å¯æ¥å—èŒƒå›´ã€‚ |
| **ä»£ç å¯ç»´æŠ¤æ€§** | `_convert_value` ç°åŠ å…¥ `skip_forward_batch` å‚æ•°ï¼Œè‹¥æœªæ¥è¿˜æœ‰å…¶ä»–ç‰¹æ®Šå¯¹è±¡ï¼Œå»ºè®®åœ¨å‡½æ•°å¤´éƒ¨åŠ å…¥ `@overload` æˆ–æ›´æ˜ç¡®çš„ç±»å‹æ³¨é‡Šï¼Œä»¥å…è¯¯ç”¨ã€‚ |
| **æµ‹è¯•è¦†ç›–** | å·²æ–°å¢å®Œæ•´çš„æ¨¡å¼æµ‹è¯•ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥å¯¹ `non_intrusive_mode` ç¯å¢ƒå˜é‡çš„ç»„åˆæµ‹è¯•ï¼Œç¡®ä¿é»˜è®¤è¡Œä¸ºä¸å—å¤–éƒ¨é…ç½®æ³„æ¼å½±å“ã€‚ |

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨è®©éä¾µå…¥å¼è°ƒè¯•æ›´å…·çµæ´»æ€§ï¼Œå‘åå…¼å®¹æ€§ç¨æœ‰é£é™©ï¼ˆè¿”å›å€¼å˜ä¸º Optionalï¼‰ï¼Œåªè¦åœ¨è°ƒç”¨æ–¹é€‚é…å³å¯ã€‚å»ºè®®åŒæ­¥æ›´æ–°æ–‡æ¡£å¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é»˜è®¤ `core` æ¨¡å¼ï¼Œä»¥é¿å…ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚

---

### Support non-intrusive dumping in dumper (#19068)
**SHA**: `0384c45` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/0384c459a7b707a288751b77e5ecd4ad557f0585)

**ğŸŸ¡ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆä¸º `sglang.srt.debug_utils.dumper` æ–°å¢éä¾µå…¥å¼ dump åŠŸèƒ½ï¼‰  
**ğŸ“¦ å½±å“èŒƒå›´**ï¼š`python/sglang/srt/debug_utils/dumper.py`ã€ç›¸å…³å•å…ƒæµ‹è¯• `test/registered/debug_utils/test_dumper.py`ï¼Œä»¥åŠæ‰€æœ‰ä¾èµ– `Dumper` çš„è°ƒè¯•/æ—¥å¿—åŸ‹ç‚¹åœºæ™¯ã€‚  

**æ ¸å¿ƒå˜æ›´**  
1. åœ¨ `_Dumper` ä¸­åŠ å…¥ `register_non_intrusive_dumper` æ–¹æ³•ï¼Œè¿”å›å†…éƒ¨å®ç°ç±» `_NonIntrusiveDumper`ã€‚  
2. `_NonIntrusiveDumper` åœ¨æ¨¡å‹çš„æ¯ä¸ªå­æ¨¡å—ä¸Šæ³¨å†Œ `forward_hook`ï¼Œåœ¨ forward æœŸé—´è‡ªåŠ¨æ•è·è¾“å…¥/è¾“å‡º Tensor å¹¶é€šè¿‡åŸ `dump` æ¥å£å†™å…¥ã€‚  
3. å®ç°äº†å¯¹å¤šç§è¿”å›ç»“æ„çš„ç»Ÿä¸€è½¬åŒ–ï¼ˆTensorã€å•/å¤š Tensor åˆ—è¡¨ã€SGLang ä¸“ç”¨ç±»å‹ï¼‰ï¼Œå¹¶åœ¨æ— æ³•è¯†åˆ«æ—¶å®‰å…¨è·³è¿‡ã€‚  
4. ä¸ºè¯¥ç‰¹æ€§è¡¥å……äº† 30+ æ¡ç»†ç²’åº¦å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–å•/å¤š Tensorã€åµŒå¥—æ¨¡å—ã€è¿‡æ»¤å™¨ã€å…³é—­ dumperã€æ ¹æ¨¡å—å‘½åç­‰åœºæ™¯ã€‚  

**æ½œåœ¨é£é™© & å»ºè®®**  
- **æ€§èƒ½å¼€é”€**ï¼šæ¯ä¸ªæ¨¡å—éƒ½ä¼šæŒ‚è½½ Hookï¼Œæ¨ç†é˜¶æ®µä¼šäº§ç”Ÿé¢å¤–çš„ Python è°ƒç”¨ä¸ Tensor æ‹·è´ã€‚å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒé»˜è®¤å…³é—­ï¼Œä»…åœ¨è°ƒè¯•æ—¶æ˜¾å¼ `configure(enable=True)`ï¼›æˆ–æä¾›â€œå±‚çº§æ·±åº¦â€/â€œæ¨¡å—ç™½åå•â€é€‰é¡¹ä»¥é™åˆ¶ Hook æ•°é‡ã€‚  
- **é‡å¤æ³¨å†Œ**ï¼šå½“å‰å®ç°æ²¡æœ‰é˜²æ­¢åŒä¸€æ¨¡å‹å¤šæ¬¡è°ƒç”¨ `register_non_intrusive_dumper`ï¼Œå¯èƒ½å¯¼è‡´é‡å¤ Hookã€é‡å¤ dumpã€‚å¯åœ¨ `register_non_intrusive_dumper` åŠ å…¥ id æ£€æŸ¥æˆ–åœ¨ `_NonIntrusiveDumper` å®ä¾‹åŒ–æ—¶è®°å½•å·²æ³¨å†Œæ¨¡å‹ã€‚  
- **èµ„æºé‡Šæ”¾**ï¼šHook åœ¨æ¨¡å‹ç”Ÿå‘½å‘¨æœŸå†…æŒç»­å­˜åœ¨ï¼Œè‹¥æ¨¡å‹è¢«é”€æ¯åä»ä¿ç•™å¼•ç”¨ï¼Œå¯èƒ½é˜»æ­¢ GCã€‚è€ƒè™‘åœ¨ `_NonIntrusiveDumper` æä¾› `unregister` æ–¹æ³•æˆ–åœ¨ `__del__` ä¸­è‡ªåŠ¨ç§»é™¤ Hookã€‚  
- **å…¼å®¹æ€§**ï¼šå¯¹ `torch.nn.Module` çš„ `named_modules` è¿­ä»£å‡è®¾äº†æ™®é€šæ¨¡å—ç»“æ„ï¼›è‹¥æ¨¡å‹ä½¿ç”¨ `torch.nn.ModuleList/Sequential` åŒ…è£…æˆ–è‡ªå®šä¹‰ `__getattr__`ï¼Œç”Ÿæˆçš„åç§°å¯èƒ½å‡ºç° `..` æˆ–å‰ç¼€ç©ºä¸²ã€‚æµ‹è¯•å·²è¦†ç›–æ ¹æ¨¡å—æƒ…å†µï¼Œåç»­å¯åœ¨ `_dump_value` ä¸­å¯¹ `module_name` åšæ›´ä¸¥æ ¼çš„æ¸…æ´—ã€‚  
- **é Tensor å€¼**ï¼šå½“å‰å¯¹ `int/float` ç­‰æ ‡é‡ç›´æ¥è·³è¿‡ï¼Œç¬¦åˆé¢„æœŸï¼›ä½†å¦‚æœç”¨æˆ·å¸Œæœ›è®°å½•è¿™äº›ä¿¡æ¯ï¼Œå»ºè®®æä¾›å¯é€‰çš„â€œfallback serializerâ€ã€‚  

**å¯¹å¼€å‘è€…çš„å»ºè®®**  
- åœ¨æ–‡æ¡£ä¸­æ˜ç¡®ä»‹ç»ä½•æ—¶é€‚åˆä½¿ç”¨éä¾µå…¥å¼ dumperã€å…¶å¯¹æ€§èƒ½çš„å½±å“ä»¥åŠå¦‚ä½•é€šè¿‡ `filter`ã€`enable` æ§åˆ¶ã€‚  
- ä¸º `register_non_intrusive_dumper` åŠ å…¥å‚æ•° `max_depth`ã€`include_modules` æˆ– `exclude_modules`ï¼Œæå‡çµæ´»æ€§ã€‚  
- åœ¨ CI ä¸­åŠ å…¥åŸºå‡†æµ‹è¯•ï¼Œç¡®ä¿ Hook æ³¨å†Œä¸ä¼šæ˜¾è‘—æ”¾å¤§æ¨ç†æ—¶å»¶ã€‚  

**å¯¹ç”¨æˆ·çš„å»ºè®®**  
- è°ƒè¯•æ—¶å¼€å¯ `enable=True` å¹¶ä½¿ç”¨ `filter` ç²¾å‡†é™å®šå…³æ³¨çš„èŠ‚ç‚¹ï¼Œé¿å…äº§ç”Ÿæµ·é‡ dumpã€‚  
- å¦‚åœ¨å¤šè¿›ç¨‹/åˆ†å¸ƒå¼ç¯å¢ƒä½¿ç”¨ï¼Œè¯·ç¡®è®¤æ¯ä¸ªè¿›ç¨‹åˆ†åˆ«æ³¨å†Œå¹¶æ•è·è¾“å‡ºï¼Œä»¥å…å‡ºç°è·¨è¿›ç¨‹å†²çªã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸º SGLang æ·»åŠ äº†å¼ºå¤§çš„å¯è§†åŒ–è°ƒè¯•æ‰‹æ®µï¼Œä»£ç å®ç°ä¸æµ‹è¯•å®Œæ•´ï¼Œä½†ä»éœ€æ³¨æ„ Hook å¸¦æ¥çš„è¿è¡Œæ—¶å¼€é”€å’Œèµ„æºå›æ”¶ã€‚

---

### Refactor dumper and change on_forward_pass_start API (#19065)
**SHA**: `5eccc3c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/5eccc3cff9308a37ea357ed6681b77ff7e30c6ce)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / API è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°†è°ƒè¯•/åŸ‹ç‚¹ç³»ç»Ÿä¸­çš„ `forward_pass_id` å®Œå…¨æ›¿æ¢ä¸º `step`ï¼Œå¹¶æŠŠåŸæ¥çš„ `on_forward_pass_start()` æ¥å£æ”¹ä¸ºæ›´è¯­ä¹‰åŒ–çš„ `step()`ã€‚åŒæ­¥æ›´æ–°ç¯å¢ƒå˜é‡å‰ç¼€ä¸º `DUMPER_`ï¼ˆåŸ `SGLANG_DUMPER_`ï¼‰ï¼Œæ‰€æœ‰ metaã€æ–‡ä»¶åã€HTTP æ§åˆ¶ä»¥åŠå•å…ƒæµ‹è¯•å‡æ”¹ç”¨ `step`ã€‚æ­¤å¤–æŠŠ `dump_model`ã€`dump_dict` ç­‰å…¬å…±æ–¹æ³•æå‰æš´éœ²ï¼Œç®€åŒ–å†…éƒ¨å®ç°ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/debug_utils/dumper.py`ï¼ˆæ ¸å¿ƒå®ç°ã€çŠ¶æ€å­—æ®µã€å…¬å¼€ APIï¼‰  
- `dump_loader.py`ã€`dump_comparator.py`ï¼ˆè¯»å–/å¯¹æ¯” metaï¼‰  
- `entrypoints/http_server.py`ï¼ˆç¯å¢ƒå˜é‡æ£€æŸ¥ï¼‰  
- `environ.py`ï¼ˆä¸´æ—¶ç¯å¢ƒå˜é‡è¿‡æ»¤è¯´æ˜ï¼‰  
- ç›¸å…³å•å…ƒæµ‹è¯•åŠç¤ºä¾‹è„šæœ¬  
- ä»»ä½•ç›´æ¥ä½¿ç”¨ `SGLANG_DUMPER_*` ç¯å¢ƒå˜é‡æˆ–è°ƒç”¨ `dumper.on_forward_pass_start()` çš„å¤–éƒ¨ä»£ç ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **ä»£ç è¿ç§»**ï¼šæ‰€æœ‰ç”¨æˆ·ä»£ç å¿…é¡»æ”¹ä¸º `dumper.step()`ï¼Œå¹¶å°†æ—§çš„ `forward_pass_id` å­—æ®µæ›¿æ¢ä¸º `step`ï¼ˆåŒ…æ‹¬æ–‡ä»¶åã€æ—¥å¿—è§£æã€æ‰‹åŠ¨è¿‡æ»¤ï¼‰ã€‚  
2. **ç¯å¢ƒå˜é‡**ï¼šä½¿ç”¨ `DUMPER_ENABLE`ã€`DUMPER_DIR`ã€`DUMPER_ZMQ_BASE_PORT`ã€`DUMPER_SERVER_PORT` ç­‰æ›¿ä»£åŸ `SGLANG_DUMPER_*`ï¼Œå¹¶ç¡®ä¿ä¸å†ä¾èµ– `allow_sglang=True` çš„ä¸´æ—¶ç»•è¿‡ã€‚  
3. **æ–‡ä»¶å…¼å®¹**ï¼šå·²æœ‰å†å² dump æ–‡ä»¶ä»ç„¶ä½¿ç”¨ `forward_pass_id`ï¼Œè‹¥éœ€è¦å…¼å®¹è¯·è‡ªè¡Œæ·»åŠ è¿ç§»è„šæœ¬æˆ–ä¿ç•™æ—§å­—æ®µçš„è½¯å…¼å®¹å±‚ã€‚  
4. **HTTP æ§åˆ¶**ï¼šè°ƒç”¨ `reset`ã€`configure`ã€`get_state` ç­‰æ¥å£æ—¶è¿”å›çš„é”®å·²æ”¹ä¸º `step`ï¼Œç›¸åº”çš„ç›‘æ§æˆ–è‡ªåŠ¨åŒ–è„šæœ¬éœ€åŒæ­¥æ›´æ–°ã€‚  
5. **å¹¶è¡Œ/åˆ†å¸ƒå¼**ï¼š`step` çš„è®¡æ•°åœ¨æ‰€æœ‰ Rank ä¸Šåº”ä¿æŒåŒæ­¥ï¼Œä½¿ç”¨ `dumper.step()` è€Œä¸æ˜¯æ‰‹åŠ¨é€’å¢è®¡æ•°å™¨ï¼Œä»¥é¿å…æ–­è¨€å¤±è´¥ã€‚  
6. **æµ‹è¯•**ï¼šCI å·²è¦†ç›–ä¸»è¦è·¯å¾„ï¼Œå»ºè®®åœ¨æœ¬åœ°è·‘ä¸€é `test/registered/debug_utils`ï¼Œç¡®è®¤è‡ªå®šä¹‰è„šæœ¬çš„è·¯å¾„ã€è¿‡æ»¤è§„åˆ™ç­‰ä»ç„¶ç”Ÿæ•ˆã€‚  

æ•´ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†è¯­ä¹‰ä¸€è‡´æ€§å¹¶ç®€åŒ–äº† APIï¼Œä½†ä¼šå¯¼è‡´å‘åä¸å…¼å®¹ã€‚åŠ¡å¿…åœ¨å‡çº§å‰å®Œæˆä¸Šè¿°è¿ç§»ï¼Œç‰¹åˆ«æ˜¯ç¯å¢ƒå˜é‡å’Œ `step` è°ƒç”¨çš„æ”¹åŠ¨ï¼Œä»¥å…åœ¨åˆ†å¸ƒå¼è®­ç»ƒæˆ–ç¦»çº¿ dump åˆ†ææ—¶å‡ºç°æ‰¾ä¸åˆ°å…ƒæ•°æ®æ–‡ä»¶çš„é”™è¯¯ã€‚  

---

### [Benchmark] Remove re-exports from bench_serving.py (#19130)
**SHA**: `1f2da82` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/1f2da824ddc7d8b93093bda07373d98cfb07229f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / ä»£ç ç»„ç»‡  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
æœ¬æ¬¡æäº¤å°†åŸå…ˆåœ¨ `sglang/bench_serving.py` ä¸­å¯¹å¤–é‡æ–°å¯¼å‡ºçš„å·¥å…·å‡½æ•°ï¼ˆå¦‚ `get_tokenizer`ã€`remove_prefix`ã€`set_ulimit`ã€`sample_*` ç­‰ï¼‰å…¨éƒ¨è¿ç§»è‡³ä¸“é—¨çš„å­æ¨¡å— `sglang/benchmark/utils` ä¸ `sglang/benchmark/datasets`ï¼Œå¹¶åœ¨æ‰€æœ‰ benchmark è„šæœ¬ã€æµ‹è¯•ã€ç¤ºä¾‹ä»£ç ä¸­ç›¸åº”åœ°æ›´æ¢äº† import è·¯å¾„ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `benchmark/hicache/*`ã€`benchmark/lora/*`ã€`benchmark/*` ç³»åˆ—åŸºå‡†è„šæœ¬  
- `python/sglang/bench_offline_throughput.py`ã€`python/sglang/bench_serving.py`  
- å¤šä¸ªå•å…ƒ/é›†æˆæµ‹è¯•æ–‡ä»¶ï¼ˆ`test/registered/*`ã€`test/manual/*`ï¼‰  
- `scripts/playground/*` ç¤ºä¾‹è„šæœ¬  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§**ï¼š`bench_serving.py` å·²ä¸å†æä¾›è¿™äº›ç¬¦å·çš„å†å¯¼å‡ºï¼Œè‹¥å¤–éƒ¨é¡¹ç›®ä»é€šè¿‡ `sglang.bench_serving` å¼•å…¥ï¼Œå¯èƒ½ä¼šå‡ºç° `ImportError`ã€‚å»ºè®®åœ¨ `bench_serving.py` ä¸­ä¿ç•™è½»é‡çš„åˆ«åæˆ–åŠ å…¥å¼ƒç”¨æç¤ºï¼Œä»¥å…ç ´åå·²æœ‰ç”Ÿæ€ã€‚  
2. **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–° READMEã€benchmark æ–‡æ¡£ä»¥åŠ API è¯´æ˜ï¼Œæ˜ç¡®æ–° import è·¯å¾„ã€‚  
3. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿æ‰€æœ‰å—å½±å“çš„æµ‹è¯•åœ¨ CI ä¸­å…¨éƒ¨é€šè¿‡ï¼Œç‰¹åˆ«æ˜¯ `test/registered/bench_fn/test_bench_serving_functionality.py` ä¸­å¯¹ `parse_custom_headers` çš„ä½ç½®å˜æ›´ã€‚  
4. **å‘å¸ƒè¯´æ˜**ï¼šåœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„ Release Note ä¸­æ³¨æ˜ â€œbenchmark utilities å·²è¿ç§»è‡³ `sglang.benchmark.utils/datasets`â€ï¼Œå¹¶æä¾›è¿ç§»æŒ‡å—ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†ä»£ç å¯ç»´æŠ¤æ€§å’Œæ¨¡å—èŒè´£åˆ’åˆ†ï¼Œä½†éœ€æ³¨æ„å¯¹å¤– API çš„å¹³æ»‘è¿‡æ¸¡ã€‚

---

### Tiny rename `cuda_graph` tests to `piecewise_cuda_graph` (#19128)
**SHA**: `3fb457b` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/3fb457b1036a07957ddeed70662afb0802ed0e42)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„/ç»´æŠ¤ï¼ˆæ–‡ä»¶é‡å‘½åï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šæœ¬æ¬¡æäº¤å°†åŸå…ˆä½äº `test/registered/cuda_graph` ç›®å½•ä¸‹çš„ä¸‰ä¸ª GPU ç«¯ CUDAâ€‘Graph æµ‹ä¾‹é‡å‘½åè‡³ `test/registered/piecewise_cuda_graph`ï¼Œæ–‡ä»¶åä¿æŒä¸å˜ï¼Œä»…è·¯å¾„è°ƒæ•´ï¼Œä»¥æ›´å‡†ç¡®åœ°åæ˜ å®ƒä»¬é’ˆå¯¹ **piecewise CUDAâ€‘Graph** ç‰¹æ€§çš„æµ‹è¯•ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- **æµ‹è¯•å­ç³»ç»Ÿ**ï¼š`pytest`ã€`unittest` æˆ– CI ä¸­çš„æµ‹è¯•å‘ç°æœºåˆ¶ä¼šä¾æ®æ–‡ä»¶è·¯å¾„æ”¶é›†ç”¨ä¾‹ï¼Œæ”¹ååéœ€ç¡®ä¿æ–°çš„è·¯å¾„è¢«æ­£ç¡®åŒ…å«ã€‚  
- **æ–‡æ¡£/è„šæœ¬**ï¼šè‹¥é¡¹ç›®çš„ READMEã€CI é…ç½®ï¼ˆå¦‚ `.github/workflows/*.yml`ï¼‰æˆ–å†…éƒ¨è„šæœ¬ä¸­ç¡¬ç¼–ç äº†æ—§è·¯å¾„ï¼Œéœ€è¦åŒæ­¥æ›´æ–°ã€‚  
- **å¼€å‘è€… IDE/æœç´¢**ï¼šæœç´¢ `cuda_graph` çš„å¿«æ·æ–¹å¼å¯èƒ½å¤±æ•ˆï¼Œéœ€ä½¿ç”¨æ–°å…³é”®å­— `piecewise_cuda_graph`ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **CI é€šè¿‡éªŒè¯**ï¼šåœ¨ CI ç¯å¢ƒä¸‹è·‘ä¸€éå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼Œç¡®è®¤æµ‹è¯•ä»è¢«å‘ç°å¹¶æ‰§è¡Œï¼›ç‰¹åˆ«ç•™æ„ `--ignore` æˆ– `--collect-only` å‚æ•°æ˜¯å¦å—è·¯å¾„å˜åŠ¨å½±å“ã€‚  
2. **æ–‡æ¡£åŒæ­¥**ï¼šæ£€æŸ¥ `docs/`ã€`CONTRIBUTING.md`ã€`README.md` ä¸­å…³äº â€œcuda_graphâ€ ç¤ºä¾‹çš„æè¿°ï¼Œæ”¹ä¸º â€œpiecewise_cuda_graphâ€ã€‚  
3. **æœç´¢/å¼•ç”¨æ›´æ–°**ï¼šé¡¹ç›®å†…éƒ¨è‹¥æœ‰å¯¹è¿™äº›æµ‹è¯•æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å¼•ç”¨ï¼ˆä¾‹å¦‚åœ¨ `scripts/run_tests.sh` æˆ– `benchmark/` ä¸­ï¼‰ï¼Œè¯·ä¸€å¹¶æ”¹ä¸ºæ–°è·¯å¾„ã€‚  
4. **å†å²è¿½æº¯**ï¼šå› ä¸ºä»…æ˜¯é‡å‘½åï¼Œgit history ä»å¯è¿½æº¯åˆ°åŸæ–‡ä»¶ï¼›è‹¥ä½¿ç”¨ `git log --follow`ï¼Œä»èƒ½æŸ¥çœ‹å˜æ›´è®°å½•ï¼›è‹¥æœ‰å·¥å…·ä¾èµ–æ–‡ä»¶è·¯å¾„åšç»Ÿè®¡ï¼Œéœ€è¦ç¡®è®¤å…¼å®¹ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨å¯¹åŠŸèƒ½æ²¡æœ‰ç›´æ¥å½±å“ï¼Œä¸»è¦æ˜¯æå‡å¯ç»´æŠ¤æ€§å’Œè¯­ä¹‰æ¸…æ™°åº¦ã€‚åªè¦ç¡®ä¿ CI ä¸æ–‡æ¡£åŒæ­¥æ›´æ–°ï¼Œé£é™©æä½ã€‚

---

### [FlashInfer] Switch FlashInfer allreduce fusion to unified API (#18341)
**SHA**: `7b0fb43` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/7b0fb43c7a7e5a6d8584e9ebdd5bc6b12e2f0fcd)

**å˜æ›´æ¦‚è§ˆ**  
æœ¬æ¬¡æäº¤å°† FlashInfer çš„ Allâ€‘Reduceâ€‘Fusion ä»åŸå…ˆçš„ `trtllm_*` æ¥å£è¿ç§»åˆ°ç»Ÿä¸€çš„ `create_allreduce_fusion_workspace / allreduce_fusion` APIã€‚ä»£ç ä¸­åŠ å…¥äº†å¯¹ç»Ÿä¸€ API æ˜¯å¦å¯ç”¨çš„æ£€æµ‹ã€å·¥ä½œç©ºé—´çš„ dtype ä¸ oneshot å‚æ•°ã€ä»¥åŠç¼“å†²åŒºå°ºå¯¸æ£€æŸ¥ã€‚`ensure_workspace_initialized` ç°åœ¨ä½¿ç”¨ `get_tensor_model_parallel_rank` ä»£æ›¿ç›´æ¥çš„ `torch.distributed.get_rank`ï¼Œå¹¶åœ¨å¼ é‡éè¿ç»­æˆ–å°ºå¯¸ä¸è¶³æ—¶å®‰å…¨å›é€€ã€‚

**å½±å“èŒƒå›´**  
- `python/sglang/srt/layers/flashinfer_comm_fusion.py`ï¼ˆæ ¸å¿ƒå®ç°ï¼‰  
- ä¾èµ–è¯¥å±‚çš„æ¨¡å‹æ¨ç†è·¯å¾„ï¼ˆå¦‚æ®‹å·® RMSNormã€å…¶ä»–è‡ªå®šä¹‰å±‚ï¼‰  

**æ ¸å¿ƒé£é™©**  
1. **æ–° API å…¼å®¹æ€§**ï¼šè‹¥è¿è¡Œç¯å¢ƒçš„ FlashInfer ç‰ˆæœ¬ä¸å®ç° `create_allreduce_fusion_workspace` æˆ– `allreduce_fusion`ï¼Œä¼šè‡ªåŠ¨å›é€€åˆ°æ—§å®ç°ï¼Œä½†éƒ¨åˆ†å‚æ•°ï¼ˆå¦‚ `dtype`ã€`use_oneshot`ï¼‰åœ¨æ—§å®ç°ä¸­è¢«å¿½ç•¥ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½æˆ–æ•°å€¼å·®å¼‚ã€‚  
2. **Rank è·å–æ–¹å¼å˜æ›´**ï¼šæ”¹ç”¨ `get_tensor_model_parallel_rank`ï¼Œè‹¥åˆ†å¸ƒå¼åˆå§‹åŒ–æ–¹å¼ä¸åŒï¼Œå¯èƒ½äº§ç”Ÿ rank ä¸ä¸€è‡´ã€‚  
3. **å·¥ä½œç©ºé—´ç”Ÿå‘½å‘¨æœŸ**ï¼š`cleanup` ä»…åœ¨ `self.workspace` å­˜åœ¨æ—¶è°ƒç”¨ `destroy()`ï¼Œè‹¥å¼‚å¸¸æå‰é€€å‡ºï¼Œå¯èƒ½å¯¼è‡´æ®‹ç•™çš„ IPC å¥æŸ„ã€‚  
4. **å¼ é‡è¿ç»­æ€§æ£€æŸ¥**ï¼šåŠ å…¥ `is_contiguous` åˆ¤å®šåç›´æ¥è¿”å› `None, None`ï¼Œè°ƒç”¨æ–¹éœ€å¤„ç†è¿”å›ä¸ºç©ºçš„æƒ…å†µï¼Œé˜²æ­¢åç»­ `None` ä½¿ç”¨å¯¼è‡´å´©æºƒã€‚  

**å»ºè®®**  
- åœ¨ CI ä¸­åŠ å…¥ä¸åŒ FlashInfer ç‰ˆæœ¬ï¼ˆæ—§/æ–°ï¼‰çš„å…¼å®¹æ€§æµ‹è¯•ï¼Œç¡®ä¿å›é€€è·¯å¾„ä»èƒ½æ­£å¸¸è¿è¡Œã€‚  
- ä¸º `ensure_workspace_initialized` æ·»åŠ æ˜¾å¼å¼‚å¸¸æ•è·ï¼Œé˜²æ­¢åˆå§‹åŒ–å¤±è´¥æ—¶å¯¼è‡´å…¨å±€çŠ¶æ€ä¸ä¸€è‡´ã€‚  
- åœ¨è°ƒç”¨ `flashinfer_allreduce_residual_rmsnorm` å‰æ£€æŸ¥è¿”å›å€¼ï¼Œæä¾›å‹å¥½é”™è¯¯ä¿¡æ¯æˆ–è‡ªåŠ¨åˆ‡æ¢åˆ°æ ‡å‡†å®ç°ã€‚  
- æ›´æ–°æ–‡æ¡£ï¼Œè¯´æ˜ `dtype`ã€`use_oneshot` å‚æ•°ä»…åœ¨æ”¯æŒç»Ÿä¸€ API æ—¶ç”Ÿæ•ˆï¼ŒåŠå¦‚ä½•åœ¨ä¸æ”¯æŒçš„ç¯å¢ƒä¸‹æ‰‹åŠ¨ç¦ç”¨ Fusionã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ”¹åŠ¨æå‡äº†ç»Ÿä¸€æ€§å’Œå¯é…ç½®æ€§ï¼Œä½†éœ€å…³æ³¨ç‰ˆæœ¬å…¼å®¹ä¸å¼‚å¸¸æ¢å¤ï¼Œä»¥é¿å…ç”Ÿäº§ç¯å¢ƒå‡ºç°ä¸å¯é¢„æœŸçš„å›é€€æˆ–å´©æºƒã€‚

---

#### ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (9)

### Fix corrupted JSONL metrics file due to concurrent writes (#19011)
**SHA**: `c6a99e4` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/c6a99e43b9872007affc83e624ce4fe19a112f95)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¸º `RequestMetricsExporter` æ·»åŠ  `asyncio.Lock`ï¼Œåœ¨å†™å…¥æ–‡ä»¶æ—¶åŠ é”ï¼Œé˜²æ­¢å¹¶å‘å†™å¯¼è‡´ JSONL æ–‡ä»¶æŸåã€‚

---

### [CI]Extend timeout for test_text_models_perf.py (#19155)
**SHA**: `1f7a813` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/1f7a8130511fd12b96d2d314af1fb4061b049a88)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ nightly æµ‹è¯•å·¥ä½œæµä¸­ä¸ºæ–‡æœ¬æ¨¡å‹å’Œ VLM æ€§èƒ½æµ‹è¯•åŠ å…¥ `--timeout-per-file 3600` å‚æ•°ï¼Œå»¶é•¿å•æ–‡ä»¶è¶…æ—¶æ—¶é—´ã€‚

---

### [diffusion] CI: relax perf check threshold (#19154)
**SHA**: `7d4860b` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/7d4860bc5e2ba9f06c26df534c882c3477edf619)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `perf_baselines.json` ä¸­å°† `denoise_step_ms` çš„ç¬¬2é¡¹é˜ˆå€¼ä» 477.59 æå‡è‡³ 721.20ï¼Œæ”¾å®½ CI æ€§èƒ½æ£€æŸ¥çš„å®¹å·®ã€‚

---

### [PD] Change bootstrap_room metadata dtype from int64 to uint64 (#19141)
**SHA**: `eccee4c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/eccee4c48e55fb05426f238fe0c780a0749e5917)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°† `bootstrap_room` çš„å¼ é‡æ•°æ®ç±»å‹ä» `int64` æ”¹ä¸º `uint64`ï¼Œä»¥é˜²æ­¢å…ƒæ•°æ®æº¢å‡ºæˆ–è´Ÿå€¼å¯¼è‡´çš„é”™è¯¯ã€‚ä»…æ¶‰åŠä¸€è¡Œä»£ç çš„ dtype è°ƒæ•´ï¼Œå½±å“èŒƒå›´æå°ã€‚

---

### [Qwen3-Next] Enable fused_qkvzba_split_reshape_cat also for prefill (#18917)
**SHA**: `5995bfe` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/5995bfec6368faa48fd8ad159bf9805c15ebc217)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `qwen3_next.py` ä¸­ç§»é™¤å¯¹ `is_cuda_graph` çš„æ£€æŸ¥ï¼Œä½¿ `fused_qkvzba_split_reshape_cat` åœ¨é CPU ç¯å¢ƒä¸‹çš„é¢„å¡«å……é˜¶æ®µä¹Ÿèƒ½å¯ç”¨ï¼Œä»è€Œç®€åŒ–æ¡ä»¶åˆ¤æ–­å¹¶æå‡å…¼å®¹æ€§ã€‚

---

### Fix spec v2+dp attention in nsa backend (#19134)
**SHA**: `8cf003c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/8cf003c44b1b6481cf8b7f61258137f3fc625f85)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `pad_nsa_cache_seqlens` ä¸­åŠ å…¥å¯¹ DP åœºæ™¯çš„æ£€æŸ¥ï¼Œç»Ÿä¸€ä½¿ç”¨ `needs_cp_pad` ä¸ `needs_dp_pad` æ§åˆ¶æ˜¯å¦éœ€è¦å¡«å……ï¼Œæå‡æ³¨æ„åŠ›ç¼“å­˜å¡«å……é€»è¾‘çš„å¯è¯»æ€§ä¸å…¼å®¹æ€§ã€‚

---

### [BUG] [DLLM] Missing max_running_requests value (#18740)
**SHA**: `8612358` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/8612358ee9183053e6e74a4f11806e2da41c5ba1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šå°†è°ƒåº¦å™¨ä¸­è·å– DLLM æœ€å¤§å¹¶å‘å®¹é‡çš„æ¥æºï¼Œä» `server_args.max_running_requests` æ”¹ä¸º `dllm_config.max_running_requests`ï¼Œä¿®å¤ç¼ºå¤±é…ç½®å¯¼è‡´çš„é”™è¯¯ã€‚

---

### [Fix] Quick fix for int32 overflow in Mooncakes' send_kvcache_slice (#19076)
**SHA**: `cef353f` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/cef353f338437c84787c55778dbdce143bb29f69)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `conn.py` ä¸­å°†åŸæœ¬ä½¿ç”¨ `np.int32` çš„ç´¢å¼•å’Œæ•°ç»„æ”¹ä¸º `np.int64`ï¼Œé˜²æ­¢åœ¨ Mooncake çš„ `send_kvcache_slice` è¿‡ç¨‹ä¸­å‡ºç° int32 æº¢å‡ºã€‚

---

### Fix dev Docker build OOM on ARM64 cu13 by adding docker system prune (#18947)
**SHA**: `b2d8cc8` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/b2d8cc8cf0bd8623989ffb1b5cc6e5f7083b60d5)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé…ç½®è°ƒæ•´  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `release-docker-dev.yml` å·¥ä½œæµä¸­åŠ å…¥ Docker æ¸…ç†æ­¥éª¤ï¼Œä½¿ç”¨ `docker buildx prune` ä¸ `docker system prune` åœ¨æ„å»ºå‰å›æ”¶ç£ç›˜ç©ºé—´ï¼Œé¿å… ARM64 cu13 å¼€å‘é•œåƒæ„å»ºæ—¶å‡ºç° OOMã€‚

---

