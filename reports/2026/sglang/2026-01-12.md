# æ¯æ—¥æ›´æ–°æŠ¥å‘Šï¼ˆ2026-01-12ï¼‰

## sgl-project/sglang

| æäº¤æ—¶é—´ | ä½œè€… | æäº¤ä¿¡æ¯ |
|----------|------|----------|
| 2026-01-12 23:44:45 | Gaoji Liu | [Model] Support IQuest-Coder-40B-Loop (#16348) |
| 2026-01-12 22:37:39 | Simo Lin | [model-gateway] Fix workflow engine race conditions and add graceful shutdown (#16963) |
| 2026-01-12 21:58:16 | WenhaoZhang | [diffusion] app: add ComfyUI plugin support for SGLang-Diffusion (#15271) |
| 2026-01-12 20:16:30 | khalilzhk | [CI] fix piecewise graph test case on ascend (#16933) |
| 2026-01-12 20:14:35 | chenxu214 | Bugfix: EagleDraftWorker has not attribute "eagle_use_aux_hidden_state" (#16480) |
| 2026-01-12 19:40:37 | HuangJi | [diffusion] Support I2I/TI2I/I2V/TI2V warmup && T2I/T2V warmup bug fix (#16922) |
| 2026-01-12 19:14:07 | ybyang | add doc for dsv32 cp+pp (#16916) |
| 2026-01-12 17:26:57 | Liangsheng Yin | Fix wrong kernel selection for int32/int64 indices (#16912) |
| 2026-01-12 17:01:24 | Xun Sun | Re-introduce the unit test of test_mooncake_ep_small (#16019) |
| 2026-01-12 16:06:31 | YC Tseng | [AMD] CI - enable test case for amd ci : triton_attention_kernels , torch_compile_moe (#16559) |
| 2026-01-12 16:00:10 | Hu Chong | [diffusion] chore: validate sampling params (#16677) |
| 2026-01-12 15:01:29 | Wenyi Xu | [model-gateway] Improve Health Check Logging (#16930) |
| 2026-01-12 14:49:55 | Adarsh Shirawalmath | [docs] sync diffusion docs to main docs (#16932) |
| 2026-01-12 13:55:38 | HuangJi | [diffusion] model: Support TurboWan2.2-I2V SLA && add CI test for TurboWan (#16536) |
| 2026-01-12 13:42:43 | fzyzcjy | Tiny refactor age computation in router (#16850) |
| 2026-01-12 11:47:58 | Hexq0210 | [NPU] update feature supported on ascend NPU (#16915) |
| 2026-01-12 10:53:17 | fzyzcjy | Tiny fix NoAvailableWorkers being a RetryError (#16896) |
| 2026-01-12 10:52:42 | Liangsheng Yin | Decouple grammar logic out of scheduler. (#16820) |
| 2026-01-12 08:54:56 | chenxu140 | llama model and llama eagle3 model support dp-attn (#15268) |
| 2026-01-12 08:09:41 | ybyang | [model-gateway]: add qwen coder tool parser support xml format for qwen3 coder and microthinker (#12909) |
| 2026-01-12 00:36:45 | Liangsheng Yin | Tiny fix typo `minxin` -> `mixin` (#16908) |

### ğŸ“Š ç»Ÿè®¡æ‘˜è¦
> æœ¬æ—¥å…± 21 ä¸ªæäº¤ | ğŸ”´é«˜ 2 | ğŸŸ¡ä¸­ 11 | ğŸŸ¢ä½ 8
## ğŸ“‹ ç›®å½•

- [sgl-project/sglang](#sgl-project-sglang)
  - [ğŸ“Š ç»Ÿè®¡æ‘˜è¦](#-ç»Ÿè®¡æ‘˜è¦)
  - [ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (2)](#-ğŸ”´-é«˜é‡è¦åº¦å˜æ›´-2)
    - [[diffusion] app: add ComfyUI plugin support for SGLang-Di...](#76f69b7)
    - [[model-gateway]: add qwen coder tool parser support xml f...](#503c3d9)
  - [ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (11)](#-ğŸŸ¡-ä¸­é‡è¦åº¦å˜æ›´-11)
    - [[Model] Support IQuest-Coder-40B-Loop (#16348)](#7b682de)
    - [[model-gateway] Fix workflow engine race conditions and a...](#d0092de)
    - [[diffusion] Support I2I/TI2I/I2V/TI2V warmup && T2I/T2V w...](#2dadf63)
    - [Re-introduce the unit test of test_mooncake_ep_small (#16...](#9f5cd80)
    - [[AMD] CI - enable test case for amd ci : triton_attention...](#b1ee75a)
    - [[diffusion] chore: validate sampling params (#16677)](#f44c63e)
    - [[docs] sync diffusion docs to main docs (#16932)](#aab906a)
    - [[diffusion] model: Support TurboWan2.2-I2V SLA && add CI ...](#feb39f7)
    - [Tiny refactor age computation in router (#16850)](#38b30c7)
    - [Decouple grammar logic out of scheduler. (#16820)](#5b7bed7)
    - [Tiny fix typo `minxin` -> `mixin` (#16908)](#934ae89)
  - [ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (8)](#-ğŸŸ¢-ä½é‡è¦åº¦å˜æ›´-8)
    - [[CI] fix piecewise graph test case on ascend (#16933)](#9a62874)
    - [Bugfix: EagleDraftWorker has not attribute "eagle_use_aux...](#53dca74)
    - [add doc for dsv32 cp+pp (#16916)](#aab640c)
    - [Fix wrong kernel selection for int32/int64 indices (#16912)](#2b3791e)
    - [[model-gateway] Improve Health Check Logging (#16930)](#c54c70a)
    - [[NPU] update feature supported on ascend NPU (#16915)](#c581b5e)
    - [Tiny fix NoAvailableWorkers being a RetryError (#16896)](#a1c4894)
    - [llama model and llama eagle3 model support dp-attn (#15268)](#38a8847)
#### ğŸ”´ é«˜é‡è¦åº¦å˜æ›´ (2)

### [diffusion] app: add ComfyUI plugin support for SGLang-Diffusion (#15271)
**SHA**: `76f69b7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/76f69b77530c734ff9b92b5d036316ba097ba943)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºã€æ¶æ„å˜æ›´ã€æ€§èƒ½ä¼˜åŒ–ã€å…¼å®¹æ€§å¢å¼º  

**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
æœ¬æ¬¡æäº¤ä¸º SGLangâ€‘Diffusion å¼•å…¥äº†å¯¹ **ComfyUI** çš„æ’ä»¶åŒ–æ”¯æŒã€‚æ ¸å¿ƒå®ç°åŒ…æ‹¬ï¼š  
1. æ–°å¢ `ComfyUI_SGLDiffusion` åº”ç”¨ç›®å½•ï¼Œæä¾›èŠ‚ç‚¹ã€å·¥å…·å‡½æ•°ã€ç¤ºä¾‹ workflowã€‚  
2. å®ç° **ComfyUIâ€‘ä¸“ç”¨ Pipeline**ï¼ˆ`ComfyUIFluxPipeline` ä¸ `ComfyUIZImagePipeline`ï¼‰ï¼Œåœ¨æœåŠ¡å™¨ç«¯ç›´æ¥ä½¿ç”¨ **Passâ€‘Through Scheduler**ï¼Œå°†å»å™ªæ­¥éª¤äº¤ç»™ ComfyUIã€‚  
3. æ‰©å±•æ¨¡å‹åŠ è½½é€»è¾‘ï¼Œæ”¯æŒç›´æ¥ä» **.safetensors** å•æ–‡ä»¶åŠ è½½ï¼ˆæ— éœ€ `model_index.json`ï¼‰ï¼Œå¹¶å®ç° **ComfyUI æƒé‡æ˜ å°„** ä¸ **qkv/MLP æ‹†åˆ†**ã€‚  
4. åœ¨ `registry`ã€`server_args`ã€`pipeline` æ„å»ºæµç¨‹ä¸­åŠ å…¥ **pipeline_class_name**ã€`comfyui_mode` ç­‰å‚æ•°ï¼Œä»¥å®ç°æ˜¾å¼ç®¡çº¿è¦†ç›–ä¸ ComfyUI é›†æˆã€‚  
5. æ–°å¢å¤šçº¿ç¨‹/è¿›ç¨‹æ¸…ç†ã€LoRA è®¾ç½®/è§£é™¤ã€è§†é¢‘/å›¾ç‰‡ API å“åº”å­—æ®µï¼ˆ`file_path`ï¼‰ç­‰ç»†èŠ‚è¡¥å……ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `python/sglang/multimodal_gen/apps/ComfyUI_SGLDiffusion/*`ï¼ˆèŠ‚ç‚¹ã€æ ¸å¿ƒç±»ã€å·¥å…·ã€workflow ç¤ºä¾‹ï¼‰  
- `python/sglang/multimodal_gen/configs/*`ï¼ˆpipeline_configã€sampling_params çš„ safetensors å…¼å®¹ï¼‰  
- `python/sglang/multimodal_gen/registry.py`ï¼ˆpipeline config æ³¨å†Œã€è·å–ï¼‰  
- `python/sglang/multimodal_gen/runtime/*`ï¼ˆpipeline æ„å»ºã€schedulerã€pipeline stagesã€GPU workerã€server_argsï¼‰  
- å¯¹å¤– APIï¼š`/v1/images/*`ã€`/v1/videos/*` å¢åŠ  `file_path`ã€`output_path` å‚æ•°ã€‚  

---

## ğŸ” æŠ€æœ¯æ´å¯Ÿ  

### æ¶æ„å½±å“  
| å½±å“ç‚¹ | è¯´æ˜ |
|--------|------|
| **ComfyUI æ’ä»¶å±‚** | æ–°å¢ `__init__.py`ã€`nodes.py`ã€`core/*`ï¼ˆgeneratorã€model_patcherã€server_apiï¼‰ä»¥åŠ `executors`ï¼ˆFluxã€ZImageï¼‰å®ç°ï¼Œå½¢æˆ **ComfyUI â†’ SGLangæœåŠ¡å™¨** åŒå‘è°ƒç”¨ç»“æ„ã€‚ |
| **Pipeline å¯è¦†ç›–** | `ServerArgs.pipeline_class_name` å…è®¸åœ¨å¯åŠ¨æ—¶ç›´æ¥æŒ‡å®š pipelineï¼Œç»•è¿‡ `model_index.json`ï¼Œå¯¹å•æ–‡ä»¶ï¼ˆ.safetensorsï¼‰æ¨¡å‹å°¤ä¸ºå…³é”®ã€‚ |
| **Passâ€‘Through Scheduler** | `ComfyUIPassThroughScheduler` åªè´Ÿè´£ timesteps ä¼ é€’ä¸åŒ…è£…ï¼Œä¸åšå™ªå£°é¢„æµ‹ï¼ŒçœŸæ­£çš„ denoising äº¤ç»™ ComfyUI çš„è‡ªå®šä¹‰ `FluxExecutor` / `ZImageExecutor`ã€‚è¿™ä½¿å¾— **ComfyUI** èƒ½å®Œæ•´æ§åˆ¶é‡‡æ ·å¾ªç¯ï¼ˆé‡‡æ ·æ­¥æ•°ã€è‡ªå®šä¹‰ LoRAã€å›¾åƒ/è§†é¢‘åå¤„ç†ç­‰ï¼‰ã€‚ |
| **æ¨¡å‹åŠ è½½æ”¹é€ ** | å½“æ£€æµ‹åˆ° `.safetensors` ä¸”æä¾› `pipeline_class_name` æ—¶ï¼Œ`registry` ä¼šè¿”å›å¯¹åº”çš„ `PipelineConfig` ä¸ `SamplingParams`ï¼Œå¹¶åœ¨ `load_modules` ä¸­è‡ªè¡Œè§£ææƒé‡ã€æ‰§è¡Œ **æƒé‡æ˜ å°„ + æ‹†åˆ†**ï¼ˆå¦‚ `single_blocks.{i}.linear1` â†’ `attn.to_qkv` ä¸ `proj_mlp`ï¼‰ï¼Œå¹¶å¤„ç† **scale/shift** äº¤æ¢ï¼ˆ`norm_out.linear`ï¼‰ã€‚ |
| **æ–°å¢ Stage** | `ComfyUILatentPreparationStage` ç»§æ‰¿åŸ `LatentPreparationStage`ï¼Œåœ¨å¤š GPUï¼ˆSPï¼‰ç¯å¢ƒä¸‹è‡ªåŠ¨ **ä¿®å¤å¼ é‡è®¾å¤‡ä¸åŒ¹é…**ï¼ˆå›  `broadcast_pyobj` äº§ç”Ÿçš„ metaâ€‘tensorï¼‰ï¼Œä¿è¯ latents åœ¨æ‰€æœ‰è¿›ç¨‹ä¸Šä¿æŒåŒä¸€ deviceã€‚ |
| **è¾“å‡ºè·¯å¾„æ›å…‰** | `ImageResponseData` ä¸ `VideoResponse` å¢åŠ  `file_path`ï¼Œä½¿å¾—å‰ç«¯ï¼ˆComfyUIï¼‰å¯ç›´æ¥è¯»å–æœ¬åœ°ç”Ÿæˆæ–‡ä»¶ï¼Œé¿å…äºŒæ¬¡ä¸‹è½½ã€‚ |
| **GPU Worker è¾“å‡º** | `gpu_worker.execute_forward` ç°åœ¨æŠŠ `noise_pred` ä¼ å› `OutputBatch`ï¼Œä¾›åç»­ `ComfyUI` é‡‡æ ·é˜¶æ®µä½¿ç”¨ã€‚ |

### æ€§èƒ½å½±å“  
| ç»´åº¦ | æ­£é¢å½±å“ | æ½œåœ¨è´Ÿé¢ |
|------|----------|----------|
| **GPU èµ„æºåˆ©ç”¨** | é€šè¿‡ Passâ€‘Through Schedulerï¼Œ**å»å™ªè®¡ç®—å…¨éƒ¨åœ¨ ComfyUI ç«¯**ï¼ˆé€šå¸¸åœ¨åŒä¸€æœºå™¨ä¸Šï¼‰ï¼Œå¯ç›´æ¥åˆ©ç”¨ ComfyUI çš„ **å¤šå¡/åˆ†å¸ƒå¼è°ƒåº¦**ï¼Œé¿å…æœåŠ¡å™¨ç«¯é‡å¤æ¨ç†ã€‚ | è‹¥ ComfyUI ä¸æœåŠ¡å™¨ä¸åœ¨åŒä¸€è¿›ç¨‹/èŠ‚ç‚¹ï¼Œè·¨è¿›ç¨‹/ç½‘ç»œä¼ è¾“ latents ä¸å™ªå£°é¢„æµ‹ä¼šäº§ç”Ÿé¢å¤–çš„ **å¸¦å®½/å»¶è¿Ÿ** å¼€é”€ã€‚ |
| **æ¨¡å‹åŠ è½½æ—¶é—´** | æ”¯æŒå•æ–‡ä»¶ `.safetensors` ç›´æ¥åŠ è½½ï¼Œçœå»è¯»å– `model_index.json`ã€å¤šæ–‡ä»¶è§£å‹çš„ I/O æ­¥éª¤ã€‚ | æƒé‡æ˜ å°„ä¸æ‹†åˆ†ï¼ˆå°¤å…¶æ˜¯ `linear1` â†’ `to_qkv`/`proj_mlp`ï¼‰åœ¨åŠ è½½é˜¶æ®µä¼šåšé¢å¤–çš„ **CPUâ€‘ä¾§å¼ é‡åˆ‡å‰²**ï¼Œå¯¹å¤§æ¨¡å‹ç•¥æœ‰ CPU è´Ÿæ‹…ã€‚ |
| **å¤š GPUï¼ˆSPï¼‰** | `ComfyUILatentPreparationStage` ä¿®å¤äº† **device mismatch**ï¼Œé˜²æ­¢å›  metaâ€‘tensor å¯¼è‡´çš„ **æ˜¾å­˜æµªè´¹æˆ–é¢å¤–æ‹·è´**ã€‚ | ä»ç„¶ä¾èµ– `gather_latents_for_sp` åœ¨ç»“æœæ”¶é›†æ—¶è¿›è¡Œä¸€æ¬¡ **Allâ€‘Gather**ï¼Œåœ¨æå¤§ batch/é«˜åˆ†è¾¨ç‡æƒ…å†µä¸‹ä»æœ‰é€šä¿¡å¼€é”€ã€‚ |
| **LoRA åŠ¨æ€åŠ è½½** | `set_lora` / `unset_lora` é€šè¿‡ HTTP æ¥å£å®ç°å³æ—¶åŠ è½½/å¸è½½ï¼Œå…é™¤é‡å¯æœåŠ¡å™¨ã€‚ | LoRA æƒé‡åˆ‡æ¢æ—¶ä¼šè§¦å‘ **æ¨¡å‹å‚æ•°é‡æ–°æ‹·è´**ï¼Œè‹¥ LoRA è¾ƒå¤§ï¼ˆå¦‚å¤š adapterï¼‰ï¼Œå¯èƒ½ç¬æ—¶å ç”¨é¢å¤–æ˜¾å­˜ã€‚ |
| **I/O** | `file_path` ç›´æ¥è¿”å›æœ¬åœ°è·¯å¾„ï¼Œçœå» base64 ç¼–ç /ç½‘ç»œä¼ è¾“çš„æ—¶é—´ä¸ CPU è´Ÿè½½ã€‚ | è‹¥ç”¨æˆ·æŒ‡å®šçš„ `output_path` ä½äºç½‘ç»œæŒ‚è½½æˆ–æ…¢ç£ç›˜ï¼Œå†™å…¥å»¶è¿Ÿå¯èƒ½å½±å“ API è¿”å›æ—¶é—´ã€‚ |

### å®‰å…¨è€ƒè™‘  
| é£é™©ç‚¹ | æè¿° | ä¸¥é‡åº¦ |
|--------|------|--------|
| **API Key ä¼ æ’­** | `SGLDiffusionServerAPI` é»˜è®¤ä½¿ç”¨ `api_key="sk-proj-1234567890"`ï¼Œä¸”åœ¨ `ImageResponseData`ã€`VideoResponse` ä¸­ **è¿”å› `file_path`**ï¼Œå¯èƒ½æ³„éœ²ç³»ç»Ÿå†…éƒ¨è·¯å¾„ã€‚ | ä¸­ |
| **æ–‡ä»¶è·¯å¾„æ‹¼æ¥** | `get_image_path`ã€`convert_video_to_comfy_video` å°†ç”¨æˆ·æä¾›çš„ `image`/`video` è·¯å¾„ç›´æ¥å†™å…¥ç£ç›˜ï¼Œè‹¥æœªæ ¡éªŒå¯èƒ½äº§ç”Ÿ **è·¯å¾„éå†**ï¼ˆå¦‚ `../`ï¼‰ã€‚ | ä¸­ |
| **LoRA å‚æ•°** | `set_lora` å…è®¸ä»»æ„è·¯å¾„ `lora_path`ï¼Œè‹¥æŒ‡å‘æ¶æ„æ–‡ä»¶ï¼ˆæ¯”å¦‚ç³»ç»Ÿè„šæœ¬ï¼‰ï¼Œåœ¨åŠ è½½æ—¶å¯èƒ½ **æ‰§è¡Œä»»æ„ä»£ç **ï¼ˆå–å†³äº `torch.load` å®ç°ï¼‰ã€‚ | é«˜ |
| **è·¨è¿›ç¨‹æ€ä¼¤** | `SGLDiffusionGenerator.kill_generator` ä½¿ç”¨ `psutil` ç»“æŸæ‰€æœ‰åŒ¹é… `sgl_diffusion::` çš„å­è¿›ç¨‹ï¼Œè‹¥åŒ¹é…æ¡ä»¶è¿‡å®½ï¼Œå¯èƒ½è¯¯æ€å…¶å®ƒä¸ç›¸å…³è¿›ç¨‹ã€‚ | ä½ |
| **ç½‘ç»œè¯·æ±‚è¶…æ—¶** | `generate_video`ã€`generate_image` ä½¿ç”¨é»˜è®¤ 300 ç§’è¶…æ—¶ï¼Œè‹¥æœåŠ¡å™¨è¢«æ¶æ„å ç”¨å¯é€ æˆ **DoS**ï¼ˆé•¿æ—¶é—´å ç”¨èµ„æºï¼‰ã€‚ | ä½ |

**å»ºè®®**ï¼š  
- å°†é»˜è®¤ `api_key` ç§»é™¤æˆ–å¼ºåˆ¶ç”¨æˆ·åœ¨å¯åŠ¨æ—¶æ˜¾å¼é…ç½®ã€‚  
- å¯¹ `image_path`ã€`video_path`ã€`lora_path` åš **ç™½åå•/è·¯å¾„æ­£åˆ™æ ¡éªŒ**ï¼Œé˜²æ­¢ç›®å½•éå†ã€‚  
- LoRA åŠ è½½å‰æ£€æŸ¥æ–‡ä»¶æ‰©å±•åï¼ˆä»… `.safetensors`ï¼‰å¹¶ä½¿ç”¨ `torch.load(..., map_location='cpu')` å†è½¬ç§»åˆ° GPUï¼Œä»¥é¿å…æ‰§è¡ŒåµŒå…¥çš„è‡ªå®šä¹‰ç±»ã€‚  
- åœ¨ `kill_generator` ä¸­åŠ å…¥ **è¿›ç¨‹åå®Œæ•´åŒ¹é…**ï¼ˆå¦‚ `sgl_diffusion::worker`ï¼‰æˆ–è®°å½•å­è¿›ç¨‹ PID è¿›è¡Œç²¾å‡†ç»ˆæ­¢ã€‚  
- å¯¹é•¿æ—¶é—´ HTTP è°ƒç”¨è¿”å› **è¿›åº¦å›è°ƒ** æˆ– **åå°ä»»åŠ¡ ID**ï¼Œå‰ç«¯è½®è¯¢è€Œéé˜»å¡ç­‰å¾…ã€‚  

---

**âš ï¸ æ½œåœ¨é£é™©**  
1. **å…¼å®¹æ€§ç ´å**ï¼šæ—§ç‰ˆæ¨¡å‹ï¼ˆä»…ä»¥ç›®å½•ç»“æ„å­˜æ”¾ï¼‰ä»

---

### [model-gateway]: add qwen coder tool parser support xml format for qwen3 coder and microthinker (#12909)
**SHA**: `503c3d9` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/503c3d9566646ac3bb42c0c1ae0e384b0954c2d7)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºã€æ¶æ„æ‰©å±•ã€æµ‹è¯•è¦†ç›–å¢åŠ   

**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸ”´é«˜  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. ä¸º Qwen ç³»åˆ—çš„ *Coder* æ¨¡å‹æ–°å¢ä¸“ç”¨çš„ XMLâ€‘style toolâ€‘call è§£æå™¨ `QwenCoderParser`ï¼Œæ”¯æŒ `<tool_call>`ã€`<function=â€¦>`ã€`<parameter=â€¦>` ç­‰æ ‡ç­¾ã€‚  
2. åœ¨ `ParserFactory` ä¸­æ³¨å†Œè¯¥è§£æå™¨ï¼Œå¹¶ä¸ºå¤šç§ Qwenâ€‘Coder å‹å·æ˜ å°„ `qwen_coder`ï¼Œä¿ç•™åŸæœ‰ `qwen`ï¼ˆJSON æ ¼å¼ï¼‰æ˜ å°„ã€‚  
3. æ–°å¢å¤§é‡å•å…ƒã€é›†æˆã€è¾¹ç•ŒåŠå¼‚å¸¸æµ‹è¯•ï¼Œç¡®ä¿å®Œæ•´çš„è§£æã€å¢é‡æµå¼ã€é”™è¯¯æ¢å¤ç­‰è¡Œä¸ºã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sgl-model-gateway/src/tool_parser/`ï¼šæ–°å¢ `qwen_coder.rs`ã€æ¨¡å—å¯¼å‡ºã€å·¥å‚æ³¨å†Œã€‚  
- `sgl-model-gateway/src/tool_parser/factory.rs`ï¼šæ¨¡å‹æ˜ å°„è§„åˆ™ä¸ parser æ³¨å†Œã€‚  
- `sgl-model-gateway/tests/tool_parser/`ï¼šæ–°å¢ `tool_parser_qwen_coder.rs` ä¸å¯¹åº”çš„æµ‹è¯•å…¥å£ã€‚  
- å½±å“æ‰€æœ‰ä½¿ç”¨ `ToolParserFactory` çš„æ¨¡å‹ç½‘å…³å…¥å£ï¼ˆä¾‹å¦‚ `ModelGateway`ã€`Inference` æ¨¡å—ï¼‰ï¼Œå› ä¸ºç°åœ¨ä¼šåœ¨è¿è¡Œæ—¶æ ¹æ®æ¨¡å‹åç§°é€‰æ‹© `qwen_coder` è§£æå™¨ã€‚  

**ğŸ” æŠ€æœ¯æ´å¯Ÿ**  

| ç»´åº¦ | å½±å“åˆ†æ |
|------|----------|
| **æ¶æ„å½±å“** | â€¢ **æ¨¡å—åŒ–æ‰©å±•**ï¼š`QwenCoderParser` å®Œå…¨éµå¾ªç°æœ‰ `ToolParser` traitï¼Œä¿æŒæ¥å£ä¸€è‡´ï¼Œæ–°å¢åå¯¹å¤–æ— ç ´åæ€§æ”¹åŠ¨ã€‚<br>â€¢ **Factory å¢å¼º**ï¼šåœ¨æ¨¡å‹â€‘>parser çš„æ˜ å°„è¡¨ä¸­åŠ å…¥äº†æ›´ç»†ç²’åº¦çš„æ¨¡å¼ï¼Œä½¿ç”¨ â€œé•¿æ¨¡å¼ä¼˜å…ˆâ€ çš„é¡ºåºï¼Œç¡®ä¿ `qwen_coder` ä¸è¢« `qwen` è¦†ç›–ã€‚<br>â€¢ **çŠ¶æ€ç®¡ç†**ï¼šä¸ºæµå¼è§£ææ·»åŠ äº†å¤šæ®µç¼“å†²ã€å·¥å…·è°ƒç”¨ç´¢å¼•ã€å‚æ•°å¢é‡æ‹¼è£…ç­‰çŠ¶æ€å­—æ®µï¼Œå¯¹ `ParserFactory` æ²¡æœ‰å½±å“ï¼Œåªæ˜¯å®ä¾‹åŒ–æ—¶å¤šå ç”¨ä¸€ç‚¹å†…å­˜ã€‚ |
| **æ€§èƒ½å½±å“** | â€¢ **æ­£åˆ™ç¼–è¯‘**ï¼šåœ¨ `new()` ä¸­é¢„ç¼–è¯‘ 3 æ¡æ­£åˆ™ï¼Œæˆæœ¬åœ¨å®ä¾‹åŒ–æ—¶ä¸€æ¬¡å®Œæˆï¼Œåç»­ä½¿ç”¨ `Regex::captures_iter` è¿›è¡ŒåŒ¹é…ã€‚å¯¹å•æ¡è¯·æ±‚çš„ CPU å¼€é”€å¯æ¥å—ï¼ˆ<â€¯1â€¯msï¼‰ï¼Œä½†åœ¨æé«˜å¹¶å‘æˆ–å¤§æ–‡æœ¬ï¼ˆ>â€¯1â€¯MBï¼‰æ—¶æ¯ä¸ª chunk éƒ½ä¼šéå†ä¸€æ¬¡ç¼“å†²åŒºï¼Œå¯èƒ½äº§ç”Ÿ **O(Nâ€¯Â·â€¯M)** çš„åŒ¹é…æˆæœ¬ã€‚<br>â€¢ **å†…å­˜å ç”¨**ï¼š`buffer`ã€`prev_tool_call_arr`ã€`streamed_args_for_tool` éšæµå¼æ•°æ®å¢é•¿ã€‚å¯¹æå¤§å‚æ•°ï¼ˆå¦‚ 100â€¯KB+ï¼‰ä¼šå¯¼è‡´å †å†…å­˜çº¿æ€§å¢é•¿ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒè®¾å®šä¸Šé™å¹¶åœ¨ `parse_incremental` è¶…å‡ºæ—¶ç›´æ¥é”™è¯¯è¿”å›ã€‚<br>â€¢ **æµå¼å¢é‡**ï¼šå®ç°äº†å¢é‡æ‹¼è£… JSON ç‰‡æ®µï¼Œä»…åœ¨å‚æ•°å˜æ›´æ—¶å‘é€ï¼Œåªè¦å‚æ•°æ•°é‡ä¸æç«¯ï¼Œç½‘ç»œå¸¦å®½ä¸å“åº”å»¶è¿Ÿå‡ä¿æŒåœ¨åŸæœ‰æ°´å¹³ã€‚ |
| **å®‰å…¨è€ƒè™‘** | â€¢ **è¾“å…¥éš”ç¦»**ï¼šæ‰€æœ‰å¤–éƒ¨è¾“å…¥å‡è§†ä¸ºä¸å¯ä¿¡ï¼Œä»…åšæ ‡ç­¾æŠ½å–ä¸ HTML å®ä½“è§£ç ï¼Œéšåäº¤ç»™ `serde_json::from_str` è¿›è¡Œä¸¥æ ¼çš„ JSON è§£æï¼Œé¿å…ä»£ç æ³¨å…¥ã€‚<br>â€¢ **æ­£åˆ™ ReDoS**ï¼šä½¿ç”¨çš„æ˜¯éå›æº¯çš„ `(?s)` ä¸ç®€å•å­—ç¬¦ç±»çš„æ¨¡å¼ï¼Œé£é™©æä½ï¼›ä½†ä»å»ºè®®åœ¨ CI ä¸­åŠ å…¥ **Regexâ€‘DOS** æ£€æµ‹ï¼ˆå¦‚ `re2`ï¼‰ã€‚<br>â€¢ **å·¥å…·ç™½åå•**ï¼šåœ¨å¢é‡è§£ææ—¶é€šè¿‡ `helpers::get_tool_indices` åªå…è®¸è¿è¡Œå·²åœ¨ `tools` åˆ—è¡¨ä¸­çš„å‡½æ•°åï¼Œé˜²æ­¢æ¶æ„æ„é€ æœªçŸ¥å‡½æ•°è°ƒç”¨ã€‚<br>â€¢ **é”™è¯¯æ¢å¤**ï¼šå½“å‡½æ•°åä¸åœ¨ç™½åå•æˆ– XML ç»“æ„ä¸å®Œæ•´æ—¶ä¼š **reset** è§£æçŠ¶æ€å¹¶æŠŠåŸå§‹å†…å®¹è§†ä½œæ™®é€šæ–‡æœ¬è¿”å›ï¼Œé¿å…å¼‚å¸¸æ³„éœ²æˆ–æœåŠ¡å´©æºƒã€‚ |
| **å¯ç»´æŠ¤æ€§** | â€¢ ä»£ç éµå¾ªé¡¹ç›®å·²æœ‰çš„ **ToolParser** è§„èŒƒï¼Œé€»è¾‘ä¸ `QwenParser`ï¼ˆJSONï¼‰ç›¸ä¼¼ï¼Œä¾¿äºåç»­ç»Ÿä¸€é‡æ„ã€‚<br>â€¢ å¤§é‡å•å…ƒ/é›†æˆæµ‹è¯•è¦†ç›–äº†æ­£å¸¸ã€è¾¹ç•Œã€å¼‚å¸¸ã€è¶…å¤§ã€Unicodeã€HTMLâ€‘entity ç­‰åœºæ™¯ï¼Œé™ä½åç»­æ”¹åŠ¨å›å½’é£é™©ã€‚<br>â€¢ è¾…åŠ©å‡½æ•°ï¼ˆ`html_unescape`, `safe_val`ï¼‰ç‹¬ç«‹æŠ½å–ï¼Œå¯åœ¨å…¶ä»– parser ä¸­å¤ç”¨ã€‚ |

**âš ï¸ æ½œåœ¨é£é™©**  
1. **å†…å­˜æ³„æ¼ / OOM**ï¼šåœ¨æµå¼æ¨¡å¼ä¸‹è‹¥å®¢æˆ·ç«¯æŒç»­å‘é€æå¤§æˆ–æ— é™å¢é•¿çš„ `<parameter>` å†…å®¹ï¼Œ`buffer` ä¸ `streamed_args_for_tool` å°†æ— é™å¢é•¿ã€‚  
2. **æ­£åˆ™æ€§èƒ½å›é€€**ï¼š`xml_param_pattern` ä½¿ç”¨ `(?s)` æ•è·ä»»æ„å­—ç¬¦ï¼Œè‹¥å‡ºç°æé•¿çš„å•æ®µæ–‡æœ¬ï¼ˆä¾‹å¦‚ 10â€¯MB çš„å•å‚æ•°ï¼‰ï¼ŒåŒ¹é…è€—æ—¶å¯èƒ½æ¿€å¢ã€‚  
3. **æ¨¡å‹æ˜ å°„å†²çª**ï¼šæ–°å¢ `qwen_coder` çš„æ˜ å°„é¡ºåºä¾èµ–â€œé•¿æ¨¡å¼ä¼˜å…ˆâ€ã€‚è‹¥æœªæ¥å‡ºç°åŒåä½†æ›´é•¿çš„æ¨¡å‹æ ‡è¯†ï¼Œå¯èƒ½è¯¯åŒ¹é…åˆ° `qwen`ã€‚  
4. **é”™è¯¯æ¢å¤ä¸å®Œæ•´**ï¼šåœ¨ `parse_incremental` é‡Œå½“é‡åˆ°éæ³•å‡½æ•°åä¼šç›´æ¥ `reset` å¹¶æŠŠå‰©ä½™å†…å®¹å½“æ™®é€šæ–‡æœ¬è¿”å›ã€‚è‹¥åç»­ä»æœ‰åˆæ³•è°ƒç”¨ï¼Œå¯èƒ½å›  `reset` å¤±å»å·²ç¼“å­˜çš„å‰ç½®å‚æ•°è€Œäº§ç”Ÿé—æ¼ã€‚  
5. **å®ä½“è§£ç å®‰å…¨**ï¼š`html_unescape` æ‰‹å†™å®ç°è‹¥æœªè¦†ç›–å…¨éƒ¨å®ä½“ï¼Œå¯èƒ½äº§ç”Ÿæ„å¤–å­—ç¬¦ï¼ˆå¦‚æœªè½¬ä¹‰çš„ `&`ï¼‰ï¼Œåœ¨åç»­ JSON è§£æé˜¶æ®µè§¦å‘é”™è¯¯ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
| å»ºè®® | è¯´æ˜ |
|------|------|
| **é™åˆ¶ç¼“å†²åŒºå¤§å°** | åœ¨ `parse_incremental` ä¸­åŠ å…¥é˜ˆå€¼ï¼ˆå¦‚ 256â€¯KBï¼‰ï¼Œè¶…è¿‡æ—¶è¿”å› `ParserError::BufferOverflow` å¹¶é‡ç½®çŠ¶æ€ï¼Œé˜²æ­¢ OOMã€‚ |
| **ä½¿ç”¨éå›æº¯æ­£åˆ™å¼•æ“** | è‹¥é¡¹ç›®å…è®¸ï¼Œå¼•å…¥ `regex::RegexBuilder::case_insensitive(true).build()` å¹¶å¼€å¯ `unicode(false)`ï¼Œæˆ–è¿ç§»åˆ° `re2`â€‘compatible æ­£åˆ™ï¼Œå®ç°å¯¹æ¶æ„é•¿æ–‡æœ¬çš„å®‰å…¨ä¿æŠ¤ã€‚ |
| **æ˜¾å¼æ¨¡å‹æ˜ å°„é¡ºåº** | å°† `qwen_coder` çš„æ˜ å°„å†™åœ¨æœ€å‰é¢ï¼Œå¹¶åœ¨ `ParserFactory::map_model` æ³¨é‡Šä¸­è¯´æ˜ â€œé•¿æ¨¡å¼ä¼˜å…ˆâ€ã€‚æœªæ¥æ–°å¢å…¶å®ƒ qwenâ€‘* æ¨¡å‹æ—¶åŠ¡å¿…æ£€æŸ¥é¡ºåºã€‚ |
| **ç»Ÿä¸€å®ä½“è§£ç ** | æŠŠ `html_unescape` æŠ½ç¦»ä¸ºå…¬å…±åº“ï¼ˆå¦‚ `sgl-utils::html`ï¼‰ï¼Œå¹¶åŠ å…¥å®Œæ•´çš„å®ä½“è¡¨ä¸å•å…ƒæµ‹è¯•ï¼Œé¿å…é‡å¤å®ç°å¯¼è‡´ä¸ä¸€è‡´ã€‚ |
| **å¢é‡è§£ææ¢å¤æµ‹è¯•** | åœ¨ CI ä¸­åŠ å…¥ **é•¿æ—¶é—´æµå¼** åœºæ™¯ï¼Œæ¨¡æ‹Ÿ 1â€¯MB+ å‚æ•°é€å—è¾“å…¥ï¼Œä»¥éªŒè¯ `reset` ä¸ `buffer` æ¸…ç†çš„æ­£ç¡®æ€§ã€‚ |
| **æ–‡æ¡£ä¸ä½¿ç”¨ç¤ºä¾‹** | æ›´æ–°é¡¹ç›® README / docsï¼Œè¯´æ˜ Qwenâ€‘Coder æ”¯æŒçš„ XML æ ¼å¼ã€ç¤ºä¾‹è°ƒç”¨ä»¥åŠæ³¨æ„äº‹é¡¹ï¼ˆå¦‚ä¸æ”¯æŒåµŒ

---

#### ğŸŸ¡ ä¸­é‡è¦åº¦å˜æ›´ (11)

### [Model] Support IQuest-Coder-40B-Loop (#16348)
**SHA**: `7b682de` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/7b682de870d4ff87a5a2d69826583ae7aaecee18)

**ğŸŸ¢ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆæ–°å¢ IQuestâ€‘Loopâ€‘Coder æ¨¡å‹ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ `model_config.py` ä¸­ä¸º `IQuestLoopCoderForCausalLM` å¢åŠ  `loop_num` è§£æï¼ŒåŠ¨æ€å†³å®šæ³¨æ„åŠ›å±‚æ•°ã€‚  
2. `flashinfer_backend.forward_extend` å½“æœªæ˜¾å¼æä¾› `k/v` æ—¶ï¼Œæ”¹ä¸ºä» `token_to_kv_pool` è¯»å–ç¼“å­˜ï¼Œæ”¯æ’‘ Loopâ€‘Coder åœ¨åç»­å¾ªç¯ä¸­å¤ç”¨å·²æœ‰ KVã€‚  
3. `model_runner.initialize` æ ¹æ® `loop_num` æ‰©å±•æœ‰æ•ˆå±‚æ•°çš„è®¡æ•°ï¼Œç¡®ä¿è°ƒåº¦å’Œæ˜¾å­˜é¢„ä¼°çš„æ­£ç¡®æ€§ã€‚  
4. æ–°å¢å®Œæ•´çš„ LoopCoder å®ç°ï¼ˆattentionã€gateã€decoderã€æ¨¡å‹ã€æƒé‡åŠ è½½ï¼‰ï¼Œå¹¶åœ¨ `llama.py` çš„ `EntryClass` ä¸­æ³¨å†Œ `IQuestCoderForCausalLM`ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `sglang/srt/configs/model_config.py`ã€`sglang/srt/layers/attention/flashinfer_backend.py`ã€`sglang/srt/model_executor/model_runner.py`  
- æ–°å¢ `sglang/srt/models/iquest_loopcoder.py`ï¼ˆçº¦ 500 è¡Œï¼‰  
- `sglang/srt/models/llama.py` å…¥å£åˆ—è¡¨  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å…¼å®¹æ€§**ï¼š`loop_num` é»˜è®¤ 1 â†’ 2ï¼Œå·²æœ‰æ¨¡å‹ä»å¯ä½¿ç”¨ï¼›ä½†è‹¥ `loop_num` ä¸ `num_hidden_layers` ä¸åŒ¹é…ï¼Œ`model_runner.num_effective_layers` å¯èƒ½è¢«é”™è¯¯æ”¾å¤§ã€‚å»ºè®®åœ¨ `model_config._derive_model_shapes` ä¸­æ£€æŸ¥ `loop_num * num_hidden_layers` ä¸å®é™…å±‚æ•°çš„ä¸€è‡´æ€§ã€‚  
2. **KV ç¼“å­˜ä¸€è‡´æ€§**ï¼š`flashinfer_backend` ç°åœ¨ä¼šåœ¨ `k/v=None` æ—¶ç›´æ¥å–ç¼“å­˜ï¼Œç¡®ä¿ `RadixAttention` çš„ `save_kv_cache=False` å‚æ•°åœ¨æ‰€æœ‰è·¯å¾„ï¼ˆå°¤å…¶æ˜¯æ¨ç†é˜¶æ®µçš„å¤šè½®ï¼‰ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ç¼“å­˜æœªæ›´æ–°å¯¼è‡´çš„æ³¨æ„åŠ›é”™è¯¯ã€‚  
3. **æƒé‡åŠ è½½**ï¼š`IQuestLoopCoderForCausalLM.load_weights` é€šè¿‡æ˜ å°„å¤„ç† `gate_projections` å’Œå †å å‚æ•°ï¼ŒåŠ¡å¿…åœ¨æ–°æ¨¡å‹çš„ HF æƒé‡é‡Œæä¾› `gate_proj`ã€`up_proj` ç­‰å­—æ®µï¼›ç¼ºå¤±æ—¶ä¼š silentlyè·³è¿‡ã€‚å»ºè®®åœ¨æ¨¡å‹åˆå§‹åŒ–æ—¶æŠ¥é”™æé†’ã€‚  
4. **æ€§èƒ½è¯„ä¼°**ï¼šLoopâ€‘Coder ä¼šä¸ºæ¯ä¸ªå¾ªç¯ç”Ÿæˆç‹¬ç«‹çš„ KV åŒºåŸŸï¼Œæ˜¾å­˜å¢åŠ çº¦ `loop_num` å€ã€‚è¯·åœ¨å¤šå¡ç¯å¢ƒä¸‹éªŒè¯ `initialize` ä¸­çš„ `num_effective_layers` è®¡æ•°æ˜¯å¦å½±å“æ˜¾å­˜åˆ†é…å’Œè°ƒåº¦ã€‚  
5. **æµ‹è¯•**ï¼šæ–°å¢å•å…ƒæµ‹è¯•è¦†ç›–ï¼šâ‘  `model_config` èƒ½æ­£ç¡®è§£æ `loop_num`ï¼›â‘¡ `flashinfer_backend` åœ¨ `k/v=None` æ—¶è¿”å›å¯¹åº”ç¼“å­˜ï¼›â‘¢ `model_runner` çš„ `num_effective_layers` ä¸ `loop_num` æˆæ¯”ä¾‹ï¼›â‘£ å®Œæ•´æ¨ç†è·¯å¾„ï¼ˆä¸€æ¬¡å‰å‘ â†’ å¤šå¾ªç¯ï¼‰è¾“å‡ºåˆç†ã€‚  

æ€»ä½“æ¥è¯´ï¼Œæ”¹åŠ¨å®ç°äº† IQuestâ€‘Loopâ€‘Coder çš„å®Œæ•´æ¨ç†æµæ°´çº¿ï¼Œé€»è¾‘æ¸…æ™°ï¼Œä½†éœ€å…³æ³¨ KV ç¼“å­˜ä¸€è‡´æ€§ã€æ˜¾å­˜ä¼°ç®—åŠæƒé‡æ˜ å°„çš„å¥å£®æ€§ã€‚

---

### [model-gateway] Fix workflow engine race conditions and add graceful shutdown (#16963)
**SHA**: `d0092de` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/d0092decb15b86deb3b864441a514099eccfe7b1)

**å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼ºï¼ˆåŠ å…¥ä¼˜é›…å…³åœä¸å¹¶å‘å®‰å…¨ï¼‰  
**é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**æ ¸å¿ƒæ”¹åŠ¨**  
1. **WorkflowEngine**  
   - å¼•å…¥ `watch` é€šé“ã€`AtomicUsize` è®¡æ•°å™¨ä»¥åŠ RAII guardï¼Œå®ç°â€œå…³é—­â€‘å¯åŠ¨â€çŠ¶æ€çš„çº¿ç¨‹å®‰å…¨åˆ‡æ¢ã€‚  
   - æ–°å¢ `shutdown / is_shutting_down / wait_for_shutdown / force_cancel_all / active_workflow_count` ç­‰ APIï¼Œä¿è¯åœ¨è¿›ç¨‹é€€å‡ºæ—¶èƒ½å¤Ÿæœ‰åºåœæ­¢å·¥ä½œæµã€‚  
   - `start_workflow` ç°åœ¨åœ¨å…³åœæœŸé—´ç›´æ¥è¿”å› `WorkflowError::ShuttingDown`ï¼Œå¹¶é€šè¿‡ `StartGuard`/`ActiveWorkflowGuard` ç¡®ä¿ `active_workflows` å§‹ç»ˆä¸å®é™…è¿è¡Œæ•°ä¿æŒä¸€è‡´ã€‚  
   - æ¸…ç†ä»»åŠ¡åœ¨ `watch` å…³é—­ä¿¡å·åˆ°æ¥æ—¶é€€å‡ºï¼Œé¿å…äº†åŸå…ˆçš„æ— é™å¾ªç¯å¯¼è‡´çš„èµ„æºæ³„æ¼ã€‚  

2. **EventBus**  
   - ä¸ºæ¯ä¸ªè®¢é˜…è€…å¢åŠ è¶…æ—¶åŒ…è£…ï¼Œæ”¹ä¸º **fireâ€‘andâ€‘forget** çš„å¹¶å‘å‘å¸ƒï¼Œé˜²æ­¢å•ä¸ªæ…¢/å¼‚å¸¸è®¢é˜…è€…æ‹–æ…¢æ•´ä½“ã€‚  
   - æ–°å¢ `unsubscribe` ä¸ `publish_and_wait`ï¼Œå¹¶æä¾›å¯å®šåˆ¶çš„è¶…æ—¶ `with_timeout`ã€‚  

3. **WorkflowError**  
   - æ–°å¢ `ShuttingDown` é”™è¯¯ç±»å‹ï¼Œä¾›å¤–éƒ¨åœ¨å…³åœæœŸé—´å¿«é€Ÿæ„ŸçŸ¥ã€‚  

**å½±å“èŒƒå›´**  
- `sgl-model-gateway/src/workflow/engine.rs`ï¼ˆæ ¸å¿ƒè°ƒåº¦é€»è¾‘ï¼‰  
- `sgl-model-gateway/src/workflow/event.rs`ï¼ˆäº‹ä»¶æ€»çº¿ï¼‰  
- `sgl-model-gateway/src/workflow/types.rs`ï¼ˆé”™è¯¯å®šä¹‰ï¼‰  

**å…³æ³¨å»ºè®®**  
- **æµ‹è¯•**ï¼šè¡¥å……å…³åœè·¯å¾„çš„å•å…ƒ/é›†æˆæµ‹è¯•ï¼Œå°¤å…¶æ˜¯ `wait_for_shutdown` è¶…æ—¶ã€`force_cancel_all` ä¸ `active_workflow_count` çš„ä¸€è‡´æ€§ã€‚  
- **è®¡æ•°å®‰å…¨**ï¼š`StartGuard` åœ¨æ£€æŸ¥ `is_shutting_down` å‰å°±å·² `fetch_add(1)`ï¼Œè‹¥å…³åœåœ¨æ­¤ç¬é—´è§¦å‘ï¼Œè®¡æ•°ä¼šä¸´æ—¶å¤š 1ï¼Œéšååœ¨ `drop` ä¸­è¢«æ‰£å›ï¼Œå½±å“ä¸å¤§ä½†éœ€ç•™æ„ç»Ÿè®¡æŠ¥è¡¨çš„ç¬æ—¶å³°å€¼ã€‚  
- **å‘å¸ƒè¯­ä¹‰**ï¼š`publish` ç”±é˜»å¡æ”¹ä¸ºå¼‚æ­¥ fireâ€‘andâ€‘forgetï¼Œè‹¥ä¸šåŠ¡ä¾§ä»ä¾èµ– `publish` å®Œæˆåå†æ‰§è¡Œåç»­ä»£ç ï¼Œè¯·æ”¹ç”¨ `publish_and_wait`ã€‚  
- **èµ„æºæ³„éœ²**ï¼š`watch::Sender::send` å¯èƒ½å¤±è´¥ï¼ˆæ‰€æœ‰æ¥æ”¶ç«¯å·²å…³é—­ï¼‰ï¼Œç›®å‰ä»…è®°å½• infoï¼Œå¯é…Œæƒ…åœ¨ `shutdown` ä¸­æ•è·å¹¶ä¸ŠæŠ¥ã€‚  
- **å…¼å®¹æ€§**ï¼šæ–°å¢å­—æ®µåœ¨ `Default::default` å®ä¾‹åŒ–æ—¶å·²å¡«å……ï¼Œå‘åå…¼å®¹æ€§åŸºæœ¬æ— å†²å‡»ã€‚  

æ•´ä½“æ¥çœ‹ï¼Œè¿™æ¬¡æ”¹åŠ¨æ˜¾è‘—æå‡äº† workflow å¼•æ“çš„å¹¶å‘å®‰å…¨æ€§ä¸å¯æ§å…³é—­èƒ½åŠ›ï¼ŒåŒæ—¶é€šè¿‡äº‹ä»¶æ€»çº¿çš„è¶…æ—¶åŒ…è£…é™ä½äº†å•ç‚¹æ•…éšœé£é™©ã€‚åç»­å…³æ³¨æµ‹è¯•è¦†ç›–ç‡åŠæ–‡æ¡£æ›´æ–°å³å¯å¹³ç¨³ä¸Šçº¿ã€‚

---

### [diffusion] Support I2I/TI2I/I2V/TI2V warmup && T2I/T2V warmup bug fix (#16922)
**SHA**: `2dadf63` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2dadf6356289ef3986873ef8601efb5eb96b38a8)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / Bug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼š  
1. å°† `SamplingParams` é»˜è®¤ `seed` æ”¹ä¸º 42ã€`num_frames` æ”¹ä¸º 1ã€`guidance_scale` é»˜è®¤ 1.0ã€‚  
2. `image_api`ã€`video_api`ã€`protocol` ä¸­çš„ `guidance_scale` å‚æ•°æ”¹ä¸ºå¯é€‰å†™å…¥ï¼Œé¿å… `None` è¦†ç›–é»˜è®¤å€¼ã€‚  
3. Scheduler æ–°å¢å¯¹ I2Iã€TI2Iã€I2Vã€TI2V ä»»åŠ¡çš„ warmâ€‘up æ”¯æŒï¼Œä½¿ç”¨æœ€å°å›¾ç‰‡åšé¢„çƒ­å¹¶åŠ å…¥è¿›åº¦ç»Ÿè®¡ã€‚  
4. `Req` dataclass é‡æ„ï¼šè‡ªå®šä¹‰ `__init__` ä¸å±æ€§ä»£ç†ï¼Œé¦–æ¬¡è®¿é—®é‡‡æ ·å‚æ•°æ—¶è‡ªåŠ¨åˆ›å»º `SamplingParams` å®ä¾‹ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `python/sglang/multimodal_gen/configs/sample/sampling_params.py`  
- `runtime/entrypoints/openai/*_api.py`ã€`protocol.py`  
- `runtime/managers/scheduler.py`ï¼ˆwarmâ€‘up é€»è¾‘ã€æ—¥å¿—ï¼‰  
- `runtime/pipelines_core/schedule_batch.py`ï¼ˆReq å®ä¾‹åŒ–ã€å±æ€§è½¬å‘ï¼‰  
- ç›¸å…³å·¥å…· `save_image_to_path`ã€`utils`ã€`constants`  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
- éƒ¨ç½²å‰ç¡®è®¤ `outputs/uploads` ç›®å½•å¯å†™ï¼Œé˜²æ­¢ warmâ€‘up æ—¶å› è·¯å¾„æƒé™æŠ›å¼‚å¸¸ã€‚  
- å¯¹å·²æœ‰è°ƒç”¨æ˜ç¡® `guidance_scale` è¡Œä¸ºï¼šæœªä¼ æ—¶ä¼šä½¿ç”¨é»˜è®¤ 1.0ï¼Œè‹¥éœ€ä¿æŒ `None`ï¼ˆä¸ä½¿ç”¨ guidanceï¼‰ï¼Œè¯·åœ¨è¯·æ±‚ä¸­æ˜¾å¼ç½® `null`ã€‚  
- è¿è¡Œå®Œæ•´å›å½’æµ‹è¯•ï¼Œå°¤å…¶ I2I/I2V/TI2I/TI2V æµç¨‹çš„ warmâ€‘up ä¸åç»­æ­£å¼è¯·æ±‚çš„æ—¶åºã€‚  
- æ£€æŸ¥ç¬¬ä¸‰æ–¹ä»£ç æ˜¯å¦ä»ä¾èµ–æ—§çš„ `Req` åˆå§‹åŒ–æ–¹å¼ï¼ˆå¦‚ç›´æ¥é€šè¿‡ä½ç½®å‚æ•°åˆ›å»ºï¼‰ï¼Œå¿…è¦æ—¶è¿ç§»åˆ°å…³é”®å­—å‚æ•°ã€‚  
- æ›´æ–°æ–‡æ¡£è¯´æ˜é»˜è®¤ seedã€frameã€guidance å‚æ•°å˜åŒ–åŠ warmâ€‘up æœºåˆ¶ã€‚

---

### Re-introduce the unit test of test_mooncake_ep_small (#16019)
**SHA**: `9f5cd80` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/9f5cd80a8d21899b7c1d7cd26ba7a5f83a26422e)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º / Bug ä¿®å¤  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. é‡æ–°å¼•å…¥ `test_mooncake_ep_small` å•å…ƒæµ‹è¯•ï¼Œæ¢å¤å¯¹ Mooncake EP å°è§„æ¨¡åœºæ™¯çš„éªŒè¯ã€‚  
2. åœ¨ `eplb_algorithms.rebalance_experts` ä¸­å…³é—­å±‚çº§å‡è¡¡ (`enable_hierarchical=False`) ä»¥åŒ¹é…æµ‹è¯•éœ€æ±‚ã€‚  
3. `mooncake` TokenDispatcher ä»£ç æ”¹ä¸ºæ¯æ¬¡é€šè¿‡ `ElasticEPStateManager.instance().active_ranks` åŠ¨æ€è·å–æ´»è·ƒ rankï¼Œå»æ‰æ—§çš„æˆå‘˜ç¼“å­˜ï¼Œå¹¶ç²¾ç®€ `TYPE_CHECKING` å¯¼å…¥ã€‚  
4. å¯¹ç›¸å…³æµ‹è¯•ç±»è¿›è¡Œé‡å‘½åå¹¶é€šè¿‡ `@unittest.skip` é˜²æ­¢é‡å¤æ‰§è¡Œï¼ŒåŒæ—¶åœ¨ CI æµ‹ä¾‹åˆ—è¡¨ä¸­æ¢å¤è¯¥æ–‡ä»¶ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/eplb/eplb_algorithms/__init__.py`ï¼ˆå‡è¡¡é€»è¾‘ï¼‰  
- `python/sglang/srt/layers/moe/token_dispatcher/mooncake.py`ï¼ˆè°ƒåº¦å®ç°ï¼‰  
- `test/srt/ep/test_mooncake_ep_small.py`ã€`test/srt/run_suite.py`ï¼ˆæµ‹è¯•å¥—ä»¶ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å±‚çº§å‡è¡¡å…³é—­**ï¼šç¡®è®¤ `enable_hierarchical=False` ä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒå¯¼è‡´è´Ÿè½½ä¸å‡ï¼Œå¦‚æœ‰éœ€è¦å¯åœ¨é…ç½®ä¸­æä¾›å¯é€‰å¼€å…³ã€‚  
2. **active_ranks åŠ¨æ€è·å–**ï¼šæ–°å®ç°é¿å…äº†çŠ¶æ€ä¸ä¸€è‡´ï¼Œä½†æ¯æ¬¡è°ƒç”¨ä¼šå¤šä¸€æ¬¡å•ä¾‹æŸ¥è¯¢ï¼Œå»ºè®®åœ¨æ€§èƒ½å…³é”®è·¯å¾„ä¸Šè¯„ä¼°å¼€é”€ï¼Œæˆ–åœ¨ `ElasticEPStateManager` æ·»åŠ è½»é‡ç¼“å­˜ã€‚  
3. **æµ‹è¯•æ¢å¤**ï¼š`TestMooncakeWithEPLB` å·²è¦†ç›–åŸ `TestMooncakeWitchEPLB`ï¼Œè¯·ç¡®ä¿ CI ç¯å¢ƒçš„åˆ†å¸ƒå¼ GPU/ç½‘ç»œé…ç½®ä¸æµ‹è¯•è¦æ±‚ä¿æŒä¸€è‡´ï¼Œé¿å…å› ç¡¬ä»¶å·®å¼‚äº§ç”Ÿ flakyã€‚  
4. **ä»£ç æ•´æ´**ï¼šå·²åˆ é™¤ä¸å†ä½¿ç”¨çš„ `TYPE_CHECKING` å¯¼å…¥å’Œå†—ä½™å‚æ•°ï¼Œå»ºè®®åœ¨ä¸‹ä¸€è½® PR ä¸­å¼€å¯ `flake8`/`mypy` æ£€æŸ¥ï¼Œé˜²æ­¢ç±»ä¼¼é—ç•™ã€‚  

å¼€å‘è€…åœ¨åˆå¹¶å‰åº”è¿è¡Œå®Œæ•´çš„ 4â€‘GPU / 8â€‘GPU CIï¼Œä»¥ç¡®ä¿æ–°æµ‹è¯•ä¸ç°æœ‰ EPã€DeepEPã€EPLB åœºæ™¯ååŒé€šè¿‡ï¼›ç”¨æˆ·åœ¨å‡çº§åè‹¥ä½¿ç”¨ Mooncake è°ƒåº¦å™¨ï¼Œè¯·å…³æ³¨ `--moe-a2a-backend=mooncake` å‚æ•°çš„å…¼å®¹æ€§ã€‚

---

### [AMD] CI - enable test case for amd ci : triton_attention_kernels , torch_compile_moe (#16559)
**SHA**: `b1ee75a` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/b1ee75ae7b35061ae8753696d5428dbc111561f1)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º/CI é€‚é…  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
1. åœ¨ GitHub CI workflow ä¸­ä¸º AMD å¹³å°çš„æµ‹è¯•æ·»åŠ  `--timeoutâ€‘perâ€‘file 1800`ï¼Œé˜²æ­¢é•¿æ—¶é—´ç®—å­å› è¶…æ—¶è¢«æ€æ‰ã€‚  
2. ä¸º Triton æ³¨æ„åŠ›ç®—å­ã€LoRAã€Moe ç­‰æµ‹è¯•æ–°å¢ `register_amd_ci`ï¼Œå¹¶åœ¨éƒ¨åˆ†æ–­è¨€ä¸­æ”¾å®½å®¹å·®ï¼ˆ`atol`ã€`rtol`ï¼‰ä»¥é€‚é… AMD GPU ä¸Šçš„æ•°å€¼è¯¯å·®ã€‚  
3. è°ƒæ•´ DeepSeekâ€‘R1â€‘MXFP4 å¤šå¡æµ‹è¯•çš„æœåŠ¡å™¨å¯åŠ¨è¶…æ—¶ä» 1000â€¯s æå‡è‡³ 1200â€¯sã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- CI é…ç½® (`.github/workflows/pr-test-amd.yml`)  
- `test/registered/attention/test_triton_attention_kernels.py`  
- `test/registered/lora/test_lora_qwen3.py`ã€`test/registered/moe/test_torch_compile_moe.py`  
- `test/srt/test_deepseek_r1_mxfp4_8gpu.py`ï¼ˆæœåŠ¡å™¨å¯åŠ¨è¶…æ—¶ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **æ•°å€¼å®¹å·®**ï¼šAMD ä¸Šæ”¾å®½åˆ° `atol=5e-2`ã€`rtol=0.17`ï¼Œè¯·åœ¨åç»­éªŒè¯ä¸­ç¡®è®¤è¯¯å·®ä»åœ¨å¯æ¥å—èŒƒå›´ï¼Œé¿å…æ©ç›–å®é™…ç®—å­é”™è¯¯ã€‚  
2. **CI ç¨³å®šæ€§**ï¼šæ–°å¢çš„è¶…æ—¶å’Œæ”¾å®½å®¹å·®å¯èƒ½å¯¼è‡´åŸæœ¬çš„ flaky æµ‹è¯•å˜å¾— â€œå¯é€šè¿‡â€ï¼Œå»ºè®®åœ¨ä¸€æ®µæ—¶é—´å†…æ”¶é›† AMD CI çš„å¤±è´¥ç‡ï¼Œè‹¥ä»é¢‘ç¹æ³¢åŠ¨ï¼Œè€ƒè™‘è¿›ä¸€æ­¥è°ƒä¼˜æˆ–åŠ å…¥æ›´ä¸¥æ ¼çš„åŸºå‡†ã€‚  
3. **èµ„æºå ç”¨**ï¼š`--timeout-per-file 1800` ä¼šæ˜¾è‘—æ‹‰é•¿ AMD CI æ‰§è¡Œæ—¶é—´ï¼Œè¯„ä¼°æ˜¯å¦å¯ä»¥å¯¹è€—æ—¶æœ€é•¿çš„æµ‹è¯•å•ç‹¬æ‹†åˆ†æˆ–ä½¿ç”¨æ›´é«˜æ•ˆçš„ç®—å­å®ç°ã€‚  
4. **æ–‡æ¡£åŒæ­¥**ï¼šæ›´æ–°é¡¹ç›®çš„ CI æ–‡æ¡£å’Œç¡¬ä»¶æ”¯æŒè¯´æ˜ï¼Œæ˜ç¡® AMD CI ç°å·²å¼€å¯ä¸”éƒ¨åˆ†å®¹å·®å·²è°ƒæ•´ã€‚  
5. **å›å½’æ£€æŸ¥**ï¼šç¡®ä¿åœ¨ CUDA CI ä¸­ä»ä½¿ç”¨åŸå§‹ä¸¥æ ¼é˜ˆå€¼ï¼Œä»¥é˜²ä¸¤å¥—å¹³å°å‡ºç°è¡Œä¸ºåˆ†æ­§ã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä½¿é¡¹ç›®åœ¨ AMD GPU ä¸Šçš„æŒç»­é›†æˆå¾—åˆ°è¦†ç›–ï¼Œä½†éœ€åç»­æŒç»­ç›‘æ§æ•°å€¼è¯¯å·®å’Œæ‰§è¡Œæ—¶é•¿ï¼Œä»¥ä¿è¯äº§å“è´¨é‡ä¸å—å½±å“ã€‚

---

### [diffusion] chore: validate sampling params (#16677)
**SHA**: `f44c63e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/f44c63eef74d0e576d1031ca8a6cd21759e237f2)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šåœ¨ `SamplingParams` ä¸­åŠ å…¥å®Œæ•´çš„å‚æ•°åˆæ³•æ€§æ ¡éªŒï¼Œæå‡é”™è¯¯æç¤ºçš„å¯è¯»æ€§å¹¶é˜²æ­¢æ— æ•ˆæ•°å€¼ï¼ˆå¦‚è´Ÿæ•°ã€NaNã€Infã€å¸ƒå°”å‹ï¼‰è¿›å…¥é‡‡æ ·æµç¨‹ã€‚æ–°å¢å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰æ ¡éªŒè·¯å¾„ï¼Œå¹¶åœ¨æµ‹è¯•å¥—ä»¶ä¸­åŠ å…¥è¯¥æ–‡ä»¶ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/multimodal_gen/configs/sample/sampling_params.py`ï¼ˆæ ¸å¿ƒé…ç½®ç±»ï¼‰  
- `python/sglang/multimodal_gen/test/`ï¼ˆæµ‹è¯•å…¥å£ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **å‘åå…¼å®¹**ï¼š`check_sampling_param` ä»è°ƒç”¨ `_validate`ï¼Œä¿æŒæ—§è°ƒç”¨ä¸å˜ï¼›è‹¥æœªæ¥ç§»é™¤è¯¥æ–¹æ³•ï¼Œè¯·åŒæ­¥æ›´æ–°æ‰€æœ‰ä½¿ç”¨ç‚¹ã€‚  
2. **ç±»å‹æ£€æŸ¥**ï¼š`fps`ã€`num_outputs_per_prompt` ç­‰å­—æ®µå·²å¼ºåˆ¶ä¸ºæ­£æ•´æ•°ï¼Œç¡®ä¿è°ƒç”¨æ–¹ä¼ å…¥ `int`ï¼Œå¦åˆ™ä¼šè§¦å‘ `ValueError`ã€‚  
3. **å¸ƒå°”å€¼è¯¯åˆ¤**ï¼šæ˜¾å¼æ’é™¤ `bool`ï¼Œé˜²æ­¢ `True/False` è¢«è¯¯å½“ä½œ 1/0ã€‚  
4. **æµ‹è¯•è¦†ç›–**ï¼šæ–°åŠ å…¥çš„ `test_sampling_params_validate.py` æ£€æŸ¥å¸¸è§é”™è¯¯æƒ…å½¢ï¼Œå»ºè®®åœ¨ CI ä¸­ä¿æŒè¯¥æ–‡ä»¶è¿è¡Œä»¥é˜²å›å½’ã€‚  
5. **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–° `SamplingParams` çš„ä½¿ç”¨è¯´æ˜ï¼Œåˆ—å‡ºæ–°å¢æ ¡éªŒè§„åˆ™åŠå¯¹åº”å¼‚å¸¸ä¿¡æ¯ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½é…ç½®é—®é¢˜ã€‚

---

### [docs] sync diffusion docs to main docs (#16932)
**SHA**: `aab906a` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/aab906a3d407d9b45d24fb5735a522f90920bc32)

**ğŸ”§ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°ï¼ˆåŠŸèƒ½è¡¥å…¨ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  

**ğŸ“‹ å˜æ›´æ‘˜è¦**  
- åœ¨ `docs/index.rst` ä¸­æ–°å¢å¯¹ Diffusion æ¨¡å‹ç« èŠ‚çš„å…¥å£é“¾æ¥ã€‚  
- æ–°å¢ `docs/supported_models/diffusion_models.md`ï¼Œå…± 1273 è¡Œï¼Œç³»ç»Ÿæ€§æ¢³ç†äº† SGLangâ€‘Diffusion çš„å®‰è£…æ–¹å¼ã€å…¼å®¹æ¨¡å‹ã€CLI/Server ç”¨æ³•ã€OpenAIâ€‘compatible APIã€LoRA ç®¡ç†ã€æ³¨æ„åŠ›åç«¯ã€Cacheâ€‘DiT åŠ é€Ÿã€Profiling ä¸è´¡çŒ®æŒ‡å—ç­‰å†…å®¹ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- **æ–‡æ¡£ä½“ç³»**ï¼š`docs` ç›®å½•ä»¥åŠç´¢å¼•æ–‡ä»¶ã€‚  
- **ç”¨æˆ·å…¥å£**ï¼šæ–°å¢ `supported_models/diffusion_models.md` å°†åœ¨å®˜ç½‘å¯¼èˆªä¸­å‡ºç°ï¼Œç›´æ¥å½±å“æ–°ç”¨æˆ·çš„ä¸Šæ‰‹æ–‡æ¡£ã€‚  
- **CI**ï¼šDocs æ„å»ºæµç¨‹ï¼ˆSphinxï¼‰å°†å¤šå‡ºä¸€é¡µï¼Œéœ€è¦ç¡®ä¿é“¾æ¥ã€RST è¯­æ³•æ— è¯¯ã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **é“¾æ¥æ ¡éªŒ**ï¼šç¡®è®¤ `index.rst` ä¸­çš„ç¼©è¿›å’Œè·¯å¾„æ‹¼å†™æ­£ç¡®ï¼Œé˜²æ­¢æ„å»ºæ—¶æŠ¥é”™ã€‚  
2. **è·¨å¹³å°è¯´æ˜**ï¼šæ–‡æ¡£å·²è¦†ç›– NVIDIAã€AMDã€MPS ç­‰å¹³å°ï¼Œè¯·åœ¨ CI ä¸­åŠ å…¥å¯¹ `docs/supported_models/diffusion_models.md` çš„æ¸²æŸ“æµ‹è¯•ï¼Œé¿å…å› æ¡ä»¶å®å¯¼è‡´çš„æ¸²æŸ“å¼‚å¸¸ã€‚  
3. **ç‰ˆæœ¬åŒæ­¥**ï¼šè¯¥é¡µåˆ—ä¸¾çš„æ¨¡å‹ã€Docker é•œåƒã€ç¯å¢ƒå˜é‡ç­‰ä¿¡æ¯éœ€éšä»£ç æ›´æ–°ä¿æŒä¸€è‡´ï¼Œå»ºè®®åœ¨å‘å¸ƒ Release æ—¶åŒæ­¥æ›´æ–°æ–‡æ¡£ï¼ˆå¯åœ¨ Release æµç¨‹ä¸­åŠ å…¥æ£€æŸ¥è„šæœ¬ï¼‰ã€‚  
4. **æœç´¢å‹å¥½**ï¼šä¸ºå…³é”®ç« èŠ‚å¦‚ â€œCacheâ€‘DiT åŠ é€Ÿâ€ ä¸ â€œLoRA ç®¡ç†â€ æ·»åŠ æ˜¾å¼çš„é”šç‚¹æˆ–æ ‡é¢˜å±‚çº§ï¼Œæå‡å†…éƒ¨æœç´¢å’Œå¤–éƒ¨æœç´¢å¼•æ“çš„å¯è§åº¦ã€‚  
5. **CI æ£€æŸ¥**ï¼šåœ¨ç°æœ‰ docs CI ä¸­åŠ å…¥å¯¹æ–° Markdownï¼ˆ`.md`ï¼‰æ–‡ä»¶çš„æ¸²æŸ“æ£€æŸ¥ï¼ˆå¦‚ `pandoc` â†’ ReSTï¼‰ï¼Œé˜²æ­¢æ ¼å¼é”™è¯¯é˜»æ–­å‘å¸ƒã€‚  

æ€»ä½“æ¥çœ‹ï¼Œæ­¤æ¬¡æ–‡æ¡£è¡¥å…¨æå‡äº† Diffusion å­é¡¹ç›®çš„å¯ç”¨æ€§ä¸ä¸Šæ‰‹ä½“éªŒï¼Œé£é™©ä¸»è¦åœ¨äºæ„å»ºè¿‡ç¨‹çš„é“¾æ¥ä¸æ¸²æŸ“å…¼å®¹æ€§ï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥ç›¸åº”çš„éªŒè¯æ­¥éª¤ã€‚

---

### [diffusion] model: Support TurboWan2.2-I2V SLA && add CI test for TurboWan (#16536)
**SHA**: `feb39f7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/feb39f776805ac59415b45d225e69ebcd5dddcfb)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šåŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šä¸º Wan ç³»åˆ—æ¨¡å‹æ–°å¢ TurboWan ç³»åˆ—ï¼ˆSLAï¼‰æ”¯æŒï¼Œæ‰©å±•äº† pipeline é…ç½®ã€é‡‡æ ·å‚æ•°ã€æ¨¡å‹æ³¨å†ŒåŠè¿è¡Œæ—¶å®ç°ï¼›åŒæ—¶åœ¨æ–‡æ¡£ã€æ€§èƒ½åŸºå‡†ã€CI ç”¨ä¾‹ä¸­åŠ å…¥ç›¸åº”è¯´æ˜å’Œæµ‹è¯•ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**  
- **é…ç½®å±‚**ï¼š`wan.py` ä¸­æ–°å¢ `TurboWanI2V720Config` ä¸ `Turbo_Wan2_2_I2V_A14B_SamplingParam`ï¼›`pipeline_configs`ã€`sample` ä¸¤å¥—é…ç½®åŒæ­¥æ›´æ–°ã€‚  
- **æ¨¡å‹æ³¨å†Œ**ï¼š`registry.py` å¢åŠ  TurboWan é…ç½®ä¸æ¨¡å‹è·¯å¾„çš„æ³¨å†Œï¼Œæ–°å¢åŒæ¨¡å‹ï¼ˆé«˜å™ªâ€‘ä½å™ªï¼‰æ”¯æŒã€‚  
- **è¿è¡Œæ—¶æ ¸å¿ƒ**ï¼š`wan_i2v_dmd_pipeline.py`ã€`denoising_dmd.py` é€šè¿‡ `transformer_2` å®ç°åŒä¸“å®¶åˆ‡æ¢ï¼Œå¹¶åœ¨ `DmdDenoisingStage` ä¸­åŠ å…¥ `boundary_ratio` è®¡ç®—ã€æ¨¡å‹è£…è½½/å¸è½½é€»è¾‘ï¼›å¯¹å¯é€‰çš„ `image_encoder`/`image_processor` åšäº†æ¡ä»¶æ·»åŠ ã€‚  
- **æµ‹è¯•ä¸ CI**ï¼š`perf_baselines.json`ã€`test_server_utils.py`ã€`testcase_configs.py` å¢åŠ  TurboWan åŸºå‡†ã€é¢å¤– `fps/num_frames` å‚æ•°çš„ä¼ é€’ï¼›é’ˆå¯¹ AMDï¼ˆHIPï¼‰å¹³å°åšäº†è·³è¿‡å¤„ç†ã€‚  
- **æ–‡æ¡£**ï¼š`support_matrix.md` æ›´æ–°è¡¨æ ¼ï¼Œæ ‡æ˜ SLA çš„æ”¯æŒæƒ…å†µã€‚  

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **é…ç½®å‘åå…¼å®¹**ï¼š`TurboWanI2V720Config` ç»§æ‰¿ `WanI2V720PConfig`ï¼Œä½†åœ¨å…¶ä»–ä»£ç ï¼ˆå¦‚ `ServerArgs.pipeline_config`) ä»å‡è®¾ä»…æœ‰ `flow_shift`ã€‚ç¡®è®¤æ‰€æœ‰ä½¿ç”¨ `pipeline_config.dit_config` çš„ä½ç½®å·²èƒ½å®‰å…¨è¯»å–æ–°å¢ `boundary_ratio`ã€‚  
2. **åŒæ¨¡å‹åˆ‡æ¢**ï¼š`_select_and_manage_model` é€šè¿‡ `boundary_ratio` åˆ¤å®šåˆ‡æ¢æ—¶æœºï¼Œå»ºè®®åœ¨ CI ä¸­åŠ å…¥è¾¹ç•Œæ¯”ç‡æç«¯å€¼ï¼ˆ`0`ã€`1`ï¼‰çš„å•å…ƒæµ‹è¯•ï¼Œé˜²æ­¢è¯¯é€‰æ¨¡å‹å¯¼è‡´ç©ºæŒ‡é’ˆã€‚  
3. **GPU/CPU Offè½½**ï¼š`_manage_device_placement` ä¾èµ– `server_args.dit_cpu_offload`ã€‚è‹¥ç”¨æˆ·æœªæ˜¾å¼å¼€å¯ï¼ŒåŒæ¨¡å‹ä»ä¼šå…¨éƒ¨ä¿æŒåœ¨ GPUï¼Œå¯èƒ½è§¦å‘æ˜¾å­˜æº¢å‡ºã€‚å¯åœ¨æ–‡æ¡£ä¸­æç¤ºå¼€å¯è¯¥å¼€å…³æˆ–åœ¨é»˜è®¤é…ç½®ä¸­å¯ç”¨ã€‚  
4. **å¯é€‰ Image ç¼–ç **ï¼š`wan_i2v_dmd_pipeline` ç°åœ¨åœ¨ `image_encoder` ä¸º `None` æ—¶è·³è¿‡ `ImageEncodingStage`ï¼Œç¡®è®¤ downstreamï¼ˆå¦‚ `DecodingStage`ï¼‰å¯¹ç¼ºå¤±çš„ VAE ç¼–ç æœ‰å®¹é”™è·¯å¾„ã€‚  
5. **API å…¼å®¹**ï¼š`extra_body` ä¸­æ–°å¢ `fps`ã€`num_frames`ï¼Œç¡®ä¿æœåŠ¡ç«¯çš„è¯·æ±‚è§£æå±‚ï¼ˆ`RequestBody`ã€`DiffusionSamplingParams`ï¼‰å·²åŠ å…¥å¯¹åº”å­—æ®µçš„è§£æä¸æ ¡éªŒã€‚  
6. **æ€§èƒ½åŸºå‡†**ï¼šæ–°å¢çš„åŸºå‡†å€¼åœ¨ CI ä¸­ä»…åœ¨é HIP ç¯å¢ƒè¿è¡Œï¼Œå»ºè®®åœ¨ PR æ–‡æ¡£ä¸­æ ‡æ˜æ­¤é™åˆ¶ï¼Œé¿å…å› å¹³å°å·®å¼‚å¯¼è‡´è¯¯æŠ¥ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡æ”¹åŠ¨ä¸º TurboWan ç³»åˆ—æä¾›äº†å®Œæ•´çš„é…ç½®ã€æ³¨å†Œä¸åŒä¸“å®¶æ‰§è¡Œè·¯å¾„ï¼Œæå‡äº†æ¨¡å‹çš„ SLA èƒ½åŠ›ã€‚å…³æ³¨ä¸Šè¿°å…¼å®¹æ€§ä¸èµ„æºç®¡ç†ç»†èŠ‚ï¼Œå¯è¿›ä¸€æ­¥é™ä½å›å½’é£é™©ã€‚

---

### Tiny refactor age computation in router (#16850)
**SHA**: `38b30c7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/38b30c7b56b4a068e38d3d66cfa11d5ae4e2da79)

**å˜æ›´ç±»å‹**ï¼šé‡æ„ï¼ˆTiny refactor age computationï¼‰  
**å½±å“èŒƒå›´**ï¼š`sgl-model-gateway/src/observability/inflight_tracker.rs`ã€`sgl-model-gateway/src/observability/metrics.rs` ä»¥åŠå¯¹åº”å•å…ƒæµ‹è¯•ã€‚  

**æ ¸å¿ƒæ”¹åŠ¨**  
1. ç”¨ç»Ÿä¸€çš„ `GaugeHistogram`ï¼ˆ`BucketBounds`ã€`GaugeHistogramVec`ã€`GaugeHistogramHandle`ï¼‰å–ä»£æ‰‹å†™çš„ `NumericalBuckets`ï¼Œå®ç°äº†æ›´ç®€æ´çš„æ¡¶è®¡æ•°ä¸æ³¨å†Œæµç¨‹ã€‚  
2. `compute_bucket_counts` åªè¿”å›è®¡æ•°å‘é‡ï¼›å®é™…çš„æ ‡ç­¾æ˜ å°„ä¸ `Metrics::set_inflight_request_age_count` å·²åˆ é™¤ï¼Œæ”¹ä¸º `INFLIGHT_AGE_HANDLE.set_counts` ç›´æ¥å†™å…¥ç›‘æ§åç«¯ã€‚  
3. æ–°å¢ `collect_ages` è¾…åŠ©å‡½æ•°ï¼Œå°†å¹´é¾„æ”¶é›†ä¸è®¡æ•°åˆ†ç¦»ï¼Œä¾¿äºå•å…ƒæµ‹è¯•ã€‚  
4. ç›¸åº”æµ‹è¯•ä»éªŒè¯æ ‡ç­¾/æ¡¶æ·±åº¦è½¬ä¸ºéªŒè¯å¹´é¾„æ”¶é›†çš„æ­£ç¡®æ€§ã€‚  
5. `metrics.rs` ä¸­çš„ `set_inflight_request_age_count` è¢«åºŸå¼ƒï¼Œé¿å…é‡å¤å®ç°ã€‚

**æ½œåœ¨å½±å“ & å»ºè®®**  
- **æŒ‡æ ‡å…¼å®¹æ€§**ï¼šæ–°å»ºçš„ `GaugeHistogramVec` ä½¿ç”¨çš„åº¦é‡å `smg_http_inflight_request_age_count` ä¸æ—§å®ç°ä¿æŒä¸€è‡´ï¼Œç¡®ä¿ä»ªè¡¨ç›˜ä¸å—å½±å“ã€‚ä»éœ€æ£€æŸ¥ Prometheus é…ç½®æ˜¯å¦å·²è‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„ `_bucket` ç³»åˆ—ã€‚  
- **å¹¶å‘å®‰å…¨**ï¼š`GaugeHistogramHandle` é€šè¿‡ `LazyLock` å»¶è¿Ÿæ³¨å†Œï¼Œç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä»…åˆ›å»ºä¸€æ¬¡ï¼Œä»å»ºè®®åœ¨é«˜å¹¶å‘å¯åŠ¨æ—¶è·‘ä¸€æ¬¡å‹åŠ›æµ‹è¯•ç¡®è®¤æ— ç«äº‰ã€‚  
- **ä»£ç å¯ç»´æŠ¤æ€§**ï¼šå»é™¤æ‰‹å†™æ ‡ç­¾ç”Ÿæˆé€»è¾‘åï¼Œåç»­è‹¥è¦æ›´æ”¹æ¡¶è¾¹ç•Œï¼Œåªéœ€ä¿®æ”¹ `INFLIGHT_AGE_BOUNDS` å¸¸é‡å³å¯ï¼Œé™ä½å‡ºé”™æ¦‚ç‡ã€‚  
- **æµ‹è¯•è¦†ç›–**ï¼šå½“å‰ä»…éªŒè¯äº†å¹´é¾„æ”¶é›†çš„æ•°é‡ä¸å¤§è‡´èŒƒå›´ï¼Œå»ºè®®è¡¥å……è¾¹ç•Œå€¼æµ‹è¯•ï¼ˆä¾‹å¦‚æ­£å¥½ç­‰äº 30ã€60 ç§’çš„æƒ…å†µï¼‰ä»¥åŠ `compute_bucket_counts` å¯¹åº”çš„è®¡æ•°ç»“æœï¼Œç¡®ä¿æ–°æ¡¶è®¡ç®—é€»è¾‘ä¸æ—§å®ç°å®Œå…¨ç­‰ä»·ã€‚  
- **æ–‡æ¡£æ›´æ–°**ï¼šREADME/ç›‘æ§æ–‡æ¡£ä¸­å…³äº â€œinflight request ageâ€ çš„å®ç°ç»†èŠ‚éœ€è¦åŒæ­¥ä¸ºåŸºäº `GaugeHistogram`ï¼Œé¿å…æ··æ·†ã€‚  

æ€»ä½“è€Œè¨€ï¼Œæ­¤æ¬¡é‡æ„æå‡äº†æŠ½è±¡å±‚æ¬¡ã€å¯è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œé£é™©ä¸»è¦åœ¨äºåº¦é‡æ³¨å†Œçš„å…¼å®¹æ€§ä¸è¾¹ç•Œæµ‹è¯•çš„å®Œæ•´æ€§ã€‚å®Œæˆä¸Šè¿°éªŒè¯åå¯å®‰å…¨åˆå¹¶ã€‚

---

### Decouple grammar logic out of scheduler. (#16820)
**SHA**: `5b7bed7` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/5b7bed7ca429b32416a35909d4dc1fa5d726707c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šé‡æ„ / åŠŸèƒ½å¢å¼º  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°†åŸæœ¬æ•£è½åœ¨ `Scheduler` ä¸­çš„çº¦æŸè¯­æ³•ï¼ˆgrammarï¼‰é¢„å¤„ç†é€»è¾‘æŠ½å–ä¸ºç‹¬ç«‹çš„ `GrammarManager` ç±»ã€‚Scheduler åªä¿ç•™è°ƒåº¦ã€é˜Ÿåˆ—ç®¡ç†ç­‰æ ¸å¿ƒèŒè´£ï¼Œæ‰€æœ‰ä¸ grammar ç¼“å­˜ã€è¶…æ—¶ã€è·¨ TP åŒæ­¥ã€è¯·æ±‚å…¥é˜Ÿ/å‡ºé˜Ÿçš„ç»†èŠ‚å‡äº¤ç”± `GrammarManager` å®Œæˆã€‚ç›¸åº”åœ°ï¼ŒåŸæ¥çš„ `grammar_queue`ã€`grammar_backend`ã€`move_ready_grammar_requests` ç­‰æˆå‘˜è¢«åˆ é™¤æˆ–æ”¹ä¸ºé€šè¿‡ `self.grammar_manager` è®¿é—®ï¼Œå¹¶åœ¨ç›¸åº”çš„ç»Ÿè®¡ã€æ¸…ç†ã€abort æµç¨‹ä¸­åšäº†ç›¸åº”æ›¿æ¢ã€‚

**ğŸ¯ å½±å“èŒƒå›´**  
- `python/sglang/srt/constrained/grammar_manager.py`ï¼ˆæ–°æ–‡ä»¶ï¼‰  
- `python/sglang/srt/managers/scheduler.py`ï¼ˆæ ¸å¿ƒè°ƒåº¦å™¨ï¼‰  
- `python/sglang/srt/managers/schedule_batch.py`ï¼ˆæ–°å¢ `grammar_key` å­—æ®µï¼‰  
- `python/sglang/srt/disaggregation/decode.py`ã€`scheduler_metrics_mixin.py`ã€`scheduler_runtime_checker_mixin.py`ï¼ˆå¯¹ `grammar_manager` çš„è°ƒç”¨ï¼‰  
- ç›¸å…³æ¸…ç†/abort/flush ä»£ç ã€‚

**ğŸ’¡ å…³æ³¨å»ºè®®**  
1. **çº¿ç¨‹å®‰å…¨**ï¼š`GrammarManager` åœ¨å¤š TP ç¯å¢ƒä¸‹ä½¿ç”¨ `torch.distributed.all_reduce` åŒæ­¥å·²å°±ç»ªè®¡æ•°ï¼Œä¿æŒåŸè¡Œä¸ºï¼›ä½†åœ¨å•è¿›ç¨‹/å•å¡åœºæ™¯ä¸‹ä»ä¼šå¹¶å‘è®¿é—® `grammar_queue`ï¼Œå»ºè®®åœ¨æ–‡æ¡£ä¸­è¯´æ˜ `GrammarManager` æœ¬èº«æ˜¯ Scheduler çš„å”¯ä¸€æ‹¥æœ‰è€…ï¼Œå¤–éƒ¨ä¸å¯ç›´æ¥å¹¶å‘ä¿®æ”¹ã€‚  
2. **å¼‚å¸¸è·¯å¾„**ï¼š`process_req_with_grammar` è¿”å› `True` æ—¶æ‰åŠ å…¥ `grammar_queue`ï¼Œå¦åˆ™ç›´æ¥å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚è¯·ç¡®è®¤æ‰€æœ‰è°ƒç”¨ç‚¹ï¼ˆå¦‚ `handle_generate_request`ã€`_get_new_batch_prefill_raw`ï¼‰å·²è¦†ç›– `add_to_grammar_queue=False` çš„æƒ…å†µï¼Œé¿å…é—æ¼è¯·æ±‚ã€‚  
3. **æ€§èƒ½åŸºå‡†**ï¼šæŠ½ç¦»å `Scheduler` çš„ä¸»å¾ªç¯ä½“å˜å¾—æ›´ç®€æ´ï¼Œä½† `GrammarManager.get_ready_grammar_requests` ä»ä¼šåœ¨æ¯æ¬¡è°ƒåº¦è½®ä¸­éå† `grammar_queue` å¹¶æ‰§è¡Œ `result(timeout=0.03)`ã€‚å»ºè®®åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ç›‘æ§è¯¥è¶…æ—¶æ£€æŸ¥çš„ CPU å¼€é”€ï¼Œå¹¶è€ƒè™‘ä½¿ç”¨æ›´å¤§æ‰¹æ¬¡çš„å¼‚æ­¥ç­‰å¾…ï¼ˆä¾‹å¦‚ `wait`ï¼‰æ¥è¿›ä¸€æ­¥é™ä½è°ƒåº¦é¢‘ç‡ã€‚  
4. **æµ‹è¯•è¦†ç›–**ï¼šæ–°å¢çš„ç±»å’Œæ¥å£å¢åŠ äº†ä»£ç è·¯å¾„ï¼ˆåˆå§‹åŒ–ã€clearã€abortã€ç»Ÿè®¡ï¼‰ï¼Œè¯·åœ¨ CI ä¸­æ·»åŠ é’ˆå¯¹ `GrammarManager` çš„å•å…ƒæµ‹è¯•ï¼ŒéªŒè¯ï¼šç¼“å­˜å‘½ä¸­/æœªå‘½ä¸­ã€è¶…æ—¶æ·˜æ±°ã€è·¨ TP åŒæ­¥ä»¥åŠ `abort_requests` çš„å®Œæ•´æ€§ã€‚  
5. **æ–‡æ¡£ä¸ä½¿ç”¨æç¤º**ï¼š`--grammar-backend none` ä»ä¼šå¯¼è‡´ `grammar_backend` ä¸º `None`ï¼Œæ­¤æ—¶ `GrammarManager.process_req_with_grammar` ä¼šç›´æ¥ abort è¯·æ±‚ã€‚å»ºè®®åœ¨ README/CLI å¸®åŠ©ä¸­æ˜ç¡®æç¤ºç”¨æˆ·åœ¨ç¦ç”¨ grammar åä»å¯å‘é€æ™®é€šè¯·æ±‚ï¼Œä½†å«æœ‰ json/regex/ebnf å‚æ•°çš„è¯·æ±‚ä¼šè¢«å¿«é€Ÿæ‹’ç»ã€‚  

æ€»ä½“æ¥çœ‹ï¼ŒæŠ½ç¦»ä½¿ Scheduler çš„èŒè´£æ›´åŠ å•ä¸€ï¼Œä»£ç å¯ç»´æŠ¤æ€§æå‡ï¼›åªè¦åœ¨å¹¶å‘ã€å¼‚å¸¸å’Œæµ‹è¯•å±‚é¢åšå¥½ä¿éšœï¼Œæ”¹åŠ¨å¯¹ç°æœ‰åŠŸèƒ½çš„å½±å“åº”æ˜¯æ­£é¢çš„ã€‚

---

### Tiny fix typo `minxin` -> `mixin` (#16908)
**SHA**: `934ae89` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/934ae89abe104da5ca49f17d9f679c8d8a0f3c76)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šå…¶ä»–ï¼ˆTypo ä¿®å¤ï¼‰  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¡ ä¸­  
**ğŸ“‹ å˜æ›´æ‘˜è¦**ï¼šå°†æµ‹è¯•å¥—ä»¶ä¸­å‡ºç°çš„ç±»å `TestEBNFConstrainedMinxin` æ­£ç¡®æ‹¼å†™ä¸º `TestEBNFConstrainedMixin`ï¼Œå¹¶åŒæ­¥æ›´æ–°æ‰€æœ‰ç›¸å…³ import ä¸åŸºç±»å¼•ç”¨ã€‚  

**ğŸ¯ å½±å“èŒƒå›´**ï¼š  
- `python/sglang/test/kits/ebnf_constrained_kit.py`ï¼ˆç±»å®šä¹‰ï¼‰  
- `test/registered/constrained_decoding/test_constrained_decoding.py`ã€`test/registered/distributed/test_dp_attention.py`ï¼ˆæµ‹è¯•æ–‡ä»¶çš„ import ä¸ç»§æ‰¿ï¼‰  

**ğŸ’¡ å…³æ³¨å»ºè®®**ï¼š  
1. è¿è¡Œå®Œæ•´çš„å•å…ƒ/é›†æˆæµ‹è¯•ï¼Œç¡®è®¤æ²¡æœ‰é—æ¼çš„ `Minxin` æ‹¼å†™å¯¼è‡´ ImportErrorã€‚  
2. æ£€æŸ¥æ–‡æ¡£ã€ç¤ºä¾‹æˆ– CI é…ç½®ä¸­æ˜¯å¦ä»ä½¿ç”¨æ—§åç§°ï¼Œç»Ÿä¸€æ”¹ä¸º `Mixin`ã€‚  
3. ç”±äºæ”¹åŠ¨ä»…é™æµ‹è¯•ä»£ç ï¼Œä¸å½±å“åº“çš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œå¯ç›´æ¥åˆå¹¶ã€‚  

æ€»ä½“æ¥è¯´ï¼Œè¿™æ˜¯ä¸€å¤„ç»†å¾®çš„æ‹¼å†™é”™è¯¯ä¿®æ­£ï¼Œé£é™©æä½ï¼Œä»…éœ€éªŒè¯æµ‹è¯•ä»èƒ½å…¨éƒ¨é€šè¿‡å³å¯ã€‚

---

#### ğŸŸ¢ ä½é‡è¦åº¦å˜æ›´ (8)

### [CI] fix piecewise graph test case on ascend (#16933)
**SHA**: `9a62874` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/9a628744fcefb0aaf4920cb673ffee7f1d93458c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæµ‹è¯•ä¿®æ”¹  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£ `test/srt/ascend/test_ascend_piecewise_graph_prefill.py` ä¸­ `--piecewise-cuda-graph-tokens` å‚æ•°çš„æ‹¼æ¥æ–¹å¼ï¼Œç”±åŸæ¥çš„åˆ—è¡¨å†™æ³•æ”¹ä¸ºå…ˆé—­åˆåˆ—è¡¨å†åŠ  `TOKENS_TO_CAPTURE`ï¼Œç¡®ä¿ Ascend ç¯å¢ƒä¸‹ piecewise å›¾æµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚

---

### Bugfix: EagleDraftWorker has not attribute "eagle_use_aux_hidden_state" (#16480)
**SHA**: `53dca74` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/53dca74f478dc245242e735b2476b4529b0e504f)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `EagleDraftWorker` ä¸­æ–°å¢ `eagle_use_aux_hidden_state` æ ‡å¿—ï¼Œå¹¶æ ¹æ® `eagle3` é…ç½®è¯»å– `use_aux_hidden_state`ï¼Œè§£å†³å±æ€§ç¼ºå¤±å¯¼è‡´çš„è¿è¡Œé”™è¯¯ã€‚

---

### add doc for dsv32 cp+pp (#16916)
**SHA**: `aab640c` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/aab640c99f22e4920d87571f5a625e019f45bf02)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `deepseek_v32.md` ä¸­æ–°å¢ Pipeline Parallel + Context Parallelï¼ˆPP+CPï¼‰åŠå…¶åœ¨ PD Disaggregation åœºæ™¯ä¸‹çš„å¯åŠ¨ç¤ºä¾‹ä¸å‚è€ƒé“¾æ¥ï¼Œå®Œå–„ä½¿ç”¨è¯´æ˜ã€‚

---

### Fix wrong kernel selection for int32/int64 indices (#16912)
**SHA**: `2b3791e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/2b3791ed370048fceda5df957d88b8e80863dd21)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `kvcache.cuh` ä¸­å¼•å…¥ `indice_dtype`ï¼Œå¹¶ä¾æ®å…¶ç±»å‹ï¼ˆint32/int64ï¼‰æ­£ç¡®é€‰æ‹©å¯¹åº”çš„ KVâ€‘Cache kernelï¼Œä¿®å¤äº†ç´¢å¼•ç±»å‹é”™è¯¯å¯¼è‡´çš„ kernel é€‰æ‹©é—®é¢˜ã€‚

---

### [model-gateway] Improve Health Check Logging (#16930)
**SHA**: `c54c70a` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/c54c70ab62180cca8a4b652c65107eb6df683a23)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¿®æ­£ health_url çš„å¼•ç”¨æ–¹å¼ï¼Œæ–°å¢å¯¹éæˆåŠŸ HTTP çŠ¶æ€çš„è­¦å‘Šæ—¥å¿—ï¼Œå¹¶ç»Ÿä¸€é”™è¯¯æ—¥å¿—çš„ URLï¼Œæå‡å¥åº·æ£€æŸ¥æ—¥å¿—å¯è¯»æ€§ã€‚

---

### [NPU] update feature supported on ascend NPU (#16915)
**SHA**: `c581b5e` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/c581b5ed799901982c361142a85bc98aaac9e32c)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šæ–‡æ¡£æ›´æ–°  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `docs/platforms/ascend_npu_support_features.md` ä¸­ï¼Œé‡æ–°æ•´ç†äº† Speculative è§£ç ç›¸å…³å‚æ•°è¡¨ï¼Œç²¾ç®€äº† Options åˆ—ï¼Œä»…ä¿ç•™ Ascend NPU æ”¯æŒçš„é€‰é¡¹å¹¶ç”¨ âœ“/âœ— æ ‡ç¤ºå¯ç”¨æ€§ï¼ŒåŒæ—¶æ›´æ–°äº† HICache ç›¸å…³å‚æ•°çš„æ”¯æŒçŠ¶æ€ã€‚

---

### Tiny fix NoAvailableWorkers being a RetryError (#16896)
**SHA**: `a1c4894` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/a1c48943d7de4a2c2b18980259761de348aecde7)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šåœ¨ `retry.rs` ä¸­ç§»é™¤ `RetryError` æšä¸¾çš„ `NoAvailableWorkers` å˜ä½“ï¼Œç®€åŒ–é”™è¯¯å®šä¹‰ã€‚

---

### llama model and llama eagle3 model support dp-attn (#15268)
**SHA**: `38a8847` | ğŸ”— [æŸ¥çœ‹æäº¤](https://github.com/sgl-project/sglang/commit/38a88479c6a739b1a57778f2146b13f113875646)

**ğŸ¯ å˜æ›´ç±»å‹**ï¼šä»£ç é‡æ„  
**âš¡ é‡è¦ç¨‹åº¦**ï¼šğŸŸ¢ä½  
**ğŸ“‹ æ‘˜è¦**ï¼šä¸º LLaMA/Eagle3 æ¨¡å‹åŠ å…¥ DPâ€‘Attention æ”¯æŒï¼Œæ–°å¢ `get_attention_tp_group` å¯¼å…¥ï¼Œå¹¶åœ¨ draft åˆå§‹åŒ–åŠå‰å‘æ¨ç†æ—¶æ¡ä»¶æ€§ä½¿ç”¨ `draft_tp_context`ã€‚

---

